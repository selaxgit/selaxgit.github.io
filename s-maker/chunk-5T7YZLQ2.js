import{$a as je,$b as ee,$c as zt,Aa as m,Ad as jn,Ae as Ee,Ba as U,Bb as ki,Bd as Bn,Be as Jn,C as xi,Ca as ln,Cb as gn,D as Yi,Da as cn,Db as Me,De as ei,E as Te,Ea as V,F as Ei,Fc as Dn,G as ut,Ga as g,Gb as Cn,Gc as Pn,Ha as C,Hb as vn,Hc as In,He as Kn,I as dt,J as Xi,K as Ue,Ka as un,Kb as Sn,Kd as Ut,L as Qi,Lb as Mi,M as A,Md as qt,Nd as Zt,Oa as Lt,Od as Wt,Pa as Rt,Pb as Ce,Qa as Ft,Qb as X,R as en,Ra as pt,Rb as G,Rc as Tn,Rd as $n,S,Sa as v,Sb as q,Sd as Hn,T as w,Ta as ke,Tb as Z,Tc as re,Ua as mt,Ub as wn,Uc as kn,V as tn,Va as At,W as kt,Wa as qe,Wb as yn,Wc as Mn,X as J,Xa as Ze,Y as Mt,Ya as We,Yc as Ht,Z as Di,Za as Je,_a as ht,a as ze,aa as nn,ab as Be,ac as bn,ad as Ln,b as yi,bb as dn,bc as xn,be as zn,c as H,cb as pn,cc as Ot,ce as Gn,d as Wi,da as f,dc as Ke,de as Jt,e as Ji,ea as T,eb as L,ed as Rn,ee as Kt,fb as R,fc as Nt,fd as Fn,fe as ve,gc as jt,gd as An,ge as Yt,h as lt,ha as rn,hb as $e,hc as Bt,hd as Vn,he as Xt,ia as ge,ib as _t,ic as En,id as On,ja as N,jb as mn,jc as ne,jd as Gt,k as Ki,ka as on,l as Ge,la as Pi,lb as Ti,mb as hn,me as Un,na as Ii,nb as Y,ne as qn,oa as I,ob as z,pa as sn,pc as $t,qa as y,r as ct,s as Tt,sa as le,se as Zn,ua as k,ub as _n,ue as Qt,va as an,w as xe,wb as ft,xa as me,xb as Vt,ya as he,yb as gt,yd as Nn,z as bi,za as d,zb as fn,ze as Wn}from"./chunk-FGQYVVFQ.js";import"./chunk-XP2N47VC.js";import{k as St}from"./chunk-XJADAOP3.js";import"./chunk-WDCVTZT5.js";import"./chunk-ZKQ77EQL.js";import"./chunk-Q75QCHGE.js";import"./chunk-JOYMENOW.js";import{L as Ct,Q as Le,W as vt,a as Q,b as Ie,i as at}from"./chunk-FY46XAGK.js";var ti=class extends Le{constructor(i){super(),i.canvas&&(this.sprite=new vt(Ct.from(i.canvas)),this.addChild(this.sprite)),i.canvasFlipH&&(this.spriteFlipH=new vt(Ct.from(i.canvasFlipH)),this.addChild(this.spriteFlipH)),i.canvasFlipV&&(this.spriteFlipV=new vt(Ct.from(i.canvasFlipV)),this.addChild(this.spriteFlipV)),i.canvasFlipHV&&(this.spriteFlipHV=new vt(Ct.from(i.canvasFlipHV)),this.addChild(this.spriteFlipHV))}updateFrame(i,e,t){this.x=i.x,this.y=i.y,this.visible=i.visible,this.sprite.visible=!1,this.spriteFlipH.visible=!1,this.spriteFlipV.visible=!1,this.spriteFlipHV.visible=!1,e&&t?this.spriteFlipHV.visible=!0:e?this.spriteFlipH.visible=!0:t?this.spriteFlipV.visible=!0:this.sprite.visible=!0}};var ii=class extends Le{constructor(i,e){super(),this.framesCacheService=i,this.gLayerRect=new St,this.frames=new Map,this.addChild(this.gLayerRect),this.updateLayer(e)}updateLayer(i){return at(this,null,function*(){let e=[];for(let t of i.frames)e.push(t.id),this.frames.has(t.id)?this.frames.get(t.id)?.updateFrame(t,i.flipHorizontal,i.flipVertical):(yield this.addFrame(t)).updateFrame(t,i.flipHorizontal,i.flipVertical);for(let t of this.frames.keys())e.includes(t)||(this.frames.get(t)?.destroy(!0),this.frames.delete(t));this.position.set(i.x,i.y),this.zIndex=i.zIndex,this.visible=i.visible,this.updateLayerRect(i.bgColor)})}addFrame(i){return at(this,null,function*(){let e=yield this.framesCacheService.getCache({id:i.id,file:i.file}),t=new ti(e);return this.addChild(t),this.frames.set(i.id,t),t})}updateLayerRect(i){this.gLayerRect.clear(),i&&this.gLayerRect.rect(0,0,this.width,this.height).fill(Nt.hex2hexadecimal(i))}};var ni=class extends Le{constructor(i){super(),this.framesCacheService=i,this.layers=new Map,this.sortableChildren=!0}updateLayers(i){return at(this,null,function*(){let e=[];for(let t of i)e.push(t.id),this.layers.has(t.id)?this.layers.get(t.id)?.updateLayer(t):this.addLayer(t);for(let t of this.layers.keys())e.includes(t)||(this.layers.get(t)?.destroy(!0),this.layers.delete(t))})}addLayer(i){let e=new ii(this.framesCacheService,i);this.addChild(e),this.layers.set(i.id,e)}};var Yn=11161352,ri=class extends Le{constructor(i){super(),this.framesCacheService=i,this.animationCompleteEvent=new J,this.animationFrameChangeEvent=new J,this.gSpriteRect=new St,this.gSpriteGround=new St,this.adjustmentContainer=new ni(this.framesCacheService),this.viewSpriteContainer=new Bt(this.framesCacheService),this.ngUnsubscribe=new H,this.initialize()}get rectWidth(){return this.gSpriteRect.width}get rectHeight(){return this.gSpriteRect.height}destroy(i){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete(),this.adjustmentContainer.destroy(i),this.viewSpriteContainer.destroy(i),super.destroy(i)}setCurrentFrame(i){this.viewSpriteContainer.setCurrentFrame(i)}animationPlay(i){this.viewSpriteContainer.play=i}setAnimation(i){this.viewSpriteContainer.setAnimation(i)}initViewSprite(i){this.viewSpriteContainer.initSprite(i)}setView(i){i==="adjustment"?(this.viewSpriteContainer.visible=!1,this.adjustmentContainer.visible=!0):(this.adjustmentContainer.visible=!1,this.viewSpriteContainer.visible=!0)}updateLayers(i){this.adjustmentContainer.updateLayers(i),this.viewSpriteContainer.setLayers(i)}drawSpriteGround(i){this.gSpriteGround.clear(),i&&this.gSpriteGround.moveTo(0,i.y).lineTo(this.rectWidth,i.y).stroke({width:1,color:Yn}).circle(i.x,i.y,5).fill(Yn)}drawSpriteRect(i,e,t=null){this.gSpriteRect.clear().rect(0,0,i,e),t!==null&&this.gSpriteRect.fill(t),this.gSpriteRect.stroke({width:1,color:0})}initialize(){this.addChild(this.viewSpriteContainer),this.addChild(this.adjustmentContainer),this.addChild(this.gSpriteRect),this.addChild(this.gSpriteGround),this.viewSpriteContainer.animationFrameChangeEvent.pipe(Te(this.ngUnsubscribe)).subscribe(i=>{this.animationFrameChangeEvent.emit(i)}),this.viewSpriteContainer.animationCompleteEvent.pipe(Te(this.ngUnsubscribe)).subscribe(()=>{this.animationCompleteEvent.emit()})}};var Xr=["pixiContainer"];function Qr(n,i){if(n&1){let e=V();d(0,"button",15),g("click",function(){S(e);let r=C(2);return w(r.onSetAnimationPlaying(!1))}),d(1,"mat-icon"),v(2,"stop"),m()()}}function eo(n,i){if(n&1){let e=V();d(0,"button",16),g("click",function(){S(e);let r=C(2);return w(r.onSetAnimationPlaying(!0))}),d(1,"mat-icon"),v(2,"play_arrow"),m()()}if(n&2){C(2);let e=je(2);y("disabled",!(e!=null&&e.id))}}function to(n,i){if(n&1){let e=V();d(0,"div",8),v(1,"\xA0"),m(),d(2,"button",9),g("click",function(){S(e);let r=C();return w(r.onAnimationSetFrame("first"))}),d(3,"mat-icon"),v(4,"first_page"),m()(),d(5,"button",10),g("click",function(){S(e);let r=C();return w(r.onAnimationSetFrame("prev"))}),d(6,"mat-icon"),v(7,"chevron_left"),m()(),I(8,Qr,3,0,"button",11)(9,eo,3,1,"button",12),d(10,"button",13),g("click",function(){S(e);let r=C();return w(r.onAnimationSetFrame("next"))}),d(11,"mat-icon"),v(12,"chevron_right"),m()(),d(13,"button",14),g("click",function(){S(e);let r=C();return w(r.onAnimationSetFrame("last"))}),d(14,"mat-icon"),v(15,"last_page"),m()()}if(n&2){C();let e=je(2),t=je(4);f(2),y("disabled",!(e!=null&&e.id)),f(3),y("disabled",!(e!=null&&e.id)),f(3),k(t!=null&&t.playing?8:9),f(2),y("disabled",!(e!=null&&e.id)),f(3),y("disabled",!(e!=null&&e.id))}}function io(n,i){if(n&1&&(d(0,"div",5)(1,"div",17)(2,"strong"),v(3,"\u0410\u043D\u0438\u043C\u0430\u0446\u0438\u044F:"),m(),d(4,"span",18),v(5),m()(),d(6,"strong"),v(7,"\u0424\u0440\u0435\u0439\u043C:"),m(),d(8,"span",18),v(9),m()()),n&2){let e,t=C(),r=je(2);f(5),ke((e=r==null?null:r.name)!==null&&e!==void 0?e:"<\u043D\u0435 \u0432\u044B\u0431\u0440\u0430\u043D\u0430>"),f(4),ke(t.animationFrameFromTotal())}}var Xn=(()=>{class n{constructor(e,t){this.spriteStore=e,this.framesCacheService=t,this.animationFrameFromTotal=ge("0 \u0438\u0437 0"),this.spriteEditState$=this.spriteStore.spriteEditState$,this.animationPlaying$=this.spriteStore.animationPlaying$,this.currentAnimation$=this.spriteStore.currentAnimation$,this.appPixi=new jt,this.spriteContainer=new ri(this.framesCacheService),this.destroyRef$=A(kt),this.hasInitViewSprite=!1,this.animationFrameCurrent=0,this.animationFrameTotal=0,this.appPixi.onZoomDone=()=>this.centeredSpriteContainer()}ngAfterViewInit(){this.initializePixi()}ngOnDestroy(){this.appPixi.destroy()}onAnimationSetFrame(e){switch(e){case"first":this.spriteContainer.setCurrentFrame(0),this.setCurrentFrame(0,this.animationFrameTotal);break;case"prev":{let t=this.animationFrameCurrent-1<0?this.animationFrameTotal-1:this.animationFrameCurrent-1;this.spriteContainer.setCurrentFrame(t),this.setCurrentFrame(t,this.animationFrameTotal);break}case"next":{let t=this.animationFrameCurrent+1>=this.animationFrameTotal?0:this.animationFrameCurrent+1;this.spriteContainer.setCurrentFrame(t),this.setCurrentFrame(t,this.animationFrameTotal);break}case"last":this.spriteContainer.setCurrentFrame(this.animationFrameTotal-1),this.setCurrentFrame(this.animationFrameTotal-1,this.animationFrameTotal);break}}onSetAnimationPlaying(e){this.spriteStore.currentAnimation$.pipe(xe(1)).subscribe(t=>{t&&this.spriteStore.setAnimationPlaying({id:t.id,playing:e})})}onZoom(e){this.appPixi.setZoom(e,!1)}onSetSpriteEditState(e){this.spriteStore.setSpriteEditState(e)}initializePixi(){this.appPixi.useScale=!0,this.appPixi.initialize(this.pixiContainerRef.nativeElement).then(()=>{this.appPixi.attachScaleContainer(this.spriteContainer),this.spriteContainer.animationFrameChangeEvent.pipe(ee(this.destroyRef$)).subscribe(e=>{this.setCurrentFrame(e.current,e.total)}),this.spriteContainer.animationCompleteEvent.pipe(ee(this.destroyRef$)).subscribe(()=>{this.onSetAnimationPlaying(!1)}),this.initializeSubscriptions()})}initializeSubscriptions(){this.spriteStore.sprite$.pipe(ee(this.destroyRef$)).subscribe(e=>{this.updateSprite(e)}),this.spriteStore.layers$.pipe(ee(this.destroyRef$)).subscribe(e=>{this.updateLayers(e)}),this.spriteStore.spriteEditState$.pipe(ee(this.destroyRef$)).subscribe(e=>{this.spriteContainer.setView(e)}),this.spriteStore.currentAnimation$.pipe(ee(this.destroyRef$)).subscribe(e=>{this.spriteContainer.setAnimation(e),e?.layers[0]?.frames.length&&this.setCurrentFrame(0,e.layers[0].frames.length)}),this.spriteStore.animationPlaying$.pipe(ee(this.destroyRef$)).subscribe(e=>{this.spriteContainer.animationPlay(e?.playing??!1)})}updateLayers(e){this.spriteContainer.updateLayers(e)}updateSprite(e){e?(this.spriteContainer.drawSpriteRect(e.width,e.height,e.bgColor?Nt.hex2hexadecimal(e.bgColor):null),e.visibleGroundPoint?this.spriteContainer.drawSpriteGround({x:e.groundPointX??0,y:e.groundPointY??0}):this.spriteContainer.drawSpriteGround(null),this.hasInitViewSprite||(this.hasInitViewSprite=!0,this.spriteContainer.initViewSprite(e))):(this.spriteContainer.drawSpriteRect(0,0),this.spriteContainer.drawSpriteGround(null)),this.centeredSpriteContainer()}centeredSpriteContainer(){this.spriteContainer.x=(this.appPixi.screenWidth-this.spriteContainer.width)/2,this.spriteContainer.y=(this.appPixi.screenHeight-this.spriteContainer.height)/2}setCurrentFrame(e,t){this.animationFrameCurrent=e,this.animationFrameTotal=t,this.animationFrameFromTotal.set(`${e+1} \u0438\u0437 ${t}`)}static{this.\u0275fac=function(t){return new(t||n)(T(re),T($t))}}static{this.\u0275cmp=N({type:n,selectors:[["sc-sprite-adjustment"]],viewQuery:function(t,r){if(t&1&&Lt(Xr,5),t&2){let o;Rt(o=Ft())&&(r.pixiContainerRef=o.first)}},decls:18,vars:16,consts:[["pixiContainer",""],[1,"flex-row-align-center","border-bottom","pl-5","pr-5"],[1,"flex-row-align-center","flex-auto"],["buttonColor","primary",3,"zoomEvent"],["mat-button","","color","primary",3,"click","disabled"],[1,"flex-row-align-center","padding-10"],[1,"flex-auto","flex-col","p-relative"],[1,"pixi-container"],[1,"tools-divider"],["mat-icon-button","","title","\u041F\u0435\u0440\u0432\u044B\u0439 \u0444\u0440\u0435\u0439\u043C","color","primary",3,"click","disabled"],["mat-icon-button","","title","\u041F\u0440\u0435\u0434\u044B\u0434\u0443\u0449\u0438\u0439 \u0444\u0440\u0435\u0439\u043C","color","primary",3,"click","disabled"],["mat-icon-button","","title","\u041E\u0441\u0442\u0430\u043D\u043E\u0432\u0438\u0442\u044C","color","primary"],["mat-icon-button","","title","\u041F\u0440\u043E\u0438\u0433\u0440\u0430\u0442\u044C","color","primary",3,"disabled"],["mat-icon-button","","title","\u0421\u043B\u0435\u0434\u0443\u044E\u0449\u0438\u0439 \u0444\u0440\u0435\u0439\u043C","color","primary",3,"click","disabled"],["mat-icon-button","","title","\u041F\u043E\u0441\u043B\u0435\u0434\u043D\u0438\u0439 \u0444\u0440\u0435\u0439\u043C","color","primary",3,"click","disabled"],["mat-icon-button","","title","\u041E\u0441\u0442\u0430\u043D\u043E\u0432\u0438\u0442\u044C","color","primary",3,"click"],["mat-icon-button","","title","\u041F\u0440\u043E\u0438\u0433\u0440\u0430\u0442\u044C","color","primary",3,"click","disabled"],[1,"flex-auto"],[1,"ml-10"]],template:function(t,r){if(t&1){let o=V();Je(0),L(1,"async"),Je(2),L(3,"async"),Je(4),L(5,"async"),d(6,"div",1)(7,"div",2)(8,"smc-scale-buttons",3),g("zoomEvent",function(a){return S(o),w(r.onZoom(a))}),m(),I(9,to,16,5),m(),d(10,"button",4),g("click",function(){return S(o),w(r.onSetSpriteEditState("adjustment"))}),v(11," \u0420\u0435\u0436\u0438\u043C \u0441\u043F\u0440\u0430\u0439\u0442\u0430 "),m(),d(12,"button",4),g("click",function(){return S(o),w(r.onSetSpriteEditState("animations"))}),v(13," \u0420\u0435\u0436\u0438\u043C \u0430\u043D\u0438\u043C\u0430\u0446\u0438\u0438 "),m()(),I(14,io,10,2,"div",5),d(15,"div",6),U(16,"div",7,0),m()}if(t&2){let o=R(1,8,r.spriteEditState$);f(2),ht(R(3,10,r.currentAnimation$)),f(2),ht(R(5,13,r.animationPlaying$)),f(5),k(o==="animations"?9:-1),f(),le("button-font-size-lg",o==="adjustment"),y("disabled",o==="adjustment"),f(2),le("button-font-size-lg",o==="animations"),y("disabled",o==="animations"),f(2),k(o==="animations"?14:-1)}},dependencies:[z,Y,G,Ce,X,Z,q,ei],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column}.pixi-container[_ngcontent-%COMP%]{position:absolute;inset:5px;z-index:0;overflow:hidden}"],changeDetection:0})}}return n})();function fr(n){let i=n.cloneNode(!0),e=i.querySelectorAll("[id]"),t=n.nodeName.toLowerCase();i.removeAttribute("id");for(let r=0;r<e.length;r++)e[r].removeAttribute("id");return t==="canvas"?tr(n,i):(t==="input"||t==="select"||t==="textarea")&&er(n,i),Qn("canvas",n,i,tr),Qn("input, textarea, select",n,i,er),i}function Qn(n,i,e,t){let r=i.querySelectorAll(n);if(r.length){let o=e.querySelectorAll(n);for(let s=0;s<r.length;s++)t(r[s],o[s])}}var no=0;function er(n,i){i.type!=="file"&&(i.value=n.value),i.type==="radio"&&i.name&&(i.name=`mat-clone-${i.name}-${no++}`)}function tr(n,i){let e=i.getContext("2d");if(e)try{e.drawImage(n,0,0)}catch{}}function Ni(n){let i=n.getBoundingClientRect();return{top:i.top,right:i.right,bottom:i.bottom,left:i.left,width:i.width,height:i.height,x:i.x,y:i.y}}function Ri(n,i,e){let{top:t,bottom:r,left:o,right:s}=n;return e>=t&&e<=r&&i>=o&&i<=s}function yt(n,i,e){n.top+=i,n.bottom=n.top+n.height,n.left+=e,n.right=n.left+n.width}function ir(n,i,e,t){let{top:r,right:o,bottom:s,left:a,width:c,height:l}=n,u=c*i,p=l*i;return t>r-p&&t<s+p&&e>a-u&&e<o+u}var ai=class{_document;positions=new Map;constructor(i){this._document=i}clear(){this.positions.clear()}cache(i){this.clear(),this.positions.set(this._document,{scrollPosition:this.getViewportScrollPosition()}),i.forEach(e=>{this.positions.set(e,{scrollPosition:{top:e.scrollTop,left:e.scrollLeft},clientRect:Ni(e)})})}handleScroll(i){let e=gt(i),t=this.positions.get(e);if(!t)return null;let r=t.scrollPosition,o,s;if(e===this._document){let l=this.getViewportScrollPosition();o=l.top,s=l.left}else o=e.scrollTop,s=e.scrollLeft;let a=r.top-o,c=r.left-s;return this.positions.forEach((l,u)=>{l.clientRect&&e!==u&&e.contains(u)&&yt(l.clientRect,a,c)}),r.top=o,r.left=s,{top:a,left:c}}getViewportScrollPosition(){return{top:window.scrollY,left:window.scrollX}}};function gr(n,i){let e=n.rootNodes;if(e.length===1&&e[0].nodeType===i.ELEMENT_NODE)return e[0];let t=i.createElement("div");return e.forEach(r=>t.appendChild(r)),t}function ji(n,i,e){for(let t in i)if(i.hasOwnProperty(t)){let r=i[t];r?n.setProperty(t,r,e?.has(t)?"important":""):n.removeProperty(t)}return n}function Xe(n,i){let e=i?"":"none";ji(n.style,{"touch-action":i?"":"none","-webkit-user-drag":i?"":"none","-webkit-tap-highlight-color":i?"":"transparent","user-select":e,"-ms-user-select":e,"-webkit-user-select":e,"-moz-user-select":e})}function nr(n,i,e){ji(n.style,{position:i?"":"fixed",top:i?"":"0",opacity:i?"":"0",left:i?"":"-999em"},e)}function li(n,i){return i&&i!="none"?n+" "+i:n}function rr(n,i){n.style.width=`${i.width}px`,n.style.height=`${i.height}px`,n.style.transform=ci(i.left,i.top)}function ci(n,i){return`translate3d(${Math.round(n)}px, ${Math.round(i)}px, 0)`}function or(n){let i=n.toLowerCase().indexOf("ms")>-1?1:1e3;return parseFloat(n)*i}function ro(n){let i=getComputedStyle(n),e=Li(i,"transition-property"),t=e.find(a=>a==="transform"||a==="all");if(!t)return 0;let r=e.indexOf(t),o=Li(i,"transition-duration"),s=Li(i,"transition-delay");return or(o[r])+or(s[r])}function Li(n,i){return n.getPropertyValue(i).split(",").map(t=>t.trim())}var oo=new Set(["position"]),Fi=class{_document;_rootElement;_direction;_initialDomRect;_previewTemplate;_previewClass;_pickupPositionOnPage;_initialTransform;_zIndex;_previewEmbeddedView;_preview;get element(){return this._preview}constructor(i,e,t,r,o,s,a,c,l){this._document=i,this._rootElement=e,this._direction=t,this._initialDomRect=r,this._previewTemplate=o,this._previewClass=s,this._pickupPositionOnPage=a,this._initialTransform=c,this._zIndex=l}attach(i){this._preview=this._createPreview(),i.appendChild(this._preview),sr(this._preview)&&this._preview.showPopover()}destroy(){this._preview.remove(),this._previewEmbeddedView?.destroy(),this._preview=this._previewEmbeddedView=null}setTransform(i){this._preview.style.transform=i}getBoundingClientRect(){return this._preview.getBoundingClientRect()}addClass(i){this._preview.classList.add(i)}getTransitionDuration(){return ro(this._preview)}addEventListener(i,e){this._preview.addEventListener(i,e)}removeEventListener(i,e){this._preview.removeEventListener(i,e)}_createPreview(){let i=this._previewTemplate,e=this._previewClass,t=i?i.template:null,r;if(t&&i){let o=i.matchSize?this._initialDomRect:null,s=i.viewContainer.createEmbeddedView(t,i.context);s.detectChanges(),r=gr(s,this._document),this._previewEmbeddedView=s,i.matchSize?rr(r,o):r.style.transform=ci(this._pickupPositionOnPage.x,this._pickupPositionOnPage.y)}else r=fr(this._rootElement),rr(r,this._initialDomRect),this._initialTransform&&(r.style.transform=this._initialTransform);return ji(r.style,{"pointer-events":"none",margin:sr(r)?"0 auto 0 0":"0",position:"fixed",top:"0",left:"0","z-index":this._zIndex+""},oo),Xe(r,!1),r.classList.add("cdk-drag-preview"),r.setAttribute("popover","manual"),r.setAttribute("dir",this._direction),e&&(Array.isArray(e)?e.forEach(o=>r.classList.add(o)):r.classList.add(e)),r}};function sr(n){return"showPopover"in n}var ar=ft({passive:!0}),oi=ft({passive:!1}),lr=ft({passive:!1,capture:!0}),so=800,cr=new Set(["position"]),Ai=class{_config;_document;_ngZone;_viewportRuler;_dragDropRegistry;_preview;_previewContainer;_placeholderRef;_placeholder;_pickupPositionInElement;_pickupPositionOnPage;_anchor;_passiveTransform={x:0,y:0};_activeTransform={x:0,y:0};_initialTransform;_hasStartedDragging=ge(!1);_hasMoved;_initialContainer;_initialIndex;_parentPositions;_moveEvents=new H;_pointerDirectionDelta;_pointerPositionAtLastDirectionChange;_lastKnownPointerPosition;_rootElement;_ownerSVGElement;_rootElementTapHighlight;_pointerMoveSubscription=ze.EMPTY;_pointerUpSubscription=ze.EMPTY;_scrollSubscription=ze.EMPTY;_resizeSubscription=ze.EMPTY;_lastTouchEventTime;_dragStartTime;_boundaryElement=null;_nativeInteractionsEnabled=!0;_initialDomRect;_previewRect;_boundaryRect;_previewTemplate;_placeholderTemplate;_handles=[];_disabledHandles=new Set;_dropContainer;_direction="ltr";_parentDragRef;_cachedShadowRoot;lockAxis;dragStartDelay=0;previewClass;scale=1;get disabled(){return this._disabled||!!(this._dropContainer&&this._dropContainer.disabled)}set disabled(i){i!==this._disabled&&(this._disabled=i,this._toggleNativeDragInteractions(),this._handles.forEach(e=>Xe(e,i)))}_disabled=!1;beforeStarted=new H;started=new H;released=new H;ended=new H;entered=new H;exited=new H;dropped=new H;moved=this._moveEvents;data;constrainPosition;constructor(i,e,t,r,o,s){this._config=e,this._document=t,this._ngZone=r,this._viewportRuler=o,this._dragDropRegistry=s,this.withRootElement(i).withParent(e.parentDragRef||null),this._parentPositions=new ai(t),s.registerDragItem(this)}getPlaceholderElement(){return this._placeholder}getRootElement(){return this._rootElement}getVisibleElement(){return this.isDragging()?this.getPlaceholderElement():this.getRootElement()}withHandles(i){this._handles=i.map(t=>Me(t)),this._handles.forEach(t=>Xe(t,this.disabled)),this._toggleNativeDragInteractions();let e=new Set;return this._disabledHandles.forEach(t=>{this._handles.indexOf(t)>-1&&e.add(t)}),this._disabledHandles=e,this}withPreviewTemplate(i){return this._previewTemplate=i,this}withPlaceholderTemplate(i){return this._placeholderTemplate=i,this}withRootElement(i){let e=Me(i);return e!==this._rootElement&&(this._rootElement&&this._removeRootElementListeners(this._rootElement),this._ngZone.runOutsideAngular(()=>{e.addEventListener("mousedown",this._pointerDown,oi),e.addEventListener("touchstart",this._pointerDown,ar),e.addEventListener("dragstart",this._nativeDragStart,oi)}),this._initialTransform=void 0,this._rootElement=e),typeof SVGElement<"u"&&this._rootElement instanceof SVGElement&&(this._ownerSVGElement=this._rootElement.ownerSVGElement),this}withBoundaryElement(i){return this._boundaryElement=i?Me(i):null,this._resizeSubscription.unsubscribe(),i&&(this._resizeSubscription=this._viewportRuler.change(10).subscribe(()=>this._containInsideBoundaryOnResize())),this}withParent(i){return this._parentDragRef=i,this}dispose(){this._removeRootElementListeners(this._rootElement),this.isDragging()&&this._rootElement?.remove(),this._anchor?.remove(),this._destroyPreview(),this._destroyPlaceholder(),this._dragDropRegistry.removeDragItem(this),this._removeListeners(),this.beforeStarted.complete(),this.started.complete(),this.released.complete(),this.ended.complete(),this.entered.complete(),this.exited.complete(),this.dropped.complete(),this._moveEvents.complete(),this._handles=[],this._disabledHandles.clear(),this._dropContainer=void 0,this._resizeSubscription.unsubscribe(),this._parentPositions.clear(),this._boundaryElement=this._rootElement=this._ownerSVGElement=this._placeholderTemplate=this._previewTemplate=this._anchor=this._parentDragRef=null}isDragging(){return this._hasStartedDragging()&&this._dragDropRegistry.isDragging(this)}reset(){this._rootElement.style.transform=this._initialTransform||"",this._activeTransform={x:0,y:0},this._passiveTransform={x:0,y:0}}disableHandle(i){!this._disabledHandles.has(i)&&this._handles.indexOf(i)>-1&&(this._disabledHandles.add(i),Xe(i,!0))}enableHandle(i){this._disabledHandles.has(i)&&(this._disabledHandles.delete(i),Xe(i,this.disabled))}withDirection(i){return this._direction=i,this}_withDropContainer(i){this._dropContainer=i}getFreeDragPosition(){let i=this.isDragging()?this._activeTransform:this._passiveTransform;return{x:i.x,y:i.y}}setFreeDragPosition(i){return this._activeTransform={x:0,y:0},this._passiveTransform.x=i.x,this._passiveTransform.y=i.y,this._dropContainer||this._applyRootElementTransform(i.x,i.y),this}withPreviewContainer(i){return this._previewContainer=i,this}_sortFromLastPointerPosition(){let i=this._lastKnownPointerPosition;i&&this._dropContainer&&this._updateActiveDropContainer(this._getConstrainedPointerPosition(i),i)}_removeListeners(){this._pointerMoveSubscription.unsubscribe(),this._pointerUpSubscription.unsubscribe(),this._scrollSubscription.unsubscribe(),this._getShadowRoot()?.removeEventListener("selectstart",dr,lr)}_destroyPreview(){this._preview?.destroy(),this._preview=null}_destroyPlaceholder(){this._placeholder?.remove(),this._placeholderRef?.destroy(),this._placeholder=this._placeholderRef=null}_pointerDown=i=>{if(this.beforeStarted.next(),this._handles.length){let e=this._getTargetHandle(i);e&&!this._disabledHandles.has(e)&&!this.disabled&&this._initializeDragSequence(e,i)}else this.disabled||this._initializeDragSequence(this._rootElement,i)};_pointerMove=i=>{let e=this._getPointerPositionOnPage(i);if(!this._hasStartedDragging()){let r=Math.abs(e.x-this._pickupPositionOnPage.x),o=Math.abs(e.y-this._pickupPositionOnPage.y);if(r+o>=this._config.dragStartThreshold){let a=Date.now()>=this._dragStartTime+this._getDragStartDelay(i),c=this._dropContainer;if(!a){this._endDragSequence(i);return}(!c||!c.isDragging()&&!c.isReceiving())&&(i.cancelable&&i.preventDefault(),this._hasStartedDragging.set(!0),this._ngZone.run(()=>this._startDragSequence(i)))}return}i.cancelable&&i.preventDefault();let t=this._getConstrainedPointerPosition(e);if(this._hasMoved=!0,this._lastKnownPointerPosition=e,this._updatePointerDirectionDelta(t),this._dropContainer)this._updateActiveDropContainer(t,e);else{let r=this.constrainPosition?this._initialDomRect:this._pickupPositionOnPage,o=this._activeTransform;o.x=t.x-r.x+this._passiveTransform.x,o.y=t.y-r.y+this._passiveTransform.y,this._applyRootElementTransform(o.x,o.y)}this._moveEvents.observers.length&&this._ngZone.run(()=>{this._moveEvents.next({source:this,pointerPosition:t,event:i,distance:this._getDragDistance(t),delta:this._pointerDirectionDelta})})};_pointerUp=i=>{this._endDragSequence(i)};_endDragSequence(i){if(this._dragDropRegistry.isDragging(this)&&(this._removeListeners(),this._dragDropRegistry.stopDragging(this),this._toggleNativeDragInteractions(),this._handles&&(this._rootElement.style.webkitTapHighlightColor=this._rootElementTapHighlight),!!this._hasStartedDragging()))if(this.released.next({source:this,event:i}),this._dropContainer)this._dropContainer._stopScrolling(),this._animatePreviewToPlaceholder().then(()=>{this._cleanupDragArtifacts(i),this._cleanupCachedDimensions(),this._dragDropRegistry.stopDragging(this)});else{this._passiveTransform.x=this._activeTransform.x;let e=this._getPointerPositionOnPage(i);this._passiveTransform.y=this._activeTransform.y,this._ngZone.run(()=>{this.ended.next({source:this,distance:this._getDragDistance(e),dropPoint:e,event:i})}),this._cleanupCachedDimensions(),this._dragDropRegistry.stopDragging(this)}}_startDragSequence(i){wt(i)&&(this._lastTouchEventTime=Date.now()),this._toggleNativeDragInteractions();let e=this._getShadowRoot(),t=this._dropContainer;if(e&&this._ngZone.runOutsideAngular(()=>{e.addEventListener("selectstart",dr,lr)}),t){let r=this._rootElement,o=r.parentNode,s=this._placeholder=this._createPlaceholderElement(),a=this._anchor=this._anchor||this._document.createComment("");o.insertBefore(a,r),this._initialTransform=r.style.transform||"",this._preview=new Fi(this._document,this._rootElement,this._direction,this._initialDomRect,this._previewTemplate||null,this.previewClass||null,this._pickupPositionOnPage,this._initialTransform,this._config.zIndex||1e3),this._preview.attach(this._getPreviewInsertionPoint(o,e)),nr(r,!1,cr),this._document.body.appendChild(o.replaceChild(s,r)),this.started.next({source:this,event:i}),t.start(),this._initialContainer=t,this._initialIndex=t.getItemIndex(this)}else this.started.next({source:this,event:i}),this._initialContainer=this._initialIndex=void 0;this._parentPositions.cache(t?t.getScrollableParents():[])}_initializeDragSequence(i,e){this._parentDragRef&&e.stopPropagation();let t=this.isDragging(),r=wt(e),o=!r&&e.button!==0,s=this._rootElement,a=gt(e),c=!r&&this._lastTouchEventTime&&this._lastTouchEventTime+so>Date.now(),l=r?vn(e):Cn(e);if(a&&a.draggable&&e.type==="mousedown"&&e.preventDefault(),t||o||c||l)return;if(this._handles.length){let h=s.style;this._rootElementTapHighlight=h.webkitTapHighlightColor||"",h.webkitTapHighlightColor="transparent"}this._hasMoved=!1,this._hasStartedDragging.set(this._hasMoved),this._removeListeners(),this._initialDomRect=this._rootElement.getBoundingClientRect(),this._pointerMoveSubscription=this._dragDropRegistry.pointerMove.subscribe(this._pointerMove),this._pointerUpSubscription=this._dragDropRegistry.pointerUp.subscribe(this._pointerUp),this._scrollSubscription=this._dragDropRegistry.scrolled(this._getShadowRoot()).subscribe(h=>this._updateOnScroll(h)),this._boundaryElement&&(this._boundaryRect=Ni(this._boundaryElement));let u=this._previewTemplate;this._pickupPositionInElement=u&&u.template&&!u.matchSize?{x:0,y:0}:this._getPointerPositionInElement(this._initialDomRect,i,e);let p=this._pickupPositionOnPage=this._lastKnownPointerPosition=this._getPointerPositionOnPage(e);this._pointerDirectionDelta={x:0,y:0},this._pointerPositionAtLastDirectionChange={x:p.x,y:p.y},this._dragStartTime=Date.now(),this._dragDropRegistry.startDragging(this,e)}_cleanupDragArtifacts(i){nr(this._rootElement,!0,cr),this._anchor.parentNode.replaceChild(this._rootElement,this._anchor),this._destroyPreview(),this._destroyPlaceholder(),this._initialDomRect=this._boundaryRect=this._previewRect=this._initialTransform=void 0,this._ngZone.run(()=>{let e=this._dropContainer,t=e.getItemIndex(this),r=this._getPointerPositionOnPage(i),o=this._getDragDistance(r),s=e._isOverContainer(r.x,r.y);this.ended.next({source:this,distance:o,dropPoint:r,event:i}),this.dropped.next({item:this,currentIndex:t,previousIndex:this._initialIndex,container:e,previousContainer:this._initialContainer,isPointerOverContainer:s,distance:o,dropPoint:r,event:i}),e.drop(this,t,this._initialIndex,this._initialContainer,s,o,r,i),this._dropContainer=this._initialContainer})}_updateActiveDropContainer({x:i,y:e},{x:t,y:r}){let o=this._initialContainer._getSiblingContainerFromPosition(this,i,e);!o&&this._dropContainer!==this._initialContainer&&this._initialContainer._isOverContainer(i,e)&&(o=this._initialContainer),o&&o!==this._dropContainer&&this._ngZone.run(()=>{this.exited.next({item:this,container:this._dropContainer}),this._dropContainer.exit(this),this._dropContainer=o,this._dropContainer.enter(this,i,e,o===this._initialContainer&&o.sortingDisabled?this._initialIndex:void 0),this.entered.next({item:this,container:o,currentIndex:o.getItemIndex(this)})}),this.isDragging()&&(this._dropContainer._startScrollingIfNecessary(t,r),this._dropContainer._sortItem(this,i,e,this._pointerDirectionDelta),this.constrainPosition?this._applyPreviewTransform(i,e):this._applyPreviewTransform(i-this._pickupPositionInElement.x,e-this._pickupPositionInElement.y))}_animatePreviewToPlaceholder(){if(!this._hasMoved)return Promise.resolve();let i=this._placeholder.getBoundingClientRect();this._preview.addClass("cdk-drag-animating"),this._applyPreviewTransform(i.left,i.top);let e=this._preview.getTransitionDuration();return e===0?Promise.resolve():this._ngZone.runOutsideAngular(()=>new Promise(t=>{let r=s=>{(!s||this._preview&&gt(s)===this._preview.element&&s.propertyName==="transform")&&(this._preview?.removeEventListener("transitionend",r),t(),clearTimeout(o))},o=setTimeout(r,e*1.5);this._preview.addEventListener("transitionend",r)}))}_createPlaceholderElement(){let i=this._placeholderTemplate,e=i?i.template:null,t;return e?(this._placeholderRef=i.viewContainer.createEmbeddedView(e,i.context),this._placeholderRef.detectChanges(),t=gr(this._placeholderRef,this._document)):t=fr(this._rootElement),t.style.pointerEvents="none",t.classList.add("cdk-drag-placeholder"),t}_getPointerPositionInElement(i,e,t){let r=e===this._rootElement?null:e,o=r?r.getBoundingClientRect():i,s=wt(t)?t.targetTouches[0]:t,a=this._getViewportScrollPosition(),c=s.pageX-o.left-a.left,l=s.pageY-o.top-a.top;return{x:o.left-i.left+c,y:o.top-i.top+l}}_getPointerPositionOnPage(i){let e=this._getViewportScrollPosition(),t=wt(i)?i.touches[0]||i.changedTouches[0]||{pageX:0,pageY:0}:i,r=t.pageX-e.left,o=t.pageY-e.top;if(this._ownerSVGElement){let s=this._ownerSVGElement.getScreenCTM();if(s){let a=this._ownerSVGElement.createSVGPoint();return a.x=r,a.y=o,a.matrixTransform(s.inverse())}}return{x:r,y:o}}_getConstrainedPointerPosition(i){let e=this._dropContainer?this._dropContainer.lockAxis:null,{x:t,y:r}=this.constrainPosition?this.constrainPosition(i,this,this._initialDomRect,this._pickupPositionInElement):i;if(this.lockAxis==="x"||e==="x"?r=this._pickupPositionOnPage.y-(this.constrainPosition?this._pickupPositionInElement.y:0):(this.lockAxis==="y"||e==="y")&&(t=this._pickupPositionOnPage.x-(this.constrainPosition?this._pickupPositionInElement.x:0)),this._boundaryRect){let{x:o,y:s}=this.constrainPosition?{x:0,y:0}:this._pickupPositionInElement,a=this._boundaryRect,{width:c,height:l}=this._getPreviewRect(),u=a.top+s,p=a.bottom-(l-s),h=a.left+o,b=a.right-(c-o);t=ur(t,h,b),r=ur(r,u,p)}return{x:t,y:r}}_updatePointerDirectionDelta(i){let{x:e,y:t}=i,r=this._pointerDirectionDelta,o=this._pointerPositionAtLastDirectionChange,s=Math.abs(e-o.x),a=Math.abs(t-o.y);return s>this._config.pointerDirectionChangeThreshold&&(r.x=e>o.x?1:-1,o.x=e),a>this._config.pointerDirectionChangeThreshold&&(r.y=t>o.y?1:-1,o.y=t),r}_toggleNativeDragInteractions(){if(!this._rootElement||!this._handles)return;let i=this._handles.length>0||!this.isDragging();i!==this._nativeInteractionsEnabled&&(this._nativeInteractionsEnabled=i,Xe(this._rootElement,i))}_removeRootElementListeners(i){i.removeEventListener("mousedown",this._pointerDown,oi),i.removeEventListener("touchstart",this._pointerDown,ar),i.removeEventListener("dragstart",this._nativeDragStart,oi)}_applyRootElementTransform(i,e){let t=1/this.scale,r=ci(i*t,e*t),o=this._rootElement.style;this._initialTransform==null&&(this._initialTransform=o.transform&&o.transform!="none"?o.transform:""),o.transform=li(r,this._initialTransform)}_applyPreviewTransform(i,e){let t=this._previewTemplate?.template?void 0:this._initialTransform,r=ci(i,e);this._preview.setTransform(li(r,t))}_getDragDistance(i){let e=this._pickupPositionOnPage;return e?{x:i.x-e.x,y:i.y-e.y}:{x:0,y:0}}_cleanupCachedDimensions(){this._boundaryRect=this._previewRect=void 0,this._parentPositions.clear()}_containInsideBoundaryOnResize(){let{x:i,y:e}=this._passiveTransform;if(i===0&&e===0||this.isDragging()||!this._boundaryElement)return;let t=this._rootElement.getBoundingClientRect(),r=this._boundaryElement.getBoundingClientRect();if(r.width===0&&r.height===0||t.width===0&&t.height===0)return;let o=r.left-t.left,s=t.right-r.right,a=r.top-t.top,c=t.bottom-r.bottom;r.width>t.width?(o>0&&(i+=o),s>0&&(i-=s)):i=0,r.height>t.height?(a>0&&(e+=a),c>0&&(e-=c)):e=0,(i!==this._passiveTransform.x||e!==this._passiveTransform.y)&&this.setFreeDragPosition({y:e,x:i})}_getDragStartDelay(i){let e=this.dragStartDelay;return typeof e=="number"?e:wt(i)?e.touch:e?e.mouse:0}_updateOnScroll(i){let e=this._parentPositions.handleScroll(i);if(e){let t=gt(i);this._boundaryRect&&t!==this._boundaryElement&&t.contains(this._boundaryElement)&&yt(this._boundaryRect,e.top,e.left),this._pickupPositionOnPage.x+=e.left,this._pickupPositionOnPage.y+=e.top,this._dropContainer||(this._activeTransform.x-=e.left,this._activeTransform.y-=e.top,this._applyRootElementTransform(this._activeTransform.x,this._activeTransform.y))}}_getViewportScrollPosition(){return this._parentPositions.positions.get(this._document)?.scrollPosition||this._parentPositions.getViewportScrollPosition()}_getShadowRoot(){return this._cachedShadowRoot===void 0&&(this._cachedShadowRoot=Vt(this._rootElement)),this._cachedShadowRoot}_getPreviewInsertionPoint(i,e){let t=this._previewContainer||"global";if(t==="parent")return i;if(t==="global"){let r=this._document;return e||r.fullscreenElement||r.webkitFullscreenElement||r.mozFullScreenElement||r.msFullscreenElement||r.body}return Me(t)}_getPreviewRect(){return(!this._previewRect||!this._previewRect.width&&!this._previewRect.height)&&(this._previewRect=this._preview?this._preview.getBoundingClientRect():this._initialDomRect),this._previewRect}_nativeDragStart=i=>{if(this._handles.length){let e=this._getTargetHandle(i);e&&!this._disabledHandles.has(e)&&!this.disabled&&i.preventDefault()}else this.disabled||i.preventDefault()};_getTargetHandle(i){return this._handles.find(e=>i.target&&(i.target===e||e.contains(i.target)))}};function ur(n,i,e){return Math.max(i,Math.min(e,n))}function wt(n){return n.type[0]==="t"}function dr(n){n.preventDefault()}function Qe(n,i,e){let t=pr(i,n.length-1),r=pr(e,n.length-1);if(t===r)return;let o=n[t],s=r<t?-1:1;for(let a=t;a!==r;a+=s)n[a]=n[a+s];n[r]=o}function pr(n,i){return Math.max(0,Math.min(i,n))}var ui=class{_dragDropRegistry;_element;_sortPredicate;_itemPositions=[];_activeDraggables;orientation="vertical";direction;constructor(i){this._dragDropRegistry=i}_previousSwap={drag:null,delta:0,overlaps:!1};start(i){this.withItems(i)}sort(i,e,t,r){let o=this._itemPositions,s=this._getItemIndexFromPointerPosition(i,e,t,r);if(s===-1&&o.length>0)return null;let a=this.orientation==="horizontal",c=o.findIndex(O=>O.drag===i),l=o[s],u=o[c].clientRect,p=l.clientRect,h=c>s?1:-1,b=this._getItemOffsetPx(u,p,h),M=this._getSiblingOffsetPx(c,o,h),D=o.slice();return Qe(o,c,s),o.forEach((O,$)=>{if(D[$]===O)return;let ae=O.drag===i,F=ae?b:M,W=ae?i.getPlaceholderElement():O.drag.getRootElement();O.offset+=F;let Ne=Math.round(O.offset*(1/O.drag.scale));a?(W.style.transform=li(`translate3d(${Ne}px, 0, 0)`,O.initialTransform),yt(O.clientRect,0,F)):(W.style.transform=li(`translate3d(0, ${Ne}px, 0)`,O.initialTransform),yt(O.clientRect,F,0))}),this._previousSwap.overlaps=Ri(p,e,t),this._previousSwap.drag=l.drag,this._previousSwap.delta=a?r.x:r.y,{previousIndex:c,currentIndex:s}}enter(i,e,t,r){let o=r==null||r<0?this._getItemIndexFromPointerPosition(i,e,t):r,s=this._activeDraggables,a=s.indexOf(i),c=i.getPlaceholderElement(),l=s[o];if(l===i&&(l=s[o+1]),!l&&(o==null||o===-1||o<s.length-1)&&this._shouldEnterAsFirstChild(e,t)&&(l=s[0]),a>-1&&s.splice(a,1),l&&!this._dragDropRegistry.isDragging(l)){let u=l.getRootElement();u.parentElement.insertBefore(c,u),s.splice(o,0,i)}else this._element.appendChild(c),s.push(i);c.style.transform="",this._cacheItemPositions()}withItems(i){this._activeDraggables=i.slice(),this._cacheItemPositions()}withSortPredicate(i){this._sortPredicate=i}reset(){this._activeDraggables?.forEach(i=>{let e=i.getRootElement();if(e){let t=this._itemPositions.find(r=>r.drag===i)?.initialTransform;e.style.transform=t||""}}),this._itemPositions=[],this._activeDraggables=[],this._previousSwap.drag=null,this._previousSwap.delta=0,this._previousSwap.overlaps=!1}getActiveItemsSnapshot(){return this._activeDraggables}getItemIndex(i){return(this.orientation==="horizontal"&&this.direction==="rtl"?this._itemPositions.slice().reverse():this._itemPositions).findIndex(t=>t.drag===i)}updateOnScroll(i,e){this._itemPositions.forEach(({clientRect:t})=>{yt(t,i,e)}),this._itemPositions.forEach(({drag:t})=>{this._dragDropRegistry.isDragging(t)&&t._sortFromLastPointerPosition()})}withElementContainer(i){this._element=i}_cacheItemPositions(){let i=this.orientation==="horizontal";this._itemPositions=this._activeDraggables.map(e=>{let t=e.getVisibleElement();return{drag:e,offset:0,initialTransform:t.style.transform||"",clientRect:Ni(t)}}).sort((e,t)=>i?e.clientRect.left-t.clientRect.left:e.clientRect.top-t.clientRect.top)}_getItemOffsetPx(i,e,t){let r=this.orientation==="horizontal",o=r?e.left-i.left:e.top-i.top;return t===-1&&(o+=r?e.width-i.width:e.height-i.height),o}_getSiblingOffsetPx(i,e,t){let r=this.orientation==="horizontal",o=e[i].clientRect,s=e[i+t*-1],a=o[r?"width":"height"]*t;if(s){let c=r?"left":"top",l=r?"right":"bottom";t===-1?a-=s.clientRect[c]-o[l]:a+=o[c]-s.clientRect[l]}return a}_shouldEnterAsFirstChild(i,e){if(!this._activeDraggables.length)return!1;let t=this._itemPositions,r=this.orientation==="horizontal";if(t[0].drag!==this._activeDraggables[0]){let s=t[t.length-1].clientRect;return r?i>=s.right:e>=s.bottom}else{let s=t[0].clientRect;return r?i<=s.left:e<=s.top}}_getItemIndexFromPointerPosition(i,e,t,r){let o=this.orientation==="horizontal",s=this._itemPositions.findIndex(({drag:a,clientRect:c})=>{if(a===i)return!1;if(r){let l=o?r.x:r.y;if(a===this._previousSwap.drag&&this._previousSwap.overlaps&&l===this._previousSwap.delta)return!1}return o?e>=Math.floor(c.left)&&e<Math.floor(c.right):t>=Math.floor(c.top)&&t<Math.floor(c.bottom)});return s===-1||!this._sortPredicate(s,i)?-1:s}},Vi=class{_document;_dragDropRegistry;_element;_sortPredicate;_rootNode;_activeItems;_previousSwap={drag:null,deltaX:0,deltaY:0,overlaps:!1};_relatedNodes=[];constructor(i,e){this._document=i,this._dragDropRegistry=e}start(i){let e=this._element.childNodes;this._relatedNodes=[];for(let t=0;t<e.length;t++){let r=e[t];this._relatedNodes.push([r,r.nextSibling])}this.withItems(i)}sort(i,e,t,r){let o=this._getItemIndexFromPointerPosition(i,e,t),s=this._previousSwap;if(o===-1||this._activeItems[o]===i)return null;let a=this._activeItems[o];if(s.drag===a&&s.overlaps&&s.deltaX===r.x&&s.deltaY===r.y)return null;let c=this.getItemIndex(i),l=i.getPlaceholderElement(),u=a.getRootElement();o>c?u.after(l):u.before(l),Qe(this._activeItems,c,o);let p=this._getRootNode().elementFromPoint(e,t);return s.deltaX=r.x,s.deltaY=r.y,s.drag=a,s.overlaps=u===p||u.contains(p),{previousIndex:c,currentIndex:o}}enter(i,e,t,r){let o=r==null||r<0?this._getItemIndexFromPointerPosition(i,e,t):r;o===-1&&(o=this._getClosestItemIndexToPointer(i,e,t));let s=this._activeItems[o],a=this._activeItems.indexOf(i);a>-1&&this._activeItems.splice(a,1),s&&!this._dragDropRegistry.isDragging(s)?(this._activeItems.splice(o,0,i),s.getRootElement().before(i.getPlaceholderElement())):(this._activeItems.push(i),this._element.appendChild(i.getPlaceholderElement()))}withItems(i){this._activeItems=i.slice()}withSortPredicate(i){this._sortPredicate=i}reset(){let i=this._element,e=this._previousSwap;for(let t=this._relatedNodes.length-1;t>-1;t--){let[r,o]=this._relatedNodes[t];r.parentNode===i&&r.nextSibling!==o&&(o===null?i.appendChild(r):o.parentNode===i&&i.insertBefore(r,o))}this._relatedNodes=[],this._activeItems=[],e.drag=null,e.deltaX=e.deltaY=0,e.overlaps=!1}getActiveItemsSnapshot(){return this._activeItems}getItemIndex(i){return this._activeItems.indexOf(i)}updateOnScroll(){this._activeItems.forEach(i=>{this._dragDropRegistry.isDragging(i)&&i._sortFromLastPointerPosition()})}withElementContainer(i){i!==this._element&&(this._element=i,this._rootNode=void 0)}_getItemIndexFromPointerPosition(i,e,t){let r=this._getRootNode().elementFromPoint(Math.floor(e),Math.floor(t)),o=r?this._activeItems.findIndex(s=>{let a=s.getRootElement();return r===a||a.contains(r)}):-1;return o===-1||!this._sortPredicate(o,i)?-1:o}_getRootNode(){return this._rootNode||(this._rootNode=Vt(this._element)||this._document),this._rootNode}_getClosestItemIndexToPointer(i,e,t){if(this._activeItems.length===0)return-1;if(this._activeItems.length===1)return 0;let r=1/0,o=-1;for(let s=0;s<this._activeItems.length;s++){let a=this._activeItems[s];if(a!==i){let{x:c,y:l}=a.getRootElement().getBoundingClientRect(),u=Math.hypot(e-c,t-l);u<r&&(r=u,o=s)}}return o}},mr=.05,Cr=.05,de=function(n){return n[n.NONE=0]="NONE",n[n.UP=1]="UP",n[n.DOWN=2]="DOWN",n}(de||{}),se=function(n){return n[n.NONE=0]="NONE",n[n.LEFT=1]="LEFT",n[n.RIGHT=2]="RIGHT",n}(se||{}),Oi=class{_dragDropRegistry;_ngZone;_viewportRuler;element;disabled=!1;sortingDisabled=!1;lockAxis;autoScrollDisabled=!1;autoScrollStep=2;enterPredicate=()=>!0;sortPredicate=()=>!0;beforeStarted=new H;entered=new H;exited=new H;dropped=new H;sorted=new H;receivingStarted=new H;receivingStopped=new H;data;_container;_isDragging=!1;_parentPositions;_sortStrategy;_domRect;_draggables=[];_siblings=[];_activeSiblings=new Set;_viewportScrollSubscription=ze.EMPTY;_verticalScrollDirection=de.NONE;_horizontalScrollDirection=se.NONE;_scrollNode;_stopScrollTimers=new H;_cachedShadowRoot=null;_document;_scrollableElements=[];_initialScrollSnap;_direction="ltr";constructor(i,e,t,r,o){this._dragDropRegistry=e,this._ngZone=r,this._viewportRuler=o;let s=this.element=Me(i);this._document=t,this.withOrientation("vertical").withElementContainer(s),e.registerDropContainer(this),this._parentPositions=new ai(t)}dispose(){this._stopScrolling(),this._stopScrollTimers.complete(),this._viewportScrollSubscription.unsubscribe(),this.beforeStarted.complete(),this.entered.complete(),this.exited.complete(),this.dropped.complete(),this.sorted.complete(),this.receivingStarted.complete(),this.receivingStopped.complete(),this._activeSiblings.clear(),this._scrollNode=null,this._parentPositions.clear(),this._dragDropRegistry.removeDropContainer(this)}isDragging(){return this._isDragging}start(){this._draggingStarted(),this._notifyReceivingSiblings()}enter(i,e,t,r){this._draggingStarted(),r==null&&this.sortingDisabled&&(r=this._draggables.indexOf(i)),this._sortStrategy.enter(i,e,t,r),this._cacheParentPositions(),this._notifyReceivingSiblings(),this.entered.next({item:i,container:this,currentIndex:this.getItemIndex(i)})}exit(i){this._reset(),this.exited.next({item:i,container:this})}drop(i,e,t,r,o,s,a,c={}){this._reset(),this.dropped.next({item:i,currentIndex:e,previousIndex:t,container:this,previousContainer:r,isPointerOverContainer:o,distance:s,dropPoint:a,event:c})}withItems(i){let e=this._draggables;return this._draggables=i,i.forEach(t=>t._withDropContainer(this)),this.isDragging()&&(e.filter(r=>r.isDragging()).every(r=>i.indexOf(r)===-1)?this._reset():this._sortStrategy.withItems(this._draggables)),this}withDirection(i){return this._direction=i,this._sortStrategy instanceof ui&&(this._sortStrategy.direction=i),this}connectedTo(i){return this._siblings=i.slice(),this}withOrientation(i){if(i==="mixed")this._sortStrategy=new Vi(this._document,this._dragDropRegistry);else{let e=new ui(this._dragDropRegistry);e.direction=this._direction,e.orientation=i,this._sortStrategy=e}return this._sortStrategy.withElementContainer(this._container),this._sortStrategy.withSortPredicate((e,t)=>this.sortPredicate(e,t,this)),this}withScrollableParents(i){let e=this._container;return this._scrollableElements=i.indexOf(e)===-1?[e,...i]:i.slice(),this}withElementContainer(i){if(i===this._container)return this;let e=Me(this.element),t=this._scrollableElements.indexOf(this._container),r=this._scrollableElements.indexOf(i);return t>-1&&this._scrollableElements.splice(t,1),r>-1&&this._scrollableElements.splice(r,1),this._sortStrategy&&this._sortStrategy.withElementContainer(i),this._cachedShadowRoot=null,this._scrollableElements.unshift(i),this._container=i,this}getScrollableParents(){return this._scrollableElements}getItemIndex(i){return this._isDragging?this._sortStrategy.getItemIndex(i):this._draggables.indexOf(i)}isReceiving(){return this._activeSiblings.size>0}_sortItem(i,e,t,r){if(this.sortingDisabled||!this._domRect||!ir(this._domRect,mr,e,t))return;let o=this._sortStrategy.sort(i,e,t,r);o&&this.sorted.next({previousIndex:o.previousIndex,currentIndex:o.currentIndex,container:this,item:i})}_startScrollingIfNecessary(i,e){if(this.autoScrollDisabled)return;let t,r=de.NONE,o=se.NONE;if(this._parentPositions.positions.forEach((s,a)=>{a===this._document||!s.clientRect||t||ir(s.clientRect,mr,i,e)&&([r,o]=ao(a,s.clientRect,this._direction,i,e),(r||o)&&(t=a))}),!r&&!o){let{width:s,height:a}=this._viewportRuler.getViewportSize(),c={width:s,height:a,top:0,right:s,bottom:a,left:0};r=vr(c,e),o=Sr(c,i),t=window}t&&(r!==this._verticalScrollDirection||o!==this._horizontalScrollDirection||t!==this._scrollNode)&&(this._verticalScrollDirection=r,this._horizontalScrollDirection=o,this._scrollNode=t,(r||o)&&t?this._ngZone.runOutsideAngular(this._startScrollInterval):this._stopScrolling())}_stopScrolling(){this._stopScrollTimers.next()}_draggingStarted(){let i=this._container.style;this.beforeStarted.next(),this._isDragging=!0,this._initialScrollSnap=i.msScrollSnapType||i.scrollSnapType||"",i.scrollSnapType=i.msScrollSnapType="none",this._sortStrategy.start(this._draggables),this._cacheParentPositions(),this._viewportScrollSubscription.unsubscribe(),this._listenToScrollEvents()}_cacheParentPositions(){this._parentPositions.cache(this._scrollableElements),this._domRect=this._parentPositions.positions.get(this._container).clientRect}_reset(){this._isDragging=!1;let i=this._container.style;i.scrollSnapType=i.msScrollSnapType=this._initialScrollSnap,this._siblings.forEach(e=>e._stopReceiving(this)),this._sortStrategy.reset(),this._stopScrolling(),this._viewportScrollSubscription.unsubscribe(),this._parentPositions.clear()}_startScrollInterval=()=>{this._stopScrolling(),ct(0,Ji).pipe(Te(this._stopScrollTimers)).subscribe(()=>{let i=this._scrollNode,e=this.autoScrollStep;this._verticalScrollDirection===de.UP?i.scrollBy(0,-e):this._verticalScrollDirection===de.DOWN&&i.scrollBy(0,e),this._horizontalScrollDirection===se.LEFT?i.scrollBy(-e,0):this._horizontalScrollDirection===se.RIGHT&&i.scrollBy(e,0)})};_isOverContainer(i,e){return this._domRect!=null&&Ri(this._domRect,i,e)}_getSiblingContainerFromPosition(i,e,t){return this._siblings.find(r=>r._canReceive(i,e,t))}_canReceive(i,e,t){if(!this._domRect||!Ri(this._domRect,e,t)||!this.enterPredicate(i,this))return!1;let r=this._getShadowRoot().elementFromPoint(e,t);return r?r===this._container||this._container.contains(r):!1}_startReceiving(i,e){let t=this._activeSiblings;!t.has(i)&&e.every(r=>this.enterPredicate(r,this)||this._draggables.indexOf(r)>-1)&&(t.add(i),this._cacheParentPositions(),this._listenToScrollEvents(),this.receivingStarted.next({initiator:i,receiver:this,items:e}))}_stopReceiving(i){this._activeSiblings.delete(i),this._viewportScrollSubscription.unsubscribe(),this.receivingStopped.next({initiator:i,receiver:this})}_listenToScrollEvents(){this._viewportScrollSubscription=this._dragDropRegistry.scrolled(this._getShadowRoot()).subscribe(i=>{if(this.isDragging()){let e=this._parentPositions.handleScroll(i);e&&this._sortStrategy.updateOnScroll(e.top,e.left)}else this.isReceiving()&&this._cacheParentPositions()})}_getShadowRoot(){if(!this._cachedShadowRoot){let i=Vt(this._container);this._cachedShadowRoot=i||this._document}return this._cachedShadowRoot}_notifyReceivingSiblings(){let i=this._sortStrategy.getActiveItemsSnapshot().filter(e=>e.isDragging());this._siblings.forEach(e=>e._startReceiving(this,i))}};function vr(n,i){let{top:e,bottom:t,height:r}=n,o=r*Cr;return i>=e-o&&i<=e+o?de.UP:i>=t-o&&i<=t+o?de.DOWN:de.NONE}function Sr(n,i){let{left:e,right:t,width:r}=n,o=r*Cr;return i>=e-o&&i<=e+o?se.LEFT:i>=t-o&&i<=t+o?se.RIGHT:se.NONE}function ao(n,i,e,t,r){let o=vr(i,r),s=Sr(i,t),a=de.NONE,c=se.NONE;if(o){let l=n.scrollTop;o===de.UP?l>0&&(a=de.UP):n.scrollHeight-l>n.clientHeight&&(a=de.DOWN)}if(s){let l=n.scrollLeft;e==="rtl"?s===se.RIGHT?l<0&&(c=se.RIGHT):n.scrollWidth+l>n.clientWidth&&(c=se.LEFT):s===se.LEFT?l>0&&(c=se.LEFT):n.scrollWidth-l>n.clientWidth&&(c=se.RIGHT)}return[a,c]}var si=ft({passive:!1,capture:!0}),lo=(()=>{class n{static \u0275fac=function(t){return new(t||n)};static \u0275cmp=N({type:n,selectors:[["ng-component"]],hostAttrs:["cdk-drag-resets-container",""],decls:0,vars:0,template:function(t,r){},styles:["@layer cdk-resets{.cdk-drag-preview{background:none;border:none;padding:0;color:inherit;inset:auto}}.cdk-drag-placeholder *,.cdk-drag-preview *{pointer-events:none !important}"],encapsulation:2,changeDetection:0})}return n})(),co=(()=>{class n{_ngZone=A(Mt);_document=A(Ti);_styleLoader=A(fn);_dropInstances=new Set;_dragInstances=new Set;_activeDragInstances=ge([]);_globalListeners=new Map;_draggingPredicate=e=>e.isDragging();pointerMove=new H;pointerUp=new H;scroll=new H;constructor(){}registerDropContainer(e){this._dropInstances.has(e)||this._dropInstances.add(e)}registerDragItem(e){this._dragInstances.add(e),this._dragInstances.size===1&&this._ngZone.runOutsideAngular(()=>{this._document.addEventListener("touchmove",this._persistentTouchmoveListener,si)})}removeDropContainer(e){this._dropInstances.delete(e)}removeDragItem(e){this._dragInstances.delete(e),this.stopDragging(e),this._dragInstances.size===0&&this._document.removeEventListener("touchmove",this._persistentTouchmoveListener,si)}startDragging(e,t){if(!(this._activeDragInstances().indexOf(e)>-1)&&(this._styleLoader.load(lo),this._activeDragInstances.update(r=>[...r,e]),this._activeDragInstances().length===1)){let r=t.type.startsWith("touch");this._globalListeners.set(r?"touchend":"mouseup",{handler:o=>this.pointerUp.next(o),options:!0}).set("scroll",{handler:o=>this.scroll.next(o),options:!0}).set("selectstart",{handler:this._preventDefaultWhileDragging,options:si}),r||this._globalListeners.set("mousemove",{handler:o=>this.pointerMove.next(o),options:si}),this._ngZone.runOutsideAngular(()=>{this._globalListeners.forEach((o,s)=>{this._document.addEventListener(s,o.handler,o.options)})})}}stopDragging(e){this._activeDragInstances.update(t=>{let r=t.indexOf(e);return r>-1?(t.splice(r,1),[...t]):t}),this._activeDragInstances().length===0&&this._clearGlobalListeners()}isDragging(e){return this._activeDragInstances().indexOf(e)>-1}scrolled(e){let t=[this.scroll];return e&&e!==this._document&&t.push(new yi(r=>this._ngZone.runOutsideAngular(()=>{let s=a=>{this._activeDragInstances().length&&r.next(a)};return e.addEventListener("scroll",s,!0),()=>{e.removeEventListener("scroll",s,!0)}}))),Tt(...t)}ngOnDestroy(){this._dragInstances.forEach(e=>this.removeDragItem(e)),this._dropInstances.forEach(e=>this.removeDropContainer(e)),this._clearGlobalListeners(),this.pointerMove.complete(),this.pointerUp.complete()}_preventDefaultWhileDragging=e=>{this._activeDragInstances().length>0&&e.preventDefault()};_persistentTouchmoveListener=e=>{this._activeDragInstances().length>0&&(this._activeDragInstances().some(this._draggingPredicate)&&e.preventDefault(),this.pointerMove.next(e))};_clearGlobalListeners(){this._globalListeners.forEach((e,t)=>{this._document.removeEventListener(t,e.handler,e.options)}),this._globalListeners.clear()}static \u0275fac=function(t){return new(t||n)};static \u0275prov=dt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),uo={dragStartThreshold:5,pointerDirectionChangeThreshold:5},Bi=(()=>{class n{_document=A(Ti);_ngZone=A(Mt);_viewportRuler=A(jn);_dragDropRegistry=A(co);constructor(){}createDrag(e,t=uo){return new Ai(e,t,this._document,this._ngZone,this._viewportRuler,this._dragDropRegistry)}createDropList(e){return new Oi(e,this._dragDropRegistry,this._document,this._ngZone,this._viewportRuler)}static \u0275fac=function(t){return new(t||n)};static \u0275prov=dt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),hr=new Ue("CDK_DRAG_PARENT");var po=new Ue("CdkDragHandle");var wr=new Ue("CDK_DRAG_CONFIG"),mo="cdk-drag",yr=new Ue("CdkDropList"),et=(()=>{class n{element=A(Di);dropContainer=A(yr,{optional:!0,skipSelf:!0});_ngZone=A(Mt);_viewContainerRef=A(rn);_dir=A(Mi,{optional:!0});_changeDetectorRef=A($e);_selfHandle=A(po,{optional:!0,self:!0});_parentDrag=A(hr,{optional:!0,skipSelf:!0});_destroyed=new H;static _dragInstances=[];_handles=new Wi([]);_previewTemplate;_placeholderTemplate;_dragRef;data;lockAxis;rootElementSelector;boundaryElement;dragStartDelay;freeDragPosition;get disabled(){return this._disabled||!!(this.dropContainer&&this.dropContainer.disabled)}set disabled(e){this._disabled=e,this._dragRef.disabled=this._disabled}_disabled;constrainPosition;previewClass;previewContainer;scale=1;started=new J;released=new J;ended=new J;entered=new J;exited=new J;dropped=new J;moved=new yi(e=>{let t=this._dragRef.moved.pipe(Ki(r=>({source:this,pointerPosition:r.pointerPosition,event:r.event,delta:r.delta,distance:r.distance}))).subscribe(e);return()=>{t.unsubscribe()}});_injector=A(tn);constructor(){let e=this.dropContainer,t=A(wr,{optional:!0}),r=A(Bi);this._dragRef=r.createDrag(this.element,{dragStartThreshold:t&&t.dragStartThreshold!=null?t.dragStartThreshold:5,pointerDirectionChangeThreshold:t&&t.pointerDirectionChangeThreshold!=null?t.pointerDirectionChangeThreshold:5,zIndex:t?.zIndex}),this._dragRef.data=this,n._dragInstances.push(this),t&&this._assignDefaults(t),e&&(this._dragRef._withDropContainer(e._dropListRef),e.addItem(this),e._dropListRef.beforeStarted.pipe(Te(this._destroyed)).subscribe(()=>{this._dragRef.scale=this.scale})),this._syncInputs(this._dragRef),this._handleEvents(this._dragRef)}getPlaceholderElement(){return this._dragRef.getPlaceholderElement()}getRootElement(){return this._dragRef.getRootElement()}reset(){this._dragRef.reset()}getFreeDragPosition(){return this._dragRef.getFreeDragPosition()}setFreeDragPosition(e){this._dragRef.setFreeDragPosition(e)}ngAfterViewInit(){nn(()=>{this._updateRootElement(),this._setupHandlesListener(),this._dragRef.scale=this.scale,this.freeDragPosition&&this._dragRef.setFreeDragPosition(this.freeDragPosition)},{injector:this._injector})}ngOnChanges(e){let t=e.rootElementSelector,r=e.freeDragPosition;t&&!t.firstChange&&this._updateRootElement(),this._dragRef.scale=this.scale,r&&!r.firstChange&&this.freeDragPosition&&this._dragRef.setFreeDragPosition(this.freeDragPosition)}ngOnDestroy(){this.dropContainer&&this.dropContainer.removeItem(this);let e=n._dragInstances.indexOf(this);e>-1&&n._dragInstances.splice(e,1),this._ngZone.runOutsideAngular(()=>{this._handles.complete(),this._destroyed.next(),this._destroyed.complete(),this._dragRef.dispose()})}_addHandle(e){let t=this._handles.getValue();t.push(e),this._handles.next(t)}_removeHandle(e){let t=this._handles.getValue(),r=t.indexOf(e);r>-1&&(t.splice(r,1),this._handles.next(t))}_setPreviewTemplate(e){this._previewTemplate=e}_resetPreviewTemplate(e){e===this._previewTemplate&&(this._previewTemplate=null)}_setPlaceholderTemplate(e){this._placeholderTemplate=e}_resetPlaceholderTemplate(e){e===this._placeholderTemplate&&(this._placeholderTemplate=null)}_updateRootElement(){let e=this.element.nativeElement,t=e;this.rootElementSelector&&(t=e.closest!==void 0?e.closest(this.rootElementSelector):e.parentElement?.closest(this.rootElementSelector)),this._dragRef.withRootElement(t||e)}_getBoundaryElement(){let e=this.boundaryElement;return e?typeof e=="string"?this.element.nativeElement.closest(e):Me(e):null}_syncInputs(e){e.beforeStarted.subscribe(()=>{if(!e.isDragging()){let t=this._dir,r=this.dragStartDelay,o=this._placeholderTemplate?{template:this._placeholderTemplate.templateRef,context:this._placeholderTemplate.data,viewContainer:this._viewContainerRef}:null,s=this._previewTemplate?{template:this._previewTemplate.templateRef,context:this._previewTemplate.data,matchSize:this._previewTemplate.matchSize,viewContainer:this._viewContainerRef}:null;e.disabled=this.disabled,e.lockAxis=this.lockAxis,e.scale=this.scale,e.dragStartDelay=typeof r=="object"&&r?r:ki(r),e.constrainPosition=this.constrainPosition,e.previewClass=this.previewClass,e.withBoundaryElement(this._getBoundaryElement()).withPlaceholderTemplate(o).withPreviewTemplate(s).withPreviewContainer(this.previewContainer||"global"),t&&e.withDirection(t.value)}}),e.beforeStarted.pipe(xe(1)).subscribe(()=>{if(this._parentDrag){e.withParent(this._parentDrag._dragRef);return}let t=this.element.nativeElement.parentElement;for(;t;){if(t.classList.contains(mo)){e.withParent(n._dragInstances.find(r=>r.element.nativeElement===t)?._dragRef||null);break}t=t.parentElement}})}_handleEvents(e){e.started.subscribe(t=>{this.started.emit({source:this,event:t.event}),this._changeDetectorRef.markForCheck()}),e.released.subscribe(t=>{this.released.emit({source:this,event:t.event})}),e.ended.subscribe(t=>{this.ended.emit({source:this,distance:t.distance,dropPoint:t.dropPoint,event:t.event}),this._changeDetectorRef.markForCheck()}),e.entered.subscribe(t=>{this.entered.emit({container:t.container.data,item:this,currentIndex:t.currentIndex})}),e.exited.subscribe(t=>{this.exited.emit({container:t.container.data,item:this})}),e.dropped.subscribe(t=>{this.dropped.emit({previousIndex:t.previousIndex,currentIndex:t.currentIndex,previousContainer:t.previousContainer.data,container:t.container.data,isPointerOverContainer:t.isPointerOverContainer,item:this,distance:t.distance,dropPoint:t.dropPoint,event:t.event})})}_assignDefaults(e){let{lockAxis:t,dragStartDelay:r,constrainPosition:o,previewClass:s,boundaryElement:a,draggingDisabled:c,rootElementSelector:l,previewContainer:u}=e;this.disabled=c??!1,this.dragStartDelay=r||0,t&&(this.lockAxis=t),o&&(this.constrainPosition=o),s&&(this.previewClass=s),a&&(this.boundaryElement=a),l&&(this.rootElementSelector=l),u&&(this.previewContainer=u)}_setupHandlesListener(){this._handles.pipe(ut(e=>{let t=e.map(r=>r.element);this._selfHandle&&this.rootElementSelector&&t.push(this.element),this._dragRef.withHandles(t)}),Yi(e=>Tt(...e.map(t=>t._stateChanges.pipe(xi(t))))),Te(this._destroyed)).subscribe(e=>{let t=this._dragRef,r=e.element.nativeElement;e.disabled?t.disableHandle(r):t.enableHandle(r)})}static \u0275fac=function(t){return new(t||n)};static \u0275dir=Pi({type:n,selectors:[["","cdkDrag",""]],hostAttrs:[1,"cdk-drag"],hostVars:4,hostBindings:function(t,r){t&2&&le("cdk-drag-disabled",r.disabled)("cdk-drag-dragging",r._dragRef.isDragging())},inputs:{data:[0,"cdkDragData","data"],lockAxis:[0,"cdkDragLockAxis","lockAxis"],rootElementSelector:[0,"cdkDragRootElement","rootElementSelector"],boundaryElement:[0,"cdkDragBoundary","boundaryElement"],dragStartDelay:[0,"cdkDragStartDelay","dragStartDelay"],freeDragPosition:[0,"cdkDragFreeDragPosition","freeDragPosition"],disabled:[2,"cdkDragDisabled","disabled",_t],constrainPosition:[0,"cdkDragConstrainPosition","constrainPosition"],previewClass:[0,"cdkDragPreviewClass","previewClass"],previewContainer:[0,"cdkDragPreviewContainer","previewContainer"],scale:[2,"cdkDragScale","scale",mn]},outputs:{started:"cdkDragStarted",released:"cdkDragReleased",ended:"cdkDragEnded",entered:"cdkDragEntered",exited:"cdkDragExited",dropped:"cdkDragDropped",moved:"cdkDragMoved"},exportAs:["cdkDrag"],features:[Be([{provide:hr,useExisting:n}]),Ii,en]})}return n})(),_r=new Ue("CdkDropListGroup");var tt=(()=>{class n{element=A(Di);_changeDetectorRef=A($e);_scrollDispatcher=A(Nn);_dir=A(Mi,{optional:!0});_group=A(_r,{optional:!0,skipSelf:!0});_destroyed=new H;_scrollableParentsResolved;static _dropLists=[];_dropListRef;connectedTo=[];data;orientation;id=A(Sn).getId("cdk-drop-list-");lockAxis;get disabled(){return this._disabled||!!this._group&&this._group.disabled}set disabled(e){this._dropListRef.disabled=this._disabled=e}_disabled;sortingDisabled;enterPredicate=()=>!0;sortPredicate=()=>!0;autoScrollDisabled;autoScrollStep;elementContainerSelector;dropped=new J;entered=new J;exited=new J;sorted=new J;_unsortedItems=new Set;constructor(){let e=A(Bi),t=A(wr,{optional:!0});this._dropListRef=e.createDropList(this.element),this._dropListRef.data=this,t&&this._assignDefaults(t),this._dropListRef.enterPredicate=(r,o)=>this.enterPredicate(r.data,o.data),this._dropListRef.sortPredicate=(r,o,s)=>this.sortPredicate(r,o.data,s.data),this._setupInputSyncSubscription(this._dropListRef),this._handleEvents(this._dropListRef),n._dropLists.push(this),this._group&&this._group._items.add(this)}addItem(e){this._unsortedItems.add(e),this._dropListRef.isDragging()&&this._syncItemsWithRef()}removeItem(e){this._unsortedItems.delete(e),this._dropListRef.isDragging()&&this._syncItemsWithRef()}getSortedItems(){return Array.from(this._unsortedItems).sort((e,t)=>e._dragRef.getVisibleElement().compareDocumentPosition(t._dragRef.getVisibleElement())&Node.DOCUMENT_POSITION_FOLLOWING?-1:1)}ngOnDestroy(){let e=n._dropLists.indexOf(this);e>-1&&n._dropLists.splice(e,1),this._group&&this._group._items.delete(this),this._unsortedItems.clear(),this._dropListRef.dispose(),this._destroyed.next(),this._destroyed.complete()}_setupInputSyncSubscription(e){this._dir&&this._dir.change.pipe(xi(this._dir.value),Te(this._destroyed)).subscribe(t=>e.withDirection(t)),e.beforeStarted.subscribe(()=>{let t=gn(this.connectedTo).map(r=>{if(typeof r=="string"){let o=n._dropLists.find(s=>s.id===r);return o}return r});if(this._group&&this._group._items.forEach(r=>{t.indexOf(r)===-1&&t.push(r)}),!this._scrollableParentsResolved){let r=this._scrollDispatcher.getAncestorScrollContainers(this.element).map(o=>o.getElementRef().nativeElement);this._dropListRef.withScrollableParents(r),this._scrollableParentsResolved=!0}if(this.elementContainerSelector){let r=this.element.nativeElement.querySelector(this.elementContainerSelector);e.withElementContainer(r)}e.disabled=this.disabled,e.lockAxis=this.lockAxis,e.sortingDisabled=this.sortingDisabled,e.autoScrollDisabled=this.autoScrollDisabled,e.autoScrollStep=ki(this.autoScrollStep,2),e.connectedTo(t.filter(r=>r&&r!==this).map(r=>r._dropListRef)).withOrientation(this.orientation)})}_handleEvents(e){e.beforeStarted.subscribe(()=>{this._syncItemsWithRef(),this._changeDetectorRef.markForCheck()}),e.entered.subscribe(t=>{this.entered.emit({container:this,item:t.item.data,currentIndex:t.currentIndex})}),e.exited.subscribe(t=>{this.exited.emit({container:this,item:t.item.data}),this._changeDetectorRef.markForCheck()}),e.sorted.subscribe(t=>{this.sorted.emit({previousIndex:t.previousIndex,currentIndex:t.currentIndex,container:this,item:t.item.data})}),e.dropped.subscribe(t=>{this.dropped.emit({previousIndex:t.previousIndex,currentIndex:t.currentIndex,previousContainer:t.previousContainer.data,container:t.container.data,item:t.item.data,isPointerOverContainer:t.isPointerOverContainer,distance:t.distance,dropPoint:t.dropPoint,event:t.event}),this._changeDetectorRef.markForCheck()}),Tt(e.receivingStarted,e.receivingStopped).subscribe(()=>this._changeDetectorRef.markForCheck())}_assignDefaults(e){let{lockAxis:t,draggingDisabled:r,sortingDisabled:o,listAutoScrollDisabled:s,listOrientation:a}=e;this.disabled=r??!1,this.sortingDisabled=o??!1,this.autoScrollDisabled=s??!1,this.orientation=a||"vertical",t&&(this.lockAxis=t)}_syncItemsWithRef(){this._dropListRef.withItems(this.getSortedItems().map(e=>e._dragRef))}static \u0275fac=function(t){return new(t||n)};static \u0275dir=Pi({type:n,selectors:[["","cdkDropList",""],["cdk-drop-list"]],hostAttrs:[1,"cdk-drop-list"],hostVars:7,hostBindings:function(t,r){t&2&&(sn("id",r.id),le("cdk-drop-list-disabled",r.disabled)("cdk-drop-list-dragging",r._dropListRef.isDragging())("cdk-drop-list-receiving",r._dropListRef.isReceiving()))},inputs:{connectedTo:[0,"cdkDropListConnectedTo","connectedTo"],data:[0,"cdkDropListData","data"],orientation:[0,"cdkDropListOrientation","orientation"],id:"id",lockAxis:[0,"cdkDropListLockAxis","lockAxis"],disabled:[2,"cdkDropListDisabled","disabled",_t],sortingDisabled:[2,"cdkDropListSortingDisabled","sortingDisabled",_t],enterPredicate:[0,"cdkDropListEnterPredicate","enterPredicate"],sortPredicate:[0,"cdkDropListSortPredicate","sortPredicate"],autoScrollDisabled:[2,"cdkDropListAutoScrollDisabled","autoScrollDisabled",_t],autoScrollStep:[0,"cdkDropListAutoScrollStep","autoScrollStep"],elementContainerSelector:[0,"cdkDropListElementContainer","elementContainerSelector"]},outputs:{dropped:"cdkDropListDropped",entered:"cdkDropListEntered",exited:"cdkDropListExited",sorted:"cdkDropListSorted"},exportAs:["cdkDropList"],features:[Be([{provide:_r,useValue:void 0},{provide:yr,useExisting:n}]),Ii]})}return n})();var it=(()=>{class n{static \u0275fac=function(t){return new(t||n)};static \u0275mod=on({type:n});static \u0275inj=Xi({providers:[Bi],imports:[Bn]})}return n})();var ho={id:-1,spriteId:-1,projectId:-1,name:"",default:!1,groundPoint:null,collisionFrame:null,layers:[],visibleGround:!1,visibleCollision:!1},we=(()=>{class n extends xn{constructor(e){super(ho),this.spritesAnimationService=e,this.layers$=this.select(t=>t.layers),this.animation$=this.select(t=>t),this.removeLayer=this.updater((t,r)=>(t.layers.splice(r,1),Q({},t))),this.updateLayer=this.updater((t,r)=>t.layers[r.idx]?(t.layers[r.idx]=Q({},r.layer),Q({},t)):t),this.addLayer=this.updater(t=>Ie(Q({},t),{layers:[...t.layers,{layerId:null,loop:!1,speed:1,frames:[]}]})),this.updateAnimation=this.updater((t,r)=>Q(Q({},t),r)),this.updateGroundPoint=this.updater((t,r)=>Ie(Q({},t),{groundPoint:Q(Q({},t.groundPoint??{x:0,y:0}),r)})),this.updateCollisionFrame=this.updater((t,r)=>Ie(Q({},t),{collisionFrame:Q(Q({},t.collisionFrame??{x:0,y:0,width:0,height:0}),r)}))}initialize(e){this.patchState(e)}saveAnimation(e,t){let r=this.get();return r.name?(r.projectId=e,r.spriteId=t,r.id&&r.id>0?this.spritesAnimationService.update(r.id,r).pipe(ut(o=>this.patchState(o))):this.spritesAnimationService.add(r).pipe(ut(o=>this.patchState(o)))):lt(null)}static{this.\u0275fac=function(t){return new(t||n)(Qi(Dn))}}static{this.\u0275prov=dt({token:n,factory:n.\u0275fac})}}return n})();var nt=9e15,Oe=1e9,Hi="0123456789abcdef",mi="2.3025850929940456840179914546843642076011014886287729760333279009675726096773524802359972050895982983419677840422862486334095254650828067566662873690987816894829072083255546808437998948262331985283935053089653777326288461633662222876982198867465436674744042432743651550489343149393914796194044002221051017141748003688084012647080685567743216228355220114804663715659121373450747856947683463616792101806445070648000277502684916746550586856935673420670581136429224554405758925724208241314695689016758940256776311356919292033376587141660230105703089634572075440370847469940168269282808481184289314848524948644871927809676271275775397027668605952496716674183485704422507197965004714951050492214776567636938662976979522110718264549734772662425709429322582798502585509785265383207606726317164309505995087807523710333101197857547331541421808427543863591778117054309827482385045648019095610299291824318237525357709750539565187697510374970888692180205189339507238539205144634197265287286965110862571492198849978748873771345686209167058",hi="3.1415926535897932384626433832795028841971693993751058209749445923078164062862089986280348253421170679821480865132823066470938446095505822317253594081284811174502841027019385211055596446229489549303819644288109756659334461284756482337867831652712019091456485669234603486104543266482133936072602491412737245870066063155881748815209209628292540917153643678925903600113305305488204665213841469519415116094330572703657595919530921861173819326117931051185480744623799627495673518857527248912279381830119491298336733624406566430860213949463952247371907021798609437027705392171762931767523846748184676694051320005681271452635608277857713427577896091736371787214684409012249534301465495853710507922796892589235420199561121290219608640344181598136297747713099605187072113499999983729780499510597317328160963185950244594553469083026425223082533446850352619311881710100031378387528865875332083814206171776691473035982534904287554687311595628638823537875937519577818577805321712268066130019278766111959092164201989380952572010654858632789",zi={precision:20,rounding:4,modulo:1,toExpNeg:-7,toExpPos:21,minE:-nt,maxE:nt,crypto:!1},Dr,Pe,P=!0,fi="[DecimalError] ",Ve=fi+"Invalid argument: ",Pr=fi+"Precision limit exceeded",Ir=fi+"crypto unavailable",Tr="[object Decimal]",oe=Math.floor,K=Math.pow,_o=/^0b([01]+(\.[01]*)?|\.[01]+)(p[+-]?\d+)?$/i,fo=/^0x([0-9a-f]+(\.[0-9a-f]*)?|\.[0-9a-f]+)(p[+-]?\d+)?$/i,go=/^0o([0-7]+(\.[0-7]*)?|\.[0-7]+)(p[+-]?\d+)?$/i,kr=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,fe=1e7,E=7,Co=9007199254740991,vo=mi.length-1,Gi=hi.length-1,_={toStringTag:Tr};_.absoluteValue=_.abs=function(){var n=new this.constructor(this);return n.s<0&&(n.s=1),x(n)};_.ceil=function(){return x(new this.constructor(this),this.e+1,2)};_.clampedTo=_.clamp=function(n,i){var e,t=this,r=t.constructor;if(n=new r(n),i=new r(i),!n.s||!i.s)return new r(NaN);if(n.gt(i))throw Error(Ve+i);return e=t.cmp(n),e<0?n:t.cmp(i)>0?i:new r(t)};_.comparedTo=_.cmp=function(n){var i,e,t,r,o=this,s=o.d,a=(n=new o.constructor(n)).d,c=o.s,l=n.s;if(!s||!a)return!c||!l?NaN:c!==l?c:s===a?0:!s^c<0?1:-1;if(!s[0]||!a[0])return s[0]?c:a[0]?-l:0;if(c!==l)return c;if(o.e!==n.e)return o.e>n.e^c<0?1:-1;for(t=s.length,r=a.length,i=0,e=t<r?t:r;i<e;++i)if(s[i]!==a[i])return s[i]>a[i]^c<0?1:-1;return t===r?0:t>r^c<0?1:-1};_.cosine=_.cos=function(){var n,i,e=this,t=e.constructor;return e.d?e.d[0]?(n=t.precision,i=t.rounding,t.precision=n+Math.max(e.e,e.sd())+E,t.rounding=1,e=So(t,Ar(t,e)),t.precision=n,t.rounding=i,x(Pe==2||Pe==3?e.neg():e,n,i,!0)):new t(1):new t(NaN)};_.cubeRoot=_.cbrt=function(){var n,i,e,t,r,o,s,a,c,l,u=this,p=u.constructor;if(!u.isFinite()||u.isZero())return new p(u);for(P=!1,o=u.s*K(u.s*u,1/3),!o||Math.abs(o)==1/0?(e=te(u.d),n=u.e,(o=(n-e.length+1)%3)&&(e+=o==1||o==-2?"0":"00"),o=K(e,1/3),n=oe((n+1)/3)-(n%3==(n<0?-1:2)),o==1/0?e="5e"+n:(e=o.toExponential(),e=e.slice(0,e.indexOf("e")+1)+n),t=new p(e),t.s=u.s):t=new p(o.toString()),s=(n=p.precision)+3;;)if(a=t,c=a.times(a).times(a),l=c.plus(u),t=j(l.plus(u).times(a),l.plus(c),s+2,1),te(a.d).slice(0,s)===(e=te(t.d)).slice(0,s))if(e=e.slice(s-3,s+1),e=="9999"||!r&&e=="4999"){if(!r&&(x(a,n+1,0),a.times(a).times(a).eq(u))){t=a;break}s+=4,r=1}else{(!+e||!+e.slice(1)&&e.charAt(0)=="5")&&(x(t,n+1,1),i=!t.times(t).times(t).eq(u));break}return P=!0,x(t,n,p.rounding,i)};_.decimalPlaces=_.dp=function(){var n,i=this.d,e=NaN;if(i){if(n=i.length-1,e=(n-oe(this.e/E))*E,n=i[n],n)for(;n%10==0;n/=10)e--;e<0&&(e=0)}return e};_.dividedBy=_.div=function(n){return j(this,new this.constructor(n))};_.dividedToIntegerBy=_.divToInt=function(n){var i=this,e=i.constructor;return x(j(i,new e(n),0,1,1),e.precision,e.rounding)};_.equals=_.eq=function(n){return this.cmp(n)===0};_.floor=function(){return x(new this.constructor(this),this.e+1,3)};_.greaterThan=_.gt=function(n){return this.cmp(n)>0};_.greaterThanOrEqualTo=_.gte=function(n){var i=this.cmp(n);return i==1||i===0};_.hyperbolicCosine=_.cosh=function(){var n,i,e,t,r,o=this,s=o.constructor,a=new s(1);if(!o.isFinite())return new s(o.s?1/0:NaN);if(o.isZero())return a;e=s.precision,t=s.rounding,s.precision=e+Math.max(o.e,o.sd())+4,s.rounding=1,r=o.d.length,r<32?(n=Math.ceil(r/3),i=(1/Ci(4,n)).toString()):(n=16,i="2.3283064365386962890625e-10"),o=rt(s,1,o.times(i),new s(1),!0);for(var c,l=n,u=new s(8);l--;)c=o.times(o),o=a.minus(c.times(u.minus(c.times(u))));return x(o,s.precision=e,s.rounding=t,!0)};_.hyperbolicSine=_.sinh=function(){var n,i,e,t,r=this,o=r.constructor;if(!r.isFinite()||r.isZero())return new o(r);if(i=o.precision,e=o.rounding,o.precision=i+Math.max(r.e,r.sd())+4,o.rounding=1,t=r.d.length,t<3)r=rt(o,2,r,r,!0);else{n=1.4*Math.sqrt(t),n=n>16?16:n|0,r=r.times(1/Ci(5,n)),r=rt(o,2,r,r,!0);for(var s,a=new o(5),c=new o(16),l=new o(20);n--;)s=r.times(r),r=r.times(a.plus(s.times(c.times(s).plus(l))))}return o.precision=i,o.rounding=e,x(r,i,e,!0)};_.hyperbolicTangent=_.tanh=function(){var n,i,e=this,t=e.constructor;return e.isFinite()?e.isZero()?new t(e):(n=t.precision,i=t.rounding,t.precision=n+7,t.rounding=1,j(e.sinh(),e.cosh(),t.precision=n,t.rounding=i)):new t(e.s)};_.inverseCosine=_.acos=function(){var n,i=this,e=i.constructor,t=i.abs().cmp(1),r=e.precision,o=e.rounding;return t!==-1?t===0?i.isNeg()?_e(e,r,o):new e(0):new e(NaN):i.isZero()?_e(e,r+4,o).times(.5):(e.precision=r+6,e.rounding=1,i=i.asin(),n=_e(e,r+4,o).times(.5),e.precision=r,e.rounding=o,n.minus(i))};_.inverseHyperbolicCosine=_.acosh=function(){var n,i,e=this,t=e.constructor;return e.lte(1)?new t(e.eq(1)?0:NaN):e.isFinite()?(n=t.precision,i=t.rounding,t.precision=n+Math.max(Math.abs(e.e),e.sd())+4,t.rounding=1,P=!1,e=e.times(e).minus(1).sqrt().plus(e),P=!0,t.precision=n,t.rounding=i,e.ln()):new t(e)};_.inverseHyperbolicSine=_.asinh=function(){var n,i,e=this,t=e.constructor;return!e.isFinite()||e.isZero()?new t(e):(n=t.precision,i=t.rounding,t.precision=n+2*Math.max(Math.abs(e.e),e.sd())+6,t.rounding=1,P=!1,e=e.times(e).plus(1).sqrt().plus(e),P=!0,t.precision=n,t.rounding=i,e.ln())};_.inverseHyperbolicTangent=_.atanh=function(){var n,i,e,t,r=this,o=r.constructor;return r.isFinite()?r.e>=0?new o(r.abs().eq(1)?r.s/0:r.isZero()?r:NaN):(n=o.precision,i=o.rounding,t=r.sd(),Math.max(t,n)<2*-r.e-1?x(new o(r),n,i,!0):(o.precision=e=t-r.e,r=j(r.plus(1),new o(1).minus(r),e+n,1),o.precision=n+4,o.rounding=1,r=r.ln(),o.precision=n,o.rounding=i,r.times(.5))):new o(NaN)};_.inverseSine=_.asin=function(){var n,i,e,t,r=this,o=r.constructor;return r.isZero()?new o(r):(i=r.abs().cmp(1),e=o.precision,t=o.rounding,i!==-1?i===0?(n=_e(o,e+4,t).times(.5),n.s=r.s,n):new o(NaN):(o.precision=e+6,o.rounding=1,r=r.div(new o(1).minus(r.times(r)).sqrt().plus(1)).atan(),o.precision=e,o.rounding=t,r.times(2)))};_.inverseTangent=_.atan=function(){var n,i,e,t,r,o,s,a,c,l=this,u=l.constructor,p=u.precision,h=u.rounding;if(l.isFinite()){if(l.isZero())return new u(l);if(l.abs().eq(1)&&p+4<=Gi)return s=_e(u,p+4,h).times(.25),s.s=l.s,s}else{if(!l.s)return new u(NaN);if(p+4<=Gi)return s=_e(u,p+4,h).times(.5),s.s=l.s,s}for(u.precision=a=p+10,u.rounding=1,e=Math.min(28,a/E+2|0),n=e;n;--n)l=l.div(l.times(l).plus(1).sqrt().plus(1));for(P=!1,i=Math.ceil(a/E),t=1,c=l.times(l),s=new u(l),r=l;n!==-1;)if(r=r.times(c),o=s.minus(r.div(t+=2)),r=r.times(c),s=o.plus(r.div(t+=2)),s.d[i]!==void 0)for(n=i;s.d[n]===o.d[n]&&n--;);return e&&(s=s.times(2<<e-1)),P=!0,x(s,u.precision=p,u.rounding=h,!0)};_.isFinite=function(){return!!this.d};_.isInteger=_.isInt=function(){return!!this.d&&oe(this.e/E)>this.d.length-2};_.isNaN=function(){return!this.s};_.isNegative=_.isNeg=function(){return this.s<0};_.isPositive=_.isPos=function(){return this.s>0};_.isZero=function(){return!!this.d&&this.d[0]===0};_.lessThan=_.lt=function(n){return this.cmp(n)<0};_.lessThanOrEqualTo=_.lte=function(n){return this.cmp(n)<1};_.logarithm=_.log=function(n){var i,e,t,r,o,s,a,c,l=this,u=l.constructor,p=u.precision,h=u.rounding,b=5;if(n==null)n=new u(10),i=!0;else{if(n=new u(n),e=n.d,n.s<0||!e||!e[0]||n.eq(1))return new u(NaN);i=n.eq(10)}if(e=l.d,l.s<0||!e||!e[0]||l.eq(1))return new u(e&&!e[0]?-1/0:l.s!=1?NaN:e?0:1/0);if(i)if(e.length>1)o=!0;else{for(r=e[0];r%10===0;)r/=10;o=r!==1}if(P=!1,a=p+b,s=Ae(l,a),t=i?_i(u,a+10):Ae(n,a),c=j(s,t,a,1),bt(c.d,r=p,h))do if(a+=10,s=Ae(l,a),t=i?_i(u,a+10):Ae(n,a),c=j(s,t,a,1),!o){+te(c.d).slice(r+1,r+15)+1==1e14&&(c=x(c,p+1,0));break}while(bt(c.d,r+=10,h));return P=!0,x(c,p,h)};_.minus=_.sub=function(n){var i,e,t,r,o,s,a,c,l,u,p,h,b=this,M=b.constructor;if(n=new M(n),!b.d||!n.d)return!b.s||!n.s?n=new M(NaN):b.d?n.s=-n.s:n=new M(n.d||b.s!==n.s?b:NaN),n;if(b.s!=n.s)return n.s=-n.s,b.plus(n);if(l=b.d,h=n.d,a=M.precision,c=M.rounding,!l[0]||!h[0]){if(h[0])n.s=-n.s;else if(l[0])n=new M(b);else return new M(c===3?-0:0);return P?x(n,a,c):n}if(e=oe(n.e/E),u=oe(b.e/E),l=l.slice(),o=u-e,o){for(p=o<0,p?(i=l,o=-o,s=h.length):(i=h,e=u,s=l.length),t=Math.max(Math.ceil(a/E),s)+2,o>t&&(o=t,i.length=1),i.reverse(),t=o;t--;)i.push(0);i.reverse()}else{for(t=l.length,s=h.length,p=t<s,p&&(s=t),t=0;t<s;t++)if(l[t]!=h[t]){p=l[t]<h[t];break}o=0}for(p&&(i=l,l=h,h=i,n.s=-n.s),s=l.length,t=h.length-s;t>0;--t)l[s++]=0;for(t=h.length;t>o;){if(l[--t]<h[t]){for(r=t;r&&l[--r]===0;)l[r]=fe-1;--l[r],l[t]+=fe}l[t]-=h[t]}for(;l[--s]===0;)l.pop();for(;l[0]===0;l.shift())--e;return l[0]?(n.d=l,n.e=gi(l,e),P?x(n,a,c):n):new M(c===3?-0:0)};_.modulo=_.mod=function(n){var i,e=this,t=e.constructor;return n=new t(n),!e.d||!n.s||n.d&&!n.d[0]?new t(NaN):!n.d||e.d&&!e.d[0]?x(new t(e),t.precision,t.rounding):(P=!1,t.modulo==9?(i=j(e,n.abs(),0,3,1),i.s*=n.s):i=j(e,n,0,t.modulo,1),i=i.times(n),P=!0,e.minus(i))};_.naturalExponential=_.exp=function(){return Ui(this)};_.naturalLogarithm=_.ln=function(){return Ae(this)};_.negated=_.neg=function(){var n=new this.constructor(this);return n.s=-n.s,x(n)};_.plus=_.add=function(n){var i,e,t,r,o,s,a,c,l,u,p=this,h=p.constructor;if(n=new h(n),!p.d||!n.d)return!p.s||!n.s?n=new h(NaN):p.d||(n=new h(n.d||p.s===n.s?p:NaN)),n;if(p.s!=n.s)return n.s=-n.s,p.minus(n);if(l=p.d,u=n.d,a=h.precision,c=h.rounding,!l[0]||!u[0])return u[0]||(n=new h(p)),P?x(n,a,c):n;if(o=oe(p.e/E),t=oe(n.e/E),l=l.slice(),r=o-t,r){for(r<0?(e=l,r=-r,s=u.length):(e=u,t=o,s=l.length),o=Math.ceil(a/E),s=o>s?o+1:s+1,r>s&&(r=s,e.length=1),e.reverse();r--;)e.push(0);e.reverse()}for(s=l.length,r=u.length,s-r<0&&(r=s,e=u,u=l,l=e),i=0;r;)i=(l[--r]=l[r]+u[r]+i)/fe|0,l[r]%=fe;for(i&&(l.unshift(i),++t),s=l.length;l[--s]==0;)l.pop();return n.d=l,n.e=gi(l,t),P?x(n,a,c):n};_.precision=_.sd=function(n){var i,e=this;if(n!==void 0&&n!==!!n&&n!==1&&n!==0)throw Error(Ve+n);return e.d?(i=Mr(e.d),n&&e.e+1>i&&(i=e.e+1)):i=NaN,i};_.round=function(){var n=this,i=n.constructor;return x(new i(n),n.e+1,i.rounding)};_.sine=_.sin=function(){var n,i,e=this,t=e.constructor;return e.isFinite()?e.isZero()?new t(e):(n=t.precision,i=t.rounding,t.precision=n+Math.max(e.e,e.sd())+E,t.rounding=1,e=yo(t,Ar(t,e)),t.precision=n,t.rounding=i,x(Pe>2?e.neg():e,n,i,!0)):new t(NaN)};_.squareRoot=_.sqrt=function(){var n,i,e,t,r,o,s=this,a=s.d,c=s.e,l=s.s,u=s.constructor;if(l!==1||!a||!a[0])return new u(!l||l<0&&(!a||a[0])?NaN:a?s:1/0);for(P=!1,l=Math.sqrt(+s),l==0||l==1/0?(i=te(a),(i.length+c)%2==0&&(i+="0"),l=Math.sqrt(i),c=oe((c+1)/2)-(c<0||c%2),l==1/0?i="5e"+c:(i=l.toExponential(),i=i.slice(0,i.indexOf("e")+1)+c),t=new u(i)):t=new u(l.toString()),e=(c=u.precision)+3;;)if(o=t,t=o.plus(j(s,o,e+2,1)).times(.5),te(o.d).slice(0,e)===(i=te(t.d)).slice(0,e))if(i=i.slice(e-3,e+1),i=="9999"||!r&&i=="4999"){if(!r&&(x(o,c+1,0),o.times(o).eq(s))){t=o;break}e+=4,r=1}else{(!+i||!+i.slice(1)&&i.charAt(0)=="5")&&(x(t,c+1,1),n=!t.times(t).eq(s));break}return P=!0,x(t,c,u.rounding,n)};_.tangent=_.tan=function(){var n,i,e=this,t=e.constructor;return e.isFinite()?e.isZero()?new t(e):(n=t.precision,i=t.rounding,t.precision=n+10,t.rounding=1,e=e.sin(),e.s=1,e=j(e,new t(1).minus(e.times(e)).sqrt(),n+10,0),t.precision=n,t.rounding=i,x(Pe==2||Pe==4?e.neg():e,n,i,!0)):new t(NaN)};_.times=_.mul=function(n){var i,e,t,r,o,s,a,c,l,u=this,p=u.constructor,h=u.d,b=(n=new p(n)).d;if(n.s*=u.s,!h||!h[0]||!b||!b[0])return new p(!n.s||h&&!h[0]&&!b||b&&!b[0]&&!h?NaN:!h||!b?n.s/0:n.s*0);for(e=oe(u.e/E)+oe(n.e/E),c=h.length,l=b.length,c<l&&(o=h,h=b,b=o,s=c,c=l,l=s),o=[],s=c+l,t=s;t--;)o.push(0);for(t=l;--t>=0;){for(i=0,r=c+t;r>t;)a=o[r]+b[t]*h[r-t-1]+i,o[r--]=a%fe|0,i=a/fe|0;o[r]=(o[r]+i)%fe|0}for(;!o[--s];)o.pop();return i?++e:o.shift(),n.d=o,n.e=gi(o,e),P?x(n,p.precision,p.rounding):n};_.toBinary=function(n,i){return Zi(this,2,n,i)};_.toDecimalPlaces=_.toDP=function(n,i){var e=this,t=e.constructor;return e=new t(e),n===void 0?e:(ue(n,0,Oe),i===void 0?i=t.rounding:ue(i,0,8),x(e,n+e.e+1,i))};_.toExponential=function(n,i){var e,t=this,r=t.constructor;return n===void 0?e=ye(t,!0):(ue(n,0,Oe),i===void 0?i=r.rounding:ue(i,0,8),t=x(new r(t),n+1,i),e=ye(t,!0,n+1)),t.isNeg()&&!t.isZero()?"-"+e:e};_.toFixed=function(n,i){var e,t,r=this,o=r.constructor;return n===void 0?e=ye(r):(ue(n,0,Oe),i===void 0?i=o.rounding:ue(i,0,8),t=x(new o(r),n+r.e+1,i),e=ye(t,!1,n+t.e+1)),r.isNeg()&&!r.isZero()?"-"+e:e};_.toFraction=function(n){var i,e,t,r,o,s,a,c,l,u,p,h,b=this,M=b.d,D=b.constructor;if(!M)return new D(b);if(l=e=new D(1),t=c=new D(0),i=new D(t),o=i.e=Mr(M)-b.e-1,s=o%E,i.d[0]=K(10,s<0?E+s:s),n==null)n=o>0?i:l;else{if(a=new D(n),!a.isInt()||a.lt(l))throw Error(Ve+a);n=a.gt(i)?o>0?i:l:a}for(P=!1,a=new D(te(M)),u=D.precision,D.precision=o=M.length*E*2;p=j(a,i,0,1,1),r=e.plus(p.times(t)),r.cmp(n)!=1;)e=t,t=r,r=l,l=c.plus(p.times(r)),c=r,r=i,i=a.minus(p.times(r)),a=r;return r=j(n.minus(e),t,0,1,1),c=c.plus(r.times(l)),e=e.plus(r.times(t)),c.s=l.s=b.s,h=j(l,t,o,1).minus(b).abs().cmp(j(c,e,o,1).minus(b).abs())<1?[l,t]:[c,e],D.precision=u,P=!0,h};_.toHexadecimal=_.toHex=function(n,i){return Zi(this,16,n,i)};_.toNearest=function(n,i){var e=this,t=e.constructor;if(e=new t(e),n==null){if(!e.d)return e;n=new t(1),i=t.rounding}else{if(n=new t(n),i===void 0?i=t.rounding:ue(i,0,8),!e.d)return n.s?e:n;if(!n.d)return n.s&&(n.s=e.s),n}return n.d[0]?(P=!1,e=j(e,n,0,i,1).times(n),P=!0,x(e)):(n.s=e.s,e=n),e};_.toNumber=function(){return+this};_.toOctal=function(n,i){return Zi(this,8,n,i)};_.toPower=_.pow=function(n){var i,e,t,r,o,s,a=this,c=a.constructor,l=+(n=new c(n));if(!a.d||!n.d||!a.d[0]||!n.d[0])return new c(K(+a,l));if(a=new c(a),a.eq(1))return a;if(t=c.precision,o=c.rounding,n.eq(1))return x(a,t,o);if(i=oe(n.e/E),i>=n.d.length-1&&(e=l<0?-l:l)<=Co)return r=Lr(c,a,e,t),n.s<0?new c(1).div(r):x(r,t,o);if(s=a.s,s<0){if(i<n.d.length-1)return new c(NaN);if(n.d[i]&1||(s=1),a.e==0&&a.d[0]==1&&a.d.length==1)return a.s=s,a}return e=K(+a,l),i=e==0||!isFinite(e)?oe(l*(Math.log("0."+te(a.d))/Math.LN10+a.e+1)):new c(e+"").e,i>c.maxE+1||i<c.minE-1?new c(i>0?s/0:0):(P=!1,c.rounding=a.s=1,e=Math.min(12,(i+"").length),r=Ui(n.times(Ae(a,t+e)),t),r.d&&(r=x(r,t+5,1),bt(r.d,t,o)&&(i=t+10,r=x(Ui(n.times(Ae(a,i+e)),i),i+5,1),+te(r.d).slice(t+1,t+15)+1==1e14&&(r=x(r,t+1,0)))),r.s=s,P=!0,c.rounding=o,x(r,t,o))};_.toPrecision=function(n,i){var e,t=this,r=t.constructor;return n===void 0?e=ye(t,t.e<=r.toExpNeg||t.e>=r.toExpPos):(ue(n,1,Oe),i===void 0?i=r.rounding:ue(i,0,8),t=x(new r(t),n,i),e=ye(t,n<=t.e||t.e<=r.toExpNeg,n)),t.isNeg()&&!t.isZero()?"-"+e:e};_.toSignificantDigits=_.toSD=function(n,i){var e=this,t=e.constructor;return n===void 0?(n=t.precision,i=t.rounding):(ue(n,1,Oe),i===void 0?i=t.rounding:ue(i,0,8)),x(new t(e),n,i)};_.toString=function(){var n=this,i=n.constructor,e=ye(n,n.e<=i.toExpNeg||n.e>=i.toExpPos);return n.isNeg()&&!n.isZero()?"-"+e:e};_.truncated=_.trunc=function(){return x(new this.constructor(this),this.e+1,1)};_.valueOf=_.toJSON=function(){var n=this,i=n.constructor,e=ye(n,n.e<=i.toExpNeg||n.e>=i.toExpPos);return n.isNeg()?"-"+e:e};function te(n){var i,e,t,r=n.length-1,o="",s=n[0];if(r>0){for(o+=s,i=1;i<r;i++)t=n[i]+"",e=E-t.length,e&&(o+=Fe(e)),o+=t;s=n[i],t=s+"",e=E-t.length,e&&(o+=Fe(e))}else if(s===0)return"0";for(;s%10===0;)s/=10;return o+s}function ue(n,i,e){if(n!==~~n||n<i||n>e)throw Error(Ve+n)}function bt(n,i,e,t){var r,o,s,a;for(o=n[0];o>=10;o/=10)--i;return--i<0?(i+=E,r=0):(r=Math.ceil((i+1)/E),i%=E),o=K(10,E-i),a=n[r]%o|0,t==null?i<3?(i==0?a=a/100|0:i==1&&(a=a/10|0),s=e<4&&a==99999||e>3&&a==49999||a==5e4||a==0):s=(e<4&&a+1==o||e>3&&a+1==o/2)&&(n[r+1]/o/100|0)==K(10,i-2)-1||(a==o/2||a==0)&&(n[r+1]/o/100|0)==0:i<4?(i==0?a=a/1e3|0:i==1?a=a/100|0:i==2&&(a=a/10|0),s=(t||e<4)&&a==9999||!t&&e>3&&a==4999):s=((t||e<4)&&a+1==o||!t&&e>3&&a+1==o/2)&&(n[r+1]/o/1e3|0)==K(10,i-3)-1,s}function pi(n,i,e){for(var t,r=[0],o,s=0,a=n.length;s<a;){for(o=r.length;o--;)r[o]*=i;for(r[0]+=Hi.indexOf(n.charAt(s++)),t=0;t<r.length;t++)r[t]>e-1&&(r[t+1]===void 0&&(r[t+1]=0),r[t+1]+=r[t]/e|0,r[t]%=e)}return r.reverse()}function So(n,i){var e,t,r;if(i.isZero())return i;t=i.d.length,t<32?(e=Math.ceil(t/3),r=(1/Ci(4,e)).toString()):(e=16,r="2.3283064365386962890625e-10"),n.precision+=e,i=rt(n,1,i.times(r),new n(1));for(var o=e;o--;){var s=i.times(i);i=s.times(s).minus(s).times(8).plus(1)}return n.precision-=e,i}var j=function(){function n(t,r,o){var s,a=0,c=t.length;for(t=t.slice();c--;)s=t[c]*r+a,t[c]=s%o|0,a=s/o|0;return a&&t.unshift(a),t}function i(t,r,o,s){var a,c;if(o!=s)c=o>s?1:-1;else for(a=c=0;a<o;a++)if(t[a]!=r[a]){c=t[a]>r[a]?1:-1;break}return c}function e(t,r,o,s){for(var a=0;o--;)t[o]-=a,a=t[o]<r[o]?1:0,t[o]=a*s+t[o]-r[o];for(;!t[0]&&t.length>1;)t.shift()}return function(t,r,o,s,a,c){var l,u,p,h,b,M,D,O,$,ae,F,W,Ne,be,vi,Dt,st,Si,pe,Pt,It=t.constructor,wi=t.s==r.s?1:-1,ie=t.d,B=r.d;if(!ie||!ie[0]||!B||!B[0])return new It(!t.s||!r.s||(ie?B&&ie[0]==B[0]:!B)?NaN:ie&&ie[0]==0||!B?wi*0:wi/0);for(c?(b=1,u=t.e-r.e):(c=fe,b=E,u=oe(t.e/b)-oe(r.e/b)),pe=B.length,st=ie.length,$=new It(wi),ae=$.d=[],p=0;B[p]==(ie[p]||0);p++);if(B[p]>(ie[p]||0)&&u--,o==null?(be=o=It.precision,s=It.rounding):a?be=o+(t.e-r.e)+1:be=o,be<0)ae.push(1),M=!0;else{if(be=be/b+2|0,p=0,pe==1){for(h=0,B=B[0],be++;(p<st||h)&&be--;p++)vi=h*c+(ie[p]||0),ae[p]=vi/B|0,h=vi%B|0;M=h||p<st}else{for(h=c/(B[0]+1)|0,h>1&&(B=n(B,h,c),ie=n(ie,h,c),pe=B.length,st=ie.length),Dt=pe,F=ie.slice(0,pe),W=F.length;W<pe;)F[W++]=0;Pt=B.slice(),Pt.unshift(0),Si=B[0],B[1]>=c/2&&++Si;do h=0,l=i(B,F,pe,W),l<0?(Ne=F[0],pe!=W&&(Ne=Ne*c+(F[1]||0)),h=Ne/Si|0,h>1?(h>=c&&(h=c-1),D=n(B,h,c),O=D.length,W=F.length,l=i(D,F,O,W),l==1&&(h--,e(D,pe<O?Pt:B,O,c))):(h==0&&(l=h=1),D=B.slice()),O=D.length,O<W&&D.unshift(0),e(F,D,W,c),l==-1&&(W=F.length,l=i(B,F,pe,W),l<1&&(h++,e(F,pe<W?Pt:B,W,c))),W=F.length):l===0&&(h++,F=[0]),ae[p++]=h,l&&F[0]?F[W++]=ie[Dt]||0:(F=[ie[Dt]],W=1);while((Dt++<st||F[0]!==void 0)&&be--);M=F[0]!==void 0}ae[0]||ae.shift()}if(b==1)$.e=u,Dr=M;else{for(p=1,h=ae[0];h>=10;h/=10)p++;$.e=p+u*b-1,x($,a?o+$.e+1:o,s,M)}return $}}();function x(n,i,e,t){var r,o,s,a,c,l,u,p,h,b=n.constructor;e:if(i!=null){if(p=n.d,!p)return n;for(r=1,a=p[0];a>=10;a/=10)r++;if(o=i-r,o<0)o+=E,s=i,u=p[h=0],c=u/K(10,r-s-1)%10|0;else if(h=Math.ceil((o+1)/E),a=p.length,h>=a)if(t){for(;a++<=h;)p.push(0);u=c=0,r=1,o%=E,s=o-E+1}else break e;else{for(u=a=p[h],r=1;a>=10;a/=10)r++;o%=E,s=o-E+r,c=s<0?0:u/K(10,r-s-1)%10|0}if(t=t||i<0||p[h+1]!==void 0||(s<0?u:u%K(10,r-s-1)),l=e<4?(c||t)&&(e==0||e==(n.s<0?3:2)):c>5||c==5&&(e==4||t||e==6&&(o>0?s>0?u/K(10,r-s):0:p[h-1])%10&1||e==(n.s<0?8:7)),i<1||!p[0])return p.length=0,l?(i-=n.e+1,p[0]=K(10,(E-i%E)%E),n.e=-i||0):p[0]=n.e=0,n;if(o==0?(p.length=h,a=1,h--):(p.length=h+1,a=K(10,E-o),p[h]=s>0?(u/K(10,r-s)%K(10,s)|0)*a:0),l)for(;;)if(h==0){for(o=1,s=p[0];s>=10;s/=10)o++;for(s=p[0]+=a,a=1;s>=10;s/=10)a++;o!=a&&(n.e++,p[0]==fe&&(p[0]=1));break}else{if(p[h]+=a,p[h]!=fe)break;p[h--]=0,a=1}for(o=p.length;p[--o]===0;)p.pop()}return P&&(n.e>b.maxE?(n.d=null,n.e=NaN):n.e<b.minE&&(n.e=0,n.d=[0])),n}function ye(n,i,e){if(!n.isFinite())return Fr(n);var t,r=n.e,o=te(n.d),s=o.length;return i?(e&&(t=e-s)>0?o=o.charAt(0)+"."+o.slice(1)+Fe(t):s>1&&(o=o.charAt(0)+"."+o.slice(1)),o=o+(n.e<0?"e":"e+")+n.e):r<0?(o="0."+Fe(-r-1)+o,e&&(t=e-s)>0&&(o+=Fe(t))):r>=s?(o+=Fe(r+1-s),e&&(t=e-r-1)>0&&(o=o+"."+Fe(t))):((t=r+1)<s&&(o=o.slice(0,t)+"."+o.slice(t)),e&&(t=e-s)>0&&(r+1===s&&(o+="."),o+=Fe(t))),o}function gi(n,i){var e=n[0];for(i*=E;e>=10;e/=10)i++;return i}function _i(n,i,e){if(i>vo)throw P=!0,e&&(n.precision=e),Error(Pr);return x(new n(mi),i,1,!0)}function _e(n,i,e){if(i>Gi)throw Error(Pr);return x(new n(hi),i,e,!0)}function Mr(n){var i=n.length-1,e=i*E+1;if(i=n[i],i){for(;i%10==0;i/=10)e--;for(i=n[0];i>=10;i/=10)e++}return e}function Fe(n){for(var i="";n--;)i+="0";return i}function Lr(n,i,e,t){var r,o=new n(1),s=Math.ceil(t/E+4);for(P=!1;;){if(e%2&&(o=o.times(i),xr(o.d,s)&&(r=!0)),e=oe(e/2),e===0){e=o.d.length-1,r&&o.d[e]===0&&++o.d[e];break}i=i.times(i),xr(i.d,s)}return P=!0,o}function br(n){return n.d[n.d.length-1]&1}function Rr(n,i,e){for(var t,r=new n(i[0]),o=0;++o<i.length;)if(t=new n(i[o]),t.s)r[e](t)&&(r=t);else{r=t;break}return r}function Ui(n,i){var e,t,r,o,s,a,c,l=0,u=0,p=0,h=n.constructor,b=h.rounding,M=h.precision;if(!n.d||!n.d[0]||n.e>17)return new h(n.d?n.d[0]?n.s<0?0:1/0:1:n.s?n.s<0?0:n:NaN);for(i==null?(P=!1,c=M):c=i,a=new h(.03125);n.e>-2;)n=n.times(a),p+=5;for(t=Math.log(K(2,p))/Math.LN10*2+5|0,c+=t,e=o=s=new h(1),h.precision=c;;){if(o=x(o.times(n),c,1),e=e.times(++u),a=s.plus(j(o,e,c,1)),te(a.d).slice(0,c)===te(s.d).slice(0,c)){for(r=p;r--;)s=x(s.times(s),c,1);if(i==null)if(l<3&&bt(s.d,c-t,b,l))h.precision=c+=10,e=o=a=new h(1),u=0,l++;else return x(s,h.precision=M,b,P=!0);else return h.precision=M,s}s=a}}function Ae(n,i){var e,t,r,o,s,a,c,l,u,p,h,b=1,M=10,D=n,O=D.d,$=D.constructor,ae=$.rounding,F=$.precision;if(D.s<0||!O||!O[0]||!D.e&&O[0]==1&&O.length==1)return new $(O&&!O[0]?-1/0:D.s!=1?NaN:O?0:D);if(i==null?(P=!1,u=F):u=i,$.precision=u+=M,e=te(O),t=e.charAt(0),Math.abs(o=D.e)<15e14){for(;t<7&&t!=1||t==1&&e.charAt(1)>3;)D=D.times(n),e=te(D.d),t=e.charAt(0),b++;o=D.e,t>1?(D=new $("0."+e),o++):D=new $(t+"."+e.slice(1))}else return l=_i($,u+2,F).times(o+""),D=Ae(new $(t+"."+e.slice(1)),u-M).plus(l),$.precision=F,i==null?x(D,F,ae,P=!0):D;for(p=D,c=s=D=j(D.minus(1),D.plus(1),u,1),h=x(D.times(D),u,1),r=3;;){if(s=x(s.times(h),u,1),l=c.plus(j(s,new $(r),u,1)),te(l.d).slice(0,u)===te(c.d).slice(0,u))if(c=c.times(2),o!==0&&(c=c.plus(_i($,u+2,F).times(o+""))),c=j(c,new $(b),u,1),i==null)if(bt(c.d,u-M,ae,a))$.precision=u+=M,l=s=D=j(p.minus(1),p.plus(1),u,1),h=x(D.times(D),u,1),r=a=1;else return x(c,$.precision=F,ae,P=!0);else return $.precision=F,c;c=l,r+=2}}function Fr(n){return String(n.s*n.s/0)}function qi(n,i){var e,t,r;for((e=i.indexOf("."))>-1&&(i=i.replace(".","")),(t=i.search(/e/i))>0?(e<0&&(e=t),e+=+i.slice(t+1),i=i.substring(0,t)):e<0&&(e=i.length),t=0;i.charCodeAt(t)===48;t++);for(r=i.length;i.charCodeAt(r-1)===48;--r);if(i=i.slice(t,r),i){if(r-=t,n.e=e=e-t-1,n.d=[],t=(e+1)%E,e<0&&(t+=E),t<r){for(t&&n.d.push(+i.slice(0,t)),r-=E;t<r;)n.d.push(+i.slice(t,t+=E));i=i.slice(t),t=E-i.length}else t-=r;for(;t--;)i+="0";n.d.push(+i),P&&(n.e>n.constructor.maxE?(n.d=null,n.e=NaN):n.e<n.constructor.minE&&(n.e=0,n.d=[0]))}else n.e=0,n.d=[0];return n}function wo(n,i){var e,t,r,o,s,a,c,l,u;if(i.indexOf("_")>-1){if(i=i.replace(/(\d)_(?=\d)/g,"$1"),kr.test(i))return qi(n,i)}else if(i==="Infinity"||i==="NaN")return+i||(n.s=NaN),n.e=NaN,n.d=null,n;if(fo.test(i))e=16,i=i.toLowerCase();else if(_o.test(i))e=2;else if(go.test(i))e=8;else throw Error(Ve+i);for(o=i.search(/p/i),o>0?(c=+i.slice(o+1),i=i.substring(2,o)):i=i.slice(2),o=i.indexOf("."),s=o>=0,t=n.constructor,s&&(i=i.replace(".",""),a=i.length,o=a-o,r=Lr(t,new t(e),o,o*2)),l=pi(i,e,fe),u=l.length-1,o=u;l[o]===0;--o)l.pop();return o<0?new t(n.s*0):(n.e=gi(l,u),n.d=l,P=!1,s&&(n=j(n,r,a*4)),c&&(n=n.times(Math.abs(c)<54?K(2,c):xt.pow(2,c))),P=!0,n)}function yo(n,i){var e,t=i.d.length;if(t<3)return i.isZero()?i:rt(n,2,i,i);e=1.4*Math.sqrt(t),e=e>16?16:e|0,i=i.times(1/Ci(5,e)),i=rt(n,2,i,i);for(var r,o=new n(5),s=new n(16),a=new n(20);e--;)r=i.times(i),i=i.times(o.plus(r.times(s.times(r).minus(a))));return i}function rt(n,i,e,t,r){var o,s,a,c,l=1,u=n.precision,p=Math.ceil(u/E);for(P=!1,c=e.times(e),a=new n(t);;){if(s=j(a.times(c),new n(i++*i++),u,1),a=r?t.plus(s):t.minus(s),t=j(s.times(c),new n(i++*i++),u,1),s=a.plus(t),s.d[p]!==void 0){for(o=p;s.d[o]===a.d[o]&&o--;);if(o==-1)break}o=a,a=t,t=s,s=o,l++}return P=!0,s.d.length=p+1,s}function Ci(n,i){for(var e=n;--i;)e*=n;return e}function Ar(n,i){var e,t=i.s<0,r=_e(n,n.precision,1),o=r.times(.5);if(i=i.abs(),i.lte(o))return Pe=t?4:1,i;if(e=i.divToInt(r),e.isZero())Pe=t?3:2;else{if(i=i.minus(e.times(r)),i.lte(o))return Pe=br(e)?t?2:3:t?4:1,i;Pe=br(e)?t?1:4:t?3:2}return i.minus(r).abs()}function Zi(n,i,e,t){var r,o,s,a,c,l,u,p,h,b=n.constructor,M=e!==void 0;if(M?(ue(e,1,Oe),t===void 0?t=b.rounding:ue(t,0,8)):(e=b.precision,t=b.rounding),!n.isFinite())u=Fr(n);else{for(u=ye(n),s=u.indexOf("."),M?(r=2,i==16?e=e*4-3:i==8&&(e=e*3-2)):r=i,s>=0&&(u=u.replace(".",""),h=new b(1),h.e=u.length-s,h.d=pi(ye(h),10,r),h.e=h.d.length),p=pi(u,10,r),o=c=p.length;p[--c]==0;)p.pop();if(!p[0])u=M?"0p+0":"0";else{if(s<0?o--:(n=new b(n),n.d=p,n.e=o,n=j(n,h,e,t,0,r),p=n.d,o=n.e,l=Dr),s=p[e],a=r/2,l=l||p[e+1]!==void 0,l=t<4?(s!==void 0||l)&&(t===0||t===(n.s<0?3:2)):s>a||s===a&&(t===4||l||t===6&&p[e-1]&1||t===(n.s<0?8:7)),p.length=e,l)for(;++p[--e]>r-1;)p[e]=0,e||(++o,p.unshift(1));for(c=p.length;!p[c-1];--c);for(s=0,u="";s<c;s++)u+=Hi.charAt(p[s]);if(M){if(c>1)if(i==16||i==8){for(s=i==16?4:3,--c;c%s;c++)u+="0";for(p=pi(u,r,i),c=p.length;!p[c-1];--c);for(s=1,u="1.";s<c;s++)u+=Hi.charAt(p[s])}else u=u.charAt(0)+"."+u.slice(1);u=u+(o<0?"p":"p+")+o}else if(o<0){for(;++o;)u="0"+u;u="0."+u}else if(++o>c)for(o-=c;o--;)u+="0";else o<c&&(u=u.slice(0,o)+"."+u.slice(o))}u=(i==16?"0x":i==2?"0b":i==8?"0o":"")+u}return n.s<0?"-"+u:u}function xr(n,i){if(n.length>i)return n.length=i,!0}function bo(n){return new this(n).abs()}function xo(n){return new this(n).acos()}function Eo(n){return new this(n).acosh()}function Do(n,i){return new this(n).plus(i)}function Po(n){return new this(n).asin()}function Io(n){return new this(n).asinh()}function To(n){return new this(n).atan()}function ko(n){return new this(n).atanh()}function Mo(n,i){n=new this(n),i=new this(i);var e,t=this.precision,r=this.rounding,o=t+4;return!n.s||!i.s?e=new this(NaN):!n.d&&!i.d?(e=_e(this,o,1).times(i.s>0?.25:.75),e.s=n.s):!i.d||n.isZero()?(e=i.s<0?_e(this,t,r):new this(0),e.s=n.s):!n.d||i.isZero()?(e=_e(this,o,1).times(.5),e.s=n.s):i.s<0?(this.precision=o,this.rounding=1,e=this.atan(j(n,i,o,1)),i=_e(this,o,1),this.precision=t,this.rounding=r,e=n.s<0?e.minus(i):e.plus(i)):e=this.atan(j(n,i,o,1)),e}function Lo(n){return new this(n).cbrt()}function Ro(n){return x(n=new this(n),n.e+1,2)}function Fo(n,i,e){return new this(n).clamp(i,e)}function Ao(n){if(!n||typeof n!="object")throw Error(fi+"Object expected");var i,e,t,r=n.defaults===!0,o=["precision",1,Oe,"rounding",0,8,"toExpNeg",-nt,0,"toExpPos",0,nt,"maxE",0,nt,"minE",-nt,0,"modulo",0,9];for(i=0;i<o.length;i+=3)if(e=o[i],r&&(this[e]=zi[e]),(t=n[e])!==void 0)if(oe(t)===t&&t>=o[i+1]&&t<=o[i+2])this[e]=t;else throw Error(Ve+e+": "+t);if(e="crypto",r&&(this[e]=zi[e]),(t=n[e])!==void 0)if(t===!0||t===!1||t===0||t===1)if(t)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))this[e]=!0;else throw Error(Ir);else this[e]=!1;else throw Error(Ve+e+": "+t);return this}function Vo(n){return new this(n).cos()}function Oo(n){return new this(n).cosh()}function Vr(n){var i,e,t;function r(o){var s,a,c,l=this;if(!(l instanceof r))return new r(o);if(l.constructor=r,Er(o)){l.s=o.s,P?!o.d||o.e>r.maxE?(l.e=NaN,l.d=null):o.e<r.minE?(l.e=0,l.d=[0]):(l.e=o.e,l.d=o.d.slice()):(l.e=o.e,l.d=o.d?o.d.slice():o.d);return}if(c=typeof o,c==="number"){if(o===0){l.s=1/o<0?-1:1,l.e=0,l.d=[0];return}if(o<0?(o=-o,l.s=-1):l.s=1,o===~~o&&o<1e7){for(s=0,a=o;a>=10;a/=10)s++;P?s>r.maxE?(l.e=NaN,l.d=null):s<r.minE?(l.e=0,l.d=[0]):(l.e=s,l.d=[o]):(l.e=s,l.d=[o]);return}else if(o*0!==0){o||(l.s=NaN),l.e=NaN,l.d=null;return}return qi(l,o.toString())}else if(c!=="string")throw Error(Ve+o);return(a=o.charCodeAt(0))===45?(o=o.slice(1),l.s=-1):(a===43&&(o=o.slice(1)),l.s=1),kr.test(o)?qi(l,o):wo(l,o)}if(r.prototype=_,r.ROUND_UP=0,r.ROUND_DOWN=1,r.ROUND_CEIL=2,r.ROUND_FLOOR=3,r.ROUND_HALF_UP=4,r.ROUND_HALF_DOWN=5,r.ROUND_HALF_EVEN=6,r.ROUND_HALF_CEIL=7,r.ROUND_HALF_FLOOR=8,r.EUCLID=9,r.config=r.set=Ao,r.clone=Vr,r.isDecimal=Er,r.abs=bo,r.acos=xo,r.acosh=Eo,r.add=Do,r.asin=Po,r.asinh=Io,r.atan=To,r.atanh=ko,r.atan2=Mo,r.cbrt=Lo,r.ceil=Ro,r.clamp=Fo,r.cos=Vo,r.cosh=Oo,r.div=No,r.exp=jo,r.floor=Bo,r.hypot=$o,r.ln=Ho,r.log=zo,r.log10=Uo,r.log2=Go,r.max=qo,r.min=Zo,r.mod=Wo,r.mul=Jo,r.pow=Ko,r.random=Yo,r.round=Xo,r.sign=Qo,r.sin=es,r.sinh=ts,r.sqrt=is,r.sub=ns,r.sum=rs,r.tan=os,r.tanh=ss,r.trunc=as,n===void 0&&(n={}),n&&n.defaults!==!0)for(t=["precision","rounding","toExpNeg","toExpPos","maxE","minE","modulo","crypto"],i=0;i<t.length;)n.hasOwnProperty(e=t[i++])||(n[e]=this[e]);return r.config(n),r}function No(n,i){return new this(n).div(i)}function jo(n){return new this(n).exp()}function Bo(n){return x(n=new this(n),n.e+1,3)}function $o(){var n,i,e=new this(0);for(P=!1,n=0;n<arguments.length;)if(i=new this(arguments[n++]),i.d)e.d&&(e=e.plus(i.times(i)));else{if(i.s)return P=!0,new this(1/0);e=i}return P=!0,e.sqrt()}function Er(n){return n instanceof xt||n&&n.toStringTag===Tr||!1}function Ho(n){return new this(n).ln()}function zo(n,i){return new this(n).log(i)}function Go(n){return new this(n).log(2)}function Uo(n){return new this(n).log(10)}function qo(){return Rr(this,arguments,"lt")}function Zo(){return Rr(this,arguments,"gt")}function Wo(n,i){return new this(n).mod(i)}function Jo(n,i){return new this(n).mul(i)}function Ko(n,i){return new this(n).pow(i)}function Yo(n){var i,e,t,r,o=0,s=new this(1),a=[];if(n===void 0?n=this.precision:ue(n,1,Oe),t=Math.ceil(n/E),this.crypto)if(crypto.getRandomValues)for(i=crypto.getRandomValues(new Uint32Array(t));o<t;)r=i[o],r>=429e7?i[o]=crypto.getRandomValues(new Uint32Array(1))[0]:a[o++]=r%1e7;else if(crypto.randomBytes){for(i=crypto.randomBytes(t*=4);o<t;)r=i[o]+(i[o+1]<<8)+(i[o+2]<<16)+((i[o+3]&127)<<24),r>=214e7?crypto.randomBytes(4).copy(i,o):(a.push(r%1e7),o+=4);o=t/4}else throw Error(Ir);else for(;o<t;)a[o++]=Math.random()*1e7|0;for(t=a[--o],n%=E,t&&n&&(r=K(10,E-n),a[o]=(t/r|0)*r);a[o]===0;o--)a.pop();if(o<0)e=0,a=[0];else{for(e=-1;a[0]===0;e-=E)a.shift();for(t=1,r=a[0];r>=10;r/=10)t++;t<E&&(e-=E-t)}return s.e=e,s.d=a,s}function Xo(n){return x(n=new this(n),n.e+1,this.rounding)}function Qo(n){return n=new this(n),n.d?n.d[0]?n.s:0*n.s:n.s||NaN}function es(n){return new this(n).sin()}function ts(n){return new this(n).sinh()}function is(n){return new this(n).sqrt()}function ns(n,i){return new this(n).sub(i)}function rs(){var n=0,i=arguments,e=new this(i[n]);for(P=!1;e.s&&++n<i.length;)e=e.plus(i[n]);return P=!0,x(e,this.precision,this.rounding)}function os(n){return new this(n).tan()}function ss(n){return new this(n).tanh()}function as(n){return x(n=new this(n),n.e+1,1)}_[Symbol.for("nodejs.util.inspect.custom")]=_.toString;_[Symbol.toStringTag]="Decimal";var xt=_.constructor=Vr(zi);mi=new xt(mi);hi=new xt(hi);var Et=xt;var Or=500,Nr=.01,jr=(()=>{class n{set value(e){this.viewValue=e}constructor(e){this.cdr=e,this.valueChange=new J,this.viewValue=null,this.processing=!1}onChange(){this.hasViewValue()||this.valueChange.emit(null),Number(this.viewValue)>10&&(this.viewValue=10),this.valueChange.emit(this.viewValue)}onTextKeyDown(e){if(!["ArrowLeft","ArrowRight","ArrowUp","ArrowDown","ArrowUp","Backspace","Delete"].includes(e.key)){if(e.key==="."){(!this.hasViewValue()||String(this.viewValue).indexOf(".")>=0)&&e.preventDefault();return}/[0-9]/.test(e.key)||e.preventDefault()}}onSelectText(e){e.target?.select()}onIncrementMouseDown(){this.processing=!0,setTimeout(()=>this.autoIncrement(),Or)}onDecrementMouseDown(){this.processing=!0,setTimeout(()=>this.autoDecrement(),Or)}onIncrementClick(){this.processing=!1,this.increment()}onDecrementClick(){this.processing=!1,this.decrement()}onStop(){this.processing&&(this.processing=!1)}autoIncrement(){ct(100).pipe(Ei(()=>this.processing)).subscribe(()=>{this.processing&&this.increment()})}autoDecrement(){ct(100).pipe(Ei(()=>this.processing)).subscribe(()=>{this.processing&&this.decrement()})}increment(){let e=this.viewValue?new Et(this.viewValue):new Et(0);e=e.plus(Nr),e.greaterThan(10)?this.viewValue=10:this.viewValue=Number(e.toFixed(3)),this.cdr.detectChanges(),this.processing||this.onChange()}decrement(){let e=this.viewValue?new Et(this.viewValue):new Et(0);e=e.minus(Nr),e.lessThan(0)?this.viewValue=0:this.viewValue=Number(e.toFixed(3)),this.cdr.detectChanges(),this.processing||this.onChange()}hasViewValue(){return![null,"",void 0].includes(this.viewValue)}static{this.\u0275fac=function(t){return new(t||n)(T($e))}}static{this.\u0275cmp=N({type:n,selectors:[["sc-inline-number-input"]],inputs:{value:"value"},outputs:{valueChange:"valueChange"},decls:7,vars:1,consts:[["mat-icon-button","","color","primary",3,"mousedown","mouseup","mouseout","click"],["type","number","min","0","max","10","step","0.1",1,"input",3,"ngModelChange","keydown","focus","ngModel"]],template:function(t,r){t&1&&(d(0,"button",0),g("mousedown",function(){return r.onDecrementMouseDown()})("mouseup",function(){return r.onStop()})("mouseout",function(){return r.onStop()})("click",function(){return r.onDecrementClick()}),d(1,"mat-icon"),v(2,"remove_circle_outline"),m()(),d(3,"input",1),We("ngModelChange",function(s){return Ze(r.viewValue,s)||(r.viewValue=s),s}),g("keydown",function(s){return r.onTextKeyDown(s)})("focus",function(s){return r.onSelectText(s)})("ngModelChange",function(){return r.onChange()}),m(),d(4,"button",0),g("mousedown",function(){return r.onIncrementMouseDown()})("mouseup",function(){return r.onStop()})("mouseout",function(){return r.onStop()})("click",function(){return r.onIncrementClick()}),d(5,"mat-icon"),v(6,"add_circle_outline"),m()()),t&2&&(f(3),qe("ngModel",r.viewValue))},dependencies:[z,G,X,Z,q,Gt,Mn,Ln,Ht,On,Vn,zt],styles:["[_nghost-%COMP%]{display:flex;align-items:center}.input[_ngcontent-%COMP%]{border:none;text-align:center;font-size:16px;width:40px;outline:none;background:transparent;appearance:textfield;-webkit-appearance:none;-moz-appearance:textfield}"],changeDetection:0})}}return n})();var Br=(n,i)=>i.id;function cs(n,i){if(n&1&&(d(0,"option",5),v(1),m()),n&2){let e=i.$implicit;y("value",e.id),f(),ke(e.name)}}function us(n,i){n&1&&(d(0,"mat-icon",8),v(1," task_alt "),m())}function ds(n,i){n&1&&(d(0,"mat-icon",9),v(1," block_flipped "),m())}function ps(n,i){if(n&1){let e=V();d(0,"div",15)(1,"div",17),v(2),m(),d(3,"sc-inline-number-input",11),We("valueChange",function(r){let o=S(e).$implicit;return Ze(o.speed,r)||(o.speed=r),w(r)}),g("valueChange",function(){S(e);let r=C(2);return w(r.onChangeFrame())}),m()()}if(n&2){let e=i.$implicit;f(2),ke(e.name),f(),qe("value",e.speed)}}function ms(n,i){n&1&&(d(0,"div",16),v(1,"\u041D\u0435\u0442 \u0444\u0440\u0435\u0439\u043C\u043E\u0432"),m())}function hs(n,i){if(n&1&&(d(0,"div",14),me(1,ps,4,2,"div",15,Br,!1,ms,2,0,"div",16),m()),n&2){let e=C();f(),he(e.layerInfo().frames)}}var $r=(()=>{class n{constructor(){this.layersList=[],this.layerChangeEvent=new J,this.layerRemoveEvent=new J,this.visibleFrames=ge(!1),this.layerInfo=ge({layerId:null,loop:!1,speed:1,frames:[]})}set layer(e){this.layerInfo.set(e)}get layerId(){return this.layerInfo().layerId}set layerId(e){this.layerInfo.update(t=>{let r=this.layersList.find(o=>o.id===Number(e));return Ie(Q({},t),{layerId:e!==null?Number(e):null,frames:(r?.frames||[]).map(o=>({id:o.id,name:o.name,speed:null}))})}),this.layerChangeEvent.emit(this.layerInfo())}get speed(){return this.layerInfo().speed}set speed(e){this.layerInfo.update(t=>Ie(Q({},t),{speed:e})),this.layerChangeEvent.emit(this.layerInfo())}onChangeFrame(){this.layerChangeEvent.emit(this.layerInfo())}toggleVisibleFrames(){this.visibleFrames.update(e=>!e)}onRemove(){this.layerRemoveEvent.emit()}onToggleLoop(){this.layerInfo.update(e=>Ie(Q({},e),{loop:!e.loop})),this.layerChangeEvent.emit(this.layerInfo())}static{this.\u0275fac=function(t){return new(t||n)}}static{this.\u0275cmp=N({type:n,selectors:[["sc-animation-layer-item"]],inputs:{layer:"layer",layersList:"layersList"},outputs:{layerChangeEvent:"layerChangeEvent",layerRemoveEvent:"layerRemoveEvent"},decls:21,vars:6,consts:[[1,"layer"],[1,"layer-title"],["mat-icon-button","","color","primary","title","\u041F\u043E\u043A\u0430\u0437\u0430\u0442\u044C/\u0441\u043A\u0440\u044B\u0442\u044C \u0444\u0440\u0435\u0439\u043C\u044B",3,"click","disabled"],[1,"ml-10","select",3,"ngModelChange","ngModel"],["disabled","",3,"value"],[3,"value"],[1,"layer-loop"],["mat-icon-button","",3,"click"],["color","success"],["color","accent"],[1,"layer-speed"],[3,"valueChange","value"],[1,"layer-button"],["mat-icon-button","","color","accent","title","\u0423\u0434\u0430\u043B\u0438\u0442\u044C \u0441\u043B\u043E\u0439",3,"click"],[1,"flex-col"],[1,"frame-item"],[1,"empty-message"],[1,"flex-auto"]],template:function(t,r){t&1&&(d(0,"div",0)(1,"div",1)(2,"button",2),g("click",function(){return r.toggleVisibleFrames()}),d(3,"mat-icon"),v(4,"lists"),m()(),d(5,"select",3),We("ngModelChange",function(s){return Ze(r.layerId,s)||(r.layerId=s),s}),d(6,"option",4),v(7,"--- \u0412\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u0441\u043B\u043E\u0439 ---"),m(),me(8,cs,2,2,"option",5,Br),m()(),d(10,"div",6)(11,"button",7),g("click",function(){return r.onToggleLoop()}),I(12,us,2,0,"mat-icon",8)(13,ds,2,0,"mat-icon",9),m()(),d(14,"div",10)(15,"sc-inline-number-input",11),We("valueChange",function(s){return Ze(r.speed,s)||(r.speed=s),s}),m()(),d(16,"div",12)(17,"button",13),g("click",function(){return r.onRemove()}),d(18,"mat-icon"),v(19,"highlight_off"),m()()()(),I(20,hs,4,1,"div",14)),t&2&&(f(2),y("disabled",!r.layerInfo().layerId),f(3),qe("ngModel",r.layerId),f(),y("value",null),f(2),he(r.layersList),f(4),k(r.layerInfo().loop?12:13),f(3),qe("value",r.speed),f(5),k(r.visibleFrames()?20:-1))},dependencies:[z,G,X,Z,q,Gt,Fn,An,Rn,Ht,zt,jr],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column}.layer[_ngcontent-%COMP%]{display:flex;align-items:center}.layer-title[_ngcontent-%COMP%]{flex:auto;display:flex;align-items:center}.layer-loop[_ngcontent-%COMP%]{width:150px;text-align:center}.layer-speed[_ngcontent-%COMP%]{display:flex;align-items:center;width:150px;justify-content:center}.layer-button[_ngcontent-%COMP%]{width:32px}.select[_ngcontent-%COMP%]{flex:auto;background:transparent;border:none;outline:none;font-size:16px;padding:0;text-align:center}.frame-item[_ngcontent-%COMP%]{display:flex;align-items:center;padding:0 56px 0 28px}"],changeDetection:0})}}return n})();function _s(n,i){if(n&1){let e=V();d(0,"sc-animation-layer-item",11),g("layerChangeEvent",function(r){let o=S(e).$index,s=C(3);return w(s.onLayerChange(o,r))})("layerRemoveEvent",function(){let r=S(e).$index,o=C(3);return w(o.onLayerRemove(r))}),m()}if(n&2){let e=i.$implicit,t=C(3);y("layer",e)("layersList",t.layersList)}}function fs(n,i){if(n&1&&(d(0,"div",8),me(1,_s,1,2,"sc-animation-layer-item",10,an),m()),n&2){let e=C();f(),he(e)}}function gs(n,i){n&1&&(d(0,"div",9),v(1,"\u041D\u0435\u0442 \u0434\u0430\u043D\u043D\u044B\u0445"),m())}function Cs(n,i){n&1&&I(0,fs,3,0,"div",8)(1,gs,2,0,"div",9),n&2&&k(i.length>0?0:1)}var Hr=(()=>{class n{constructor(e){this.animationStore=e,this.layersList=[],this.layers$=this.animationStore.layers$}onLayerRemove(e){this.animationStore.removeLayer(e)}onLayerChange(e,t){this.animationStore.updateLayer({idx:e,layer:t})}onAddLayer(){this.animationStore.addLayer()}static{this.\u0275fac=function(t){return new(t||n)(T(we))}}static{this.\u0275cmp=N({type:n,selectors:[["sc-animation-layers"]],inputs:{layersList:"layersList"},decls:15,vars:3,consts:[[1,"flex-auto","flex-col"],[1,"header"],[1,"header-title","flex-auto"],[1,"header-title","header-loop"],[1,"header-title","header-speed"],[1,"header-title","header-button"],["mat-icon-button","","color","primary","title","\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C \u0441\u043B\u043E\u0439",3,"click"],[1,"scroll-container","flex-col"],[1,"scroll"],[1,"empty-message"],[3,"layer","layersList"],[3,"layerChangeEvent","layerRemoveEvent","layer","layersList"]],template:function(t,r){if(t&1&&(d(0,"fieldset",0)(1,"div",1)(2,"div",2),v(3,"\u0421\u043B\u043E\u0439"),m(),d(4,"div",3),v(5,"\u0426\u0438\u043A\u043B\u0438\u0447\u043D\u043E\u0441\u0442\u044C"),m(),d(6,"div",4),v(7,"\u0421\u043A\u043E\u0440\u043E\u0441\u0442\u044C"),m(),d(8,"div",5)(9,"button",6),g("click",function(){return r.onAddLayer()}),d(10,"mat-icon"),v(11,"add"),m()()()(),d(12,"div",7),I(13,Cs,2,1),L(14,"async"),m()()),t&2){let o;f(13),k((o=R(14,1,r.layers$))?13:-1,o)}},dependencies:[z,Y,G,X,Z,q,$r],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column}.header[_ngcontent-%COMP%]{display:flex;align-items:center;padding-right:5px}.header-title[_ngcontent-%COMP%]{text-align:center;font-weight:700}.header-loop[_ngcontent-%COMP%], .header-speed[_ngcontent-%COMP%]{width:150px}.header-button[_ngcontent-%COMP%]{width:32px}"],changeDetection:0})}}return n})();function vs(n,i){if(n&1){let e=V();d(0,"fieldset",0)(1,"jst-input",1),g("valueChange",function(r){S(e);let o=C();return w(o.onChangeAnimation("name",r))}),m(),d(2,"jst-checkbox",2),g("valueChange",function(r){S(e);let o=C();return w(o.onChangeAnimation("default",r))}),m()(),d(3,"fieldset",3)(4,"legend"),v(5,"\u0422\u043E\u0447\u043A\u0430 \u0441\u043E\u043F\u0440\u0438\u043A\u043E\u0441\u043D\u043E\u0432\u0435\u043D\u0438\u044F \u0441 \u0437\u0435\u043C\u043B\u0435\u0439"),m(),d(6,"div",4)(7,"div",5)(8,"jst-touchspin",6),g("valueChange",function(r){S(e);let o=C();return w(o.onChangeGroundPoint("x",r))}),m()(),d(9,"div",7)(10,"jst-touchspin",8),g("valueChange",function(r){S(e);let o=C();return w(o.onChangeGroundPoint("y",r))}),m()()(),d(11,"jst-checkbox",9),g("valueChange",function(r){S(e);let o=C();return w(o.onChangeAnimation("visibleGround",r))}),m()(),d(12,"fieldset",3)(13,"legend"),v(14,"\u0420\u0430\u043C\u043A\u0430 \u043A\u043E\u043B\u043B\u0438\u0437\u0438\u0439"),m(),d(15,"div",4)(16,"div",5)(17,"jst-touchspin",6),g("valueChange",function(r){S(e);let o=C();return w(o.onChangeCollisionFrame("x",r))}),m()(),d(18,"div",7)(19,"jst-touchspin",8),g("valueChange",function(r){S(e);let o=C();return w(o.onChangeCollisionFrame("y",r))}),m()()(),d(20,"div",10)(21,"div",5)(22,"jst-touchspin",11),g("valueChange",function(r){S(e);let o=C();return w(o.onChangeCollisionFrame("width",r))}),m()(),d(23,"div",7)(24,"jst-touchspin",12),g("valueChange",function(r){S(e);let o=C();return w(o.onChangeCollisionFrame("height",r))}),m()()(),d(25,"jst-checkbox",13),g("valueChange",function(r){S(e);let o=C();return w(o.onChangeAnimation("visibleCollision",r))}),m()()}if(n&2){let e=i;f(),y("controlRequred",!0)("value",e.name),f(),y("value",e.default),f(6),y("permanentValueChange",!1)("value",e.groundPoint==null?null:e.groundPoint.x),f(2),y("permanentValueChange",!1)("value",e.groundPoint==null?null:e.groundPoint.y),f(),y("value",e.visibleGround),f(6),y("permanentValueChange",!1)("value",e.collisionFrame==null?null:e.collisionFrame.x),f(2),y("permanentValueChange",!1)("value",e.collisionFrame==null?null:e.collisionFrame.y),f(3),y("permanentValueChange",!1)("value",e.collisionFrame==null?null:e.collisionFrame.width),f(2),y("permanentValueChange",!1)("value",e.collisionFrame==null?null:e.collisionFrame.height),f(),y("value",e.visibleCollision)}}var zr=(()=>{class n{constructor(e){this.animationStore=e,this.animation$=this.animationStore.animation$}onChangeCollisionFrame(e,t){this.animationStore.updateCollisionFrame({[e]:t})}onChangeGroundPoint(e,t){this.animationStore.updateGroundPoint({[e]:t})}onChangeAnimation(e,t){this.animationStore.updateAnimation({[e]:t})}static{this.\u0275fac=function(t){return new(t||n)(T(we))}}static{this.\u0275cmp=N({type:n,selectors:[["sc-animation-params"]],decls:2,vars:3,consts:[[1,"pt-10"],["label","\u041D\u0430\u0438\u043C\u0435\u043D\u043E\u0432\u0430\u043D\u0438\u0435 \u0430\u043D\u0438\u043C\u0430\u0446\u0438\u0438",3,"valueChange","controlRequred","value"],["label","\u0410\u043D\u0438\u043C\u0430\u0446\u0438\u044F \u043F\u043E \u0443\u043C\u043E\u043B\u0447\u0430\u043D\u0438\u044E","mode","SLIDER-LEFT",3,"valueChange","value"],[1,"mt-20","pt-10"],[1,"flex-row"],[1,"coords-container","mat-without-hint"],["label","X",3,"valueChange","permanentValueChange","value"],[1,"ml-10","coords-container","mat-without-hint"],["label","Y",3,"valueChange","permanentValueChange","value"],["label","\u0421\u043A\u0440\u044B\u0442\u044C/\u043F\u043E\u043A\u0430\u0437\u0430\u0442\u044C \u0442\u043E\u0447\u043A\u0443","mode","SLIDER-LEFT",1,"mt-10",3,"valueChange","value"],[1,"mt-10","flex-row"],["label","\u0428\u0438\u0440\u0438\u043D\u0430",3,"valueChange","permanentValueChange","value"],["label","\u0412\u044B\u0441\u043E\u0442\u0430",3,"valueChange","permanentValueChange","value"],["label","\u0421\u043A\u0440\u044B\u0442\u044C/\u043F\u043E\u043A\u0430\u0437\u0430\u0442\u044C \u0440\u0430\u043C\u043A\u0443","mode","SLIDER-LEFT",1,"mt-10",3,"valueChange","value"]],template:function(t,r){if(t&1&&(I(0,vs,26,17),L(1,"async")),t&2){let o;k((o=R(1,1,r.animation$))?0:-1,o)}},dependencies:[z,Y,Gn,zn,Xt,Yt,Kt,Jt],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column}.coords-container[_ngcontent-%COMP%]{width:135px}.mt-20[_ngcontent-%COMP%]{margin-top:20px}"],changeDetection:0})}}return n})();var Ss=["pixiContainer"],Gr=(()=>{class n{constructor(e,t,r){this.cdr=e,this.framesCacheService=t,this.animationStore=r,this.sprite=null,this.layersList=[],this.appPixi=new jt,this.spriteContainer=new Bt(this.framesCacheService),this.destroyRef$=A(kt),this.appPixi.onZoomDone=()=>this.centeredSpriteContainer()}get isPlaying(){return this.spriteContainer?.playing??!1}ngAfterViewInit(){this.initializePixi()}ngOnDestroy(){this.appPixi.destroy()}onPlay(e){this.spriteContainer&&(this.spriteContainer.play=e)}onZoom(e){this.appPixi.setZoom(e,!1)}initializePixi(){this.appPixi.useScale=!0,this.appPixi.initialize(this.pixiContainerRef.nativeElement).then(()=>{this.sprite&&(this.spriteContainer.initSprite(this.sprite,0,!1),this.spriteContainer.setLayers(this.layersList),this.centeredSpriteContainer(),this.appPixi.attachScaleContainer(this.spriteContainer)),this.initializeSubscriptions()})}initializeSubscriptions(){this.animationStore.animation$.pipe(ee(this.destroyRef$)).subscribe(e=>{this.updateSprite(e),this.cdr.markForCheck()})}updateSprite(e){e.visibleGround&&e.groundPoint?this.spriteContainer.drawSpriteGround(e.groundPoint):this.spriteContainer.drawSpriteGround(null),e.visibleCollision&&e.collisionFrame?this.spriteContainer.drawSpriteCollisionRect(e.collisionFrame):this.spriteContainer.drawSpriteCollisionRect(null),this.spriteContainer.updateSpriteLayers(e.layers.filter(t=>t.layerId))}centeredSpriteContainer(){this.spriteContainer.x=(this.appPixi.screenWidth-this.spriteContainer.width)/2,this.spriteContainer.y=(this.appPixi.screenHeight-this.spriteContainer.height)/2}static{this.\u0275fac=function(t){return new(t||n)(T($e),T($t),T(we))}}static{this.\u0275cmp=N({type:n,selectors:[["sc-animation-preview"]],viewQuery:function(t,r){if(t&1&&Lt(Ss,5),t&2){let o;Rt(o=Ft())&&(r.pixiContainerRef=o.first)}},inputs:{sprite:"sprite",layersList:"layersList"},decls:12,vars:2,consts:[["pixiContainer",""],[1,"flex-auto","p-relative"],[1,"buttons-container"],["buttonColor","primary",3,"zoomEvent"],[1,"divider"],["mat-icon-button","","color","primary","title","\u041F\u0440\u043E\u0438\u0433\u0440\u0430\u0442\u044C \u0430\u043D\u0438\u043C\u0430\u0446\u0438\u044E",3,"click","disabled"],["mat-icon-button","","color","primary","title","\u041E\u0441\u0442\u0430\u043D\u043E\u0432\u0438\u0442\u044C \u0430\u043D\u0438\u043C\u0430\u0446\u0438\u044E",3,"click","disabled"],[1,"pixi-container"]],template:function(t,r){if(t&1){let o=V();d(0,"fieldset",1)(1,"div",2)(2,"smc-scale-buttons",3),g("zoomEvent",function(a){return S(o),w(r.onZoom(a))}),m(),U(3,"div",4),d(4,"button",5),g("click",function(){return S(o),w(r.onPlay(!0))}),d(5,"mat-icon"),v(6,"play_circle_outline"),m()(),d(7,"button",6),g("click",function(){return S(o),w(r.onPlay(!1))}),d(8,"mat-icon"),v(9,"stop"),m()()(),U(10,"div",7,0),m()}t&2&&(f(4),y("disabled",r.isPlaying),f(3),y("disabled",!r.isPlaying))},dependencies:[G,X,Z,q,ei],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;height:250px}.buttons-container[_ngcontent-%COMP%]{display:flex;align-items:center;position:absolute;right:5px;top:5px;z-index:1;border-radius:6px;background-color:#0003}.buttons-container[_ngcontent-%COMP%]   .divider[_ngcontent-%COMP%]{width:2px;background-color:#ffffff80;height:27px;margin:0 5px;-webkit-user-select:none;user-select:none}.pixi-container[_ngcontent-%COMP%]{position:absolute;inset:5px;z-index:0;overflow:hidden;height:240px}"],changeDetection:0})}}return n})();var Ur=(()=>{class n{constructor(e){this.animationStore=e,this.applyTile="\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C \u0430\u043D\u0438\u043C\u0430\u0446\u0438\u044E",this.layersList=[],this.sprite=null,this.canSave=!1,this.animationStore.animation$.pipe(ee()).subscribe(t=>{this.canSave=!!t.name})}setData(e){this.sprite=e.sprite??null,this.layersList=e.layersList||[],setTimeout(()=>{e.animation&&(this.applyTile="\u0421\u043E\u0445\u0440\u0430\u043D\u0438\u0442\u044C \u0430\u043D\u0438\u043C\u0430\u0446\u0438\u044E",this.animationStore.initialize(e.animation))},100)}onApply(){this.canSave&&this.sprite&&this.animationStore.saveAnimation(this.sprite.projectId,this.sprite.id).subscribe(e=>{e!==null&&this.dialogRef?.close({reload:!0})})}onClose(){this.dialogRef?.close()}static{this.\u0275fac=function(t){return new(t||n)(T(we))}}static{this.\u0275cmp=N({type:n,selectors:[["sc-animation-edit-modal"]],features:[Be([we])],decls:11,vars:4,consts:[[1,"jst-modal-container"],[1,"content"],[1,"ml-10","flex-auto","flex-col"],[1,"flex-auto",3,"layersList"],[1,"mt-10",3,"sprite","layersList"],[1,"jst-modal-footer-buttons"],["mat-raised-button","","color","primary",3,"click"],["mat-raised-button","","color","accent",3,"click"]],template:function(t,r){t&1&&(d(0,"div",0)(1,"div",1),U(2,"sc-animation-params"),d(3,"div",2),U(4,"sc-animation-layers",3)(5,"sc-animation-preview",4),m()()(),d(6,"div",5)(7,"button",6),g("click",function(){return r.onApply()}),v(8),m(),d(9,"button",7),g("click",function(){return r.onClose()}),v(10,"\u0417\u0430\u043A\u0440\u044B\u0442\u044C"),m()()),t&2&&(f(4),y("layersList",r.layersList),f(),y("sprite",r.sprite)("layersList",r.layersList),f(3),ke(r.applyTile))},dependencies:[z,G,Ce,zr,Hr,Gr],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;width:1280px;height:80vh}.content[_ngcontent-%COMP%]{flex:auto;display:flex;padding:10px}"]})}}return n})();var ws=(n,i)=>i.id;function ys(n,i){if(n&1){let e=V();d(0,"button",14),g("click",function(){S(e);let r=C(2).$implicit,o=C(3);return w(o.onSetAnimationPlaying(r,!1))}),d(1,"mat-icon"),v(2,"stop"),m()()}}function bs(n,i){if(n&1){let e=V();d(0,"button",15),g("click",function(){S(e);let r=C(2).$implicit,o=C(3);return w(o.onSetAnimationPlaying(r,!0))}),d(1,"mat-icon"),v(2,"play_arrow"),m()()}}function xs(n,i){if(n&1&&I(0,ys,3,0,"button",12)(1,bs,3,0,"button",13),n&2){let e=C().$implicit;C(3);let t=je(3);k(t&&t.id===e.id&&(t!=null&&t.playing)?0:1)}}function Es(n,i){if(n&1){let e=V();d(0,"div",6)(1,"div",7),L(2,"async"),I(3,xs,2,1),L(4,"async"),d(5,"div",8),g("click",function(){let r=S(e).$implicit,o=C(3);return w(o.onSelectAnimation(r))})("dblclick",function(r){let o=S(e).$implicit,s=C(3);return w(s.onEditAnimation(r,o))}),d(6,"span",9),v(7),m()(),d(8,"button",10),g("click",function(r){let o=S(e).$implicit,s=C(3);return w(s.onEditAnimation(r,o))}),d(9,"mat-icon"),v(10,"edit"),m()(),d(11,"button",11),g("click",function(r){let o=S(e).$implicit,s=C(3);return w(s.onRemoveAnimation(r,o))}),d(12,"mat-icon"),v(13,"highlight_off"),m()()()()}if(n&2){let e,t=i.$implicit,r=C(3);f(),le("selected",((e=R(2,8,r.currentAnimation$))==null?null:e.id)===t.id),f(2),k(R(4,10,r.spriteEditState$)==="animations"?3:-1),f(3),le("text-bold",t.default),un("matTooltip",t.default?"\u0410\u043D\u0438\u043C\u0430\u0446\u0438\u044F \u043F\u043E \u0443\u043C\u043E\u043B\u0447\u0430\u043D\u0438\u044E":""),f(),At(" (",t.id,") ",t.name," ")}}function Ds(n,i){if(n&1&&(d(0,"div",2)(1,"div",4)(2,"div",5),me(3,Es,14,12,"div",6,ws),m()()()),n&2){let e=C();f(2),y("cdkDropListData",e),f(),he(e)}}function Ps(n,i){n&1&&(d(0,"div",3),v(1,"\u041D\u0435\u0442 \u0434\u0430\u043D\u043D\u044B\u0445"),m())}function Is(n,i){n&1&&I(0,Ds,5,1,"div",2)(1,Ps,2,0,"div",3),n&2&&k(i.length>0?0:1)}var qr=(()=>{class n{constructor(e,t){this.jstDialogService=e,this.spriteStore=t,this.animations$=this.spriteStore.animations$,this.spriteEditState$=this.spriteStore.spriteEditState$,this.animationPlaying$=this.spriteStore.animationPlaying$,this.currentAnimation$=this.spriteStore.currentAnimation$}onSetAnimationPlaying(e,t){this.onSelectAnimation(e),this.spriteStore.setAnimationPlaying({id:e.id,playing:t})}onEditAnimation(e,t){e.stopPropagation(),ne.blurActiveElement(),this.editAnimation(t)}onRemoveAnimation(e,t){e.stopPropagation(),ne.blurActiveElement(),this.jstDialogService.showConfirm("\u0412\u044B \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0442\u0435\u043B\u044C\u043D\u043E \u0445\u043E\u0442\u0438\u0442\u0435 \u0443\u0434\u0430\u043B\u0438\u0442\u044C \u0430\u043D\u0438\u043C\u0430\u0446\u0438\u044E?").subscribe(r=>{r&&this.spriteStore.removeAnimation(t.id)})}onSelectAnimation(e){this.spriteEditState$.pipe(xe(1)).subscribe(t=>{t==="animations"&&this.spriteStore.setCurrentAnimation(e)})}onAddAnimation(){ne.blurActiveElement(),this.editAnimation()}editAnimation(e=null){Ge([this.spriteStore.sprite$,this.spriteStore.layers$]).pipe(xe(1)).subscribe(([t,r])=>{let o=e?"\u0420\u0435\u0434\u0430\u043A\u0442\u0438\u0440\u043E\u0432\u0430\u043D\u0438\u0435 \u0430\u043D\u0438\u043C\u0430\u0446\u0438\u0438":"\u0414\u043E\u0431\u0430\u0432\u043B\u0435\u043D\u0438\u0435 \u0430\u043D\u0438\u043C\u0430\u0446\u0438\u0438";this.jstDialogService.showModal(o,Ur,{layersList:r,sprite:t,animation:e},!1).subscribe(s=>{s?.reload&&this.spriteStore.updateAnimations()})})}static{this.\u0275fac=function(t){return new(t||n)(T(ve),T(re))}}static{this.\u0275cmp=N({type:n,selectors:[["sc-sprite-animations"]],inputs:{projectId:"projectId"},decls:7,vars:6,consts:[[1,"flex-row-align-center","border-bottom","pl-5","pr-5"],["mat-button","","color","primary",1,"flex-auto",3,"click"],[1,"scroll-container","mt-10"],[1,"empty-message"],[1,"scroll"],["cdkDropList","",1,"animation-list",3,"cdkDropListData"],["cdkDrag","",1,"animation-item"],[1,"animation-item-line"],[1,"animation-title",3,"click","dblclick"],[3,"matTooltip"],["mat-icon-button","","color","primary","title","\u0420\u0435\u0434\u0430\u043A\u0442\u0438\u0440\u043E\u0432\u0430\u0442\u044C \u0430\u043D\u0438\u043C\u0430\u0446\u0438\u044E","tabindex","-1",3,"click"],["mat-icon-button","","color","accent","title","\u0423\u0434\u0430\u043B\u0438\u0442\u044C \u0430\u043D\u0438\u043C\u0430\u0446\u0438\u044E","tabindex","-1",3,"click"],["mat-icon-button","","color","primary","title","\u041E\u0441\u0442\u0430\u043D\u043E\u0432\u0438\u0442\u044C \u0430\u043D\u0438\u043C\u0430\u0446\u0438\u044E","tabindex","-1",1,"ml-10"],["mat-icon-button","","color","primary","title","\u0417\u0430\u043F\u0443\u0441\u0442\u0438\u0442\u044C \u0430\u043D\u0438\u043C\u0430\u0446\u0438\u044E","tabindex","-1",1,"ml-10"],["mat-icon-button","","color","primary","title","\u041E\u0441\u0442\u0430\u043D\u043E\u0432\u0438\u0442\u044C \u0430\u043D\u0438\u043C\u0430\u0446\u0438\u044E","tabindex","-1",1,"ml-10",3,"click"],["mat-icon-button","","color","primary","title","\u0417\u0430\u043F\u0443\u0441\u0442\u0438\u0442\u044C \u0430\u043D\u0438\u043C\u0430\u0446\u0438\u044E","tabindex","-1",1,"ml-10",3,"click"]],template:function(t,r){if(t&1){let o=V();d(0,"div",0)(1,"button",1),g("click",function(){return S(o),w(r.onAddAnimation())}),v(2,"\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C \u0430\u043D\u0438\u043C\u0430\u0446\u0438\u044E"),m()(),Je(3),L(4,"async"),I(5,Is,2,1),L(6,"async")}if(t&2){let o;f(3),ht(R(4,1,r.animationPlaying$)),f(2),k((o=R(6,4,r.animations$))?5:-1,o)}},dependencies:[z,Y,G,Ce,X,Z,q,Ke,Hn,$n,it,tt,et],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;width:320px}.animation-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;-webkit-user-select:none;user-select:none}.animation-list[_ngcontent-%COMP%]   .animation-item[_ngcontent-%COMP%]   .mat-mdc-icon-button[_ngcontent-%COMP%]{width:24px;height:24px;line-height:20px}.animation-list[_ngcontent-%COMP%]   .animation-item[_ngcontent-%COMP%]   .mat-mdc-icon-button[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{line-height:18px;height:18px;width:18px;font-size:16px}.animation-list[_ngcontent-%COMP%]   .animation-item[_ngcontent-%COMP%]   .animation-item-line[_ngcontent-%COMP%]{display:flex;align-items:center}.animation-list[_ngcontent-%COMP%]   .animation-item[_ngcontent-%COMP%]   .animation-item-line[_ngcontent-%COMP%]:hover{background-color:#e6effc}.animation-list[_ngcontent-%COMP%]   .animation-item[_ngcontent-%COMP%]   .animation-item-line.selected[_ngcontent-%COMP%]{background-color:#0275d8;color:#fff}.animation-list[_ngcontent-%COMP%]   .animation-item[_ngcontent-%COMP%]   .animation-item-line.selected[_ngcontent-%COMP%]   .mat-mdc-icon-button[_ngcontent-%COMP%]{color:#fff!important}.animation-list[_ngcontent-%COMP%]   .animation-item[_ngcontent-%COMP%]   .animation-item-line[_ngcontent-%COMP%]   .animation-title[_ngcontent-%COMP%]{flex:auto;padding-left:10px}.animation-list.cdk-drop-list-dragging[_ngcontent-%COMP%]   .animation-item[_ngcontent-%COMP%]:not(.cdk-drag-placeholder){transition:transform .25s cubic-bezier(0,0,.2,1)}.animation-item.cdk-drag-preview[_ngcontent-%COMP%]   .animation-item-line[_ngcontent-%COMP%]{display:flex}.animation-item.cdk-drag-preview[_ngcontent-%COMP%]   .animation-item-line[_ngcontent-%COMP%]   .animation-title[_ngcontent-%COMP%]{flex:auto}"],changeDetection:0})}}return n})();var He=class{static getLayerSerialNumer(i){let e=i.map(t=>{let r=t.name.match(/Layer (\d+)/i);return r&&r[1]?Number(r[1]):null}).filter(t=>t);return e.push(0),Math.max(...e)+1}static getFrameSerialNumer(i){let e=i.map(t=>{let r=t.name.match(/Frame (\d+)/i);return r&&r[1]?Number(r[1]):null}).filter(t=>t);return e.push(0),Math.max(...e)+1}};function Ts(n,i){n&1&&(d(0,"mat-icon",5),v(1,"visibility"),m())}function ks(n,i){n&1&&(d(0,"mat-icon"),v(1,"visibility_off"),m())}var Zr=(()=>{class n{constructor(e,t){this.jstDialogService=e,this.spriteStore=t,this.visible=!0,this.currentFrame$=this.spriteStore.currentFrame$}onSelect(){this.spriteStore.selectFrameById(this.frame.id)}onToggleVisible(e){e.stopPropagation(),ne.blurActiveElement(),this.spriteStore.updateFrame({id:this.frame.id,layerId:this.frame.layerId,frame:{visible:!this.frame.visible}})}onRemoveFrame(e){e.stopPropagation(),ne.blurActiveElement(),this.jstDialogService.showConfirm("\u0412\u044B \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0442\u0435\u043B\u044C\u043D\u043E \u0445\u043E\u0442\u0438\u0442\u0435 \u0443\u0434\u0430\u043B\u0438\u0442\u044C \u044D\u0442\u043E\u0442 \u0444\u0440\u0435\u0439\u043C?","\u0423\u0434\u0430\u043B\u0435\u043D\u0438\u0435 \u0444\u0440\u0435\u0439\u043C\u0430","\u0423\u0434\u0430\u043B\u0438\u0442\u044C \u0444\u0440\u0435\u0439\u043C").subscribe(t=>{t&&this.spriteStore.removeFrame({id:this.frame.id,layerId:this.frame.layerId})})}onEditName(e){e.stopPropagation(),ne.blurActiveElement(),this.jstDialogService.showModal("\u0418\u0437\u043C\u0435\u043D\u0438\u0442\u044C \u043D\u0430\u0438\u043C\u0435\u043D\u043E\u0432\u0430\u043D\u0438\u0435 \u0444\u0440\u0435\u0439\u043C\u0430",Ee,{label:"\u041D\u0430\u0438\u043C\u0435\u043D\u043E\u0432\u0430\u043D\u0438\u0435 \u0444\u0440\u0435\u0439\u043C\u0430",applyTitle:"\u0418\u0437\u043C\u0435\u043D\u0438\u0442\u044C \u043D\u0430\u0438\u043C\u0435\u043D\u043E\u0432\u0430\u043D\u0438\u0435",value:this.frame.name}).subscribe(t=>{t!==void 0&&this.spriteStore.updateFrame({id:this.frame.id,layerId:this.frame.layerId,frame:{name:t}})})}static{this.\u0275fac=function(t){return new(t||n)(T(ve),T(re))}}static{this.\u0275cmp=N({type:n,selectors:[["sc-sprite-layer-item-frame"]],inputs:{frame:"frame",name:"name",visible:"visible"},decls:13,vars:6,consts:[[1,"item","mat-small-button-icon"],[1,"title",3,"dblclick","click"],["mat-icon-button","","color","primary","title","\u0420\u0435\u0434\u0430\u043A\u0442\u0438\u0440\u043E\u0432\u0430\u0442\u044C \u043D\u0430\u0438\u043C\u0435\u043D\u043E\u0432\u0430\u043D\u0438\u0435 \u0444\u0440\u0435\u0439\u043C\u0430","tabindex","-1",3,"click"],["mat-icon-button","","color","accent","title","\u0423\u0434\u0430\u043B\u0438\u0442\u044C \u0444\u0440\u0435\u0439\u043C","tabindex","-1",3,"click"],["mat-icon-button","","color","primary","title","\u0412\u0438\u0434\u0438\u043C\u043E\u0441\u0442\u044C \u0444\u0440\u0435\u0439\u043C\u0430","tabindex","-1",3,"click"],["color","success"]],template:function(t,r){if(t&1&&(d(0,"div",0),L(1,"async"),d(2,"span",1),g("dblclick",function(s){return r.onEditName(s)})("click",function(){return r.onSelect()}),v(3),m(),d(4,"button",2),g("click",function(s){return r.onEditName(s)}),d(5,"mat-icon"),v(6,"edit"),m()(),d(7,"button",3),g("click",function(s){return r.onRemoveFrame(s)}),d(8,"mat-icon"),v(9,"highlight_off"),m()(),d(10,"button",4),g("click",function(s){return r.onToggleVisible(s)}),I(11,Ts,2,0,"mat-icon",5)(12,ks,2,0,"mat-icon"),m()()),t&2){let o;le("selected",((o=R(1,4,r.currentFrame$))==null?null:o.id)===r.frame.id),f(3),mt(" ",r.name," "),f(8),k(r.visible?11:12)}},dependencies:[z,Y,G,X,Z,q],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;cursor:default}.item[_ngcontent-%COMP%]{display:flex;align-items:center;padding-left:30px}.item[_ngcontent-%COMP%]:hover{background-color:#e6effc}.item.selected[_ngcontent-%COMP%]{background-color:#0275d8;color:#fff}.item.selected[_ngcontent-%COMP%]   .mat-mdc-icon-button.mat-primary[_ngcontent-%COMP%]{color:#fff}.item[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{flex:auto;font-size:14px}"],changeDetection:0})}}return n})();var Ls=(n,i)=>i.id;function Rs(n,i){n&1&&U(0,"button",2)}function Fs(n,i){if(n&1){let e=V();d(0,"button",12),g("click",function(r){S(e);let o=C();return w(o.onToggleExpand(r))}),d(1,"mat-icon",13),v(2),m()()}if(n&2){let e=C();f(2),mt(" ",e.expanded()?"expand_more":"chevron_right"," ")}}function As(n,i){n&1&&(d(0,"mat-icon",9),v(1,"visibility"),m())}function Vs(n,i){n&1&&(d(0,"mat-icon"),v(1,"visibility_off"),m())}function Os(n,i){if(n&1&&U(0,"sc-sprite-layer-item-frame",15),n&2){let e=i.$implicit;y("frame",e)("name",e.name)("visible",e.visible)}}function Ns(n,i){if(n&1){let e=V();d(0,"div",14),g("cdkDropListDropped",function(r){S(e);let o=C();return w(o.onDropFrame(r))}),me(1,Os,1,3,"sc-sprite-layer-item-frame",15,Ls),m()}if(n&2){let e=C();y("cdkDropListData",e.layer.frames),f(),he(e.layer.frames)}}var js="s-marker:sc-sprite-layers:expanded-layers",Wr=(()=>{class n{constructor(e,t,r){this.jstDialogService=e,this.sessionStorageService=t,this.spriteStore=r,this.layerVisible=!0,this.expanded=ge(!1),this.currentLayer$=this.spriteStore.currentLayer$,this.currentFrame$=this.spriteStore.currentFrame$,this.currentLayerId=null,Ge([this.currentLayer$,this.currentFrame$]).pipe(ee()).subscribe(([o,s])=>{this.currentLayerId=o?.id??s?.layerId??null,this.currentLayerId===this.layer?.id&&!this.expanded()&&this.expanded.set(!0)})}get isSelected(){return this.currentLayerId===this.layer.id}ngOnInit(){this.expandedStorage("load")}onSelect(){this.spriteStore.selectLayerById(this.layer.id)}onAddFrame(e){switch(e){case"collection":this.addFrameFromCollection();break;case"file":this.addFrameFromFile();break}}onRemove(e){e.stopPropagation(),ne.blurActiveElement(),this.jstDialogService.showConfirm("\u0412\u044B \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0442\u0435\u043B\u044C\u043D\u043E \u0445\u043E\u0442\u0438\u0442\u0435 \u0443\u0434\u0430\u043B\u0438\u0442\u044C \u044D\u0442\u043E\u0442 \u0441\u043B\u043E\u0439 \u0438 \u0435\u0433\u043E \u0444\u0440\u0435\u0439\u043C\u044B?","\u0423\u0434\u0430\u043B\u0435\u043D\u0438\u0435 \u0441\u043B\u043E\u044F","\u0423\u0434\u0430\u043B\u0438\u0442\u044C \u0441\u043B\u043E\u0439").subscribe(t=>{t&&this.spriteStore.removeLayer(this.layer.id)})}onEditName(e){e.stopPropagation(),ne.blurActiveElement(),this.jstDialogService.showModal("\u0418\u0437\u043C\u0435\u043D\u0438\u0442\u044C \u043D\u0430\u0438\u043C\u0435\u043D\u043E\u0432\u0430\u043D\u0438\u0435 \u0441\u043B\u043E\u0439",Ee,{label:"\u041D\u0430\u0438\u043C\u0435\u043D\u043E\u0432\u0430\u043D\u0438\u0435 \u0441\u043B\u043E\u044F",applyTitle:"\u0418\u0437\u043C\u0435\u043D\u0438\u0442\u044C \u043D\u0430\u0438\u043C\u0435\u043D\u043E\u0432\u0430\u043D\u0438\u0435",value:this.layer.name}).subscribe(t=>{t!==void 0&&this.spriteStore.updateLayer(this.layer.id,{name:t})})}onToggleVisible(e){e.stopPropagation(),ne.blurActiveElement(),this.spriteStore.updateLayer(this.layer.id,{visible:!this.layer.visible})}onToggleExpand(e){e?.stopPropagation(),ne.blurActiveElement(),this.expandLayer(!this.expanded())}onDropFrame(e){e.isPointerOverContainer&&e.previousContainer===e.container&&(Qe(e.container.data,e.previousIndex,e.currentIndex),this.spriteStore.reOrderFrames({layerId:this.layer.id,frames:e.container.data}))}addFrameFromCollection(){this.jstDialogService.showModal("\u0412\u044B\u0431\u043E\u0440 \u0444\u0440\u0435\u0439\u043C\u0430",Kn,{projectId:this.projectId,multiple:!0},!0,!1).subscribe(e=>{if(!e)return;let t=He.getFrameSerialNumer(this.layer.frames);this.expandLayer(!0),this.spriteStore.addLayerFrameFromCollection({projectId:this.projectId,spriteId:this.spriteId,layerId:this.layer.id,startIdxName:t,frames:e})})}addFrameFromFile(){En.uploadFile("image/*",!0).subscribe(e=>{let t=He.getFrameSerialNumer(this.layer.frames);this.expandLayer(!0),this.spriteStore.addLayerFrameFromFiles({projectId:this.projectId,spriteId:this.spriteId,layerId:this.layer.id,startIdxName:t,files:e})})}expandLayer(e){this.expanded()!==e&&this.expanded.update(()=>(this.expandedStorage("save",e),e))}expandedStorage(e,t){let r=`${js}:${this.projectId}:${this.spriteId}:${this.layer.id}`;e==="load"?this.sessionStorageService.get(r)&&this.expanded.set(!0):this.sessionStorageService.set(r,!!t)}static{this.\u0275fac=function(t){return new(t||n)(T(ve),T(kn),T(re))}}static{this.\u0275cmp=N({type:n,selectors:[["sc-sprite-layer-item"]],hostVars:2,hostBindings:function(t,r){t&2&&le("selected",r.isSelected)},inputs:{projectId:"projectId",spriteId:"spriteId",layer:"layer",layerName:"layerName",layerVisible:"layerVisible"},decls:26,vars:11,consts:[["addFramesMenu",""],[1,"item","mat-small-button-icon"],["mat-icon-button","","disabled","disabled"],["mat-icon-button",""],[1,"title",3,"dblclick","click"],["mat-icon-button","","color","primary","title","\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C \u0444\u0440\u0435\u0439\u043C","tabindex","-1",3,"click","matMenuTriggerFor"],["mat-icon-button","","color","primary","title","\u0420\u0435\u0434\u0430\u043A\u0442\u0438\u0440\u043E\u0432\u0430\u0442\u044C \u043D\u0430\u0438\u043C\u0435\u043D\u043E\u0432\u0430\u043D\u0438\u0435 \u0441\u043B\u043E\u044F","tabindex","-1",3,"click"],["mat-icon-button","","color","accent","title","\u0423\u0434\u0430\u043B\u0438\u0442\u044C \u0441\u043B\u043E\u0439","tabindex","-1",3,"click"],["mat-icon-button","","color","primary","title","\u0412\u0438\u0434\u0438\u043C\u043E\u0441\u0442\u044C \u0441\u043B\u043E\u044F","tabindex","-1",3,"click"],["color","success"],["cdkDropList","",1,"frames-list",3,"cdkDropListData"],["mat-menu-item","",3,"click"],["mat-icon-button","",3,"click"],[1,"mat-icon-rtl-mirror"],["cdkDropList","",1,"frames-list",3,"cdkDropListDropped","cdkDropListData"],["cdkDrag","",3,"frame","name","visible"]],template:function(t,r){if(t&1){let o=V();d(0,"div",1),L(1,"async"),L(2,"async"),I(3,Rs,1,0,"button",2)(4,Fs,3,1,"button",3),d(5,"span",4),g("dblclick",function(a){return S(o),w(r.onToggleExpand(a))})("click",function(){return S(o),w(r.onSelect())}),v(6),m(),d(7,"button",5),g("click",function(a){return S(o),w(a.stopPropagation())}),d(8,"mat-icon"),v(9,"add"),m()(),d(10,"button",6),g("click",function(a){return S(o),w(r.onEditName(a))}),d(11,"mat-icon"),v(12,"edit"),m()(),d(13,"button",7),g("click",function(a){return S(o),w(r.onRemove(a))}),d(14,"mat-icon"),v(15,"highlight_off"),m()(),d(16,"button",8),g("click",function(a){return S(o),w(r.onToggleVisible(a))}),I(17,As,2,0,"mat-icon",9)(18,Vs,2,0,"mat-icon"),m()(),I(19,Ns,3,1,"div",10),d(20,"mat-menu",null,0)(22,"menu",11),g("click",function(){return S(o),w(r.onAddFrame("file"))}),v(23,"\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C \u0444\u0440\u0435\u0439\u043C \u0438\u0437 \u0444\u0430\u0439\u043B\u0430"),m(),d(24,"menu",11),g("click",function(){return S(o),w(r.onAddFrame("collection"))}),v(25,"\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C \u0444\u0440\u0435\u0439\u043C \u0438\u0437 \u043A\u043E\u043B\u043B\u0435\u043A\u0446\u0438\u0438"),m()()}if(t&2){let o,s=pt(21);le("selected",((o=R(1,7,r.currentLayer$))==null?null:o.id)===r.layer.id&&!((o=R(2,9,r.currentFrame$))!=null&&o.id)),f(3),k(r.layer.frames.length===0?3:4),f(3),mt(" ",r.layerName," "),f(),y("matMenuTriggerFor",s),f(10),k(r.layerVisible?17:18),f(2),k(r.expanded()?19:-1)}},dependencies:[z,Y,G,X,Z,q,Wt,qt,Ut,Zt,it,tt,et,Zr],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;cursor:default}.selected[_nghost-%COMP%]{background-color:#0000001a}.item[_ngcontent-%COMP%]{display:flex;align-items:center}.item[_ngcontent-%COMP%]:hover{background-color:#e6effc}.item.selected[_ngcontent-%COMP%]{background-color:#0275d8;color:#fff}.item.selected[_ngcontent-%COMP%]   .mat-mdc-icon-button.mat-primary[_ngcontent-%COMP%]{color:#fff}.item[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{flex:auto;font-size:14px}.frames-list[_ngcontent-%COMP%]{display:flex;flex-direction:column}"],changeDetection:0})}}return n})();var $s=(n,i)=>i.id,Hs=n=>({value:n}),zs=()=>[];function Gs(n,i){n&1&&(d(0,"mat-icon"),v(1,"visibility"),m())}function Us(n,i){n&1&&(d(0,"mat-icon"),v(1,"visibility_off"),m())}function qs(n,i){if(n&1){let e=V();ln(0),d(1,"button",4),g("click",function(){let r=S(e).ngIf,o=C();return w(o.onToggleVisible(r.value))}),I(2,Gs,2,0,"mat-icon")(3,Us,2,0,"mat-icon"),m(),cn()}if(n&2){let e=i.ngIf;f(2),k(e.value?2:3)}}function Zs(n,i){n&1&&(d(0,"div",3),U(1,"mat-spinner"),m())}function Ws(n,i){if(n&1&&U(0,"sc-sprite-layer-item",9),n&2){let e=i.$implicit,t=C(3);y("projectId",t.projectId)("spriteId",t.spriteId)("layer",e)("layerName",e.name)("layerVisible",e.visible)}}function Js(n,i){if(n&1){let e=V();d(0,"div",5)(1,"div",7)(2,"div",8),L(3,"async"),g("cdkDropListDropped",function(r){S(e);let o=C(2);return w(o.onDropLayer(r))}),me(4,Ws,1,5,"sc-sprite-layer-item",9,$s),m()()()}if(n&2){let e=C(),t=C();f(2),y("cdkDropListData",R(3,1,t.layers$)||dn(3,zs)),f(2),he(e)}}function Ks(n,i){n&1&&(d(0,"div",6),v(1,"\u041D\u0435\u0442 \u0434\u0430\u043D\u043D\u044B\u0445"),m())}function Ys(n,i){n&1&&I(0,Js,6,4,"div",5)(1,Ks,2,0,"div",6),n&2&&k(i.length>0?0:1)}var Jr=(()=>{class n{constructor(e,t){this.jstDialogService=e,this.spriteStore=t,this.allLayerVisibledState$=this.spriteStore.allLayerVisibledState$,this.isLoading$=this.spriteStore.isLayersLoading$,this.layers$=this.spriteStore.layers$}onDropLayer(e){e.isPointerOverContainer&&e.previousContainer===e.container&&(Qe(e.container.data,e.previousIndex,e.currentIndex),this.spriteStore.reOrderLayers(e.container.data))}onAdd(){this.layers$.pipe(xe(1)).subscribe(e=>{let t=He.getLayerSerialNumer(e);this.jstDialogService.showModal("\u041D\u043E\u0432\u044B\u0439 \u0441\u043B\u043E\u0439",Ee,{label:"\u041D\u0430\u0438\u043C\u0435\u043D\u043E\u0432\u0430\u043D\u0438\u0435 \u0441\u043B\u043E\u044F",applyTitle:"\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C \u0441\u043B\u043E\u0439",value:`Layer ${t}`}).subscribe(r=>{r!==void 0&&this.spriteStore.addLayer({projectId:this.projectId,name:r})})})}onToggleVisible(e){this.spriteStore.setAllLayersVisible(!e)}static{this.\u0275fac=function(t){return new(t||n)(T(ve),T(re))}}static{this.\u0275cmp=N({type:n,selectors:[["sc-sprite-layers"]],inputs:{projectId:"projectId",spriteId:"spriteId"},decls:9,vars:11,consts:[[1,"flex-row-align-center","border-bottom","pl-5","pr-5","mat-small-button-icon"],["mat-button","","color","primary",1,"flex-auto",3,"click"],[4,"ngIf"],[1,"loading-container"],["mat-icon-button","","color","primary","title","\u041F\u0435\u0440\u0435\u043A\u043B\u044E\u0447\u0438\u0442\u044C \u0432\u0438\u0434\u0438\u043C\u043E\u0441\u0442\u044C \u0432\u0441\u0435\u0445 \u0441\u043B\u043E\u0435\u0432",3,"click"],[1,"scroll-container","mt-10"],[1,"empty-message"],[1,"scroll"],["cdkDropList","",1,"layers-list",3,"cdkDropListDropped","cdkDropListData"],["cdkDrag","",3,"projectId","spriteId","layer","layerName","layerVisible"]],template:function(t,r){if(t&1&&(d(0,"div",0)(1,"button",1),g("click",function(){return r.onAdd()}),v(2,"\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C \u0441\u043B\u043E\u0439"),m(),I(3,qs,4,1,"ng-container",2),L(4,"async"),m(),I(5,Zs,2,0,"div",3),L(6,"async"),I(7,Ys,2,1),L(8,"async")),t&2){let o;f(3),y("ngIf",pn(9,Hs,R(4,3,r.allLayerVisibledState$))),f(2),k(R(6,5,r.isLoading$)?5:-1),f(2),k((o=R(8,7,r.layers$))?7:-1,o)}},dependencies:[z,hn,Y,G,Ce,X,Z,q,Ke,Ot,it,tt,et,Wr],styles:["[_nghost-%COMP%]{position:relative;display:flex;flex-direction:column;width:320px}.selected-block[_ngcontent-%COMP%]{background-color:#0000001a}.layers-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;-webkit-user-select:none;user-select:none}"],changeDetection:0})}}return n})();function Xs(n,i){if(n&1){let e=V();d(0,"fieldset",22)(1,"legend"),v(2),m(),d(3,"div",3)(4,"div",4)(5,"div",5)(6,"jst-touchspin",10),g("valueChange",function(r){let o=S(e),s=C(),a=C(2);return w(a.onChangeFrame(s.id,o.id,"x",r))}),m()(),d(7,"div",5)(8,"jst-touchspin",11),g("valueChange",function(r){let o=S(e),s=C(),a=C(2);return w(a.onChangeFrame(s.id,o.id,"y",r))}),m()()(),d(9,"div",12)(10,"jst-checkbox",23),g("valueChange",function(r){let o=S(e),s=C(),a=C(2);return w(a.onChangeFrame(s.id,o.id,"visible",r))}),m()()()()}if(n&2){let e=i;f(2),At("\u041F\u0430\u0440\u0430\u043C\u0435\u0442\u0440\u044B \u0444\u0440\u0435\u0439\u043C\u0430 (",e.width,"x",e.height,")"),f(4),y("value",e.x)("permanentValueChange",!1),f(2),y("value",e.y)("permanentValueChange",!1),f(2),y("value",e.visible)}}function Qs(n,i){if(n&1){let e=V();d(0,"fieldset",2)(1,"legend"),v(2,"\u041F\u0430\u0440\u0430\u043C\u0435\u0442\u0440\u044B \u0441\u043B\u043E\u044F"),m(),d(3,"div",3)(4,"div",4)(5,"div",5)(6,"jst-touchspin",10),g("valueChange",function(r){let o=S(e),s=C(2);return w(s.onChangeLayer(o.id,"x",r))}),m()(),d(7,"div",5)(8,"jst-touchspin",11),g("valueChange",function(r){let o=S(e),s=C(2);return w(s.onChangeLayer(o.id,"y",r))}),m()()(),d(9,"div",14)(10,"div",15)(11,"jst-touchspin",16),g("valueChange",function(r){let o=S(e),s=C(2);return w(s.onChangeLayer(o.id,"zIndex",r))}),m()(),d(12,"div",15)(13,"jst-color-picker",17),g("valueChange",function(r){let o=S(e),s=C(2);return w(s.onChangeLayer(o.id,"bgColor",r))}),m()()(),d(14,"div",18)(15,"jst-checkbox",19),g("valueChange",function(r){let o=S(e),s=C(2);return w(s.onChangeLayer(o.id,"visible",r))}),m(),d(16,"jst-checkbox",20),g("valueChange",function(r){let o=S(e),s=C(2);return w(s.onChangeLayer(o.id,"flipHorizontal",r))}),m(),d(17,"jst-checkbox",21),g("valueChange",function(r){let o=S(e),s=C(2);return w(s.onChangeLayer(o.id,"flipVertical",r))}),m()()()(),I(18,Xs,11,7,"fieldset",22),L(19,"async")}if(n&2){let e,t=i,r=C(2);f(6),y("value",t.x)("permanentValueChange",!1),f(2),y("value",t.y)("permanentValueChange",!1),f(3),y("value",t.zIndex)("permanentValueChange",!1),f(2),y("clearButton",!0)("value",t.bgColor),f(2),y("value",t.visible),f(),y("value",t.flipHorizontal),f(),y("value",t.flipVertical),f(),k((e=R(19,12,r.currentFrame$))?18:-1,e)}}function ea(n,i){if(n&1){let e=V();d(0,"div",0)(1,"div",1)(2,"fieldset",2)(3,"legend"),v(4,"\u041F\u0430\u0440\u0430\u043C\u0435\u0442\u0440\u044B \u0441\u043F\u0440\u0430\u0439\u0442\u0430"),m(),d(5,"div",3)(6,"div",4)(7,"div",5)(8,"jst-touchspin",6),g("valueChange",function(r){S(e);let o=C();return w(o.onChangeSprite("width",r))}),m()(),d(9,"div",5)(10,"jst-touchspin",7),g("valueChange",function(r){S(e);let o=C();return w(o.onChangeSprite("height",r))}),m()()(),d(11,"div",8)(12,"jst-color-picker",9),g("valueChange",function(r){S(e);let o=C();return w(o.onChangeSprite("bgColor",r))}),m()()()(),d(13,"fieldset",2)(14,"legend"),v(15,"\u0422\u043E\u0447\u043A\u0430 \u0441\u043E\u043F\u0440\u0438\u043A\u043E\u0441\u043D\u043E\u0432\u0435\u043D\u0438\u044F \u0441 \u0437\u0435\u043C\u043B\u0435\u0439"),m(),d(16,"div",3)(17,"div",4)(18,"div",5)(19,"jst-touchspin",10),g("valueChange",function(r){S(e);let o=C();return w(o.onChangeSprite("groundPointX",r))}),m()(),d(20,"div",5)(21,"jst-touchspin",11),g("valueChange",function(r){S(e);let o=C();return w(o.onChangeSprite("groundPointY",r))}),m()()(),d(22,"div",12)(23,"jst-checkbox",13),g("valueChange",function(r){S(e);let o=C();return w(o.onChangeSprite("visibleGroundPoint",r))}),m()()()(),I(24,Qs,20,14),L(25,"async"),m()()}if(n&2){let e,t=i,r=C();f(8),y("min",10)("max",1e4)("value",t.width)("permanentValueChange",!1),f(2),y("min",10)("max",1e4)("value",t.height)("permanentValueChange",!1),f(2),y("clearButton",!0)("value",t.bgColor),f(7),y("value",t.groundPointX)("permanentValueChange",!1),f(2),y("value",t.groundPointY)("permanentValueChange",!1),f(2),y("value",t.visibleGroundPoint),f(),k((e=R(25,16,r.currentLayer$))?24:-1,e)}}var Kr=(()=>{class n{constructor(e){this.spriteStore=e,this.sprite$=this.spriteStore.sprite$,this.currentLayer$=this.spriteStore.currentLayer$,this.currentFrame$=this.spriteStore.currentFrame$}onChangeSprite(e,t){this.spriteStore.updateSprite({[e]:t})}onChangeLayer(e,t,r){this.spriteStore.updateLayer(e,{[t]:r})}onChangeFrame(e,t,r,o){this.spriteStore.updateFrame({id:t,layerId:e,frame:{[r]:o}})}static{this.\u0275fac=function(t){return new(t||n)(T(re))}}static{this.\u0275cmp=N({type:n,selectors:[["sc-sprite-params"]],decls:2,vars:3,consts:[[1,"scroll-container"],[1,"scroll"],[1,"mt-10"],[1,"flex-col","mt-10"],[1,"flex-row","mat-without-hint"],[1,"w-coords"],["label","\u0428\u0438\u0440\u0438\u043D\u0430","mode","compactmode",3,"valueChange","min","max","value","permanentValueChange"],["label","\u0412\u044B\u0441\u043E\u0442\u0430","mode","compactmode",3,"valueChange","min","max","value","permanentValueChange"],[1,"mt-15","mat-without-hint"],["label","\u041F\u043E\u0434\u0441\u0432\u0435\u0442\u043A\u0430 \u0444\u043E\u043D\u0430 \u0441\u043F\u0440\u0430\u0439\u0442\u0430",3,"valueChange","clearButton","value"],["label","X","mode","compactmode",3,"valueChange","value","permanentValueChange"],["label","Y","mode","compactmode",3,"valueChange","value","permanentValueChange"],[1,"mt-10","mat-without-hint"],["label","\u0421\u043A\u0440\u044B\u0442\u044C/\u043F\u043E\u043A\u0430\u0437\u0430\u0442\u044C \u0442\u043E\u0447\u043A\u0443",3,"valueChange","value"],[1,"flex-row","mt-15"],[1,"w-coords","mat-without-hint"],["label","Z-\u0438\u043D\u0434\u0435\u043A\u0441","mode","compactmode",3,"valueChange","value","permanentValueChange"],["label","\u041F\u043E\u0434\u0441\u0432\u0435\u0442\u043A\u0430 \u0444\u043E\u043D\u0430 \u0441\u043B\u043E\u044F","emptyColorTitle","\u041D\u0435\u0442",3,"valueChange","clearButton","value"],[1,"mt-10","flex-col"],["label","\u0412\u0438\u0434\u0438\u043C\u043E\u0441\u0442\u044C \u0441\u043B\u043E\u044F",3,"valueChange","value"],["label","\u041E\u0442\u0440\u0430\u0437\u0438\u0442\u044C \u043F\u043E \u0433\u043E\u0440\u0438\u0437\u043E\u043D\u0442\u0430\u043B\u0438",3,"valueChange","value"],["label","\u041E\u0442\u0440\u0430\u0437\u0438\u0442\u044C \u043F\u043E \u0432\u0435\u0440\u0442\u0438\u043A\u0430\u043B\u0438",3,"valueChange","value"],[1,"mt-10","mb-10"],["label","\u0412\u0438\u0434\u0438\u043C\u043E\u0441\u0442\u044C \u0444\u0440\u0435\u0439\u043C\u0430",3,"valueChange","value"]],template:function(t,r){if(t&1&&(I(0,ea,26,18,"div",0),L(1,"async")),t&2){let o;k((o=R(1,1,r.sprite$))?0:-1,o)}},dependencies:[z,Y,Kt,Jt,qn,Un,Xt,Yt],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;padding-left:5px;width:340px}"],changeDetection:0})}}return n})();function ta(n,i){n&1&&(d(0,"div",2),U(1,"mat-spinner"),m())}function ia(n,i){if(n&1){let e=V();d(0,"button",5)(1,"div",6)(2,"span"),v(3,"\u042D\u043A\u0441\u043F\u043E\u0440\u0442 \u0441\u043F\u0440\u0430\u0439\u0442\u0430"),m(),d(4,"mat-icon"),v(5,"arrow_drop_down"),m()()(),d(6,"button",5)(7,"div",6)(8,"span"),v(9,"\u0414\u0435\u0439\u0441\u0442\u0432\u0438\u044F \u043D\u0430\u0434 \u0441\u043F\u0440\u0430\u0439\u0442\u043E\u043C"),m(),d(10,"mat-icon"),v(11,"arrow_drop_down"),m()()(),d(12,"mat-menu",null,0)(14,"button",7),g("click",function(){let r=S(e),o=C(3);return w(o.onExportSprite(r,"default"))}),v(15," \u041E\u0431\u044B\u0447\u043D\u044B\u0439 \u044D\u043A\u0441\u043F\u043E\u0440\u0442 \u0441\u043F\u0440\u0430\u0439\u0442\u0430 "),m(),d(16,"button",8),g("click",function(){let r=S(e),o=C(3);return w(o.onExportSprite(r,"for-game"))}),v(17,"\u042D\u043A\u0441\u043F\u043E\u0440\u0442 \u0441\u043F\u0440\u0430\u0439\u0442\u0430 \u0434\u043B\u044F \u0438\u0433\u0440\u044B"),m()(),d(18,"mat-menu",null,1)(20,"button",8),g("click",function(){let r=S(e),o=C(3);return w(o.onChangeNameSprite(r))}),v(21,"\u0418\u0437\u043C\u0435\u043D\u0438\u0442\u044C \u043D\u0430\u0438\u043C\u0435\u043D\u043E\u0432\u0430\u043D\u0438\u0435 \u0441\u043F\u0440\u0430\u0439\u0442\u0430"),m(),d(22,"button",8),g("click",function(){let r=S(e),o=C(3);return w(o.onCloneSprite(r))}),v(23,"\u0421\u043E\u0437\u0434\u0430\u0442\u044C \u043A\u043E\u043F\u0438\u044E \u0441\u043F\u0440\u0430\u0439\u0442\u0430"),m(),d(24,"button",8),g("click",function(){let r=S(e),o=C(3);return w(o.onRemoveSprite(r))}),d(25,"span",9),v(26,"\u0423\u0434\u0430\u043B\u0438\u0442\u044C \u0441\u043F\u0440\u0430\u0439\u0442"),m()()()}if(n&2){let e=pt(13),t=pt(19);y("matMenuTriggerFor",e),f(6),y("matMenuTriggerFor",t)}}function na(n,i){if(n&1&&(d(0,"div",4)(1,"div",10),U(2,"sc-sprite-layers",11)(3,"sc-sprite-params",12)(4,"sc-sprite-adjustment",13)(5,"sc-sprite-animations",14),m()()),n&2){let e=C();f(2),y("projectId",e.id)("spriteId",i.id),f(3),y("projectId",e.id)}}function ra(n,i){n&1&&(d(0,"div",2),U(1,"mat-spinner"),m())}function oa(n,i){n&1&&U(0,"smc-page-not-found",15),n&2&&y("goHomeOnClick",!1)}function sa(n,i){if(n&1&&(I(0,ra,2,0,"div",2),L(1,"async"),I(2,oa,1,1,"smc-page-not-found",15)),n&2){let e=C(3);k(R(1,1,e.isSpriteInitializing$)?0:2)}}function aa(n,i){if(n&1&&(d(0,"smc-header",3),L(1,"async"),I(2,ia,27,2),L(3,"async"),m(),I(4,na,6,3,"div",4),L(5,"async"),I(6,sa,3,3)),n&2){let e,t,r,o=C(2);y("project",i)("currentModule",o.currentModule)("currentModulePage",(e=(e=R(1,5,o.sprite$))==null?null:e.name)!==null&&e!==void 0?e:"\u0421\u043F\u0440\u0430\u0439\u0442 \u043D\u0435 \u043D\u0430\u0439\u0434\u0435\u043D"),f(2),k((t=R(3,7,o.sprite$))?2:-1,t),f(2),k((r=R(5,9,o.sprite$))?4:6,r)}}function la(n,i){n&1&&U(0,"smc-page-not-found")}function ca(n,i){if(n&1&&(I(0,aa,7,11),L(1,"async"),I(2,la,1,0,"smc-page-not-found")),n&2){let e,t=C();k((e=R(1,1,t.projectStore.project$))?0:2,e)}}var xu=(()=>{class n{constructor(e,t,r,o,s,a,c,l){this.projectStore=e,this.titleService=t,this.activatedRoute=r,this.router=o,this.jstDialogService=s,this.spriteStore=a,this.exportSpriteService=c,this.spritesService=l,this.currentModule=Qt,this.isSpriteInitializing$=this.spriteStore.isInitializing$,this.sprite$=this.spriteStore.sprite$,this.activatedRoute.paramMap.pipe(ee()).subscribe(u=>{this.projectStore.initialize(u.get("pid")),this.spriteStore.initialize(u.get("id"))}),Ge([this.projectStore.project$,this.sprite$]).pipe(ee()).subscribe(([u,p])=>{u&&p&&this.titleService.setTitle(`${p.name} | ${this.currentModule.name} | ${u.name} | ${Zn}`)})}onRemoveSprite(e){this.jstDialogService.showConfirm("\u0412\u044B \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0442\u0435\u043B\u044C\u043D\u043E \u0445\u043E\u0442\u0438\u0442\u0435 \u0443\u0434\u0430\u043B\u0438\u0442\u044C \u044D\u0442\u043E\u0442 \u0441\u043F\u0440\u0430\u0439\u0442?").subscribe(t=>{t&&this.spritesService.remove(e.id).subscribe(()=>{this.router.navigate([e.projectId,Qt.code])})})}onCloneSprite(e){ne.blurActiveElement(),this.jstDialogService.showModal("\u0421\u043E\u0437\u0434\u0430\u043D\u0438\u0435 \u043A\u043E\u043F\u0438\u0438 \u0441\u043F\u0440\u0430\u0439\u0442\u0430",Ee,{label:"\u041D\u0430\u0438\u043C\u0435\u043D\u043E\u0432\u0430\u043D\u0438\u0435 \u0441\u043F\u0440\u0430\u0439\u0442\u0430",applyTitle:"\u0421\u043E\u0437\u0434\u0430\u0442\u044C \u043A\u043E\u043F\u0438\u044E \u0441\u043F\u0440\u0430\u0439\u0442\u0430",value:e.name}).subscribe(t=>{t!==void 0&&this.spritesService.cloneSprite(e.id,t).subscribe(r=>{this.router.navigate([e.projectId,Qt.code,r]),this.jstDialogService.showToastSuccess("\u041A\u043E\u043F\u0438\u044F \u0441\u043F\u0440\u0430\u0439\u0442\u0430 \u0441\u043E\u0437\u0434\u0430\u043D\u0430 \u0443\u0441\u043F\u0435\u0448\u043D\u043E")})})}onExportSprite(e,t){switch(this.jstDialogService.showWait("\u0413\u0435\u043D\u0435\u0440\u0430\u0446\u0438\u044F SpritePack..."),t){case"default":lt(this.exportSpriteService.exportSpritePack(e.id)).pipe(bi(()=>this.jstDialogService.hideWait())).subscribe({next:()=>this.jstDialogService.showToastSuccess("\u0410\u0440\u0445\u0438\u0432 \u0433\u043E\u0442\u043E\u0432 \u0438 \u043E\u0442\u043F\u0440\u0430\u0432\u043B\u0435\u043D \u043D\u0430 \u0441\u043A\u0430\u0447\u0438\u0432\u0430\u043D\u0438\u0435"),error:r=>this.jstDialogService.showToastError(r.message)});break;case"for-game":lt(this.exportSpriteService.exportSpritePackForGame(e.id)).pipe(bi(()=>this.jstDialogService.hideWait())).subscribe({next:()=>this.jstDialogService.showToastSuccess("\u0410\u0440\u0445\u0438\u0432 \u0433\u043E\u0442\u043E\u0432 \u0438 \u043E\u0442\u043F\u0440\u0430\u0432\u043B\u0435\u043D \u043D\u0430 \u0441\u043A\u0430\u0447\u0438\u0432\u0430\u043D\u0438\u0435"),error:r=>this.jstDialogService.showToastError(r.message)});break;default:this.jstDialogService.hideWait()}}onChangeNameSprite(e){ne.blurActiveElement(),this.jstDialogService.showModal("\u0418\u0437\u043C\u0435\u043D\u0435\u043D\u0438\u0435 \u0441\u043F\u0440\u0430\u0439\u0442\u0430",Ee,{label:"\u041D\u0430\u0438\u043C\u0435\u043D\u043E\u0432\u0430\u043D\u0438\u0435 \u0441\u043F\u0440\u0430\u0439\u0442\u0430",applyTitle:"\u0418\u0437\u043C\u0435\u043D\u0438\u0442\u044C \u0441\u043F\u0440\u0430\u0439\u0442",value:e.name}).subscribe(t=>{t!==void 0&&this.spriteStore.updateSprite({name:t})})}static{this.\u0275fac=function(t){return new(t||n)(T(Tn),T(_n),T(wn),T(yn),T(ve),T(re),T(In),T(Pn))}}static{this.\u0275cmp=N({type:n,selectors:[["sc-sprite-edit"]],features:[Be([bn(re)])],decls:3,vars:3,consts:[["exportMenu","matMenu"],["doMenu","matMenu"],[1,"flex-auto","flex-row-centered"],[3,"project","currentModule","currentModulePage"],[1,"flex-auto","flex-col"],["mat-button","","color","primary",3,"matMenuTriggerFor"],[1,"flex-row-align-center"],["mat-menu-item","","title","\u041D\u0435\u043B\u044C\u0437\u044F \u0431\u0443\u0434\u0435\u0442 \u0438\u0441\u043F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u044C \u0434\u043B\u044F \u0438\u043C\u043F\u043E\u0440\u0442\u0430 \u0432 S-Maker!!!",3,"click"],["mat-menu-item","",3,"click"],[1,"text-danger"],[1,"flex-auto","flex-row"],[1,"border-right",3,"projectId","spriteId"],[1,"border-right"],[1,"flex-auto","border-right"],[3,"projectId"],[3,"goHomeOnClick"]],template:function(t,r){t&1&&(I(0,ta,2,0,"div",2),L(1,"async"),I(2,ca,3,3)),t&2&&k(R(1,1,r.projectStore.isInitializing$)?0:2)},dependencies:[z,Y,Ke,Ot,G,Ce,Z,q,Wt,qt,Ut,Zt,Wn,Jn,Jr,Kr,Xn,qr],styles:["[_nghost-%COMP%]{flex:auto;display:flex;flex-direction:column}"],changeDetection:0})}}return n})();export{xu as SCSpriteEditComponent};
