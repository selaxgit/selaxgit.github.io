import{a as Q}from"./chunk-JGBLPNDP.js";import{$b as G,Aa as s,Ba as v,Be as K,Ea as g,Ga as C,Ha as c,M as b,Nc as U,Pb as V,Rb as R,Rc as W,S as p,Sa as _,T as u,Ta as w,Ub as A,W as M,Wb as F,cc as L,da as x,dc as B,ea as a,eb as T,fb as h,fe as J,h as E,ja as $,jc as O,nb as H,oa as m,ob as I,qa as D,se as N,ua as f,ub as P,ve as S,xa as k,ya as y,z as j,za as l,zc as z,ze as q}from"./chunk-FGQYVVFQ.js";import"./chunk-XP2N47VC.js";import"./chunk-XJADAOP3.js";import"./chunk-WDCVTZT5.js";import"./chunk-ZKQ77EQL.js";import"./chunk-Q75QCHGE.js";import"./chunk-JOYMENOW.js";import"./chunk-FY46XAGK.js";var tt=(i,r)=>r.id;function it(i,r){i&1&&(l(0,"div",6),v(1,"mat-spinner"),s())}function et(i,r){if(i&1){let t=g();l(0,"div",11),C("dblclick",function(){let o=p(t).$implicit,n=c(4),d=c();return u(d.onGoToGrid(n.id,o.id))}),l(1,"div",12),_(2),s(),l(3,"button",13),C("click",function(){let o=p(t).$implicit,n=c(4),d=c();return u(d.onGoToGrid(n.id,o.id))}),_(4," \u0420\u0435\u0434\u0430\u043A\u0442\u0438\u0440\u043E\u0432\u0430\u0442\u044C "),s(),l(5,"button",13),C("click",function(){let o=p(t).$implicit,n=c(5);return u(n.onExportGrid(o.id))}),_(6,"\u042D\u043A\u0441\u043F\u043E\u0440\u0442"),s(),l(7,"button",14),C("click",function(){let o=p(t).$implicit,n=c(4),d=c();return u(d.onRemoveGrid(n.id,o.id))}),_(8,"\u0423\u0434\u0430\u043B\u0438\u0442\u044C"),s()()}if(i&2){let t=r.$implicit;x(2),w(t.name)}}function ot(i,r){if(i&1&&(l(0,"div",7)(1,"div",9),k(2,et,9,1,"div",10,tt),s()()),i&2){let t=c();x(2),y(t)}}function nt(i,r){i&1&&(l(0,"div",8),_(1,"\u041D\u0435\u0442 \u0441\u0435\u0442\u043E\u043A"),s())}function rt(i,r){i&1&&m(0,ot,4,0,"div",7)(1,nt,2,0,"div",8),i&2&&f(r.length>0?0:1)}function ct(i,r){if(i&1&&(m(0,rt,2,1),T(1,"async")),i&2){let t,e=c(2);f((t=h(1,1,e.gridsList$))?0:-1,t)}}function lt(i,r){if(i&1){let t=g();v(0,"smc-header",0),l(1,"div",1)(2,"div",2)(3,"div",3)(4,"button",4),C("click",function(){let o=p(t),n=c();return u(n.onAddGrid(o.id))}),_(5,"\u041D\u043E\u0432\u0430\u044F \u0441\u0435\u0442\u043A\u0430"),s()(),l(6,"div",5),m(7,it,2,0,"div",6),T(8,"async"),m(9,ct,2,3),s()()()}if(i&2){let t=c();D("project",r)("currentModule",t.currentModule),x(7),f(h(8,3,t.isLoading$)?7:9)}}function st(i,r){i&1&&v(0,"smc-page-not-found")}var kt=(()=>{class i{constructor(t,e,o,n,d,X,Y){this.titleService=t,this.activatedRoute=e,this.router=o,this.jstDialogService=n,this.projectStore=d,this.tilesGridStore=X,this.exportTilesGridService=Y,this.currentModule=S,this.project$=this.projectStore.project$,this.isLoading$=this.tilesGridStore.isCurrentTileGridInitializing$,this.gridsList$=this.tilesGridStore.gridsList$,this.destroyRef$=b(M),this.activatedRoute.paramMap.pipe(G()).subscribe(Z=>{this.projectStore.initialize(Z.get("pid"))})}ngOnInit(){this.project$.pipe(G(this.destroyRef$)).subscribe(t=>{t&&this.titleService.setTitle(`${this.currentModule.name} | ${t.name??""} | ${N}`)})}onGoToGrid(t,e){this.router.navigate([t,this.currentModule.code,e])}onExportGrid(t){this.jstDialogService.showWait("\u0413\u0435\u043D\u0435\u0440\u0430\u0446\u0438\u044F TileGridPack..."),E(this.exportTilesGridService.exportTileGridPack(t)).pipe(j(()=>this.jstDialogService.hideWait())).subscribe({next:()=>this.jstDialogService.showToastSuccess("\u0410\u0440\u0445\u0438\u0432 \u0433\u043E\u0442\u043E\u0432 \u0438 \u043E\u0442\u043F\u0440\u0430\u0432\u043B\u0435\u043D \u043D\u0430 \u0441\u043A\u0430\u0447\u0438\u0432\u0430\u043D\u0438\u0435"),error:e=>this.jstDialogService.showToastError(e.message)})}onRemoveGrid(t,e){this.jstDialogService.showConfirm("\u0412\u044B \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0442\u0435\u043B\u044C\u043D\u043E \u0445\u043E\u0442\u0438\u0442\u0435 \u0443\u0434\u0430\u043B\u0438\u0442\u044C \u044D\u0442\u0443 \u0441\u0435\u0442\u043A\u0443?","\u0423\u0434\u0430\u043B\u0435\u043D\u0438\u0435 \u0441\u0435\u0442\u043A\u0438","\u0423\u0434\u0430\u043B\u0438\u0442\u044C \u0441\u0435\u0442\u043A\u0443").subscribe(o=>{o&&this.tilesGridStore.removeGrid(t,e)})}onAddGrid(t){O.blurActiveElement(),this.jstDialogService.showModal("\u041D\u043E\u0432\u0430\u044F \u0441\u0435\u0442\u043A\u0430 \u0442\u0430\u0439\u043B\u043E\u0432",Q,{projectId:t},!0).subscribe(e=>{e&&this.router.navigate([t,S.code,e.id])})}static{this.\u0275fac=function(e){return new(e||i)(a(P),a(A),a(F),a(J),a(W),a(U),a(z))}}static{this.\u0275cmp=$({type:i,selectors:[["tge-home"]],decls:3,vars:3,consts:[[3,"project","currentModule"],[1,"content"],[1,"projects-container"],[1,"projects-container__head"],["mat-stroked-button","","color","primary",3,"click"],[1,"projects-container__content"],[1,"loading-container"],[1,"scroll-container"],[1,"empty-message"],[1,"scroll"],[1,"projects-container-list-item"],[1,"projects-container-list-item",3,"dblclick"],[1,"projects-container-list-item__title"],["mat-button","","color","primary",3,"click"],["mat-button","","color","accent",3,"click"]],template:function(e,o){if(e&1&&(m(0,lt,10,5),T(1,"async"),m(2,st,1,0,"smc-page-not-found")),e&2){let n;f((n=h(1,1,o.project$))?0:2,n)}},dependencies:[I,H,B,L,R,V,q,K],styles:["[_nghost-%COMP%]{flex:auto;display:flex;flex-direction:column}.content[_ngcontent-%COMP%]{flex:auto;display:flex;flex-direction:column;align-items:center;padding:48px 20px 20px}"],changeDetection:0})}}return i})();export{kt as TGEHomeComponent};
