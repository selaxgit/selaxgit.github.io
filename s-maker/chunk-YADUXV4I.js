import{$b as T,Aa as c,Ae as oe,Ba as f,Be as re,Ea as h,Ga as S,Ha as s,Kd as K,Ld as Q,M as D,Md as X,Nd as Y,Od as Z,Pb as P,Pc as N,Qc as J,Ra as y,Rb as A,Rc as q,S as _,Sa as l,Sb as L,T as d,Ta as H,Tb as R,Ub as O,W as b,Wb as W,cb as $,cc as G,da as C,dc as U,ea as u,eb as v,fb as g,fe as ee,g as M,ja as w,jc as z,nb as F,oa as m,ob as V,qa as E,se as te,ua as x,ub as I,we as ie,xa as B,ya as k,z as j,za as r,ze as ne}from"./chunk-CH7MYQVU.js";import"./chunk-XP2N47VC.js";import"./chunk-XJADAOP3.js";import"./chunk-WDCVTZT5.js";import"./chunk-ZKQ77EQL.js";import"./chunk-Q75QCHGE.js";import"./chunk-JOYMENOW.js";import"./chunk-FY46XAGK.js";var le=(t,a)=>a.id,ue=t=>({id:t});function me(t,a){t&1&&(r(0,"div",8),f(1,"mat-spinner"),c())}function pe(t,a){if(t&1){let e=h();r(0,"div",13),S("dblclick",function(){let n=_(e).$implicit,o=s(4),p=s();return d(p.onGoToScene(o.id,n.id))}),r(1,"div",14),l(2),c(),r(3,"button",15),S("click",function(){let n=_(e).$implicit,o=s(4),p=s();return d(p.onGoToScene(o.id,n.id))}),l(4," \u0420\u0435\u0434\u0430\u043A\u0442\u0438\u0440\u043E\u0432\u0430\u0442\u044C "),c(),r(5,"button",16)(6,"div",17)(7,"span"),l(8,"\u042D\u043A\u0441\u043F\u043E\u0440\u0442"),c(),r(9,"mat-icon"),l(10,"arrow_drop_down"),c()()(),r(11,"button",18),S("click",function(){let n=_(e).$implicit,o=s(4),p=s();return d(p.onRemoveScene(o.id,n.id))}),l(12,"\u0423\u0434\u0430\u043B\u0438\u0442\u044C"),c()()}if(t&2){let e=a.$implicit;s(5);let i=y(4);C(2),H(e.name),C(3),E("matMenuTriggerFor",i)("matMenuTriggerData",$(3,ue,e.id))}}function _e(t,a){if(t&1&&(r(0,"div",9)(1,"div",11),B(2,pe,13,5,"div",12,le),c()()),t&2){let e=s();C(2),k(e)}}function de(t,a){t&1&&(r(0,"div",10),l(1,"\u041D\u0435\u0442 \u0441\u0446\u0435\u043D"),c())}function Se(t,a){t&1&&m(0,_e,4,0,"div",9)(1,de,2,0,"div",10),t&2&&x(a.length>0?0:1)}function Ce(t,a){if(t&1&&(m(0,Se,2,1),v(1,"async")),t&2){let e,i=s(2);x((e=g(1,1,i.scenesList$))?0:-1,e)}}function xe(t,a){if(t&1){let e=h();f(0,"smc-header",2),r(1,"div",3)(2,"div",4)(3,"div",5)(4,"button",6),S("click",function(){let n=_(e),o=s();return d(o.onAddScene(n.id))}),l(5,"\u041D\u043E\u0432\u0430\u044F \u0441\u0446\u0435\u043D\u0430"),c()(),r(6,"div",7),m(7,me,2,0,"div",8),v(8,"async"),m(9,Ce,2,3),c()()()}if(t&2){let e=s();E("project",a)("currentModule",e.currentModule),C(7),x(g(8,3,e.isLoading$)?7:9)}}function fe(t,a){t&1&&f(0,"smc-page-not-found")}function he(t,a){if(t&1){let e=h();r(0,"menu",19),S("click",function(){let n=_(e).id,o=s();return d(o.onExportScene(n))}),l(1,"\u042D\u043A\u0441\u043F\u043E\u0440\u0442\u0438\u0440\u043E\u0432\u0430\u0442\u044C \u043F\u0440\u043E\u0441\u0442\u043E \u0441\u0446\u0435\u043D\u0443"),c(),r(2,"menu",19),S("click",function(){let n=_(e).id,o=s();return d(o.onExportScenePack(n))}),l(3,"\u042D\u043A\u0441\u043F\u043E\u0440\u0442\u0438\u0440\u043E\u0432\u0430\u0442\u044C \u0432\u0435\u0441\u044C \u043D\u0430\u0431\u043E\u0440 \u0441\u0446\u0435\u043D\u044B"),c()}}var ze=(()=>{class t{constructor(e,i,n,o,p,ce,se){this.titleService=e,this.activatedRoute=i,this.router=n,this.jstDialogService=o,this.projectStore=p,this.scenesStore=ce,this.exportSceneService=se,this.currentModule=ie,this.project$=this.projectStore.project$,this.isLoading$=this.scenesStore.isLoading$,this.scenesList$=this.scenesStore.scenesList$,this.destroyRef$=D(b),this.activatedRoute.paramMap.pipe(T()).subscribe(ae=>{this.projectStore.initialize(ae.get("pid"))})}ngOnInit(){this.project$.pipe(T(this.destroyRef$)).subscribe(e=>{e&&this.titleService.setTitle(`${this.currentModule.name} | ${e.name??""} | ${te}`)})}onGoToScene(e,i){this.router.navigate([e,this.currentModule.code,i])}onExportScene(e){this.jstDialogService.showWait("\u0413\u0435\u043D\u0435\u0440\u0430\u0446\u0438\u044F SceneFile..."),M(this.exportSceneService.exportScene(e)).pipe(j(()=>this.jstDialogService.hideWait())).subscribe({next:()=>this.jstDialogService.showToastSuccess("\u0424\u0430\u0439\u043B \u043E\u0442\u043F\u0440\u0430\u0432\u043B\u0435\u043D \u043D\u0430 \u0441\u043A\u0430\u0447\u0438\u0432\u0430\u043D\u0438\u0435"),error:i=>this.jstDialogService.showToastError(i.message)})}onExportScenePack(e){this.jstDialogService.showWait("\u0413\u0435\u043D\u0435\u0440\u0430\u0446\u0438\u044F ScenePack..."),M(this.exportSceneService.exportScenePack(e)).pipe(j(()=>this.jstDialogService.hideWait())).subscribe({next:()=>this.jstDialogService.showToastSuccess("\u0410\u0440\u0445\u0438\u0432 \u0433\u043E\u0442\u043E\u0432 \u0438 \u043E\u0442\u043F\u0440\u0430\u0432\u043B\u0435\u043D \u043D\u0430 \u0441\u043A\u0430\u0447\u0438\u0432\u0430\u043D\u0438\u0435"),error:i=>this.jstDialogService.showToastError(i.message)})}onRemoveScene(e,i){this.jstDialogService.showConfirm("\u0412\u044B \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0442\u0435\u043B\u044C\u043D\u043E \u0445\u043E\u0442\u0438\u0442\u0435 \u0443\u0434\u0430\u043B\u0438\u0442\u044C \u044D\u0442\u0443 \u0441\u0446\u0435\u043D\u0443?","\u0423\u0434\u0430\u043B\u0435\u043D\u0438\u0435 \u0441\u0446\u0435\u043D\u044B","\u0423\u0434\u0430\u043B\u0438\u0442\u044C \u0441\u0446\u0435\u043D\u0443").subscribe(n=>{n&&this.scenesStore.removeScene(e,i)})}onAddScene(e){z.blurActiveElement(),this.jstDialogService.showModal("\u041D\u043E\u0432\u0430\u044F \u0441\u0446\u0435\u043D\u0430",oe,{label:"\u041D\u0430\u0438\u043C\u0435\u043D\u043E\u0432\u0430\u043D\u0438\u0435 \u0441\u0446\u0435\u043D\u044B",applyTitle:"\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C \u0441\u0446\u0435\u043D\u0443"},!0).subscribe(i=>{i!==void 0&&this.scenesStore.addScene(e,i).subscribe(n=>this.router.navigate([e,this.currentModule.code,n.id]))})}static{this.\u0275fac=function(i){return new(i||t)(u(I),u(O),u(W),u(ee),u(q),u(J),u(N))}}static{this.\u0275cmp=w({type:t,selectors:[["sb-home"]],decls:6,vars:3,consts:[["exportMenu",""],["matMenuContent",""],[3,"project","currentModule"],[1,"content"],[1,"projects-container"],[1,"projects-container__head"],["mat-stroked-button","","color","primary",3,"click"],[1,"projects-container__content"],[1,"loading-container"],[1,"scroll-container"],[1,"empty-message"],[1,"scroll"],[1,"projects-container-list-item"],[1,"projects-container-list-item",3,"dblclick"],[1,"projects-container-list-item__title"],["mat-button","","color","primary",3,"click"],["mat-button","","color","primary",3,"matMenuTriggerFor","matMenuTriggerData"],[1,"flex-row-align-center"],["mat-button","","color","accent",3,"click"],["mat-menu-item","",3,"click"]],template:function(i,n){if(i&1&&(m(0,xe,10,5),v(1,"async"),m(2,fe,1,0,"smc-page-not-found"),r(3,"mat-menu",null,0),m(5,he,4,0,"ng-template",1),c()),i&2){let o;x((o=g(1,1,n.project$))?0:2,o)}},dependencies:[V,F,U,G,A,P,Z,X,K,Q,Y,R,L,ne,re],styles:["[_nghost-%COMP%]{flex:auto;display:flex;flex-direction:column}.content[_ngcontent-%COMP%]{flex:auto;display:flex;flex-direction:column;align-items:center;padding:48px 20px 20px}"],changeDetection:0})}}return t})();export{ze as SBHomeComponent};
