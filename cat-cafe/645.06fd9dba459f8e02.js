"use strict";(self.webpackChunkcat_cafe=self.webpackChunkcat_cafe||[]).push([[645],{2645:(Ye,O,r)=>{r.r(O),r.d(O,{AdminModule:()=>b});var c=r(1390),g=r(6895),m=r(4006),Y=r(1749),e=r(4650);class C{}C.\u0275fac=function(n){return new(n||C)},C.\u0275cmp=e.Xpm({type:C,selectors:[["admin-dashboard"]],decls:3,vars:0,template:function(n,t){1&n&&(e.TgZ(0,"strong"),e._uU(1,"TODO:"),e.qZA(),e._uU(2,"\n\u0417\u0434\u0435\u0441\u044c \u0431\u0443\u0434\u0435\u0442 \u043a\u0430\u043a\u0430\u044f-\u043d\u0438\u0431\u0443\u0434\u044c \u0441\u0432\u043e\u0434\u043d\u0430\u044f \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u0438\u043b\u0438 \u0435\u0449\u0435 \u0447\u0442\u043e-\u043d\u0438\u0442\u044c\n"))},styles:["[_nghost-%COMP%]{flex:auto;display:flex;flex-direction:column;align-items:center;justify-content:center}"]});var D=r(7579),l=r(136),A=r(8613),I=r(9108),T=r(7392);function J(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"li")(1,"a",9),e.NdJ("click",function(){const u=e.CHM(t).$implicit,p=e.oxw();return e.KtG(p.onMenuClick(u))}),e.TgZ(2,"span",10)(3,"mat-icon"),e._uU(4),e.qZA(),e._uU(5),e.qZA()()()}if(2&i){const t=n.$implicit;e.xp6(1),e.ekj("current",t.active),e.Q6J("routerLink",t.link),e.xp6(3),e.Oqu(t.icon),e.xp6(1),e.hij(" ",t.title," ")}}class Z{constructor(n,t,o){this.router=n,this.userService=t,this.authService=o,this.menuList=[],this.ngUnsubscribe=new D.x,this.userName=this.userService.getShortName()}get getClass(){return"animate__animated animate__zoomIn"}ngOnInit(){this.initMenuList(),this.selectedByUrl(this.router.url,!0),this.router.events.subscribe(n=>{n instanceof c.m2&&this.selectedByUrl(n.url)})}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}onLockScreen(){this.authService.lockScreen()}onMenuClick(n){for(const t of this.menuList)t.active=t.link===n.link;this.router.navigate([n.link])}selectedByUrl(n,t=!1){n.length>0&&"/"===n[0]&&(n=n.slice(1));for(const o of this.menuList)o.active=o.compare.test(n);t&&(this.menuList.some(o=>o.compare.test(n))||this.router.navigate(this.menuList.length>0?[this.menuList[0].link]:["/"]))}initMenuList(){const n=[];this.userService.hasPermissions(l.jE.adminDahboard)&&n.push({title:"\u0413\u043b\u0430\u0432\u043d\u0430\u044f",link:"admin",icon:"dashboard",active:!0,compare:/admin$/}),this.userService.hasPermissions([l.jE.adminUserView,l.jE.adminUserEdit])&&n.push({title:"\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0438",link:"admin/users",icon:"groups",active:!1,compare:/admin\/users/}),this.userService.hasPermissions([l.jE.adminRoleView,l.jE.adminRoleEdit])&&n.push({title:"\u0420\u043e\u043b\u0438 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439",link:"admin/roles",icon:"engineering",active:!1,compare:/admin\/roles/}),this.menuList=n}}Z.\u0275fac=function(n){return new(n||Z)(e.Y36(c.F0),e.Y36(A.K),e.Y36(I.e))},Z.\u0275cmp=e.Xpm({type:Z,selectors:[["admin-home"]],hostVars:1,hostBindings:function(n,t){2&n&&e.uIk("class",t.getClass)},decls:11,vars:2,consts:[[1,"head"],["routerLink","/",1,"logo"],[1,"flex-auto"],[1,"tabs"],[4,"ngFor","ngForOf"],[1,"user-place"],[1,"user-place__name"],["title","\u0412\u044b\u0445\u043e\u0434 \u0438\u0437 \u0441\u0438\u0441\u0442\u0435\u043c\u044b",1,"logout-button",3,"click"],[1,"content"],[3,"routerLink","click"],[1,"inside-container"]],template:function(n,t){1&n&&(e.TgZ(0,"div",0),e._UZ(1,"div",1),e.TgZ(2,"div",2)(3,"ul",3),e.YNc(4,J,6,5,"li",4),e.qZA()(),e.TgZ(5,"div",5)(6,"div",6),e._uU(7),e.qZA(),e.TgZ(8,"button",7),e.NdJ("click",function(){return t.onLockScreen()}),e.qZA()()(),e.TgZ(9,"div",8),e._UZ(10,"router-outlet"),e.qZA()),2&n&&(e.xp6(4),e.Q6J("ngForOf",t.menuList),e.xp6(3),e.hij(" ",t.userName," "))},dependencies:[g.sg,c.lC,c.rH,T.Hw],styles:['[_nghost-%COMP%]{flex:auto;display:flex;flex-direction:column;overflow:hidden;padding:10px}.head[_ngcontent-%COMP%]{position:relative;display:flex;height:48px;box-sizing:border-box;align-items:flex-end}.head[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]{position:relative;width:86px;height:42px;top:-5px;left:5px;margin-right:15px;cursor:pointer;background-color:transparent;background-position:center center;background-repeat:no-repeat;background-size:contain;background-image:url(logo.3246863ca3fff759.png)}.content[_ngcontent-%COMP%]{flex:auto;display:flex;flex-direction:column;background-color:#fff;border-radius:0 0 6px 6px;box-shadow:2px 2px 2px #0006}.tabs[_ngcontent-%COMP%]{overflow:hidden;width:100%;margin:0;padding:0;list-style:none}.tabs[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{float:left;margin:0 8px 0 0}.tabs[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{position:relative;background:#dddddd;background-image:linear-gradient(to bottom,#ffffff,#dddddd);padding:10px 15px;outline:none;float:left;text-decoration:none;color:#444;text-shadow:0 1px 0 rgba(255,255,255,.8);border-radius:5px 0 0;box-shadow:0 2px 2px #0006}.tabs[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   .inside-container[_ngcontent-%COMP%]{display:flex;align-items:center}.tabs[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   .inside-container[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{margin-right:5px}.tabs[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover, .tabs[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover:after, .tabs[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:focus, .tabs[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:focus:after{background:#ffffff}.tabs[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:after{content:"";position:absolute;z-index:1;top:0;right:-.5em;bottom:0;width:1em;background:#dddddd;background-image:linear-gradient(to bottom,#ffffff,#dddddd);box-shadow:2px 2px 2px #0006;transform:skew(10deg);border-radius:0 5px 0 0}.tabs[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a.current[_ngcontent-%COMP%]{background:#ffffff;z-index:3}.tabs[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a.current[_ngcontent-%COMP%]:after{background:#fff;z-index:3}.user-place[_ngcontent-%COMP%]{display:flex;align-items:center;padding-bottom:5px}.user-place[_ngcontent-%COMP%]   .user-place__name[_ngcontent-%COMP%]{font-weight:700;margin-right:15px}.user-place[_ngcontent-%COMP%]   .logout-button[_ngcontent-%COMP%]{width:32px;height:32px;outline:none;border:none;border-radius:16px;cursor:pointer;transition:.2s;box-shadow:2px 2px 2px #0006;background-color:transparent;background-position:center center;background-repeat:no-repeat;background-size:contain;background-image:url(logout.1a9e8ae9a251b4ad.png)}.user-place[_ngcontent-%COMP%]   .logout-button[_ngcontent-%COMP%]:hover{background-color:#0000001a}']});var f=r(8746);class M{constructor(){this.totalCount=0,this.pageSize=50,this.pageIndex=0,this.pageSizeOptions=[10,30,50,100],this.total=0,this.dataSource=[],this.updatePaginator=new D.x,this.displayedColumns=[]}get colspanTable(){return this.displayedColumns.length}getList(n){}onPageChanged(n){this.pageSize=n.pageSize,this.getList(n.pageIndex+1)}}var d=r(5805),F=r(9751),Q=r(529),B=r(7253);class x{constructor(n,t){this.httpClient=n,this.apiUrl=null,this.apiUrl=t.get("apiUrl")}postRequest(n,t={}){return new F.y(o=>{this.httpClient.post(`${this.apiUrl}/${n}`,t,{headers:{"cc-api":"OK"},observe:"response"}).subscribe({next:s=>{200===s.status&&s.body?(o.next(s.body),o.complete()):o.error(new Error(`${s.status}: ${s.statusText}`))},error:s=>o.error(s)})})}postRequestVoid(n,t={}){return new F.y(o=>{this.httpClient.post(`${this.apiUrl}/${n}`,t,{headers:{"cc-api":"OK"},observe:"response"}).subscribe({next:s=>{200===s.status?(o.next(),o.complete()):o.error(new Error(`${s.status}: ${s.statusText}`))},error:s=>o.error(s)})})}}x.\u0275fac=function(n){return new(n||x)(e.LFG(Q.eN),e.LFG(B.E4))},x.\u0275prov=e.Yz7({token:x,factory:x.\u0275fac,providedIn:"root"});class h extends x{remove(n){return this.postRequestVoid("users/remove",{id:n})}get(n){return this.postRequest("users/get",{id:n})}getList(n=0,t=-1){return this.postRequest("users/list",{page:n,pageSize:t})}save(n){return this.postRequest("users/save",n)}}h.\u0275fac=function(){let i;return function(t){return(i||(i=e.n5z(h)))(t||h)}}(),h.\u0275prov=e.Yz7({token:h,factory:h.\u0275fac,providedIn:"root"});class _ extends x{remove(n){return this.postRequestVoid("roles/remove",{id:n})}get(n){return this.postRequest("roles/get",{id:n})}getList(n=0,t=-1){return this.postRequest("roles/list",{page:n,pageSize:t})}save(n){return this.postRequest("roles/save",n)}getPermisionGroups(){return this.postRequest("roles/permisions")}}_.\u0275fac=function(){let i;return function(t){return(i||(i=e.n5z(_)))(t||_)}}(),_.\u0275prov=e.Yz7({token:_,factory:_.\u0275fac,providedIn:"root"});var k=r(1481),N=r(1206),v=r(4859),a=r(671),q=r(8739);function L(i,n){1&i&&(e.TgZ(0,"button",23)(1,"mat-icon"),e._uU(2,"add"),e.qZA(),e._uU(3," \u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0440\u043e\u043b\u044c "),e.qZA())}function H(i,n){1&i&&(e.TgZ(0,"th",24),e._uU(1,"\u041d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u0435"),e.qZA())}function z(i,n){if(1&i&&(e.TgZ(0,"td",25),e._uU(1),e.qZA()),2&i){const t=n.$implicit;e.xp6(1),e.hij(" ",t.name," ")}}function j(i,n){1&i&&(e.TgZ(0,"th",24),e._uU(1,"\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435"),e.qZA())}function $(i,n){if(1&i&&(e.TgZ(0,"td",25),e._uU(1),e.qZA()),2&i){const t=n.$implicit;e.xp6(1),e.hij(" ",t.description," ")}}function G(i,n){1&i&&(e.TgZ(0,"th",26),e._uU(1," \xa0 "),e.qZA())}function K(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"td",27)(1,"div",28)(2,"button",29),e.NdJ("click",function(s){const p=e.CHM(t).$implicit,w=e.oxw();return e.KtG(w.onRemoveRole(s,p))}),e.TgZ(3,"mat-icon"),e._uU(4,"highlight_off"),e.qZA()()()()}}function W(i,n){if(1&i&&(e.TgZ(0,"td",30)(1,"div",31),e._uU(2,"\u041d\u0435\u0442 \u0434\u0430\u043d\u043d\u044b\u0445"),e.qZA()()),2&i){const t=e.oxw();e.uIk("colspan",t.colspanTable)}}function X(i,n){1&i&&e._UZ(0,"tr",32)}const V=function(i){return{selected:i}};function ee(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"tr",33),e.NdJ("click",function(){const u=e.CHM(t).$implicit,p=e.oxw();return e.KtG(p.onSelectRow(u))}),e.qZA()}2&i&&e.Q6J("ngClass",e.VKq(1,V,n.$implicit.selected))}function te(i,n){1&i&&e._UZ(0,"tr",34)}const ne=function(){return[]},ie=function(){return["notFound"]};class U extends M{constructor(n,t,o,s,u){super(),this.router=n,this.dialogService=t,this.userService=o,this.apiRolesService=s,u.setTitle(`\u0421\u043f\u0438\u0441\u043e\u043a \u0440\u043e\u043b\u0435\u0439 | \u0410\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 | ${l.XI}`)}get canAddRole(){return this.userService.hasPermissions(l.jE.adminRoleEdit)}ngOnInit(){this.displayedColumns=this.userService.hasPermissions(l.jE.adminRoleRemove)?["name","description","buttons"]:["name","description"],this.getList(this.pageIndex)}onRemoveRole(n,t){n.stopPropagation(),this.dialogService.showConfirm("\u0412\u044b \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u0445\u043e\u0442\u0438\u0442\u0435 \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u044d\u0442\u0443 \u0440\u043e\u043b\u044c?").subscribe(o=>{o&&t.id&&(this.dialogService.showWait("\u0423\u0434\u0430\u043b\u0435\u043d\u0438\u0435..."),this.apiRolesService.remove(t.id).pipe((0,f.x)(()=>this.dialogService.hideWait())).subscribe({next:()=>{this.getList(this.pageIndex)},error:s=>this.dialogService.showToastError(s.message)}))})}onSelectRow(n){this.router.navigate(["/admin/roles",n.id])}getList(n){this.dialogService.showWait("\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u0434\u0430\u043d\u043d\u044b\u0445..."),this.apiRolesService.getList(n,this.pageSize).pipe((0,f.x)(()=>this.dialogService.hideWait())).subscribe({next:t=>{this.dataSource=t},error:t=>this.dialogService.showToastError(t.message)})}}function oe(i,n){1&i&&(e.TgZ(0,"button",24)(1,"mat-icon"),e._uU(2,"add"),e.qZA(),e._uU(3," \u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f "),e.qZA())}function se(i,n){1&i&&(e.TgZ(0,"th",25),e._uU(1,"\u0424\u0430\u043c\u0438\u043b\u0438\u044f"),e.qZA())}function ae(i,n){if(1&i&&(e.TgZ(0,"td",26),e._uU(1),e.qZA()),2&i){const t=n.$implicit;e.xp6(1),e.hij(" ",t.family," ")}}function re(i,n){1&i&&(e.TgZ(0,"th",25),e._uU(1,"\u0418\u043c\u044f"),e.qZA())}function ue(i,n){if(1&i&&(e.TgZ(0,"td",26),e._uU(1),e.qZA()),2&i){const t=n.$implicit;e.xp6(1),e.hij(" ",t.name," ")}}function le(i,n){1&i&&(e.TgZ(0,"th",25),e._uU(1,"\u041e\u0442\u0447\u0435\u0441\u0442\u0432\u043e"),e.qZA())}function ce(i,n){if(1&i&&(e.TgZ(0,"td",26),e._uU(1),e.qZA()),2&i){const t=n.$implicit;e.xp6(1),e.hij(" ",t.patronimyc," ")}}function de(i,n){1&i&&(e.TgZ(0,"th",27),e._uU(1," \xa0 "),e.qZA())}function me(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"td",28)(1,"div",29)(2,"button",30),e.NdJ("click",function(s){const p=e.CHM(t).$implicit,w=e.oxw();return e.KtG(w.onRemoveRole(s,p))}),e.TgZ(3,"mat-icon"),e._uU(4,"highlight_off"),e.qZA()()()()}}function pe(i,n){if(1&i&&(e.TgZ(0,"td",31)(1,"div",32),e._uU(2,"\u041d\u0435\u0442 \u0434\u0430\u043d\u043d\u044b\u0445"),e.qZA()()),2&i){const t=e.oxw();e.uIk("colspan",t.colspanTable)}}function ge(i,n){1&i&&e._UZ(0,"tr",33)}U.\u0275fac=function(n){return new(n||U)(e.Y36(c.F0),e.Y36(d.xA),e.Y36(A.K),e.Y36(_),e.Y36(k.Dx))},U.\u0275cmp=e.Xpm({type:U,selectors:[["admin-roles"]],features:[e.qOj],decls:27,vars:11,consts:[[1,"admin-table-head"],[1,"admin-table-head__title"],[1,"admin-table-head__subtitle"],[3,"length","pageSize","pageSizeOptions","changes","page"],[1,"admin-table-head__buttons"],["mat-raised-button","","color","primary","routerLink","add",4,"ngIf"],[1,"content"],[1,"scroll-container","content"],[1,"scroll"],["scrollElement",""],["mat-table","",1,"table",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","","cdkDrag","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","description"],["matColumnDef","buttons"],["mat-header-cell","","cdkDrag","","class","buttons-cell",4,"matHeaderCellDef"],["mat-cell","","class","buttons-cell",4,"matCellDef"],["matColumnDef","notFound"],["mat-footer-cell","",4,"matFooterCellDef"],["mat-header-row","",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","","class","table-row",3,"ngClass","click",4,"matRowDef","matRowDefColumns"],["mat-footer-row","",4,"matFooterRowDef"],["mat-raised-button","","color","primary","routerLink","add"],["mat-header-cell","","cdkDrag",""],["mat-cell",""],["mat-header-cell","","cdkDrag","",1,"buttons-cell"],["mat-cell","",1,"buttons-cell"],[1,"container","journal-buttons"],["mat-icon-button","","color","accent",3,"click"],["mat-footer-cell",""],[1,"text-center","text-danger"],["mat-header-row",""],["mat-row","",1,"table-row",3,"ngClass","click"],["mat-footer-row",""]],template:function(n,t){1&n&&(e.TgZ(0,"div",0)(1,"div",1),e._uU(2,"\u0421\u043f\u0438\u0441\u043e\u043a \u0440\u043e\u043b\u0435\u0439"),e.qZA(),e.TgZ(3,"div",2),e._uU(4,"\xa0"),e.qZA(),e.TgZ(5,"mat-paginator",3),e.NdJ("changes",function(){return t.updatePaginator})("page",function(s){return t.onPageChanged(s)}),e.qZA(),e.TgZ(6,"div",4),e.YNc(7,L,4,0,"button",5),e.qZA()(),e.TgZ(8,"div",6)(9,"div",7)(10,"div",8,9)(12,"table",10),e.ynx(13,11),e.YNc(14,H,2,0,"th",12),e.YNc(15,z,2,1,"td",13),e.BQk(),e.ynx(16,14),e.YNc(17,j,2,0,"th",12),e.YNc(18,$,2,1,"td",13),e.BQk(),e.ynx(19,15),e.YNc(20,G,2,0,"th",16),e.YNc(21,K,5,0,"td",17),e.BQk(),e.ynx(22,18),e.YNc(23,W,3,1,"td",19),e.BQk(),e.YNc(24,X,1,0,"tr",20),e.YNc(25,ee,1,3,"tr",21),e.YNc(26,te,1,0,"tr",22),e.qZA()()()()),2&n&&(e.xp6(5),e.Q6J("length",t.totalCount)("pageSize",t.pageSize)("pageSizeOptions",t.pageSizeOptions),e.xp6(2),e.Q6J("ngIf",t.canAddRole),e.xp6(5),e.Q6J("dataSource",t.dataSource),e.xp6(12),e.Q6J("matHeaderRowDef",t.displayedColumns)("matHeaderRowDefSticky",!0),e.xp6(1),e.Q6J("matRowDefColumns",t.displayedColumns),e.xp6(1),e.Q6J("matFooterRowDef",t.dataSource&&t.dataSource.length?e.DdM(9,ne):e.DdM(10,ie)))},dependencies:[g.mk,g.O5,c.rH,T.Hw,N.Zt,v.lW,v.RK,a.BZ,a.fO,a.as,a.w1,a.Dz,a.nj,a.mD,a.Ke,a.ge,a.ev,a.yh,a.XQ,a.Gk,a.Q2,q.NW],styles:["[_nghost-%COMP%]{flex:auto;display:flex;flex-direction:column}.content[_ngcontent-%COMP%]{flex:auto;display:flex;flex-direction:column;padding:0 10px}"]});const _e=function(i){return{selected:i}};function fe(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"tr",34),e.NdJ("click",function(){const u=e.CHM(t).$implicit,p=e.oxw();return e.KtG(p.onSelectRow(u))}),e.qZA()}2&i&&e.Q6J("ngClass",e.VKq(1,_e,n.$implicit.selected))}function he(i,n){1&i&&e._UZ(0,"tr",35)}const xe=function(){return[]},ve=function(){return["notFound"]};class S extends M{constructor(n,t,o,s,u){super(),this.router=n,this.dialogService=t,this.userService=o,this.apiUsersService=s,u.setTitle(`\u0421\u043f\u0438\u0441\u043e\u043a \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439 | \u0410\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 | ${l.XI}`)}get canAddUser(){return this.userService.hasPermissions(l.jE.adminUserEdit)}ngOnInit(){this.displayedColumns=this.userService.hasPermissions(l.jE.adminUserRemove)?["family","name","patronimyc","buttons"]:["family","name","patronimyc"],this.getList(this.pageIndex)}onRemoveRole(n,t){n.stopPropagation(),this.dialogService.showConfirm("\u0412\u044b \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u0445\u043e\u0442\u0438\u0442\u0435 \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u044d\u0442\u0443 \u0440\u043e\u043b\u044c?").subscribe(o=>{o&&t.id&&(this.dialogService.showWait("\u0423\u0434\u0430\u043b\u0435\u043d\u0438\u0435..."),this.apiUsersService.remove(t.id).pipe((0,f.x)(()=>this.dialogService.hideWait())).subscribe({next:()=>{this.getList(this.pageIndex)},error:s=>this.dialogService.showToastError(s.message)}))})}onSelectRow(n){this.router.navigate(["/admin/users",n.id])}getList(n){this.dialogService.showWait("\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u0434\u0430\u043d\u043d\u044b\u0445..."),this.apiUsersService.getList(n,this.pageSize).pipe((0,f.x)(()=>this.dialogService.hideWait())).subscribe({next:t=>{this.dataSource=t},error:t=>this.dialogService.showToastError(t.message)})}}S.\u0275fac=function(n){return new(n||S)(e.Y36(c.F0),e.Y36(d.xA),e.Y36(A.K),e.Y36(h),e.Y36(k.Dx))},S.\u0275cmp=e.Xpm({type:S,selectors:[["admin-users"]],features:[e.qOj],decls:30,vars:11,consts:[[1,"admin-table-head"],[1,"admin-table-head__title"],[1,"admin-table-head__subtitle"],[3,"length","pageSize","pageSizeOptions","changes","page"],[1,"admin-table-head__buttons"],["mat-raised-button","","color","primary","routerLink","add",4,"ngIf"],[1,"content"],[1,"scroll-container"],[1,"scroll"],["scrollElement",""],["mat-table","",1,"table",3,"dataSource"],["matColumnDef","family"],["mat-header-cell","","cdkDrag","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","name"],["matColumnDef","patronimyc"],["matColumnDef","buttons"],["mat-header-cell","","cdkDrag","","class","buttons-cell",4,"matHeaderCellDef"],["mat-cell","","class","buttons-cell",4,"matCellDef"],["matColumnDef","notFound"],["mat-footer-cell","",4,"matFooterCellDef"],["mat-header-row","",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","","class","table-row",3,"ngClass","click",4,"matRowDef","matRowDefColumns"],["mat-footer-row","",4,"matFooterRowDef"],["mat-raised-button","","color","primary","routerLink","add"],["mat-header-cell","","cdkDrag",""],["mat-cell",""],["mat-header-cell","","cdkDrag","",1,"buttons-cell"],["mat-cell","",1,"buttons-cell"],[1,"container","journal-buttons"],["mat-icon-button","","color","accent",3,"click"],["mat-footer-cell",""],[1,"text-center","text-danger"],["mat-header-row",""],["mat-row","",1,"table-row",3,"ngClass","click"],["mat-footer-row",""]],template:function(n,t){1&n&&(e.TgZ(0,"div",0)(1,"div",1),e._uU(2,"\u0421\u043f\u0438\u0441\u043e\u043a \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439"),e.qZA(),e.TgZ(3,"div",2),e._uU(4,"\xa0"),e.qZA(),e.TgZ(5,"mat-paginator",3),e.NdJ("changes",function(){return t.updatePaginator})("page",function(s){return t.onPageChanged(s)}),e.qZA(),e.TgZ(6,"div",4),e.YNc(7,oe,4,0,"button",5),e.qZA()(),e.TgZ(8,"div",6)(9,"div",7)(10,"div",8,9)(12,"table",10),e.ynx(13,11),e.YNc(14,se,2,0,"th",12),e.YNc(15,ae,2,1,"td",13),e.BQk(),e.ynx(16,14),e.YNc(17,re,2,0,"th",12),e.YNc(18,ue,2,1,"td",13),e.BQk(),e.ynx(19,15),e.YNc(20,le,2,0,"th",12),e.YNc(21,ce,2,1,"td",13),e.BQk(),e.ynx(22,16),e.YNc(23,de,2,0,"th",17),e.YNc(24,me,5,0,"td",18),e.BQk(),e.ynx(25,19),e.YNc(26,pe,3,1,"td",20),e.BQk(),e.YNc(27,ge,1,0,"tr",21),e.YNc(28,fe,1,3,"tr",22),e.YNc(29,he,1,0,"tr",23),e.qZA()()()()),2&n&&(e.xp6(5),e.Q6J("length",t.totalCount)("pageSize",t.pageSize)("pageSizeOptions",t.pageSizeOptions),e.xp6(2),e.Q6J("ngIf",t.canAddUser),e.xp6(5),e.Q6J("dataSource",t.dataSource),e.xp6(15),e.Q6J("matHeaderRowDef",t.displayedColumns)("matHeaderRowDefSticky",!0),e.xp6(1),e.Q6J("matRowDefColumns",t.displayedColumns),e.xp6(1),e.Q6J("matFooterRowDef",t.dataSource&&t.dataSource.length?e.DdM(9,xe):e.DdM(10,ve)))},dependencies:[g.mk,g.O5,c.rH,T.Hw,N.Zt,v.lW,v.RK,a.BZ,a.fO,a.as,a.w1,a.Dz,a.nj,a.mD,a.Ke,a.ge,a.ev,a.yh,a.XQ,a.Gk,a.Q2,q.NW],styles:["[_nghost-%COMP%]{flex:auto;display:flex;flex-direction:column}.content[_ngcontent-%COMP%]{flex:auto;display:flex;flex-direction:column;padding:0 10px}"]});var E=r(2722),P=r(7084);function be(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"button",9),e.NdJ("click",function(){e.CHM(t);const s=e.oxw();return e.KtG(s.onSave())}),e.TgZ(1,"mat-icon"),e._uU(2,"save"),e.qZA(),e._uU(3," \u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c "),e.qZA()}if(2&i){const t=e.oxw();e.Q6J("disabled",t.savedState)}}function Ce(i,n){1&i&&(e.TgZ(0,"div",10),e._uU(1,"\u0420\u043e\u043b\u044c \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u0430"),e.qZA())}function Ae(i,n){1&i&&(e.TgZ(0,"div",11),e._uU(1,"\u0414\u043e\u0441\u0442\u0443\u043f \u0437\u0430\u043f\u0440\u0435\u0449\u0435\u043d"),e.qZA())}function Te(i,n){1&i&&(e.TgZ(0,"div",26),e._uU(1," \u041d\u0435\u0442 \u0440\u0430\u0437\u0440\u0435\u0448\u0435\u043d\u0438\u0439 "),e.qZA())}function Ze(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"button",31),e.NdJ("click",function(){e.CHM(t);const s=e.oxw(2).$implicit,u=e.oxw(3);return e.KtG(u.onMovePermission(s,u.availablePermissions))}),e.TgZ(1,"mat-icon"),e._uU(2,"highlight_off"),e.qZA()()}}function Ue(i,n){if(1&i&&(e.TgZ(0,"div",28)(1,"div",29),e._uU(2),e.qZA(),e.YNc(3,Ze,3,0,"button",30),e.qZA()),2&i){const t=e.oxw().$implicit,o=e.oxw(3);e.xp6(2),e.Oqu(t.name),e.xp6(1),e.Q6J("ngIf",o.canEditRole)}}function Se(i,n){if(1&i&&(e.ynx(0),e.YNc(1,Ue,4,2,"div",27),e.BQk()),2&i){const t=n.$implicit;e.xp6(1),e.Q6J("ngIf",t.visible)}}function Ee(i,n){if(1&i&&(e.TgZ(0,"mat-expansion-panel",22)(1,"mat-expansion-panel-header")(2,"mat-panel-title"),e._uU(3),e.qZA()(),e.TgZ(4,"div",23),e.YNc(5,Te,2,0,"div",24),e.YNc(6,Se,2,1,"ng-container",25),e.qZA()()),2&i){const t=n.$implicit,o=e.oxw(2);e.Q6J("expanded",t.expanded),e.xp6(3),e.hij(" ",t.name," "),e.xp6(2),e.Q6J("ngIf",!o.hasVisiblePermissions(t.permissions)),e.xp6(1),e.Q6J("ngForOf",t.permissions)}}function Re(i,n){1&i&&(e.TgZ(0,"div",26),e._uU(1," \u041d\u0435\u0442 \u0440\u0430\u0437\u0440\u0435\u0448\u0435\u043d\u0438\u0439 "),e.qZA())}function ye(i,n){1&i&&(e.TgZ(0,"mat-icon",35),e._uU(1," add_circle_outline "),e.qZA())}function we(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",33),e.NdJ("click",function(){e.CHM(t);const s=e.oxw().$implicit,u=e.oxw(3);return e.KtG(u.onMovePermission(s,u.rolePermissions))}),e.YNc(1,ye,2,0,"mat-icon",34),e.TgZ(2,"div",29),e._uU(3),e.qZA()()}if(2&i){const t=e.oxw().$implicit,o=e.oxw(3);e.xp6(1),e.Q6J("ngIf",o.canEditRole),e.xp6(2),e.Oqu(t.name)}}function De(i,n){if(1&i&&(e.ynx(0),e.YNc(1,we,4,2,"div",32),e.BQk()),2&i){const t=n.$implicit;e.xp6(1),e.Q6J("ngIf",t.visible)}}function ke(i,n){if(1&i&&(e.TgZ(0,"mat-expansion-panel",22)(1,"mat-expansion-panel-header")(2,"mat-panel-title"),e._uU(3),e.qZA()(),e.TgZ(4,"div",23),e.YNc(5,Re,2,0,"div",24),e.YNc(6,De,2,1,"ng-container",25),e.qZA()()),2&i){const t=n.$implicit,o=e.oxw(2);e.Q6J("expanded",t.expanded),e.xp6(3),e.hij(" ",t.name," "),e.xp6(2),e.Q6J("ngIf",!o.hasVisiblePermissions(t.permissions)),e.xp6(1),e.Q6J("ngForOf",t.permissions)}}function Pe(i,n){if(1&i&&(e.TgZ(0,"div",12)(1,"div",13)(2,"div"),e._UZ(3,"kui-input",14),e.qZA(),e.TgZ(4,"div",15),e._uU(5,"\u0420\u0430\u0437\u0440\u0435\u0448\u0435\u043d\u0438\u044f \u0434\u043b\u044f \u0440\u043e\u043b\u0438"),e.qZA(),e.TgZ(6,"div",16)(7,"div",17)(8,"mat-accordion",18),e.YNc(9,Ee,7,4,"mat-expansion-panel",19),e.qZA()()()(),e.TgZ(10,"div",20)(11,"div"),e._UZ(12,"kui-input",21),e.qZA(),e.TgZ(13,"div",15),e._uU(14,"\u0414\u043e\u0441\u0442\u0443\u043f\u043d\u044b\u0435 \u0440\u0430\u0437\u0440\u0435\u0448\u0435\u043d\u0438\u044f"),e.qZA(),e.TgZ(15,"div",16)(16,"div",17)(17,"mat-accordion",18),e.YNc(18,ke,7,4,"mat-expansion-panel",19),e.qZA()()()()()),2&i){const t=e.oxw();e.xp6(3),e.Q6J("formControl",t.controlName)("readonly",!t.canEditRole),e.xp6(6),e.Q6J("ngForOf",t.rolePermissions),e.xp6(3),e.Q6J("formControl",t.controlDesc)("readonly",!t.canEditRole),e.xp6(6),e.Q6J("ngForOf",t.availablePermissions)}}class R{constructor(n,t,o,s,u,p){this.titleService=n,this.router=t,this.activatedRoute=o,this.dialogService=s,this.apiRolesService=u,this.userService=p,this.rolePermissions=[],this.availablePermissions=[],this.controlName=new d.jn(null,m.kI.required),this.controlDesc=new d.jn(null),this.savedState=!0,this.is404=!1,this.isForbidden=!1,this.subTitle="",this.ngUnsubscribe=new D.x,this.roleId=null,this.rolePermissionsDef=[]}get canEditRole(){return this.userService.hasPermissions(l.jE.adminRoleEdit)}ngOnInit(){this.controlName.valueChanges.pipe((0,E.R)(this.ngUnsubscribe)).subscribe(()=>this.savedState=!1),this.controlDesc.valueChanges.pipe((0,E.R)(this.ngUnsubscribe)).subscribe(()=>this.savedState=!1),this.activatedRoute.paramMap.pipe((0,E.R)(this.ngUnsubscribe)).subscribe(n=>{const t=n.get("id");"add"===t?(this.roleId=null,this.titleService.setTitle(`\u041d\u043e\u0432\u0430\u044f \u0440\u043e\u043b\u044c | \u0421\u043f\u0438\u0441\u043e\u043a \u0440\u043e\u043b\u0435\u0439 | \u0410\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 | ${l.XI}`),this.subTitle="&nbsp;&#10148;&nbsp;\u041d\u043e\u0432\u0430\u044f \u0440\u043e\u043b\u044c",this.canEditRole||(this.isForbidden=!0),this.updatePermisionGroups()):t?this.getRole(+t):this.is404=!0})}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}onSave(){if(!this.controlName.valid)return void this.controlName.markAsTouched();this.dialogService.showWait("\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435...");const n=[];this.rolePermissions.forEach(t=>{t.permissions.forEach(o=>{o.visible&&n.push(o.id)})}),this.apiRolesService.save({id:this.roleId,name:this.controlName.value,description:this.controlDesc.value,permissions:n}).pipe((0,f.x)(()=>this.dialogService.hideWait())).subscribe({next:t=>{null===this.roleId&&this.router.navigate(["/admin/roles",t.id]),this.savedState=!0},error:t=>{this.dialogService.showToastError(t.message)}})}onMovePermission(n,t){if(!this.canEditRole)return;const o=t.find(s=>s.id===n.moduleId);if(o){o.expanded=!0;const s=o.permissions.find(u=>u.id===n.id);s&&(s.visible=!0,n.visible=!1,this.savedState=!1)}}hasVisiblePermissions(n){return n.some(t=>t.visible)}updatePermisionGroups(){this.apiRolesService.getPermisionGroups().subscribe({next:n=>{this.availablePermissions=n.map(t=>({id:t.id,name:t.name,expanded:!1,permissions:t.permissions.map(o=>({...o,visible:!this.rolePermissionsDef.includes(o.id)}))})),this.rolePermissions=n.map(t=>({id:t.id,name:t.name,expanded:!1,permissions:t.permissions.map(o=>({...o,visible:this.rolePermissionsDef.includes(o.id)}))}))},error:()=>{this.availablePermissions=[]}})}getRole(n){this.titleService.setTitle(`\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0440\u043e\u043b\u0438 | \u0421\u043f\u0438\u0441\u043e\u043a \u0440\u043e\u043b\u0435\u0439 | \u0410\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 | ${l.XI}`),this.subTitle="&nbsp;&#10148;&nbsp;\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0440\u043e\u043b\u0438",this.dialogService.showWait("\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u0434\u0430\u043d\u043d\u044b\u0445..."),this.apiRolesService.get(n).pipe((0,f.x)(()=>this.dialogService.hideWait())).subscribe({next:t=>{this.controlName.setValue(t.name),this.controlDesc.setValue(t.description),this.roleId=Number(t.id),this.rolePermissionsDef=t.permissions,this.savedState=!0,this.updatePermisionGroups()},error:t=>{this.rolePermissionsDef=[],this.dialogService.showToastError(t.message),this.is404=!0,this.roleId=null}})}}function Oe(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"button",9),e.NdJ("click",function(){e.CHM(t);const s=e.oxw();return e.KtG(s.onSave())}),e.TgZ(1,"mat-icon"),e._uU(2,"save"),e.qZA(),e._uU(3," \u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c "),e.qZA()}if(2&i){const t=e.oxw();e.Q6J("disabled",t.savedState)}}function Me(i,n){1&i&&(e.TgZ(0,"div",10),e._uU(1,"\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d"),e.qZA())}function Fe(i,n){1&i&&(e.TgZ(0,"div",11),e._uU(1,"\u0414\u043e\u0441\u0442\u0443\u043f \u0437\u0430\u043f\u0440\u0435\u0449\u0435\u043d"),e.qZA())}function Ne(i,n){if(1&i&&(e.TgZ(0,"div",12)(1,"div",13)(2,"div",14),e._UZ(3,"kui-input",15),e.qZA(),e.TgZ(4,"div",16),e._UZ(5,"kui-input",17),e.qZA(),e.TgZ(6,"div",16),e._UZ(7,"kui-input",18),e.qZA()(),e.TgZ(8,"div",13)(9,"div",14),e._UZ(10,"kui-select",19),e.qZA(),e.TgZ(11,"div",20),e._UZ(12,"kui-input",21),e.qZA()()()),2&i){const t=e.oxw();e.xp6(3),e.Q6J("readonly",!t.canEditUser),e.xp6(2),e.Q6J("readonly",!t.canEditUser),e.xp6(2),e.Q6J("readonly",!t.canEditUser),e.xp6(3),e.Q6J("multiple",!0)("options",t.rolesList)("readonly",!t.canEditUser),e.xp6(2),e.Q6J("readonly",!t.canEditUser)}}R.\u0275fac=function(n){return new(n||R)(e.Y36(k.Dx),e.Y36(c.F0),e.Y36(c.gz),e.Y36(d.xA),e.Y36(_),e.Y36(A.K))},R.\u0275cmp=e.Xpm({type:R,selectors:[["admin-role-edit"]],decls:10,vars:5,consts:[[1,"admin-table-head"],["routerLink","/admin/roles",1,"admin-table-head__title","admin-table-head__title--link"],[1,"admin-table-head__subtitle",3,"innerHTML"],[1,"admin-table-head__buttons"],["mat-raised-button","","color","success",3,"disabled","click",4,"ngIf"],[1,"content"],["class","alert-message warning",4,"ngIf"],["class","alert-message danger",4,"ngIf"],["class","flex-row flex-auto",4,"ngIf"],["mat-raised-button","","color","success",3,"disabled","click"],[1,"alert-message","warning"],[1,"alert-message","danger"],[1,"flex-row","flex-auto"],[1,"side-container"],["label","\u041d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u0435",3,"formControl","readonly"],[1,"text-center","text-bold"],[1,"scroll-container","mt-10"],[1,"scroll"],[1,"mt-10"],[3,"expanded",4,"ngFor","ngForOf"],[1,"side-container","ml-10"],["label","\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435",3,"formControl","readonly"],[3,"expanded"],[1,"roles-list"],["class","text-center text-danger mt-10 mb-10",4,"ngIf"],[4,"ngFor","ngForOf"],[1,"text-center","text-danger","mt-10","mb-10"],["class","roles-list__item",4,"ngIf"],[1,"roles-list__item"],[1,"roles-list__title"],["mat-icon-button","","color","accent",3,"click",4,"ngIf"],["mat-icon-button","","color","accent",3,"click"],["class","roles-list__item cursor-pointer",3,"click",4,"ngIf"],[1,"roles-list__item","cursor-pointer",3,"click"],["color","success",4,"ngIf"],["color","success"]],template:function(n,t){1&n&&(e.TgZ(0,"div",0)(1,"div",1),e._uU(2," \u0421\u043f\u0438\u0441\u043e\u043a \u0440\u043e\u043b\u0435\u0439 "),e.qZA(),e._UZ(3,"div",2),e.TgZ(4,"div",3),e.YNc(5,be,4,1,"button",4),e.qZA()(),e.TgZ(6,"div",5),e.YNc(7,Ce,2,0,"div",6),e.YNc(8,Ae,2,0,"div",7),e.YNc(9,Pe,19,6,"div",8),e.qZA()),2&n&&(e.xp6(3),e.Q6J("innerHTML",t.subTitle,e.oJD),e.xp6(2),e.Q6J("ngIf",!t.is404&&t.canEditRole),e.xp6(2),e.Q6J("ngIf",t.is404),e.xp6(1),e.Q6J("ngIf",t.isForbidden),e.xp6(1),e.Q6J("ngIf",!t.is404&&!t.isForbidden))},dependencies:[g.sg,g.O5,m.JJ,m.oH,c.rH,d.y0,T.Hw,v.lW,v.RK,P.pp,P.ib,P.yz,P.yK],styles:["[_nghost-%COMP%]{flex:auto;display:flex;flex-direction:column}[_nghost-%COMP%]  .mat-expansion-panel-body{padding:0!important}.content[_ngcontent-%COMP%]{flex:auto;display:flex;flex-direction:column;padding:10px}.side-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:50%}.roles-list[_ngcontent-%COMP%]{display:flex;flex-direction:column}.roles-list[_ngcontent-%COMP%]   .roles-list__item[_ngcontent-%COMP%]{display:flex;align-items:center;padding:0 10px;height:32px}.roles-list[_ngcontent-%COMP%]   .roles-list__item[_ngcontent-%COMP%]:hover{background-color:#d6e6fc}.roles-list[_ngcontent-%COMP%]   .roles-list__title[_ngcontent-%COMP%]{flex:auto;padding:0 10px}"]});class y{constructor(n,t,o,s,u,p,w){this.titleService=n,this.router=t,this.activatedRoute=o,this.dialogService=s,this.apiRolesService=u,this.apiUsersService=p,this.userService=w,this.subTitle="",this.is404=!1,this.isForbidden=!1,this.rolesList=[],this.savedState=!0,this.formGroup=new m.cw({family:new d.jn(null),name:new d.jn(null,m.kI.required),patronimyc:new d.jn(null),roles:new d.jn(null),pinCode:new d.jn(null,m.kI.required)}),this.ngUnsubscribe=new D.x,this.userId=null}get canEditUser(){return this.userService.hasPermissions(l.jE.adminUserEdit)}ngOnInit(){this.apiRolesService.getList().subscribe({next:n=>{this.rolesList=(n||[]).map(t=>({value:t.id,title:t.name}))},error:()=>{}}),this.formGroup.valueChanges.pipe((0,E.R)(this.ngUnsubscribe)).subscribe(()=>this.savedState=!1),this.activatedRoute.paramMap.pipe((0,E.R)(this.ngUnsubscribe)).subscribe(n=>{const t=n.get("id");"add"===t?(this.titleService.setTitle(`\u041d\u043e\u0432\u044b\u0439 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c | \u0421\u043f\u0438\u0441\u043e\u043a \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439 | \u0410\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 | ${l.XI}`),this.subTitle="&nbsp;&#10148;&nbsp;\u041d\u043e\u0432\u044b\u0439 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c",this.canEditUser||(this.isForbidden=!0)):t?this.getUser(+t):this.is404=!0})}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}onSave(){if(!this.formGroup.valid)return void this.formGroup.markAllAsTouched();this.dialogService.showWait("\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435...");const n={id:this.userId,...this.formGroup.value};this.apiUsersService.save(n).pipe((0,f.x)(()=>this.dialogService.hideWait())).subscribe({next:t=>{null===this.userId&&this.router.navigate(["/admin/users",t.id]),this.savedState=!0},error:t=>{this.dialogService.showToastError(t.message)}})}getUser(n){this.titleService.setTitle(`\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f | \u0421\u043f\u0438\u0441\u043e\u043a \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439 | \u0410\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 | ${l.XI}`),this.subTitle="&nbsp;&#10148;&nbsp;\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f",this.dialogService.showWait("\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u0434\u0430\u043d\u043d\u044b\u0445..."),this.apiUsersService.get(n).pipe((0,f.x)(()=>this.dialogService.hideWait())).subscribe({next:t=>{this.formGroup.patchValue(t),this.userId=Number(t.id),this.savedState=!0},error:t=>{this.dialogService.showToastError(t.message),this.is404=!0,this.userId=null}})}}y.\u0275fac=function(n){return new(n||y)(e.Y36(k.Dx),e.Y36(c.F0),e.Y36(c.gz),e.Y36(d.xA),e.Y36(_),e.Y36(h),e.Y36(A.K))},y.\u0275cmp=e.Xpm({type:y,selectors:[["admin-user-edit"]],decls:10,vars:6,consts:[[1,"admin-table-head"],["routerLink","/admin/users",1,"admin-table-head__title","admin-table-head__title--link"],[1,"admin-table-head__subtitle",3,"innerHTML"],[1,"admin-table-head__buttons"],["mat-raised-button","","color","success",3,"disabled","click",4,"ngIf"],[1,"content",3,"formGroup"],["class","alert-message warning",4,"ngIf"],["class","alert-message danger",4,"ngIf"],["class","flex-col flex-auto",4,"ngIf"],["mat-raised-button","","color","success",3,"disabled","click"],[1,"alert-message","warning"],[1,"alert-message","danger"],[1,"flex-col","flex-auto"],[1,"flex-row"],[1,"flex-auto"],["label","\u0424\u0430\u043c\u0438\u043b\u0438\u044f","formControlName","family",3,"readonly"],[1,"flex-auto","ml-10"],["label","\u0418\u043c\u044f","formControlName","name",3,"readonly"],["label","\u041e\u0442\u0447\u0435\u0441\u0442\u0432\u043e","formControlName","patronimyc",3,"readonly"],["label","\u0420\u043e\u043b\u0438 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f","formControlName","roles",3,"multiple","options","readonly"],[1,"ml-10"],["label","PIN-\u043a\u043e\u0434","mask","number","formControlName","pinCode","maxlength","6",3,"readonly"]],template:function(n,t){1&n&&(e.TgZ(0,"div",0)(1,"div",1),e._uU(2," \u0421\u043f\u0438\u0441\u043e\u043a \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439 "),e.qZA(),e._UZ(3,"div",2),e.TgZ(4,"div",3),e.YNc(5,Oe,4,1,"button",4),e.qZA()(),e.TgZ(6,"div",5),e.YNc(7,Me,2,0,"div",6),e.YNc(8,Fe,2,0,"div",7),e.YNc(9,Ne,13,7,"div",8),e.qZA()),2&n&&(e.xp6(3),e.Q6J("innerHTML",t.subTitle,e.oJD),e.xp6(2),e.Q6J("ngIf",!t.is404&&t.canEditUser),e.xp6(1),e.Q6J("formGroup",t.formGroup),e.xp6(1),e.Q6J("ngIf",t.is404),e.xp6(1),e.Q6J("ngIf",t.isForbidden),e.xp6(1),e.Q6J("ngIf",!t.is404&&!t.isForbidden))},dependencies:[g.O5,m.JJ,m.JL,m.nD,m.sg,m.u,c.rH,d.y0,d.os,T.Hw,v.lW],styles:["[_nghost-%COMP%]{flex:auto;display:flex;flex-direction:column}.content[_ngcontent-%COMP%]{flex:auto;display:flex;flex-direction:column;padding:10px}"]});const qe=[{path:"",component:Z,children:[{path:"",component:C},{path:"users/:id",component:y},{path:"users",component:S},{path:"roles/:id",component:R},{path:"roles",component:U}]}];class b{}b.\u0275fac=function(n){return new(n||b)},b.\u0275mod=e.oAB({type:b}),b.\u0275inj=e.cJS({imports:[g.ez,m.u5,m.UX,c.Bz.forChild(qe),Y.m]})}}]);