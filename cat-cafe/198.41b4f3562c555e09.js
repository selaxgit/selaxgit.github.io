"use strict";(self.webpackChunkcat_cafe=self.webpackChunkcat_cafe||[]).push([[198],{8198:(it,M,u)=>{u.r(M),u.d(M,{ConfigModule:()=>T});var d=u(1390),f=u(6895),m=u(4006),F=u(5141),k=u(7579),l=u(136),e=u(4650),C=u(7253),v=u(1481),b=u(7392);function I(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"li")(1,"a",9),e.NdJ("click",function(){const r=e.CHM(t).$implicit,c=e.oxw();return e.KtG(c.onMenuClick(r))}),e.TgZ(2,"span",10)(3,"mat-icon"),e._uU(4),e.qZA(),e._uU(5),e.qZA()()()}if(2&n){const t=i.$implicit;e.xp6(1),e.ekj("current",t.active),e.Q6J("routerLink",t.link),e.xp6(3),e.Oqu(t.icon),e.xp6(1),e.hij(" ",t.title," ")}}class D{constructor(i,t,o,s){this.router=i,this.userService=t,this.authService=o,this.menuList=[],this.ngUnsubscribe=new k.x,s.setTitle(`\u0410\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 | ${l.XI}`),this.userName=this.userService.getShortName()}get getClass(){return"animate__animated animate__zoomIn"}ngOnInit(){this.initMenuList(),this.selectedByUrl(this.router.url,!0),this.router.events.subscribe(i=>{i instanceof d.m2&&this.selectedByUrl(i.url)})}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}onLockScreen(){this.authService.lockScreen()}onMenuClick(i){for(const t of this.menuList)t.active=t.link===i.link;this.router.navigate([i.link])}selectedByUrl(i,t=!1){i.length>0&&"/"===i[0]&&(i=i.slice(1));for(const o of this.menuList)o.active=o.compare.test(i);t&&(this.menuList.some(o=>o.compare.test(i))||this.router.navigate(this.menuList.length>0?[this.menuList[0].link]:["/"]))}initMenuList(){const i=[];this.userService.hasPermissions([l.jE.configDictionariesView,l.jE.configDictionariesEdit])&&i.push({title:"\u0421\u043f\u0440\u0430\u0432\u043e\u0447\u043d\u0438\u043a\u0438",link:"config/dictionaries",icon:"receipt",active:!1,compare:/config\/dictionaries/}),this.userService.hasPermissions([l.jE.configUserView,l.jE.configUserEdit])&&i.push({title:"\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0438",link:"config/users",icon:"groups",active:!1,compare:/config\/users/}),this.userService.hasPermissions([l.jE.configRoleView,l.jE.configRoleEdit])&&i.push({title:"\u0420\u043e\u043b\u0438 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439",link:"config/roles",icon:"engineering",active:!1,compare:/config\/roles/}),this.menuList=i}}D.\u0275fac=function(i){return new(i||D)(e.Y36(d.F0),e.Y36(C.KD),e.Y36(C.e8),e.Y36(v.Dx))},D.\u0275cmp=e.Xpm({type:D,selectors:[["config-home"]],hostVars:1,hostBindings:function(i,t){2&i&&e.uIk("class",t.getClass)},decls:11,vars:2,consts:[[1,"head"],["routerLink","/",1,"logo"],[1,"flex-auto"],[1,"tabs"],[4,"ngFor","ngForOf"],[1,"user-place"],[1,"user-place__name"],["title","\u0412\u044b\u0445\u043e\u0434 \u0438\u0437 \u0441\u0438\u0441\u0442\u0435\u043c\u044b",1,"logout-button",3,"click"],[1,"content"],[3,"routerLink","click"],[1,"inside-container"]],template:function(i,t){1&i&&(e.TgZ(0,"div",0),e._UZ(1,"div",1),e.TgZ(2,"div",2)(3,"ul",3),e.YNc(4,I,6,5,"li",4),e.qZA()(),e.TgZ(5,"div",5)(6,"div",6),e._uU(7),e.qZA(),e.TgZ(8,"button",7),e.NdJ("click",function(){return t.onLockScreen()}),e.qZA()()(),e.TgZ(9,"div",8),e._UZ(10,"router-outlet"),e.qZA()),2&i&&(e.xp6(4),e.Q6J("ngForOf",t.menuList),e.xp6(3),e.hij(" ",t.userName," "))},dependencies:[f.sg,d.lC,d.rH,b.Hw],styles:['[_nghost-%COMP%]{flex:auto;display:flex;flex-direction:column;overflow:hidden;padding:10px}.head[_ngcontent-%COMP%]{position:relative;display:flex;height:48px;box-sizing:border-box;align-items:flex-end}.head[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]{position:relative;width:86px;height:42px;top:-5px;left:5px;margin-right:15px;cursor:pointer;background-color:transparent;background-position:center center;background-repeat:no-repeat;background-size:contain;background-image:url(logo.3246863ca3fff759.png)}.content[_ngcontent-%COMP%]{flex:auto;display:flex;flex-direction:column;background-color:#fff;border-radius:0 0 6px 6px;box-shadow:2px 2px 2px #0006}.tabs[_ngcontent-%COMP%]{overflow:hidden;width:100%;margin:0;padding:0;list-style:none}.tabs[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{float:left;margin:0 8px 0 0}.tabs[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{position:relative;background:#dddddd;background-image:linear-gradient(to bottom,#ffffff,#dddddd);padding:10px 15px;outline:none;float:left;text-decoration:none;color:#444;text-shadow:0 1px 0 rgba(255,255,255,.8);border-radius:5px 0 0;box-shadow:0 2px 2px #0006}.tabs[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   .inside-container[_ngcontent-%COMP%]{display:flex;align-items:center}.tabs[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   .inside-container[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{margin-right:5px}.tabs[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover, .tabs[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover:after, .tabs[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:focus, .tabs[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:focus:after{background:#ffffff}.tabs[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:after{content:"";position:absolute;z-index:1;top:0;right:-.5em;bottom:0;width:1em;background:#dddddd;background-image:linear-gradient(to bottom,#ffffff,#dddddd);box-shadow:2px 2px 2px #0006;transform:skew(10deg);border-radius:0 5px 0 0}.tabs[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a.current[_ngcontent-%COMP%]{background:#ffffff;z-index:3}.tabs[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a.current[_ngcontent-%COMP%]:after{background:#fff;z-index:3}.user-place[_ngcontent-%COMP%]{display:flex;align-items:center;padding-bottom:5px}.user-place[_ngcontent-%COMP%]   .user-place__name[_ngcontent-%COMP%]{font-weight:700;margin-right:15px}.user-place[_ngcontent-%COMP%]   .logout-button[_ngcontent-%COMP%]{width:32px;height:32px;outline:none;border:none;border-radius:16px;cursor:pointer;transition:.2s;box-shadow:2px 2px 2px #0006;background-color:transparent;background-position:center center;background-repeat:no-repeat;background-size:contain;background-image:url(logout.1a9e8ae9a251b4ad.png)}.user-place[_ngcontent-%COMP%]   .logout-button[_ngcontent-%COMP%]:hover{background-color:#0000001a}']});var g=u(8746),A=u(4130),p=u(3448),Z=u(2173),_=u(4859),a=u(671),N=u(8739);function Y(n,i){1&n&&(e.TgZ(0,"button",23)(1,"mat-icon"),e._uU(2,"add"),e.qZA(),e._uU(3," \u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0440\u043e\u043b\u044c "),e.qZA())}function J(n,i){1&n&&(e.TgZ(0,"th",24),e._uU(1,"\u041d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u0435"),e.qZA())}function q(n,i){if(1&n&&(e.TgZ(0,"td",25),e._uU(1),e.qZA()),2&n){const t=i.$implicit;e.xp6(1),e.hij(" ",t.name," ")}}function Q(n,i){1&n&&(e.TgZ(0,"th",24),e._uU(1,"\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435"),e.qZA())}function H(n,i){if(1&n&&(e.TgZ(0,"td",25),e._uU(1),e.qZA()),2&n){const t=i.$implicit;e.xp6(1),e.hij(" ",t.description," ")}}function B(n,i){1&n&&(e.TgZ(0,"th",26),e._uU(1,"\xa0"),e.qZA())}function L(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"td",27)(1,"div",28)(2,"button",29),e.NdJ("click",function(s){const c=e.CHM(t).$implicit,h=e.oxw();return e.KtG(h.onRemoveRow(s,c))}),e.TgZ(3,"mat-icon"),e._uU(4,"highlight_off"),e.qZA()()()()}}function j(n,i){if(1&n&&(e.TgZ(0,"td",30)(1,"div",31),e._uU(2,"\u041d\u0435\u0442 \u0434\u0430\u043d\u043d\u044b\u0445"),e.qZA()()),2&n){const t=e.oxw();e.uIk("colspan",t.colspanTable)}}function G(n,i){1&n&&e._UZ(0,"tr",32)}const $=function(n){return{selected:n}};function K(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"tr",33),e.NdJ("click",function(){const r=e.CHM(t).$implicit,c=e.oxw();return e.KtG(c.onSelectRow(r))}),e.qZA()}2&n&&e.Q6J("ngClass",e.VKq(1,$,i.$implicit.selected))}function z(n,i){1&n&&e._UZ(0,"tr",34)}const W=function(){return[]},X=function(){return["notFound"]};class w extends A.D{constructor(i,t,o,s,r){super(),this.router=i,this.dialogService=t,this.userService=o,this.apiConfigService=s,r.setTitle(`\u0421\u043f\u0438\u0441\u043e\u043a \u0440\u043e\u043b\u0435\u0439 | \u0410\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 | ${l.XI}`)}get isPermissionEdit(){return this.userService.hasPermissions(l.jE.configRoleEdit)}ngOnInit(){this.displayedColumns=this.userService.hasPermissions(l.jE.configRoleRemove)?["name","description","buttons"]:["name","description"],this.getList(this.pageIndex)}onRemoveRow(i,t){i.stopPropagation(),this.dialogService.showConfirm("\u0412\u044b \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u0445\u043e\u0442\u0438\u0442\u0435 \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u044d\u0442\u0443 \u0440\u043e\u043b\u044c?").subscribe(o=>{o&&t.id&&(this.dialogService.showWait("\u0423\u0434\u0430\u043b\u0435\u043d\u0438\u0435..."),this.apiConfigService.removeRole(t.id).pipe((0,g.x)(()=>this.dialogService.hideWait())).subscribe({next:()=>{this.getList(this.pageIndex)},error:s=>this.dialogService.showToastError(s.message)}))})}onSelectRow(i){this.router.navigate(["/config/roles",i.id])}getList(i){this.dialogService.showWait("\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u0434\u0430\u043d\u043d\u044b\u0445..."),this.apiConfigService.getListRoles(i,this.pageSize).pipe((0,g.x)(()=>this.dialogService.hideWait())).subscribe({next:t=>{this.dataSource=t},error:t=>this.dialogService.showToastError(t.message)})}}function V(n,i){1&n&&(e.TgZ(0,"button",21)(1,"mat-icon"),e._uU(2,"add"),e.qZA(),e._uU(3," \u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f "),e.qZA())}function ee(n,i){1&n&&(e.TgZ(0,"th",22),e._uU(1,"\u0424\u0418\u041e"),e.qZA())}function te(n,i){if(1&n&&(e.TgZ(0,"td",23),e._uU(1),e.qZA()),2&n){const t=i.$implicit,o=e.oxw();e.xp6(1),e.hij(" ",o.getUserFIO(t)," ")}}function ie(n,i){1&n&&(e.TgZ(0,"th",24),e._uU(1,"\xa0"),e.qZA())}function ne(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"td",25)(1,"div",26)(2,"button",27),e.NdJ("click",function(s){const c=e.CHM(t).$implicit,h=e.oxw();return e.KtG(h.onRemoveRow(s,c))}),e.TgZ(3,"mat-icon"),e._uU(4,"highlight_off"),e.qZA()()()()}}function oe(n,i){if(1&n&&(e.TgZ(0,"td",28)(1,"div",29),e._uU(2,"\u041d\u0435\u0442 \u0434\u0430\u043d\u043d\u044b\u0445"),e.qZA()()),2&n){const t=e.oxw();e.uIk("colspan",t.colspanTable)}}function se(n,i){1&n&&e._UZ(0,"tr",30)}w.\u0275fac=function(i){return new(i||w)(e.Y36(d.F0),e.Y36(p.xA),e.Y36(C.KD),e.Y36(Z.w1),e.Y36(v.Dx))},w.\u0275cmp=e.Xpm({type:w,selectors:[["config-roles"]],features:[e.qOj],decls:27,vars:11,consts:[[1,"page-table-head"],[1,"page-table-head__title"],[1,"page-table-head__subtitle"],[3,"length","pageSize","pageSizeOptions","changes","page"],[1,"page-table-head__buttons"],["mat-raised-button","","color","primary","routerLink","add",4,"ngIf"],[1,"content"],[1,"scroll-container","content"],[1,"scroll"],["scrollElement",""],["mat-table","",1,"table",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","","class","text-center",4,"matCellDef"],["matColumnDef","description"],["matColumnDef","buttons"],["mat-header-cell","","class","buttons-cell",4,"matHeaderCellDef"],["mat-cell","","class","buttons-cell",4,"matCellDef"],["matColumnDef","notFound"],["mat-footer-cell","",4,"matFooterCellDef"],["mat-header-row","",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","","class","table-row",3,"ngClass","click",4,"matRowDef","matRowDefColumns"],["mat-footer-row","",4,"matFooterRowDef"],["mat-raised-button","","color","primary","routerLink","add"],["mat-header-cell",""],["mat-cell","",1,"text-center"],["mat-header-cell","",1,"buttons-cell"],["mat-cell","",1,"buttons-cell"],[1,"container"],["mat-icon-button","","color","accent",3,"click"],["mat-footer-cell",""],[1,"text-center","text-danger"],["mat-header-row",""],["mat-row","",1,"table-row",3,"ngClass","click"],["mat-footer-row",""]],template:function(i,t){1&i&&(e.TgZ(0,"div",0)(1,"div",1),e._uU(2,"\u0421\u043f\u0438\u0441\u043e\u043a \u0440\u043e\u043b\u0435\u0439"),e.qZA(),e.TgZ(3,"div",2),e._uU(4,"\xa0"),e.qZA(),e.TgZ(5,"mat-paginator",3),e.NdJ("changes",function(){return t.updatePaginator})("page",function(s){return t.onPageChanged(s)}),e.qZA(),e.TgZ(6,"div",4),e.YNc(7,Y,4,0,"button",5),e.qZA()(),e.TgZ(8,"div",6)(9,"div",7)(10,"div",8,9)(12,"table",10),e.ynx(13,11),e.YNc(14,J,2,0,"th",12),e.YNc(15,q,2,1,"td",13),e.BQk(),e.ynx(16,14),e.YNc(17,Q,2,0,"th",12),e.YNc(18,H,2,1,"td",13),e.BQk(),e.ynx(19,15),e.YNc(20,B,2,0,"th",16),e.YNc(21,L,5,0,"td",17),e.BQk(),e.ynx(22,18),e.YNc(23,j,3,1,"td",19),e.BQk(),e.YNc(24,G,1,0,"tr",20),e.YNc(25,K,1,3,"tr",21),e.YNc(26,z,1,0,"tr",22),e.qZA()()()()),2&i&&(e.xp6(5),e.Q6J("length",t.totalCount)("pageSize",t.pageSize)("pageSizeOptions",t.pageSizeOptions),e.xp6(2),e.Q6J("ngIf",t.isPermissionEdit),e.xp6(5),e.Q6J("dataSource",t.dataSource),e.xp6(12),e.Q6J("matHeaderRowDef",t.displayedColumns)("matHeaderRowDefSticky",!0),e.xp6(1),e.Q6J("matRowDefColumns",t.displayedColumns),e.xp6(1),e.Q6J("matFooterRowDef",t.dataSource&&t.dataSource.length?e.DdM(9,W):e.DdM(10,X)))},dependencies:[f.mk,f.O5,d.rH,b.Hw,_.lW,_.RK,a.BZ,a.fO,a.as,a.w1,a.Dz,a.nj,a.mD,a.Ke,a.ge,a.ev,a.yh,a.XQ,a.Gk,a.Q2,N.NW],styles:["[_nghost-%COMP%]{flex:auto;display:flex;flex-direction:column}"]});const ae=function(n){return{selected:n}};function re(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"tr",31),e.NdJ("click",function(){const r=e.CHM(t).$implicit,c=e.oxw();return e.KtG(c.onSelectRow(r))}),e.qZA()}2&n&&e.Q6J("ngClass",e.VKq(1,ae,i.$implicit.selected))}function ce(n,i){1&n&&e._UZ(0,"tr",32)}const le=function(){return[]},ue=function(){return["notFound"]};class E extends A.D{constructor(i,t,o,s,r){super(),this.router=i,this.dialogService=t,this.userService=o,this.apiConfigService=s,r.setTitle(`\u0421\u043f\u0438\u0441\u043e\u043a \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439 | \u0410\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 | ${l.XI}`)}get isPermissionEdit(){return this.userService.hasPermissions(l.jE.configUserEdit)}ngOnInit(){this.displayedColumns=this.userService.hasPermissions(l.jE.configUserRemove)?["fio","buttons"]:["fio"],this.getList(this.pageIndex)}getUserFIO(i){const t=[];return i.family&&t.push(i.family),i.name&&t.push(i.name),i.patronimyc&&t.push(i.patronimyc),t.join(" ").trim()}onRemoveRow(i,t){i.stopPropagation(),this.dialogService.showConfirm("\u0412\u044b \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u0445\u043e\u0442\u0438\u0442\u0435 \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u044d\u0442\u043e\u0433\u043e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f?").subscribe(o=>{o&&t.id&&(this.dialogService.showWait("\u0423\u0434\u0430\u043b\u0435\u043d\u0438\u0435..."),this.apiConfigService.removeUser(t.id).pipe((0,g.x)(()=>this.dialogService.hideWait())).subscribe({next:()=>{this.getList(this.pageIndex)},error:s=>this.dialogService.showToastError(s.message)}))})}onSelectRow(i){this.router.navigate(["/config/users",i.id])}getList(i){this.dialogService.showWait("\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u0434\u0430\u043d\u043d\u044b\u0445..."),this.apiConfigService.getListUsers(i,this.pageSize).pipe((0,g.x)(()=>this.dialogService.hideWait())).subscribe({next:t=>{this.dataSource=t},error:t=>this.dialogService.showToastError(t.message)})}}E.\u0275fac=function(i){return new(i||E)(e.Y36(d.F0),e.Y36(p.xA),e.Y36(C.KD),e.Y36(Z.w1),e.Y36(v.Dx))},E.\u0275cmp=e.Xpm({type:E,selectors:[["config-users"]],features:[e.qOj],decls:23,vars:11,consts:[[1,"page-table-head"],[1,"page-table-head__title"],[1,"page-table-head__subtitle"],[3,"length","pageSize","pageSizeOptions","changes","page"],[1,"page-table-head__buttons"],["mat-raised-button","","color","primary","routerLink","add",4,"ngIf"],[1,"content"],[1,"scroll-container"],[1,"scroll"],["mat-table","",1,"table",3,"dataSource"],["matColumnDef","fio"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","","class","text-center",4,"matCellDef"],["matColumnDef","buttons"],["mat-header-cell","","class","buttons-cell",4,"matHeaderCellDef"],["mat-cell","","class","buttons-cell",4,"matCellDef"],["matColumnDef","notFound"],["mat-footer-cell","",4,"matFooterCellDef"],["mat-header-row","",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","","class","table-row",3,"ngClass","click",4,"matRowDef","matRowDefColumns"],["mat-footer-row","",4,"matFooterRowDef"],["mat-raised-button","","color","primary","routerLink","add"],["mat-header-cell",""],["mat-cell","",1,"text-center"],["mat-header-cell","",1,"buttons-cell"],["mat-cell","",1,"buttons-cell"],[1,"container"],["mat-icon-button","","color","accent",3,"click"],["mat-footer-cell",""],[1,"text-center","text-danger"],["mat-header-row",""],["mat-row","",1,"table-row",3,"ngClass","click"],["mat-footer-row",""]],template:function(i,t){1&i&&(e.TgZ(0,"div",0)(1,"div",1),e._uU(2,"\u0421\u043f\u0438\u0441\u043e\u043a \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439"),e.qZA(),e.TgZ(3,"div",2),e._uU(4,"\xa0"),e.qZA(),e.TgZ(5,"mat-paginator",3),e.NdJ("changes",function(){return t.updatePaginator})("page",function(s){return t.onPageChanged(s)}),e.qZA(),e.TgZ(6,"div",4),e.YNc(7,V,4,0,"button",5),e.qZA()(),e.TgZ(8,"div",6)(9,"div",7)(10,"div",8)(11,"table",9),e.ynx(12,10),e.YNc(13,ee,2,0,"th",11),e.YNc(14,te,2,1,"td",12),e.BQk(),e.ynx(15,13),e.YNc(16,ie,2,0,"th",14),e.YNc(17,ne,5,0,"td",15),e.BQk(),e.ynx(18,16),e.YNc(19,oe,3,1,"td",17),e.BQk(),e.YNc(20,se,1,0,"tr",18),e.YNc(21,re,1,3,"tr",19),e.YNc(22,ce,1,0,"tr",20),e.qZA()()()()),2&i&&(e.xp6(5),e.Q6J("length",t.totalCount)("pageSize",t.pageSize)("pageSizeOptions",t.pageSizeOptions),e.xp6(2),e.Q6J("ngIf",t.isPermissionEdit),e.xp6(4),e.Q6J("dataSource",t.dataSource),e.xp6(9),e.Q6J("matHeaderRowDef",t.displayedColumns)("matHeaderRowDefSticky",!0),e.xp6(1),e.Q6J("matRowDefColumns",t.displayedColumns),e.xp6(1),e.Q6J("matFooterRowDef",t.dataSource&&t.dataSource.length?e.DdM(9,le):e.DdM(10,ue)))},dependencies:[f.mk,f.O5,d.rH,b.Hw,_.lW,_.RK,a.BZ,a.fO,a.as,a.w1,a.Dz,a.nj,a.mD,a.Ke,a.ge,a.ev,a.yh,a.XQ,a.Gk,a.Q2,N.NW],styles:["[_nghost-%COMP%]{flex:auto;display:flex;flex-direction:column}"]});var S=u(2722),P=u(7084);function de(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"button",9),e.NdJ("click",function(){e.CHM(t);const s=e.oxw();return e.KtG(s.onSave())}),e.TgZ(1,"mat-icon"),e._uU(2,"save"),e.qZA(),e._uU(3," \u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c "),e.qZA()}if(2&n){const t=e.oxw();e.Q6J("disabled",t.savedState)}}function me(n,i){1&n&&(e.TgZ(0,"div",10),e._uU(1,"\u0420\u043e\u043b\u044c \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u0430"),e.qZA())}function pe(n,i){1&n&&(e.TgZ(0,"div",11),e._uU(1,"\u0414\u043e\u0441\u0442\u0443\u043f \u0437\u0430\u043f\u0440\u0435\u0449\u0435\u043d"),e.qZA())}function fe(n,i){1&n&&(e.TgZ(0,"div",26),e._uU(1," \u041d\u0435\u0442 \u0440\u0430\u0437\u0440\u0435\u0448\u0435\u043d\u0438\u0439 "),e.qZA())}function ge(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"button",31),e.NdJ("click",function(){e.CHM(t);const s=e.oxw(2).$implicit,r=e.oxw(3);return e.KtG(r.onMovePermission(s,r.availablePermissions))}),e.TgZ(1,"mat-icon"),e._uU(2,"highlight_off"),e.qZA()()}}function _e(n,i){if(1&n&&(e.TgZ(0,"div",28)(1,"div",29),e._uU(2),e.qZA(),e.YNc(3,ge,3,0,"button",30),e.qZA()),2&n){const t=e.oxw().$implicit,o=e.oxw(3);e.xp6(2),e.Oqu(t.name),e.xp6(1),e.Q6J("ngIf",o.isPermissionEdit)}}function he(n,i){if(1&n&&(e.ynx(0),e.YNc(1,_e,4,2,"div",27),e.BQk()),2&n){const t=i.$implicit;e.xp6(1),e.Q6J("ngIf",t.visible)}}function Ce(n,i){if(1&n&&(e.TgZ(0,"mat-expansion-panel",22)(1,"mat-expansion-panel-header")(2,"mat-panel-title"),e._uU(3),e.qZA()(),e.TgZ(4,"div",23),e.YNc(5,fe,2,0,"div",24),e.YNc(6,he,2,1,"ng-container",25),e.qZA()()),2&n){const t=i.$implicit,o=e.oxw(2);e.Q6J("expanded",t.expanded),e.xp6(3),e.hij(" ",t.name," "),e.xp6(2),e.Q6J("ngIf",!o.hasVisiblePermissions(t.permissions)),e.xp6(1),e.Q6J("ngForOf",t.permissions)}}function ve(n,i){1&n&&(e.TgZ(0,"div",26),e._uU(1," \u041d\u0435\u0442 \u0440\u0430\u0437\u0440\u0435\u0448\u0435\u043d\u0438\u0439 "),e.qZA())}function be(n,i){1&n&&(e.TgZ(0,"mat-icon",35),e._uU(1," add_circle_outline "),e.qZA())}function xe(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"div",33),e.NdJ("click",function(){e.CHM(t);const s=e.oxw().$implicit,r=e.oxw(3);return e.KtG(r.onMovePermission(s,r.rolePermissions))}),e.YNc(1,be,2,0,"mat-icon",34),e.TgZ(2,"div",29),e._uU(3),e.qZA()()}if(2&n){const t=e.oxw().$implicit,o=e.oxw(3);e.xp6(1),e.Q6J("ngIf",o.isPermissionEdit),e.xp6(2),e.Oqu(t.name)}}function Te(n,i){if(1&n&&(e.ynx(0),e.YNc(1,xe,4,2,"div",32),e.BQk()),2&n){const t=i.$implicit;e.xp6(1),e.Q6J("ngIf",t.visible)}}function De(n,i){if(1&n&&(e.TgZ(0,"mat-expansion-panel",22)(1,"mat-expansion-panel-header")(2,"mat-panel-title"),e._uU(3),e.qZA()(),e.TgZ(4,"div",23),e.YNc(5,ve,2,0,"div",24),e.YNc(6,Te,2,1,"ng-container",25),e.qZA()()),2&n){const t=i.$implicit,o=e.oxw(2);e.Q6J("expanded",t.expanded),e.xp6(3),e.hij(" ",t.name," "),e.xp6(2),e.Q6J("ngIf",!o.hasVisiblePermissions(t.permissions)),e.xp6(1),e.Q6J("ngForOf",t.permissions)}}function Ze(n,i){if(1&n&&(e.TgZ(0,"div",12)(1,"div",13)(2,"div"),e._UZ(3,"kui-input",14),e.qZA(),e.TgZ(4,"div",15),e._uU(5,"\u0420\u0430\u0437\u0440\u0435\u0448\u0435\u043d\u0438\u044f \u0434\u043b\u044f \u0440\u043e\u043b\u0438"),e.qZA(),e.TgZ(6,"div",16)(7,"div",17)(8,"mat-accordion",18),e.YNc(9,Ce,7,4,"mat-expansion-panel",19),e.qZA()()()(),e.TgZ(10,"div",20)(11,"div"),e._UZ(12,"kui-input",21),e.qZA(),e.TgZ(13,"div",15),e._uU(14,"\u0414\u043e\u0441\u0442\u0443\u043f\u043d\u044b\u0435 \u0440\u0430\u0437\u0440\u0435\u0448\u0435\u043d\u0438\u044f"),e.qZA(),e.TgZ(15,"div",16)(16,"div",17)(17,"mat-accordion",18),e.YNc(18,De,7,4,"mat-expansion-panel",19),e.qZA()()()()()),2&n){const t=e.oxw();e.xp6(3),e.Q6J("readonly",!t.isPermissionEdit),e.xp6(6),e.Q6J("ngForOf",t.rolePermissions),e.xp6(3),e.Q6J("readonly",!t.isPermissionEdit),e.xp6(6),e.Q6J("ngForOf",t.availablePermissions)}}class y{constructor(i,t,o,s,r,c){this.titleService=i,this.router=t,this.activatedRoute=o,this.dialogService=s,this.apiConfigService=r,this.userService=c,this.rolePermissions=[],this.availablePermissions=[],this.formGroup=new m.cw({name:new p.jn(null,m.kI.required),description:new p.jn(null)}),this.savedState=!0,this.is404=!1,this.isForbidden=!1,this.subTitle="",this.ngUnsubscribe=new k.x,this.roleId=null,this.rolePermissionsDef=[]}get isPermissionEdit(){return this.userService.hasPermissions(l.jE.configRoleEdit)}ngOnInit(){this.formGroup.valueChanges.pipe((0,S.R)(this.ngUnsubscribe)).subscribe(()=>this.savedState=!1),this.activatedRoute.paramMap.pipe((0,S.R)(this.ngUnsubscribe)).subscribe(i=>{const t=i.get("id");"add"===t?(this.roleId=null,this.titleService.setTitle(`\u041d\u043e\u0432\u0430\u044f \u0440\u043e\u043b\u044c | \u0421\u043f\u0438\u0441\u043e\u043a \u0440\u043e\u043b\u0435\u0439 | \u0410\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 | ${l.XI}`),this.subTitle="&nbsp;&#10148;&nbsp;\u041d\u043e\u0432\u0430\u044f \u0440\u043e\u043b\u044c",this.isPermissionEdit||(this.isForbidden=!0),this.updatePermisionGroups()):t?this.getRole(+t):this.is404=!0})}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}onSave(){if(!this.formGroup.valid)return void this.formGroup.markAllAsTouched();this.dialogService.showWait("\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435...");const i=[];this.rolePermissions.forEach(o=>{o.permissions.forEach(s=>{s.visible&&i.push(s.id)})});const t={id:this.roleId,permissions:i,...this.formGroup.value};this.apiConfigService.saveRole(t).pipe((0,g.x)(()=>this.dialogService.hideWait())).subscribe({next:o=>{null===this.roleId&&this.router.navigate(["/config/roles",o.id]),this.savedState=!0},error:o=>{this.dialogService.showToastError(o.message)}})}onMovePermission(i,t){if(!this.isPermissionEdit)return;const o=t.find(s=>s.id===i.moduleId);if(o){o.expanded=!0;const s=o.permissions.find(r=>r.id===i.id);s&&(s.visible=!0,i.visible=!1,this.savedState=!1)}}hasVisiblePermissions(i){return i.some(t=>t.visible)}updatePermisionGroups(){this.apiConfigService.getPermisionGroups().subscribe({next:i=>{this.availablePermissions=i.map(t=>({id:t.id,name:t.name,expanded:!1,permissions:t.permissions.map(o=>({...o,visible:!this.rolePermissionsDef.includes(o.id)}))})),this.rolePermissions=i.map(t=>({id:t.id,name:t.name,expanded:!1,permissions:t.permissions.map(o=>({...o,visible:this.rolePermissionsDef.includes(o.id)}))}))},error:()=>{this.availablePermissions=[]}})}getRole(i){this.titleService.setTitle(`\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0440\u043e\u043b\u0438 | \u0421\u043f\u0438\u0441\u043e\u043a \u0440\u043e\u043b\u0435\u0439 | \u0410\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 | ${l.XI}`),this.subTitle="&nbsp;&#10148;&nbsp;\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0440\u043e\u043b\u0438",this.dialogService.showWait("\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u0434\u0430\u043d\u043d\u044b\u0445..."),this.apiConfigService.getRole(i).pipe((0,g.x)(()=>this.dialogService.hideWait())).subscribe({next:t=>{this.formGroup.patchValue(t),this.roleId=Number(t.id),this.rolePermissionsDef=t.permissions,this.savedState=!0,this.updatePermisionGroups()},error:t=>{this.rolePermissionsDef=[],this.dialogService.showToastError(t.message),this.is404=!0,this.roleId=null}})}}function we(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"button",9),e.NdJ("click",function(){e.CHM(t);const s=e.oxw();return e.KtG(s.onSave())}),e.TgZ(1,"mat-icon"),e._uU(2,"save"),e.qZA(),e._uU(3," \u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c "),e.qZA()}if(2&n){const t=e.oxw();e.Q6J("disabled",t.savedState)}}function Ee(n,i){1&n&&(e.TgZ(0,"div",10),e._uU(1,"\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d"),e.qZA())}function Se(n,i){1&n&&(e.TgZ(0,"div",11),e._uU(1,"\u0414\u043e\u0441\u0442\u0443\u043f \u0437\u0430\u043f\u0440\u0435\u0449\u0435\u043d"),e.qZA())}function ye(n,i){if(1&n&&(e.TgZ(0,"div",12)(1,"div",13)(2,"div",14)(3,"div",15)(4,"div"),e._UZ(5,"kui-input",16),e.qZA(),e.TgZ(6,"div"),e._UZ(7,"kui-input",17),e.qZA(),e.TgZ(8,"div"),e._UZ(9,"kui-input",18),e.qZA()()(),e.TgZ(10,"div",19)(11,"div",20),e._UZ(12,"kui-select",21),e.qZA(),e.TgZ(13,"div",22),e._UZ(14,"kui-input",23),e.qZA()()()()),2&n){const t=e.oxw();e.xp6(5),e.Q6J("readonly",!t.isPermissionEdit),e.xp6(2),e.Q6J("readonly",!t.isPermissionEdit),e.xp6(2),e.Q6J("readonly",!t.isPermissionEdit),e.xp6(3),e.Q6J("multiple",!0)("options",t.rolesList)("readonly",!t.isPermissionEdit),e.xp6(2),e.Q6J("readonly",!t.isPermissionEdit)}}y.\u0275fac=function(i){return new(i||y)(e.Y36(v.Dx),e.Y36(d.F0),e.Y36(d.gz),e.Y36(p.xA),e.Y36(Z.w1),e.Y36(C.KD))},y.\u0275cmp=e.Xpm({type:y,selectors:[["config-role-edit"]],decls:10,vars:6,consts:[[1,"page-table-head"],["routerLink","/config/roles",1,"page-table-head__title","page-table-head__title--link"],[1,"page-table-head__subtitle",3,"innerHTML"],[1,"page-table-head__buttons"],["mat-raised-button","","color","success",3,"disabled","click",4,"ngIf"],[1,"content",3,"formGroup"],["class","alert-message warning",4,"ngIf"],["class","alert-message danger",4,"ngIf"],["class","flex-row flex-auto",4,"ngIf"],["mat-raised-button","","color","success",3,"disabled","click"],[1,"alert-message","warning"],[1,"alert-message","danger"],[1,"flex-row","flex-auto"],[1,"side-container"],["label","\u041d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u0435","appearance","outline","formControlName","name",3,"readonly"],[1,"text-center","text-bold"],[1,"scroll-container","mt-10"],[1,"scroll"],[1,"mt-10"],[3,"expanded",4,"ngFor","ngForOf"],[1,"side-container","ml-10"],["label","\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435","appearance","outline","formControlName","description",3,"readonly"],[3,"expanded"],[1,"roles-list"],["class","text-center text-danger mt-10 mb-10",4,"ngIf"],[4,"ngFor","ngForOf"],[1,"text-center","text-danger","mt-10","mb-10"],["class","roles-list__item",4,"ngIf"],[1,"roles-list__item"],[1,"roles-list__title"],["mat-icon-button","","color","accent",3,"click",4,"ngIf"],["mat-icon-button","","color","accent",3,"click"],["class","roles-list__item cursor-pointer",3,"click",4,"ngIf"],[1,"roles-list__item","cursor-pointer",3,"click"],["color","success",4,"ngIf"],["color","success"]],template:function(i,t){1&i&&(e.TgZ(0,"div",0)(1,"div",1),e._uU(2," \u0421\u043f\u0438\u0441\u043e\u043a \u0440\u043e\u043b\u0435\u0439 "),e.qZA(),e._UZ(3,"div",2),e.TgZ(4,"div",3),e.YNc(5,de,4,1,"button",4),e.qZA()(),e.TgZ(6,"div",5),e.YNc(7,me,2,0,"div",6),e.YNc(8,pe,2,0,"div",7),e.YNc(9,Ze,19,4,"div",8),e.qZA()),2&i&&(e.xp6(3),e.Q6J("innerHTML",t.subTitle,e.oJD),e.xp6(2),e.Q6J("ngIf",!t.is404&&!t.isForbidden&&t.isPermissionEdit),e.xp6(1),e.Q6J("formGroup",t.formGroup),e.xp6(1),e.Q6J("ngIf",t.is404),e.xp6(1),e.Q6J("ngIf",t.isForbidden),e.xp6(1),e.Q6J("ngIf",!t.is404&&!t.isForbidden))},dependencies:[f.sg,f.O5,m.JJ,m.JL,m.sg,m.u,d.rH,p.y0,b.Hw,_.lW,_.RK,P.pp,P.ib,P.yz,P.yK],styles:["[_nghost-%COMP%]{flex:auto;display:flex;flex-direction:column}[_nghost-%COMP%]  .mat-expansion-panel-body{padding:0!important}.side-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:50%;padding-top:10px}.roles-list[_ngcontent-%COMP%]{display:flex;flex-direction:column}.roles-list[_ngcontent-%COMP%]   .roles-list__item[_ngcontent-%COMP%]{display:flex;align-items:center;padding:0 10px;height:32px}.roles-list[_ngcontent-%COMP%]   .roles-list__item[_ngcontent-%COMP%]:hover{background-color:#d6e6fc}.roles-list[_ngcontent-%COMP%]   .roles-list__title[_ngcontent-%COMP%]{flex:auto;padding:0 10px}"]});class R{constructor(i,t,o,s,r,c){this.titleService=i,this.router=t,this.activatedRoute=o,this.dialogService=s,this.apiConfigService=r,this.userService=c,this.subTitle="",this.is404=!1,this.isForbidden=!1,this.rolesList=[],this.savedState=!0,this.formGroup=new m.cw({family:new p.jn(null),name:new p.jn(null,m.kI.required),patronimyc:new p.jn(null),roles:new p.jn(null),pinCode:new p.jn(null,m.kI.required)}),this.ngUnsubscribe=new k.x,this.userId=null}get isPermissionEdit(){return this.userService.hasPermissions(l.jE.configUserEdit)}ngOnInit(){this.apiConfigService.getListRoles().subscribe({next:i=>{this.rolesList=(i||[]).map(t=>({value:t.id,title:t.name}))},error:()=>{}}),this.formGroup.valueChanges.pipe((0,S.R)(this.ngUnsubscribe)).subscribe(()=>this.savedState=!1),this.activatedRoute.paramMap.pipe((0,S.R)(this.ngUnsubscribe)).subscribe(i=>{const t=i.get("id");"add"===t?(this.titleService.setTitle(`\u041d\u043e\u0432\u044b\u0439 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c | \u0421\u043f\u0438\u0441\u043e\u043a \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439 | \u0410\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 | ${l.XI}`),this.subTitle="&nbsp;&#10148;&nbsp;\u041d\u043e\u0432\u044b\u0439 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c",this.isPermissionEdit||(this.isForbidden=!0)):t?this.getUser(+t):this.is404=!0})}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}onSave(){if(!this.formGroup.valid)return void this.formGroup.markAllAsTouched();this.dialogService.showWait("\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435...");const i={id:this.userId,...this.formGroup.value};this.apiConfigService.saveUser(i).pipe((0,g.x)(()=>this.dialogService.hideWait())).subscribe({next:t=>{null===this.userId&&this.router.navigate(["/config/users",t.id]),this.savedState=!0},error:t=>{this.dialogService.showToastError(t.message)}})}getUser(i){this.titleService.setTitle(`\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f | \u0421\u043f\u0438\u0441\u043e\u043a \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439 | \u0410\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 | ${l.XI}`),this.subTitle="&nbsp;&#10148;&nbsp;\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f",this.dialogService.showWait("\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u0434\u0430\u043d\u043d\u044b\u0445..."),this.apiConfigService.getUser(i).pipe((0,g.x)(()=>this.dialogService.hideWait())).subscribe({next:t=>{this.formGroup.patchValue(t),this.userId=Number(t.id),setTimeout(()=>this.savedState=!0,1e3)},error:t=>{this.dialogService.showToastError(t.message),this.is404=!0,this.userId=null}})}}R.\u0275fac=function(i){return new(i||R)(e.Y36(v.Dx),e.Y36(d.F0),e.Y36(d.gz),e.Y36(p.xA),e.Y36(Z.w1),e.Y36(C.KD))},R.\u0275cmp=e.Xpm({type:R,selectors:[["config-user-edit"]],decls:10,vars:6,consts:[[1,"page-table-head"],["routerLink","/admin/users",1,"page-table-head__title","page-table-head__title--link"],[1,"page-table-head__subtitle",3,"innerHTML"],[1,"page-table-head__buttons"],["mat-raised-button","","color","success",3,"disabled","click",4,"ngIf"],[1,"content",3,"formGroup"],["class","alert-message warning",4,"ngIf"],["class","alert-message danger",4,"ngIf"],["class","flex-col flex-auto",4,"ngIf"],["mat-raised-button","","color","success",3,"disabled","click"],[1,"alert-message","warning"],[1,"alert-message","danger"],[1,"flex-col","flex-auto"],[1,"flex-row"],[1,"base-info-container"],[1,"grid-3-cell"],["label","\u0424\u0430\u043c\u0438\u043b\u0438\u044f","formControlName","family",3,"readonly"],["label","\u0418\u043c\u044f","formControlName","name",3,"readonly"],["label","\u041e\u0442\u0447\u0435\u0441\u0442\u0432\u043e","formControlName","patronimyc",3,"readonly"],[1,"flex-row","ml-30"],[1,"mt-10"],["appearance","outline","label","\u0420\u043e\u043b\u0438 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f","formControlName","roles",3,"multiple","options","readonly"],[1,"ml-10","mt-10"],["appearance","outline","label","PIN-\u043a\u043e\u0434","mask","number","formControlName","pinCode","maxlength","6",3,"readonly"]],template:function(i,t){1&i&&(e.TgZ(0,"div",0)(1,"div",1),e._uU(2," \u0421\u043f\u0438\u0441\u043e\u043a \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439 "),e.qZA(),e._UZ(3,"div",2),e.TgZ(4,"div",3),e.YNc(5,we,4,1,"button",4),e.qZA()(),e.TgZ(6,"div",5),e.YNc(7,Ee,2,0,"div",6),e.YNc(8,Se,2,0,"div",7),e.YNc(9,ye,15,7,"div",8),e.qZA()),2&i&&(e.xp6(3),e.Q6J("innerHTML",t.subTitle,e.oJD),e.xp6(2),e.Q6J("ngIf",!t.is404&&!t.isForbidden&&t.isPermissionEdit),e.xp6(1),e.Q6J("formGroup",t.formGroup),e.xp6(1),e.Q6J("ngIf",t.is404),e.xp6(1),e.Q6J("ngIf",t.isForbidden),e.xp6(1),e.Q6J("ngIf",!t.is404&&!t.isForbidden))},dependencies:[f.O5,m.JJ,m.JL,m.nD,m.sg,m.u,d.rH,p.y0,p.os,b.Hw,_.lW],styles:["[_nghost-%COMP%]{flex:auto;display:flex;flex-direction:column}"]});var Re=u(4004);const Ue=["formElement"];class U{constructor(){this.fieldsDto={}}get fieldsRows(){return this.modalChildData?.fieldsRows??[]}get fieldsService(){return this.modalChildData?.fieldsService??null}ngOnInit(){this.modalChildData?.values&&(this.fieldsDto=this.modalChildData.values)}apply(){this.formElementRef&&this.formElementRef.isFormValid()&&this.dialogRef?.close(!0)}close(){this.dialogRef?.close(!1)}}U.\u0275fac=function(i){return new(i||U)},U.\u0275cmp=e.Xpm({type:U,selectors:[["config-dictionary-edit"]],viewQuery:function(i,t){if(1&i&&e.Gf(Ue,5),2&i){let o;e.iGM(o=e.CRH())&&(t.formElementRef=o.first)}},decls:8,vars:3,consts:[[1,"inside-modal-body-container"],[3,"rows","dto","formService"],["formElement",""],[1,"footer-buttons"],["mat-raised-button","","color","primary",3,"click"],["mat-raised-button","","color","accent",3,"click"]],template:function(i,t){1&i&&(e.TgZ(0,"div",0),e._UZ(1,"kui-form-container",1,2),e.qZA(),e.TgZ(3,"div",3)(4,"button",4),e.NdJ("click",function(){return t.apply()}),e._uU(5,"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"),e.qZA(),e.TgZ(6,"button",5),e.NdJ("click",function(){return t.close()}),e._uU(7,"\u0417\u0430\u043a\u0440\u044b\u0442\u044c"),e.qZA()()),2&i&&(e.xp6(1),e.Q6J("rows",t.fieldsRows)("dto",t.fieldsDto)("formService",t.fieldsService))},dependencies:[p.CD,_.lW],styles:["[_nghost-%COMP%]{width:420px}"]});const O=[{code:"units",name:"\u0415\u0434\u0438\u043d\u0438\u0446\u044b \u0438\u0437\u043c\u0435\u0440\u0435\u043d\u0438\u044f",displayedColumns:["name","fullname"],fieldsRows:[{children:[{type:"CONTROL",controlType:"TEXT",label:"\u041d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u0435",autofill:!0,visible:!0,disabled:!1,controlProperties:{required:!0,bindDTO:"name"}}]},{children:[{type:"CONTROL",controlType:"TEXT",label:"\u041f\u043e\u043b\u043d\u043e\u0435 \u043d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u0435",autofill:!0,visible:!0,disabled:!1,controlProperties:{bindDTO:"fullname"}}]}],values:{name:"",fullname:""}},{code:"packingunits",name:"\u0424\u0430\u0441\u043e\u0432\u043a\u0438",displayedColumns:["name","unitsName","coefficient"],fieldsRows:[{children:[{type:"CONTROL",controlType:"TEXT",label:"\u041d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u0435",autofill:!0,visible:!0,disabled:!1,controlProperties:{required:!0,bindDTO:"name"}}]},{children:[{type:"CONTROL",controlType:"SELECT",label:"\u0415\u0434\u0438\u043d\u0438\u0446\u044b \u0438\u0437\u043c\u0435\u0440\u0435\u043d\u0438\u044f",autofill:!0,visible:!0,disabled:!1,controlProperties:{dataSource:"listUnits",bindDTO:"unitsId"}}]},{children:[{type:"CONTROL",controlType:"NUMBER",label:"\u041a\u043e\u044d\u0444\u0444\u0438\u0446\u0438\u0435\u043d\u0442",autofill:!0,visible:!0,disabled:!1,controlProperties:{bindDTO:"coefficient",allowDecimals:!0,decimals:3}}]}],values:{name:"",unitsId:null,coefficient:null}}];function ke(n,i){1&n&&(e.TgZ(0,"div",9),e._uU(1," \u0421\u043f\u0438\u0441\u043e\u043a \u0441\u043f\u0440\u0430\u0432\u043e\u0447\u043d\u0438\u043a\u043e\u0432 "),e.qZA())}function Pe(n,i){1&n&&(e.TgZ(0,"div",10),e._uU(1," \u0421\u043f\u0438\u0441\u043e\u043a \u0441\u043f\u0440\u0430\u0432\u043e\u0447\u043d\u0438\u043a\u043e\u0432 "),e.qZA())}function Ae(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"button",11),e.NdJ("click",function(){e.CHM(t);const s=e.oxw();return e.KtG(s.onAddRow())}),e.TgZ(1,"mat-icon"),e._uU(2,"add"),e.qZA(),e._uU(3," \u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0437\u0430\u043f\u0438\u0441\u044c "),e.qZA()}}function Oe(n,i){1&n&&(e.TgZ(0,"div",12),e._uU(1,"\u0421\u043f\u0440\u0430\u0432\u043e\u0447\u043d\u0438\u043a \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d"),e.qZA())}function Me(n,i){1&n&&(e.TgZ(0,"th",35),e._uU(1,"\u041d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u0435"),e.qZA())}function Ne(n,i){if(1&n&&(e.TgZ(0,"td",36),e._uU(1),e.qZA()),2&n){const t=i.$implicit;e.xp6(1),e.hij(" ",t.name," ")}}function Fe(n,i){1&n&&(e.TgZ(0,"th",35),e._uU(1,"\u041f\u043e\u043b\u043d\u043e\u0435 \u043d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u0435"),e.qZA())}function Ie(n,i){if(1&n&&(e.TgZ(0,"td",36),e._uU(1),e.qZA()),2&n){const t=i.$implicit;e.xp6(1),e.hij(" ",t.fullname," ")}}function Ye(n,i){1&n&&(e.TgZ(0,"th",37),e._uU(1," \u0411\u0430\u0437\u043e\u0432\u0430\u044f \u0435\u0434\u0438\u043d\u0438\u0446\u0430 \u0438\u0437\u043c\u0435\u0440\u0435\u043d\u0438\u044f "),e.qZA())}function Je(n,i){if(1&n&&(e.TgZ(0,"td",38),e._uU(1),e.qZA()),2&n){const t=i.$implicit;e.xp6(1),e.hij(" ",t.unitsName," ")}}function qe(n,i){1&n&&(e.TgZ(0,"th",39),e._uU(1," \u041a\u043e\u044d\u0444\u0444\u0438\u0446\u0438\u0435\u043d\u0442 "),e.qZA())}function Qe(n,i){if(1&n&&(e.TgZ(0,"td",40),e._uU(1),e.qZA()),2&n){const t=i.$implicit;e.xp6(1),e.hij(" ",t.coefficient," ")}}function He(n,i){1&n&&(e.TgZ(0,"th",41),e._uU(1,"\xa0"),e.qZA())}function Be(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"button",46),e.NdJ("click",function(s){e.CHM(t);const r=e.oxw().$implicit,c=e.oxw(2);return e.KtG(c.onEditRow(s,r))}),e.TgZ(1,"mat-icon"),e._uU(2,"edit"),e.qZA()()}}function Le(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"button",47),e.NdJ("click",function(s){e.CHM(t);const r=e.oxw().$implicit,c=e.oxw(2);return e.KtG(c.onRemoveRow(s,r))}),e.TgZ(1,"mat-icon"),e._uU(2,"highlight_off"),e.qZA()()}}function je(n,i){if(1&n&&(e.TgZ(0,"td",42)(1,"div",43),e.YNc(2,Be,3,0,"button",44),e.YNc(3,Le,3,0,"button",45),e.qZA()()),2&n){const t=e.oxw(2);e.xp6(2),e.Q6J("ngIf",t.isPermissionEdit),e.xp6(1),e.Q6J("ngIf",t.canRemoveDicti)}}function Ge(n,i){if(1&n&&(e.TgZ(0,"td",48)(1,"div",49),e._uU(2,"\u041d\u0435\u0442 \u0434\u0430\u043d\u043d\u044b\u0445"),e.qZA()()),2&n){const t=e.oxw(2);e.uIk("colspan",t.colspanTable)}}function $e(n,i){1&n&&e._UZ(0,"tr",50)}const Ke=function(n){return{selected:n}};function ze(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"tr",51),e.NdJ("dblclick",function(s){const c=e.CHM(t).$implicit,h=e.oxw(2);return e.KtG(h.onEditRow(s,c))})("click",function(){const r=e.CHM(t).$implicit,c=e.oxw(2);return e.KtG(c.onSelectRow(r))}),e.qZA()}2&n&&e.Q6J("ngClass",e.VKq(1,Ke,i.$implicit.selected))}function We(n,i){1&n&&e._UZ(0,"tr",52)}const Xe=function(){return[]},Ve=function(){return["notFound"]};function et(n,i){if(1&n&&(e.TgZ(0,"div",13)(1,"div",14,15)(3,"table",16),e.ynx(4,17),e.YNc(5,Me,2,0,"th",18),e.YNc(6,Ne,2,1,"td",19),e.BQk(),e.ynx(7,20),e.YNc(8,Fe,2,0,"th",18),e.YNc(9,Ie,2,1,"td",19),e.BQk(),e.ynx(10,21),e.YNc(11,Ye,2,0,"th",22),e.YNc(12,Je,2,1,"td",23),e.BQk(),e.ynx(13,24),e.YNc(14,qe,2,0,"th",25),e.YNc(15,Qe,2,1,"td",26),e.BQk(),e.ynx(16,27),e.YNc(17,He,2,0,"th",28),e.YNc(18,je,4,2,"td",29),e.BQk(),e.ynx(19,30),e.YNc(20,Ge,3,1,"td",31),e.BQk(),e.YNc(21,$e,1,0,"tr",32),e.YNc(22,ze,1,3,"tr",33),e.YNc(23,We,1,0,"tr",34),e.qZA()()()),2&n){const t=e.oxw();e.xp6(3),e.Q6J("dataSource",t.dataSource),e.xp6(18),e.Q6J("matHeaderRowDef",t.displayedColumns)("matHeaderRowDefSticky",!0),e.xp6(1),e.Q6J("matRowDefColumns",t.displayedColumns),e.xp6(1),e.Q6J("matFooterRowDef",t.dataSource&&t.dataSource.length?e.DdM(5,Xe):e.DdM(6,Ve))}}class x extends A.D{constructor(i,t,o,s,r,c){super(),this.titleService=i,this.router=t,this.activatedRoute=o,this.dialogService=s,this.userService=r,this.apiDictionariesService=c,this.viewCode=null,this.is404=!1,this.subTitle="&nbsp;",this.ngUnsubscribe=new k.x,this.titleService.setTitle(`\u0421\u043f\u0438\u0441\u043e\u043a \u0441\u043f\u0440\u0430\u0432\u043e\u0447\u043d\u0438\u043a\u043e\u0432 | \u0410\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 | ${l.XI}`)}get isPermissionEdit(){return this.userService.hasPermissions(l.jE.configDictionariesEdit)}get canRemoveDicti(){return this.userService.hasPermissions(l.jE.configDictionariesRemove)}ngOnInit(){this.activatedRoute.paramMap.pipe((0,S.R)(this.ngUnsubscribe)).subscribe(i=>{const t=i.get("code");this.setViewByCode(t)})}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}onSelectRow(i){this.viewCode||this.router.navigate(["/config/dictionaries",i.code])}onAddRow(){this.isPermissionEdit&&this.editRow()}onEditRow(i,t){i.stopPropagation(),this.isPermissionEdit&&this.editRow(t)}onRemoveRow(i,t){i.stopPropagation(),this.canRemoveDicti&&this.viewCode&&this.dialogService.showConfirm("\u0412\u044b \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u0445\u043e\u0442\u0438\u0442\u0435 \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u044d\u0442\u0443 \u0437\u0430\u043f\u0438\u0441\u044c?").subscribe(o=>{o&&t.id&&this.viewCode&&(this.dialogService.showWait("\u0423\u0434\u0430\u043b\u0435\u043d\u0438\u0435..."),this.apiDictionariesService.removeByCode(this.viewCode,t.id).pipe((0,g.x)(()=>this.dialogService.hideWait())).subscribe({next:()=>{this.getList()},error:s=>this.dialogService.showToastError(s.message)}))})}setViewByCode(i){if(!i)return this.viewCode=null,this.titleService.setTitle(`\u0421\u043f\u0438\u0441\u043e\u043a \u0441\u043f\u0440\u0430\u0432\u043e\u0447\u043d\u0438\u043a\u043e\u0432 | \u0410\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 | ${l.XI}`),this.displayedColumns=["name"],this.dataSource=O,void(this.is404=!1);const t=O.find(o=>o.code===i);t?(this.viewCode=i,this.subTitle=`&nbsp;&#10148;&nbsp;${t.name}`,this.titleService.setTitle(`${t.name} | \u0421\u043f\u0438\u0441\u043e\u043a \u0441\u043f\u0440\u0430\u0432\u043e\u0447\u043d\u0438\u043a\u043e\u0432 | \u0410\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 | ${l.XI}`),this.displayedColumns=[...t.displayedColumns],this.userService.hasPermissions([l.jE.configDictionariesEdit,l.jE.configDictionariesRemove])&&this.displayedColumns.push("buttons"),this.getList()):this.is404=!0}getList(){this.viewCode&&(this.dialogService.showWait("\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430..."),this.apiDictionariesService.getListByCode(this.viewCode).pipe((0,g.x)(()=>this.dialogService.hideWait())).subscribe({next:i=>{this.dataSource=i},error:i=>this.dialogService.showToastError(i.message)}))}editRow(i){const t=O.find(c=>c.code===this.viewCode);if(!t)return;const o={listUnits:()=>this.apiDictionariesService.getListByCode("units").pipe((0,Re.U)(c=>c.map(h=>({value:h.id,title:h.name}))))};let s;s=i?{...t.values,...i}:{...t.values},this.dialogService.showModal(i?"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0437\u0430\u043f\u0438\u0441\u0438":"\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0437\u0430\u043f\u0438\u0441\u0438",U,{fieldsRows:t.fieldsRows,fieldsService:o,values:s},!0).subscribe(c=>{c&&(this.dialogService.showWait("\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435..."),this.apiDictionariesService.saveByCode(t.code,{...s}).pipe((0,g.x)(()=>this.dialogService.hideWait())).subscribe({next:()=>this.getList(),error:h=>this.dialogService.showToastError(h.message)}))})}}x.\u0275fac=function(i){return new(i||x)(e.Y36(v.Dx),e.Y36(d.F0),e.Y36(d.gz),e.Y36(p.xA),e.Y36(C.KD),e.Y36(Z.Br))},x.\u0275cmp=e.Xpm({type:x,selectors:[["config-dictionaries"]],features:[e.qOj],decls:9,vars:6,consts:[[1,"page-table-head"],["class","page-table-head__title",4,"ngIf"],["class","page-table-head__title page-table-head__title--link","routerLink","/config/dictionaries",4,"ngIf"],[1,"page-table-head__subtitle",3,"innerHTML"],[1,"page-table-head__buttons"],["mat-raised-button","","color","primary",3,"click",4,"ngIf"],[1,"content"],["class","alert-message warning",4,"ngIf"],["class","scroll-container content",4,"ngIf"],[1,"page-table-head__title"],["routerLink","/config/dictionaries",1,"page-table-head__title","page-table-head__title--link"],["mat-raised-button","","color","primary",3,"click"],[1,"alert-message","warning"],[1,"scroll-container","content"],[1,"scroll"],["scrollElement",""],["mat-table","",1,"table",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","fullname"],["matColumnDef","unitsName"],["mat-header-cell","","class","cell-base-units",4,"matHeaderCellDef"],["mat-cell","","class","cell-base-units",4,"matCellDef"],["matColumnDef","coefficient"],["mat-header-cell","","class","cell-coefficient",4,"matHeaderCellDef"],["mat-cell","","class","cell-coefficient",4,"matCellDef"],["matColumnDef","buttons"],["mat-header-cell","","class","buttons-cell",4,"matHeaderCellDef"],["mat-cell","","class","buttons-cell",4,"matCellDef"],["matColumnDef","notFound"],["mat-footer-cell","",4,"matFooterCellDef"],["mat-header-row","",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","","class","table-row",3,"ngClass","dblclick","click",4,"matRowDef","matRowDefColumns"],["mat-footer-row","",4,"matFooterRowDef"],["mat-header-cell",""],["mat-cell",""],["mat-header-cell","",1,"cell-base-units"],["mat-cell","",1,"cell-base-units"],["mat-header-cell","",1,"cell-coefficient"],["mat-cell","",1,"cell-coefficient"],["mat-header-cell","",1,"buttons-cell"],["mat-cell","",1,"buttons-cell"],[1,"container"],["mat-icon-button","","color","primary",3,"click",4,"ngIf"],["mat-icon-button","","color","accent",3,"click",4,"ngIf"],["mat-icon-button","","color","primary",3,"click"],["mat-icon-button","","color","accent",3,"click"],["mat-footer-cell",""],[1,"text-center","text-danger"],["mat-header-row",""],["mat-row","",1,"table-row",3,"ngClass","dblclick","click"],["mat-footer-row",""]],template:function(i,t){1&i&&(e.TgZ(0,"div",0),e.YNc(1,ke,2,0,"div",1),e.YNc(2,Pe,2,0,"div",2),e._UZ(3,"div",3),e.TgZ(4,"div",4),e.YNc(5,Ae,4,0,"button",5),e.qZA()(),e.TgZ(6,"div",6),e.YNc(7,Oe,2,0,"div",7),e.YNc(8,et,24,7,"div",8),e.qZA()),2&i&&(e.xp6(1),e.Q6J("ngIf",!t.viewCode),e.xp6(1),e.Q6J("ngIf",t.viewCode),e.xp6(1),e.Q6J("innerHTML",t.subTitle,e.oJD),e.xp6(2),e.Q6J("ngIf",t.viewCode&&t.isPermissionEdit),e.xp6(2),e.Q6J("ngIf",t.is404),e.xp6(1),e.Q6J("ngIf",!t.is404))},dependencies:[f.mk,f.O5,d.rH,b.Hw,_.lW,_.RK,a.BZ,a.fO,a.as,a.w1,a.Dz,a.nj,a.mD,a.Ke,a.ge,a.ev,a.yh,a.XQ,a.Gk,a.Q2],styles:["[_nghost-%COMP%]{flex:auto;display:flex;flex-direction:column}.cell-base-units[_ngcontent-%COMP%]{width:240px;text-align:center}.cell-coefficient[_ngcontent-%COMP%]{width:100px;text-align:center}"]});const tt=[{path:"",component:D,children:[{path:"",redirectTo:"dictionaries",pathMatch:"full"},{path:"dictionaries/:code",component:x},{path:"dictionaries",component:x},{path:"users/:id",component:R},{path:"users",component:E},{path:"roles/:id",component:y},{path:"roles",component:w}]}];class T{}T.\u0275fac=function(i){return new(i||T)},T.\u0275mod=e.oAB({type:T}),T.\u0275inj=e.cJS({imports:[f.ez,m.u5,m.UX,d.Bz.forChild(tt),F.m]})}}]);