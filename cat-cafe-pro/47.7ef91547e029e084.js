"use strict";(self.webpackChunkcat_cafe=self.webpackChunkcat_cafe||[]).push([[47],{3047:(Qo,at,m)=>{m.r(at),m.d(at,{AdminModule:()=>Q});var b=m(1390),_=m(6895),r=m(4006),pt=m(8089),O=m(7579),gt=m(4147),E=m(136),g=m(1730),t=m(4650),h=m(835),k=m(1481),x=m(7392),p=m(4859),C=m(266);function ft(o,i){1&o&&(t.TgZ(0,"mat-icon"),t._uU(1,"arrow_drop_up"),t.qZA())}function ht(o,i){1&o&&(t.TgZ(0,"mat-icon"),t._uU(1,"arrow_drop_down"),t.qZA())}function xt(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"div",19),t.NdJ("click",function(){const s=t.CHM(e).$implicit,l=t.oxw(2);return t.KtG(l.onMenuClick(s))}),t._uU(1),t.qZA()}if(2&o){const e=i.$implicit;t.ekj("selected",e.active),t.xp6(1),t.hij(" ",e.title," ")}}function Ct(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"div",13)(1,"div",14),t.NdJ("click",function(){const s=t.CHM(e).$implicit;return t.KtG(s.opened=!s.opened)}),t.TgZ(2,"mat-icon"),t._uU(3),t.qZA(),t.TgZ(4,"div",15),t._uU(5),t.qZA(),t.YNc(6,ft,2,0,"mat-icon",16),t.YNc(7,ht,2,0,"mat-icon",16),t.qZA(),t.TgZ(8,"div",17),t.YNc(9,xt,2,3,"div",18),t.qZA()()}if(2&o){const e=i.$implicit;t.xp6(1),t.ekj("selected",e.active),t.xp6(2),t.Oqu(e.icon),t.xp6(2),t.Oqu(e.title),t.xp6(1),t.Q6J("ngIf",e.opened),t.xp6(1),t.Q6J("ngIf",!e.opened),t.xp6(1),t.Udp("height",e.opened?e.childHeight:0,"px"),t.xp6(1),t.Q6J("ngForOf",e.children)}}class Y{constructor(i,e,n,u){this.router=i,this.userService=e,this.authService=n,this.copyright="",this.userName="",this.menuList=[],this.ngUnsubscribe=new O.x,u.setTitle(`\u0410\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 | ${E.X}`),this.copyright=`${E.X} ${gt.i8}`,this.userName=this.userService.getShortName()}get getClass(){return"animate__animated animate__zoomIn"}ngOnInit(){this.initMenuList(),this.selectedByUrl(this.router.url),this.router.events.subscribe(i=>{i instanceof b.m2&&this.selectedByUrl(i.url)})}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}onMenuClick(i){for(const e of this.menuList){let n=!1;for(const u of e.children)u.active=u.route===i.route,u.active&&(n=!0);e.active=n}this.router.navigate([i.route])}onLogout(){this.authService.lockScreen()}selectedByUrl(i){i.length>0&&"/"===i[0]&&(i=i.slice(1));for(const e of this.menuList){let n=!1;for(const u of e.children)u.active=u.compare.test(i),u.active&&(n=!0);e.active=n,e.opened=n}}initMenuList(){this.initMenuGoods(),this.initMenuStore(),this.initMenuDicti(),this.initMenuStaff()}initMenuGoods(){const i=[];this.userService.hasPermissions([g.j.goodsEdit,g.j.goodsView])&&(i.push({title:"\u0411\u043b\u044e\u0434\u0430",route:"admin/goods-dish",active:!1,compare:/admin\/goods-dish/}),i.push({title:"\u041c\u043e\u0434\u0438\u0444\u0438\u043a\u0430\u0442\u043e\u0440\u044b",route:"admin/goods-mods",active:!1,compare:/admin\/goods-mods/}),i.push({title:"\u0418\u043d\u0433\u0440\u0435\u0434\u0438\u0435\u043d\u0442\u044b",route:"admin/goods-ingredients",active:!1,compare:/admin\/goods-ingredients/})),i.length>0&&this.menuList.push({title:"\u041d\u043e\u043c\u0435\u043d\u043a\u043b\u0430\u0442\u0443\u0440\u0430",icon:"fastfood",active:!1,childHeight:25*i.length,opened:!1,children:i})}initMenuStore(){const i=[];this.userService.hasPermissions([g.j.docIncomingEdit,g.j.docIncomingView])&&i.push({title:"\u041f\u0440\u0438\u0445\u043e\u0434\u043d\u044b\u0435 \u043d\u0430\u043a\u043b\u0430\u0434\u043d\u044b\u0435",route:"admin/store-docs-incoming",active:!1,compare:/admin\/store-docs-incoming/}),i.length>0&&this.menuList.push({title:"\u0421\u043a\u043b\u0430\u0434\u0441\u043a\u0438\u0435 \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u044b",icon:"fact_check",active:!1,childHeight:25*i.length,opened:!1,children:i})}initMenuDicti(){const i=[];this.userService.hasPermissions([g.j.dictiEdit,g.j.dictiView])&&(i.push({title:"\u0415\u0434\u0438\u043d\u0438\u0446\u044b \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f",route:"admin/dictionaries/units",active:!1,compare:/admin\/dictionaries\/units/}),i.push({title:"\u0424\u0430\u0441\u043e\u0432\u043a\u0438",route:"admin/dictionaries/packingunits",active:!1,compare:/admin\/dictionaries\/packingunits/})),i.length>0&&this.menuList.push({title:"\u0421\u043f\u0440\u0430\u0432\u043e\u0447\u043d\u0438\u043a\u0438",icon:"receipt",active:!1,childHeight:25*i.length,opened:!1,children:i})}initMenuStaff(){const i=[];this.userService.hasPermissions([g.j.userView,g.j.userEdit])&&i.push({title:"\u0421\u043e\u0442\u0440\u0443\u0434\u043d\u0438\u043a\u0438",route:"admin/users",active:!1,compare:/admin\/users/}),this.userService.hasPermissions([g.j.roleView,g.j.roleEdit])&&i.push({title:"\u0414\u043e\u043b\u0436\u043d\u043e\u0441\u0442\u0438",route:"admin/roles",active:!1,compare:/admin\/roles/}),i.length>0&&this.menuList.push({title:"\u041f\u0435\u0440\u0441\u043e\u043d\u0430\u043b",icon:"manage_accounts",active:!1,childHeight:25*i.length,opened:!1,children:i})}}Y.\u0275fac=function(i){return new(i||Y)(t.Y36(b.F0),t.Y36(h.KD),t.Y36(h.e8),t.Y36(k.Dx))},Y.\u0275cmp=t.Xpm({type:Y,selectors:[["adm-home"]],hostVars:1,hostBindings:function(i,e){2&i&&t.uIk("class",e.getClass)},decls:20,vars:4,consts:[[1,"side-menu"],[1,"flex-align-center"],["routerLink","/admin",1,"logo"],[1,"flex-align-center","flex-auto"],[1,"username",3,"matTooltip"],["mat-icon-button","","color","accent","matTooltip","\u0417\u0430\u0432\u0435\u0440\u0448\u0438\u0442\u044c \u0441\u0435\u0441\u0441\u0438\u044e \u0440\u0430\u0431\u043e\u0442\u044b",3,"click"],[1,"menu"],[1,"scroll-container"],[1,"scroll-"],["class","menu-section",4,"ngFor","ngForOf"],[1,"view-container"],[1,"view-container__content"],[1,"view-container__statusbar"],[1,"menu-section"],[1,"menu-section-title",3,"click"],[1,"flex-auto"],[4,"ngIf"],[1,"menu-section-children"],["class","menu-child",3,"selected","click",4,"ngFor","ngForOf"],[1,"menu-child",3,"click"]],template:function(i,e){1&i&&(t.TgZ(0,"div",0)(1,"div",1),t._UZ(2,"div",2),t.TgZ(3,"div",3)(4,"div",4),t._uU(5),t.qZA(),t.TgZ(6,"mat-icon"),t._uU(7,"account_circle"),t.qZA()(),t.TgZ(8,"button",5),t.NdJ("click",function(){return e.onLogout()}),t.TgZ(9,"mat-icon"),t._uU(10,"power_settings_new"),t.qZA()()(),t.TgZ(11,"div",6)(12,"div",7)(13,"div",8),t.YNc(14,Ct,10,9,"div",9),t.qZA()()()(),t.TgZ(15,"div",10)(16,"div",11),t._UZ(17,"router-outlet"),t.qZA(),t.TgZ(18,"div",12),t._uU(19),t.qZA()()),2&i&&(t.xp6(4),t.MGl("matTooltip","\u0412\u044b \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u043e\u0432\u0430\u043d\u044b \u043a\u0430\u043a ",e.userName,""),t.xp6(1),t.hij(" ",e.userName," "),t.xp6(9),t.Q6J("ngForOf",e.menuList),t.xp6(5),t.hij("\xa9 ",e.copyright,""))},dependencies:[_.sg,_.O5,b.lC,b.rH,x.Hw,p.RK,C.gM],styles:["[_nghost-%COMP%]{flex:auto;display:flex}.side-menu[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:250px;background-color:#0c2632;color:#8fa8b4}.view-container[_ngcontent-%COMP%], .view-container[_ngcontent-%COMP%]   .view-container__content[_ngcontent-%COMP%]{flex:auto;display:flex;flex-direction:column}.view-container[_ngcontent-%COMP%]   .view-container__statusbar[_ngcontent-%COMP%]{font-size:11px;line-height:14px;text-align:right;padding-right:10px}.logo[_ngcontent-%COMP%]{width:54px;height:27px;margin:3px 0 0 5px;cursor:pointer;background-color:transparent;background-position:center center;background-repeat:no-repeat;background-size:contain;background-image:url(logo.3246863ca3fff759.png)}.username[_ngcontent-%COMP%]{flex:auto;white-space:nowrap;overflow:hidden;width:123px;text-overflow:ellipsis;font-size:14px;text-align:center;-webkit-user-select:none;user-select:none}.menu[_ngcontent-%COMP%]{flex:auto;display:flex;flex-direction:column;margin-top:10px}.menu[_ngcontent-%COMP%]   .menu-section[_ngcontent-%COMP%]{display:flex;flex-direction:column}.menu[_ngcontent-%COMP%]   .menu-section[_ngcontent-%COMP%]   .menu-section-title[_ngcontent-%COMP%]{display:flex;align-items:center;padding:3px 5px;-webkit-user-select:none;user-select:none;cursor:pointer;transition:.2s}.menu[_ngcontent-%COMP%]   .menu-section[_ngcontent-%COMP%]   .menu-section-title[_ngcontent-%COMP%]:hover{background-color:#ffffff1a}.menu[_ngcontent-%COMP%]   .menu-section[_ngcontent-%COMP%]   .menu-section-title.selected[_ngcontent-%COMP%]{font-weight:700;color:#fff}.menu[_ngcontent-%COMP%]   .menu-section[_ngcontent-%COMP%]   .menu-section-title[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]:first-child{margin-right:5px}.menu[_ngcontent-%COMP%]   .menu-section[_ngcontent-%COMP%]   .menu-section-children[_ngcontent-%COMP%]{display:flex;flex-direction:column;overflow-y:hidden;transition:height .3s;height:0}.menu[_ngcontent-%COMP%]   .menu-section[_ngcontent-%COMP%]   .menu-section-children[_ngcontent-%COMP%]   .menu-child[_ngcontent-%COMP%]{display:flex;padding:3px 5px 3px 32px;cursor:pointer;transition:.2s;-webkit-user-select:none;user-select:none}.menu[_ngcontent-%COMP%]   .menu-section[_ngcontent-%COMP%]   .menu-section-children[_ngcontent-%COMP%]   .menu-child[_ngcontent-%COMP%]:hover{background-color:#ffffff1a}.menu[_ngcontent-%COMP%]   .menu-section[_ngcontent-%COMP%]   .menu-section-children[_ngcontent-%COMP%]   .menu-child.selected[_ngcontent-%COMP%]{font-weight:700;color:#fff}"]});var f=m(8746);const dt="\u0411\u0435\u0437 \u0440\u043e\u0434\u0438\u0442\u0435\u043b\u044c\u0441\u043a\u043e\u0439 \u0433\u0440\u0443\u043f\u043f\u044b";class D{constructor(){this.totalCount=0,this.pageSize=50,this.pageIndex=0,this.pageSizeOptions=[10,30,50,100],this.total=0,this.dataSource=[],this.updatePaginator=new O.x,this.displayedColumns=[],this.reducedGroups=[],this.initialData=[]}get colspanTable(){return this.displayedColumns.length}getList(i){}onPageChanged(i){this.pageSize=i.pageSize,this.getList(i.pageIndex)}isGroup(i,e){return e.isGroup}reduceGroup(i){i.expanded=!i.expanded,i.expanded?this.reducedGroups.push(i):this.reducedGroups=this.reducedGroups.filter(e=>e.value!=i.value),this.dataSource=this.groupBy(this.initialData,this.reducedGroups)}groupBy(i,e){const n="parentItem";let u=e;e||(u=[]);const l=i.reduce((v,Z)=>{const rt=Z[n];return v[rt]||(v[rt]=[{groupName:Z[n]??dt,value:Z[n],isGroup:!0,expanded:(u||[]).some(Go=>Go.value==Z[n])}]),v[rt].push(Z),v},{});return Object.keys(l).map(v=>l[v]).reduce((v,Z)=>v.concat(Z),[]).filter(v=>v.isGroup||(u||[]).every(Z=>v[n]!=Z.value))}}var a=m(3448),N=m(4128),ot=m(7084);function vt(o,i){1&o&&(t.TgZ(0,"div",6),t._UZ(1,"div",7),t.qZA())}function At(o,i){1&o&&(t.TgZ(0,"div",22),t._uU(1," \u041d\u0435\u0442 \u0440\u0430\u0437\u0440\u0435\u0448\u0435\u043d\u0438\u0439 "),t.qZA())}function bt(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"button",27),t.NdJ("click",function(){t.CHM(e);const u=t.oxw(2).$implicit,s=t.oxw(3);return t.KtG(s.onMovePermission(u,s.availablePermissions))}),t.TgZ(1,"mat-icon"),t._uU(2,"highlight_off"),t.qZA()()}}function Tt(o,i){if(1&o&&(t.TgZ(0,"div",24)(1,"div",25),t._uU(2),t.qZA(),t.YNc(3,bt,3,0,"button",26),t.qZA()),2&o){const e=t.oxw().$implicit,n=t.oxw(3);t.xp6(2),t.Oqu(e.name),t.xp6(1),t.Q6J("ngIf",n.isPermissionEdit)}}function Zt(o,i){if(1&o&&(t.ynx(0),t.YNc(1,Tt,4,2,"div",23),t.BQk()),2&o){const e=i.$implicit;t.xp6(1),t.Q6J("ngIf",e.visible)}}function wt(o,i){if(1&o&&(t.TgZ(0,"mat-expansion-panel",18)(1,"mat-expansion-panel-header")(2,"mat-panel-title"),t._uU(3),t.qZA()(),t.TgZ(4,"div",19),t.YNc(5,At,2,0,"div",20),t.YNc(6,Zt,2,1,"ng-container",21),t.qZA()()),2&o){const e=i.$implicit,n=t.oxw(2);t.Q6J("expanded",e.expanded),t.xp6(3),t.hij(" ",e.name," "),t.xp6(2),t.Q6J("ngIf",!n.hasVisiblePermissions(e.permissions)),t.xp6(1),t.Q6J("ngForOf",e.permissions)}}function Et(o,i){1&o&&(t.TgZ(0,"div",22),t._uU(1," \u041d\u0435\u0442 \u0440\u0430\u0437\u0440\u0435\u0448\u0435\u043d\u0438\u0439 "),t.qZA())}function Dt(o,i){1&o&&(t.TgZ(0,"mat-icon",31),t._uU(1," add_circle_outline "),t.qZA())}function yt(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"div",29),t.NdJ("click",function(){t.CHM(e);const u=t.oxw().$implicit,s=t.oxw(3);return t.KtG(s.onMovePermission(u,s.rolePermissions))}),t.YNc(1,Dt,2,0,"mat-icon",30),t.TgZ(2,"div",25),t._uU(3),t.qZA()()}if(2&o){const e=t.oxw().$implicit,n=t.oxw(3);t.xp6(1),t.Q6J("ngIf",n.isPermissionEdit),t.xp6(2),t.Oqu(e.name)}}function It(o,i){if(1&o&&(t.ynx(0),t.YNc(1,yt,4,2,"div",28),t.BQk()),2&o){const e=i.$implicit;t.xp6(1),t.Q6J("ngIf",e.visible)}}function kt(o,i){if(1&o&&(t.TgZ(0,"mat-expansion-panel",18)(1,"mat-expansion-panel-header")(2,"mat-panel-title"),t._uU(3),t.qZA()(),t.TgZ(4,"div",19),t.YNc(5,Et,2,0,"div",20),t.YNc(6,It,2,1,"ng-container",21),t.qZA()()),2&o){const e=i.$implicit,n=t.oxw(2);t.Q6J("expanded",e.expanded),t.xp6(3),t.hij(" ",e.name," "),t.xp6(2),t.Q6J("ngIf",!n.hasVisiblePermissions(e.permissions)),t.xp6(1),t.Q6J("ngForOf",e.permissions)}}function Nt(o,i){if(1&o&&(t.TgZ(0,"div",8)(1,"div",9)(2,"div"),t._UZ(3,"kui-input",10),t.qZA(),t.TgZ(4,"div",11),t._uU(5,"\u0420\u0430\u0437\u0440\u0435\u0448\u0435\u043d\u0438\u044f \u0434\u043b\u044f \u0434\u043e\u043b\u0436\u043d\u043e\u0441\u0442\u0438"),t.qZA(),t.TgZ(6,"div",12)(7,"div",13)(8,"mat-accordion",14),t.YNc(9,wt,7,4,"mat-expansion-panel",15),t.qZA()()()(),t.TgZ(10,"div",16)(11,"div"),t._UZ(12,"kui-input",17),t.qZA(),t.TgZ(13,"div",11),t._uU(14,"\u0414\u043e\u0441\u0442\u0443\u043f\u043d\u044b\u0435 \u0440\u0430\u0437\u0440\u0435\u0448\u0435\u043d\u0438\u044f"),t.qZA(),t.TgZ(15,"div",12)(16,"div",13)(17,"mat-accordion",14),t.YNc(18,kt,7,4,"mat-expansion-panel",15),t.qZA()()()()()),2&o){const e=t.oxw();t.Q6J("formGroup",e.formGroup),t.xp6(3),t.Q6J("tabindex",1)("readonly",!e.isPermissionEdit),t.xp6(6),t.Q6J("ngForOf",e.rolePermissions),t.xp6(3),t.Q6J("tabindex",2)("readonly",!e.isPermissionEdit),t.xp6(6),t.Q6J("ngForOf",e.availablePermissions)}}function St(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"button",32),t.NdJ("click",function(){t.CHM(e);const u=t.oxw();return t.KtG(u.onApply())}),t._uU(1," \u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c "),t.qZA()}}class B{constructor(i,e,n){this.dialogService=i,this.userService=e,this.apiAdminService=n,this.loading=!0,this.rolePermissions=[],this.availablePermissions=[],this.formGroup=new r.cw({name:new a.jn(null,r.kI.required),description:new a.jn(null)}),this.rolePermissionsDef=[]}get roleId(){return this.modalChildData?.roleId??null}get isPermissionEdit(){return this.userService.hasPermissions(g.j.roleEdit)}ngOnInit(){let i;i=this.roleId?[this.apiAdminService.getPermisionGroups(),this.apiAdminService.getRole(this.roleId)]:[this.apiAdminService.getPermisionGroups()],(0,N.D)(i).pipe((0,f.x)(()=>this.loading=!1)).subscribe({next:e=>{if(e[1]){const n=e[1];this.formGroup.patchValue(n),this.rolePermissionsDef=n.permissions}this.updatePermisionGroups(e[0])},error:e=>{this.dialogService.showToastError(e.message),this.availablePermissions=[]}})}onMovePermission(i,e){if(!this.isPermissionEdit)return;const n=e.find(u=>u.id===i.moduleId);if(n){n.expanded=!0;const u=n.permissions.find(s=>s.id===i.id);u&&(u.visible=!0,i.visible=!1)}}hasVisiblePermissions(i){return i.some(e=>e.visible)}onApply(){if(!this.formGroup.valid)return void this.formGroup.markAllAsTouched();this.dialogService.showWait("\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435...");const i=[];this.rolePermissions.forEach(n=>{n.permissions.forEach(u=>{u.visible&&i.push(u.id)})});const e={id:this.roleId,permissions:i,...this.formGroup.value};this.apiAdminService.saveRole(e).pipe((0,f.x)(()=>this.dialogService.hideWait())).subscribe({next:()=>this.dialogRef?.close(!0),error:n=>this.dialogService.showToastError(n.message)})}onClose(){this.dialogRef?.close(!1)}updatePermisionGroups(i){this.availablePermissions=i.map(e=>({id:e.id,name:e.name,expanded:!1,permissions:e.permissions.map(n=>({...n,visible:!this.rolePermissionsDef.includes(n.id)}))})),this.rolePermissions=i.map(e=>({id:e.id,name:e.name,expanded:!1,permissions:e.permissions.map(n=>({...n,visible:this.rolePermissionsDef.includes(n.id)}))}))}}B.\u0275fac=function(i){return new(i||B)(t.Y36(a.xA),t.Y36(h.KD),t.Y36(h.ib))},B.\u0275cmp=t.Xpm({type:B,selectors:[["adm-role-edit"]],decls:7,vars:3,consts:[[1,"inside-modal-body-container"],["class","flex-col-centered",4,"ngIf"],["class","flex-row flex-auto",3,"formGroup",4,"ngIf"],[1,"footer-buttons"],["mat-raised-button","","color","primary",3,"click",4,"ngIf"],["mat-raised-button","","color","accent",3,"click"],[1,"flex-col-centered"],[1,"loading-block"],[1,"flex-row","flex-auto",3,"formGroup"],[1,"side-container"],["label","\u041d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u0435","appearance","outline","formControlName","name",3,"tabindex","readonly"],[1,"text-center","text-bold"],[1,"scroll-container","mt-10"],[1,"scroll"],[1,"mt-10"],[3,"expanded",4,"ngFor","ngForOf"],[1,"side-container","ml-10"],["label","\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435","appearance","outline","formControlName","description",3,"tabindex","readonly"],[3,"expanded"],[1,"roles-list"],["class","text-center text-danger mt-10 mb-10",4,"ngIf"],[4,"ngFor","ngForOf"],[1,"text-center","text-danger","mt-10","mb-10"],["class","roles-list__item",4,"ngIf"],[1,"roles-list__item"],[1,"roles-list__title"],["mat-icon-button","","color","accent",3,"click",4,"ngIf"],["mat-icon-button","","color","accent",3,"click"],["class","roles-list__item cursor-pointer",3,"click",4,"ngIf"],[1,"roles-list__item","cursor-pointer",3,"click"],["color","success",4,"ngIf"],["color","success"],["mat-raised-button","","color","primary",3,"click"]],template:function(i,e){1&i&&(t.TgZ(0,"div",0),t.YNc(1,vt,2,0,"div",1),t.YNc(2,Nt,19,7,"div",2),t.qZA(),t.TgZ(3,"div",3),t.YNc(4,St,2,0,"button",4),t.TgZ(5,"button",5),t.NdJ("click",function(){return e.onClose()}),t._uU(6,"\u0417\u0430\u043a\u0440\u044b\u0442\u044c"),t.qZA()()),2&i&&(t.xp6(1),t.Q6J("ngIf",e.loading),t.xp6(1),t.Q6J("ngIf",!e.loading),t.xp6(2),t.Q6J("ngIf",e.isPermissionEdit))},dependencies:[_.sg,_.O5,r.JJ,r.JL,r.sg,r.u,a.y0,x.Hw,p.lW,p.RK,ot.pp,ot.ib,ot.yz,ot.yK],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;width:750px;height:460px}[_nghost-%COMP%]  .mat-expansion-panel-body{padding:0!important}.side-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:50%;padding-top:10px}.roles-list[_ngcontent-%COMP%]{display:flex;flex-direction:column}.roles-list[_ngcontent-%COMP%]   .roles-list__item[_ngcontent-%COMP%]{display:flex;align-items:center;padding:0 10px;height:32px}.roles-list[_ngcontent-%COMP%]   .roles-list__item[_ngcontent-%COMP%]:hover{background-color:#d6e6fc}.roles-list[_ngcontent-%COMP%]   .roles-list__title[_ngcontent-%COMP%]{flex:auto;padding:0 10px}"]});var c=m(671),y=m(8739);function Rt(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"button",18),t.NdJ("click",function(){t.CHM(e);const u=t.oxw();return t.KtG(u.onAddRecord())}),t.TgZ(1,"mat-icon"),t._uU(2,"add"),t.qZA(),t.TgZ(3,"span"),t._uU(4,"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0434\u043e\u043b\u0436\u043d\u043e\u0441\u0442\u044c"),t.qZA()()}}function Lt(o,i){if(1&o&&(t.TgZ(0,"th",22),t._uU(1),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.hij(" ",e.header," ")}}function Ut(o,i){if(1&o&&(t.TgZ(0,"td",23),t._uU(1),t.qZA()),2&o){const e=i.$implicit,n=t.oxw().$implicit;t.uIk("class",n.className),t.xp6(1),t.hij(" ",n.cell(e)," ")}}function Jt(o,i){1&o&&(t.ynx(0,19),t.YNc(1,Lt,2,1,"th",20),t.YNc(2,Ut,2,2,"td",21),t.BQk()),2&o&&t.Q6J("matColumnDef",i.$implicit.key)}function Pt(o,i){1&o&&(t.TgZ(0,"th",24),t._uU(1," \xa0 "),t.qZA())}function Mt(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"button",29),t.NdJ("click",function(u){t.CHM(e);const s=t.oxw().$implicit,l=t.oxw();return t.KtG(l.onRemoveRow(u,s))}),t.TgZ(1,"mat-icon"),t._uU(2,"highlight_off"),t.qZA()()}}function qt(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"td",25)(1,"div",26)(2,"button",27),t.NdJ("click",function(u){const l=t.CHM(e).$implicit,d=t.oxw();return t.KtG(d.onEditRow(u,l))}),t.TgZ(3,"mat-icon"),t._uU(4,"edit"),t.qZA()(),t.YNc(5,Mt,3,0,"button",28),t.qZA()()}if(2&o){const e=t.oxw();t.xp6(2),t.s9C("matTooltip",e.isPermissionEdit?"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0437\u0430\u043f\u0438\u0441\u044c":"\u041f\u0440\u043e\u0441\u043c\u043e\u0442\u0440\u0435\u0442\u044c \u0437\u0430\u043f\u0438\u0441\u044c"),t.xp6(3),t.Q6J("ngIf",e.isPermissionRemove)}}function Ft(o,i){1&o&&t._UZ(0,"tr",30)}function Gt(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"tr",31),t.NdJ("dblclick",function(){const s=t.CHM(e).$implicit,l=t.oxw();return t.KtG(l.onEditRow(null,s))}),t.qZA()}}function Qt(o,i){1&o&&(t.TgZ(0,"div",32),t._uU(1," \u041d\u0435\u0442 \u0434\u0430\u043d\u043d\u044b\u0445 "),t.qZA())}class H extends D{constructor(i,e,n,u){super(),this.dialogService=i,this.userService=e,this.apiAdminService=n,this.columns=[{key:"name",header:"\u041d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u0435",className:"text-center",cell:s=>`${s.name}`},{key:"description",header:"\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435",className:"text-center",cell:s=>`${s.description}`}],u.setTitle(`\u0421\u043f\u0438\u0441\u043e\u043a \u0440\u043e\u043b\u0435\u0439 | \u0410\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 | ${E.X}`)}get isPermissionEdit(){return this.userService.hasPermissions(g.j.roleEdit)}get isPermissionRemove(){return this.userService.hasPermissions(g.j.roleRemove)}ngOnInit(){this.displayedColumns=this.isPermissionEdit||this.isPermissionRemove||this.userService.hasPermissions(g.j.roleView)?["name","description","buttons"]:["name","description"],this.getList()}onReload(){this.getList()}onAddRecord(){this.editRecord()}onEditRow(i,e){i?.stopPropagation(),this.editRecord(e)}onRemoveRow(i,e){i.stopPropagation(),this.dialogService.showConfirm("\u0412\u044b \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u0445\u043e\u0442\u0438\u0442\u0435 \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u044d\u0442\u0443 \u0434\u043e\u043b\u0436\u043d\u043e\u0441\u0442\u044c?").subscribe(n=>{n&&e.id&&(this.dialogService.showWait("\u0423\u0434\u0430\u043b\u0435\u043d\u0438\u0435..."),this.apiAdminService.removeRole(e.id).pipe((0,f.x)(()=>this.dialogService.hideWait())).subscribe({next:()=>{this.getList()},error:u=>this.dialogService.showToastError(u.message)}))})}getList(){this.dialogService.showWait("\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u0434\u0430\u043d\u043d\u044b\u0445..."),this.apiAdminService.getListRoles().pipe((0,f.x)(()=>this.dialogService.hideWait())).subscribe({next:i=>{this.total=i.count,this.dataSource=i.values},error:i=>this.dialogService.showToastError(i.message)})}editRecord(i){let e=i?"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0434\u043e\u043b\u0436\u043d\u043e\u0441\u0442\u0438":"\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0434\u043e\u043b\u0436\u043d\u043e\u0441\u0442\u0438";this.isPermissionEdit||(e="\u041f\u0440\u043e\u0441\u043c\u043e\u0442\u0440 \u0434\u043e\u043b\u0436\u043d\u043e\u0441\u0442\u0438"),this.dialogService.showModal(e,B,{roleId:i?.id??null},!0).subscribe(n=>{n&&this.getList()})}}function Ot(o,i){1&o&&(t.TgZ(0,"div",6),t._UZ(1,"div",7),t.qZA())}function Yt(o,i){if(1&o&&(t.TgZ(0,"div",8)(1,"div",9)(2,"div",10)(3,"div"),t._UZ(4,"kui-input",11),t.qZA(),t.TgZ(5,"div"),t._UZ(6,"kui-input",12),t.qZA(),t.TgZ(7,"div"),t._UZ(8,"kui-input",13),t.qZA()()(),t.TgZ(9,"div",14)(10,"div",15),t._UZ(11,"kui-select",16),t.qZA(),t.TgZ(12,"div",17),t._UZ(13,"kui-input",18),t.qZA()()()),2&o){const e=t.oxw();t.Q6J("formGroup",e.formGroup),t.xp6(4),t.Q6J("readonly",!e.isPermissionEdit),t.xp6(2),t.Q6J("readonly",!e.isPermissionEdit),t.xp6(2),t.Q6J("readonly",!e.isPermissionEdit),t.xp6(3),t.Q6J("multiple",!0)("options",e.rolesList)("readonly",!e.isPermissionEdit),t.xp6(2),t.Q6J("readonly",!e.isPermissionEdit)}}function Bt(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"button",19),t.NdJ("click",function(){t.CHM(e);const u=t.oxw();return t.KtG(u.onApply())}),t._uU(1," \u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c "),t.qZA()}}H.\u0275fac=function(i){return new(i||H)(t.Y36(a.xA),t.Y36(h.KD),t.Y36(h.ib),t.Y36(k.Dx))},H.\u0275cmp=t.Xpm({type:H,selectors:[["adm-role-list"]],features:[t.qOj],decls:22,vars:9,consts:[[1,"page-list"],[1,"page-list__head"],[1,"page-title"],[1,"page-subtitle"],[3,"length","hidePageSize"],["mat-icon-button","","color","primary",3,"click"],["mat-raised-button","","color","primary","class","mat-button-with-icon head-button ml-10",3,"click",4,"ngIf"],[1,"page-list__content"],[1,"scroll-container"],[1,"scroll"],["mat-table","",1,"table","with-borders",3,"dataSource"],[3,"matColumnDef",4,"ngFor","ngForOf"],["matColumnDef","buttons"],["mat-header-cell","","class","buttons-cell",4,"matHeaderCellDef"],["mat-cell","","class","buttons-cell",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","","class","table-row",3,"dblclick",4,"matRowDef","matRowDefColumns"],["class","text-center text-danger mt-10",4,"ngIf"],["mat-raised-button","","color","primary",1,"mat-button-with-icon","head-button","ml-10",3,"click"],[3,"matColumnDef"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["mat-header-cell",""],["mat-cell",""],["mat-header-cell","",1,"buttons-cell"],["mat-cell","",1,"buttons-cell"],[1,"container"],["mat-icon-button","","color","primary",3,"matTooltip","click"],["mat-icon-button","","color","accent","matTooltip","\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u0437\u0430\u043f\u0438\u0441\u044c",3,"click",4,"ngIf"],["mat-icon-button","","color","accent","matTooltip","\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u0437\u0430\u043f\u0438\u0441\u044c",3,"click"],["mat-header-row",""],["mat-row","",1,"table-row",3,"dblclick"],[1,"text-center","text-danger","mt-10"]],template:function(i,e){1&i&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2),t._uU(3,"\u041f\u0435\u0440\u0441\u043e\u043d\u0430\u043b"),t.qZA(),t.TgZ(4,"div",3),t._uU(5,"\xa0\u27a4\xa0\u0414\u043e\u043b\u0436\u043d\u043e\u0441\u0442\u0438"),t.qZA(),t._UZ(6,"mat-paginator",4),t.TgZ(7,"button",5),t.NdJ("click",function(){return e.onReload()}),t.TgZ(8,"mat-icon"),t._uU(9,"autorenew"),t.qZA()(),t.YNc(10,Rt,5,0,"button",6),t.qZA(),t.TgZ(11,"div",7)(12,"div",8)(13,"div",9)(14,"table",10),t.YNc(15,Jt,3,1,"ng-container",11),t.ynx(16,12),t.YNc(17,Pt,2,0,"th",13),t.YNc(18,qt,6,2,"td",14),t.BQk(),t.YNc(19,Ft,1,0,"tr",15),t.YNc(20,Gt,1,0,"tr",16),t.qZA(),t.YNc(21,Qt,2,0,"div",17),t.qZA()()()()),2&i&&(t.xp6(6),t.Q6J("length",e.total)("hidePageSize",!0),t.xp6(4),t.Q6J("ngIf",e.isPermissionEdit),t.xp6(4),t.Q6J("dataSource",e.dataSource),t.xp6(1),t.Q6J("ngForOf",e.columns),t.xp6(4),t.Q6J("matHeaderRowDef",e.displayedColumns)("matHeaderRowDefSticky",!0),t.xp6(1),t.Q6J("matRowDefColumns",e.displayedColumns),t.xp6(1),t.Q6J("ngIf",0===e.dataSource.length))},dependencies:[_.sg,_.O5,x.Hw,p.lW,p.RK,c.BZ,c.fO,c.as,c.w1,c.Dz,c.nj,c.ge,c.ev,c.XQ,c.Gk,y.NW,C.gM],styles:["[_nghost-%COMP%]{flex:auto;display:flex;flex-direction:column}[_nghost-%COMP%]{flex:auto;display:flex;flex-direction:columns}"]});class j{constructor(i,e,n){this.dialogService=i,this.userService=e,this.apiAdminService=n,this.loading=!0,this.rolesList=[],this.formGroup=new r.cw({family:new a.jn(null),name:new a.jn(null,r.kI.required),patronimyc:new a.jn(null),roles:new a.jn(null),pinCode:new a.jn(null,r.kI.required)})}get userId(){return this.modalChildData?.userId??null}get isPermissionEdit(){return this.userService.hasPermissions(g.j.roleEdit)}ngOnInit(){let i;i=this.userId?[this.apiAdminService.getListRoles(),this.apiAdminService.getUser(this.userId)]:[this.apiAdminService.getListRoles()],(0,N.D)(i).pipe((0,f.x)(()=>this.loading=!1)).subscribe({next:e=>{this.rolesList=(e[0].values||[]).map(n=>({value:n.id,title:n.name})),e[1]&&this.formGroup.patchValue(e[1])},error:e=>this.dialogService.showToastError(e.message)})}onApply(){if(!this.formGroup.valid)return void this.formGroup.markAllAsTouched();this.dialogService.showWait("\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435...");const i={id:this.userId,...this.formGroup.value};this.apiAdminService.saveUser(i).pipe((0,f.x)(()=>this.dialogService.hideWait())).subscribe({next:()=>this.dialogRef?.close(!0),error:e=>this.dialogService.showToastError(e.message)})}onClose(){this.dialogRef?.close(!1)}}function Ht(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"button",18),t.NdJ("click",function(){t.CHM(e);const u=t.oxw();return t.KtG(u.onAddRecord())}),t.TgZ(1,"mat-icon"),t._uU(2,"add"),t.qZA(),t.TgZ(3,"span"),t._uU(4,"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0441\u043e\u0442\u0440\u0443\u0434\u043d\u0438\u043a\u0430"),t.qZA()()}}function jt(o,i){if(1&o&&(t.TgZ(0,"th",22),t._uU(1),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.hij(" ",e.header," ")}}function $t(o,i){if(1&o&&(t.TgZ(0,"td",23),t._uU(1),t.qZA()),2&o){const e=i.$implicit,n=t.oxw().$implicit;t.uIk("class",n.className),t.xp6(1),t.hij(" ",n.cell(e)," ")}}function Kt(o,i){1&o&&(t.ynx(0,19),t.YNc(1,jt,2,1,"th",20),t.YNc(2,$t,2,2,"td",21),t.BQk()),2&o&&t.Q6J("matColumnDef",i.$implicit.key)}function Wt(o,i){1&o&&(t.TgZ(0,"th",24),t._uU(1," \xa0 "),t.qZA())}function zt(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"button",29),t.NdJ("click",function(u){t.CHM(e);const s=t.oxw().$implicit,l=t.oxw();return t.KtG(l.onRemoveRow(u,s))}),t.TgZ(1,"mat-icon"),t._uU(2,"highlight_off"),t.qZA()()}}function Xt(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"td",25)(1,"div",26)(2,"button",27),t.NdJ("click",function(u){const l=t.CHM(e).$implicit,d=t.oxw();return t.KtG(d.onEditRow(u,l))}),t.TgZ(3,"mat-icon"),t._uU(4,"edit"),t.qZA()(),t.YNc(5,zt,3,0,"button",28),t.qZA()()}if(2&o){const e=t.oxw();t.xp6(2),t.s9C("matTooltip",e.isPermissionEdit?"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0437\u0430\u043f\u0438\u0441\u044c":"\u041f\u0440\u043e\u0441\u043c\u043e\u0442\u0440\u0435\u0442\u044c \u0437\u0430\u043f\u0438\u0441\u044c"),t.xp6(3),t.Q6J("ngIf",e.isPermissionRemove)}}function Vt(o,i){1&o&&t._UZ(0,"tr",30)}function te(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"tr",31),t.NdJ("dblclick",function(){const s=t.CHM(e).$implicit,l=t.oxw();return t.KtG(l.onEditRow(null,s))}),t.qZA()}}function ee(o,i){1&o&&(t.TgZ(0,"div",32),t._uU(1," \u041d\u0435\u0442 \u0434\u0430\u043d\u043d\u044b\u0445 "),t.qZA())}j.\u0275fac=function(i){return new(i||j)(t.Y36(a.xA),t.Y36(h.KD),t.Y36(h.ib))},j.\u0275cmp=t.Xpm({type:j,selectors:[["adm-user-edit"]],decls:7,vars:3,consts:[[1,"inside-modal-body-container"],["class","flex-col-centered",4,"ngIf"],["class","flex-col flex-auto",3,"formGroup",4,"ngIf"],[1,"footer-buttons"],["mat-raised-button","","color","primary",3,"click",4,"ngIf"],["mat-raised-button","","color","accent",3,"click"],[1,"flex-col-centered"],[1,"loading-block"],[1,"flex-col","flex-auto",3,"formGroup"],[1,"base-info-container","mb-10"],[1,"grid-3-cell"],["label","\u0424\u0430\u043c\u0438\u043b\u0438\u044f","formControlName","family",3,"readonly"],["label","\u0418\u043c\u044f","formControlName","name",3,"readonly"],["label","\u041e\u0442\u0447\u0435\u0441\u0442\u0432\u043e","formControlName","patronimyc",3,"readonly"],[1,"flex-row","mt-10"],[1,"flex-auto"],["appearance","outline","label","\u0420\u043e\u043b\u0438 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f","formControlName","roles",3,"multiple","options","readonly"],[1,"ml-10"],["appearance","outline","label","PIN-\u043a\u043e\u0434","mask","number","formControlName","pinCode","maxlength","6",3,"readonly"],["mat-raised-button","","color","primary",3,"click"]],template:function(i,e){1&i&&(t.TgZ(0,"div",0),t.YNc(1,Ot,2,0,"div",1),t.YNc(2,Yt,14,8,"div",2),t.qZA(),t.TgZ(3,"div",3),t.YNc(4,Bt,2,0,"button",4),t.TgZ(5,"button",5),t.NdJ("click",function(){return e.onClose()}),t._uU(6,"\u0417\u0430\u043a\u0440\u044b\u0442\u044c"),t.qZA()()),2&i&&(t.xp6(1),t.Q6J("ngIf",e.loading),t.xp6(1),t.Q6J("ngIf",!e.loading),t.xp6(2),t.Q6J("ngIf",e.isPermissionEdit))},dependencies:[_.O5,r.JJ,r.JL,r.nD,r.sg,r.u,a.y0,a.os,p.lW],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;width:715px;height:270px}"]});class $ extends D{constructor(i,e,n,u){super(),this.dialogService=i,this.userService=e,this.apiAdminService=n,this.columns=[{key:"fio",header:"\u0424\u0418\u041e",className:"text-center",cell:s=>this.getUserFIO(s)}],u.setTitle(`\u0421\u043f\u0438\u0441\u043e\u043a \u0441\u043e\u0442\u0440\u0443\u0434\u043d\u0438\u043a\u043e\u0432 | \u0410\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 | ${E.X}`)}get isPermissionEdit(){return this.userService.hasPermissions(g.j.userEdit)}get isPermissionRemove(){return this.userService.hasPermissions(g.j.userRemove)}ngOnInit(){this.displayedColumns=this.isPermissionEdit||this.isPermissionRemove||this.userService.hasPermissions(g.j.userView)?["fio","buttons"]:["fio"],this.getList()}onReload(){this.getList()}onAddRecord(){this.editRecord()}onEditRow(i,e){i?.stopPropagation(),this.editRecord(e)}onRemoveRow(i,e){i.stopPropagation(),this.dialogService.showConfirm("\u0412\u044b \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u0445\u043e\u0442\u0438\u0442\u0435 \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u044d\u0442\u043e\u0433\u043e \u0441\u043e\u0442\u0440\u0443\u0434\u043d\u0438\u043a\u0430?").subscribe(n=>{n&&e.id&&(this.dialogService.showWait("\u0423\u0434\u0430\u043b\u0435\u043d\u0438\u0435..."),this.apiAdminService.removeUser(e.id).pipe((0,f.x)(()=>this.dialogService.hideWait())).subscribe({next:()=>{this.getList()},error:u=>this.dialogService.showToastError(u.message)}))})}getList(){this.dialogService.showWait("\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u0434\u0430\u043d\u043d\u044b\u0445..."),this.apiAdminService.getListUsers().pipe((0,f.x)(()=>this.dialogService.hideWait())).subscribe({next:i=>{this.total=i.count,this.dataSource=i.values},error:i=>this.dialogService.showToastError(i.message)})}getUserFIO(i){const e=[];return i.family&&e.push(i.family),i.name&&e.push(i.name),i.patronimyc&&e.push(i.patronimyc),e.join(" ").trim()}editRecord(i){let e=i?"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0441\u043e\u0442\u0440\u0443\u0434\u043d\u0438\u043a\u0430":"\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0441\u043e\u0442\u0440\u0443\u0434\u043d\u0438\u043a\u0430";this.isPermissionEdit||(e="\u041f\u0440\u043e\u0441\u043c\u043e\u0442\u0440 \u0441\u043e\u0442\u0440\u0443\u0434\u043d\u0438\u043a\u0430"),this.dialogService.showModal(e,j,{userId:i?.id??null},!0).subscribe(n=>{n&&this.getList()})}}$.\u0275fac=function(i){return new(i||$)(t.Y36(a.xA),t.Y36(h.KD),t.Y36(h.ib),t.Y36(k.Dx))},$.\u0275cmp=t.Xpm({type:$,selectors:[["adm-user-list"]],features:[t.qOj],decls:22,vars:9,consts:[[1,"page-list"],[1,"page-list__head"],[1,"page-title"],[1,"page-subtitle"],[3,"length","hidePageSize"],["mat-icon-button","","color","primary",3,"click"],["mat-raised-button","","color","primary","class","mat-button-with-icon head-button ml-10",3,"click",4,"ngIf"],[1,"page-list__content"],[1,"scroll-container"],[1,"scroll"],["mat-table","",1,"table","with-borders",3,"dataSource"],[3,"matColumnDef",4,"ngFor","ngForOf"],["matColumnDef","buttons"],["mat-header-cell","","class","buttons-cell",4,"matHeaderCellDef"],["mat-cell","","class","buttons-cell",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","","class","table-row",3,"dblclick",4,"matRowDef","matRowDefColumns"],["class","text-center text-danger mt-10",4,"ngIf"],["mat-raised-button","","color","primary",1,"mat-button-with-icon","head-button","ml-10",3,"click"],[3,"matColumnDef"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["mat-header-cell",""],["mat-cell",""],["mat-header-cell","",1,"buttons-cell"],["mat-cell","",1,"buttons-cell"],[1,"container"],["mat-icon-button","","color","primary",3,"matTooltip","click"],["mat-icon-button","","color","accent","matTooltip","\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u0437\u0430\u043f\u0438\u0441\u044c",3,"click",4,"ngIf"],["mat-icon-button","","color","accent","matTooltip","\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u0437\u0430\u043f\u0438\u0441\u044c",3,"click"],["mat-header-row",""],["mat-row","",1,"table-row",3,"dblclick"],[1,"text-center","text-danger","mt-10"]],template:function(i,e){1&i&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2),t._uU(3,"\u041f\u0435\u0440\u0441\u043e\u043d\u0430\u043b"),t.qZA(),t.TgZ(4,"div",3),t._uU(5,"\xa0\u27a4\xa0\u0421\u043e\u0442\u0440\u0443\u0434\u043d\u0438\u043a\u0438"),t.qZA(),t._UZ(6,"mat-paginator",4),t.TgZ(7,"button",5),t.NdJ("click",function(){return e.onReload()}),t.TgZ(8,"mat-icon"),t._uU(9,"autorenew"),t.qZA()(),t.YNc(10,Ht,5,0,"button",6),t.qZA(),t.TgZ(11,"div",7)(12,"div",8)(13,"div",9)(14,"table",10),t.YNc(15,Kt,3,1,"ng-container",11),t.ynx(16,12),t.YNc(17,Wt,2,0,"th",13),t.YNc(18,Xt,6,2,"td",14),t.BQk(),t.YNc(19,Vt,1,0,"tr",15),t.YNc(20,te,1,0,"tr",16),t.qZA(),t.YNc(21,ee,2,0,"div",17),t.qZA()()()()),2&i&&(t.xp6(6),t.Q6J("length",e.total)("hidePageSize",!0),t.xp6(4),t.Q6J("ngIf",e.isPermissionEdit),t.xp6(4),t.Q6J("dataSource",e.dataSource),t.xp6(1),t.Q6J("ngForOf",e.columns),t.xp6(4),t.Q6J("matHeaderRowDef",e.displayedColumns)("matHeaderRowDefSticky",!0),t.xp6(1),t.Q6J("matRowDefColumns",e.displayedColumns),t.xp6(1),t.Q6J("ngIf",0===e.dataSource.length))},dependencies:[_.sg,_.O5,x.Hw,p.lW,p.RK,c.BZ,c.fO,c.as,c.w1,c.Dz,c.nj,c.ge,c.ev,c.XQ,c.Gk,y.NW,C.gM],styles:["[_nghost-%COMP%]{flex:auto;display:flex;flex-direction:column}"]});var nt=m(2722),ie=m(4004);const oe=["formElement"];class K{constructor(){this.fieldsDto={}}get fieldsRows(){return this.modalChildData?.fieldsRows??[]}get fieldsService(){return this.modalChildData?.fieldsService??null}ngOnInit(){this.modalChildData?.values&&(this.fieldsDto=this.modalChildData.values)}onApply(){this.formElementRef&&this.formElementRef.isFormValid()&&this.dialogRef?.close(!0)}onClose(){this.dialogRef?.close(!1)}}K.\u0275fac=function(i){return new(i||K)},K.\u0275cmp=t.Xpm({type:K,selectors:[["adm-dictionary-edit"]],viewQuery:function(i,e){if(1&i&&t.Gf(oe,5),2&i){let n;t.iGM(n=t.CRH())&&(e.formElementRef=n.first)}},decls:8,vars:3,consts:[[1,"inside-modal-body-container"],[3,"rows","dto","formService"],["formElement",""],[1,"footer-buttons"],["mat-raised-button","","color","primary",3,"click"],["mat-raised-button","","color","accent",3,"click"]],template:function(i,e){1&i&&(t.TgZ(0,"div",0),t._UZ(1,"kui-form-container",1,2),t.qZA(),t.TgZ(3,"div",3)(4,"button",4),t.NdJ("click",function(){return e.onApply()}),t._uU(5," \u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c "),t.qZA(),t.TgZ(6,"button",5),t.NdJ("click",function(){return e.onClose()}),t._uU(7,"\u0417\u0430\u043a\u0440\u044b\u0442\u044c"),t.qZA()()),2&i&&(t.xp6(1),t.Q6J("rows",e.fieldsRows)("dto",e.fieldsDto)("formService",e.fieldsService))},dependencies:[a.CD,p.lW],styles:["[_nghost-%COMP%]{width:420px}"]});const ut=[{code:"units",name:"\u0415\u0434\u0438\u043d\u0438\u0446\u044b \u0438\u0437\u043c\u0435\u0440\u0435\u043d\u0438\u044f",displayedColumns:["name","fullname"],fieldsRows:[{children:[{type:"CONTROL",controlType:"TEXT",label:"\u041d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u0435",autofill:!0,visible:!0,disabled:!1,controlProperties:{required:!0,bindDTO:"name"}}]},{children:[{type:"CONTROL",controlType:"TEXT",label:"\u041f\u043e\u043b\u043d\u043e\u0435 \u043d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u0435",autofill:!0,visible:!0,disabled:!1,controlProperties:{bindDTO:"fullname"}}]}],values:{name:"",fullname:""},columns:[{key:"name",header:"\u041d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u0435",cell:o=>o.name},{key:"fullname",header:"\u041f\u043e\u043b\u043d\u043e\u0435 \u043d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u0435",cell:o=>o.fullname}]},{code:"packingunits",name:"\u0424\u0430\u0441\u043e\u0432\u043a\u0438",displayedColumns:["name","unitsName","coefficient"],fieldsRows:[{children:[{type:"CONTROL",controlType:"TEXT",label:"\u041d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u0435",autofill:!0,visible:!0,disabled:!1,controlProperties:{required:!0,bindDTO:"name"}}]},{children:[{type:"CONTROL",controlType:"SELECT",label:"\u0415\u0434\u0438\u043d\u0438\u0446\u044b \u0438\u0437\u043c\u0435\u0440\u0435\u043d\u0438\u044f",autofill:!0,visible:!0,disabled:!1,controlProperties:{dataSource:"listUnits",bindDTO:"unitsId"}}]},{children:[{type:"CONTROL",controlType:"NUMBER",label:"\u041a\u043e\u044d\u0444\u0444\u0438\u0446\u0438\u0435\u043d\u0442",autofill:!0,visible:!0,disabled:!1,controlProperties:{bindDTO:"coefficient",allowDecimals:!0,decimals:3}}]}],values:{name:"",unitsId:null,coefficient:null},columns:[{key:"name",header:"\u041d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u0435",cell:o=>o.name},{key:"unitsName",header:"\u0411\u0430\u0437\u043e\u0432\u0430\u044f \u0435\u0434\u0438\u043d\u0438\u0446\u0430 \u0438\u0437\u043c\u0435\u0440\u0435\u043d\u0438\u044f",className:"cell-base-units",cell:o=>o.unitsName},{key:"coefficient",header:"\u041a\u043e\u044d\u0444\u0444\u0438\u0446\u0438\u0435\u043d\u0442",className:"cell-coefficient",cell:o=>o.coefficient}]}];var ne=m(1969);function ue(o,i){1&o&&t._UZ(0,"app-page-not-found")}function se(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"button",20),t.NdJ("click",function(){t.CHM(e);const u=t.oxw(2);return t.KtG(u.onAddRecord())}),t.TgZ(1,"mat-icon"),t._uU(2,"add"),t.qZA(),t.TgZ(3,"span"),t._uU(4,"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0437\u0430\u043f\u0438\u0441\u044c"),t.qZA()()}}function ce(o,i){if(1&o&&(t.TgZ(0,"th",24),t._uU(1),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.hij(" ",e.header," ")}}function le(o,i){if(1&o&&(t.TgZ(0,"td",25),t._uU(1),t.qZA()),2&o){const e=i.$implicit,n=t.oxw().$implicit;t.uIk("class",n.className),t.xp6(1),t.hij(" ",n.cell(e)," ")}}function re(o,i){1&o&&(t.ynx(0,21),t.YNc(1,ce,2,1,"th",22),t.YNc(2,le,2,2,"td",23),t.BQk()),2&o&&t.Q6J("matColumnDef",i.$implicit.key)}function ae(o,i){1&o&&(t.TgZ(0,"th",26),t._uU(1," \xa0 "),t.qZA())}function de(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"button",31),t.NdJ("click",function(u){t.CHM(e);const s=t.oxw().$implicit,l=t.oxw(2);return t.KtG(l.onRemoveRow(u,s))}),t.TgZ(1,"mat-icon"),t._uU(2,"highlight_off"),t.qZA()()}}function me(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"td",27)(1,"div",28)(2,"button",29),t.NdJ("click",function(u){const l=t.CHM(e).$implicit,d=t.oxw(2);return t.KtG(d.onEditRow(u,l))}),t.TgZ(3,"mat-icon"),t._uU(4,"edit"),t.qZA()(),t.YNc(5,de,3,0,"button",30),t.qZA()()}if(2&o){const e=t.oxw(2);t.xp6(2),t.s9C("matTooltip",e.isPermissionEdit?"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0437\u0430\u043f\u0438\u0441\u044c":"\u041f\u0440\u043e\u0441\u043c\u043e\u0442\u0440\u0435\u0442\u044c \u0437\u0430\u043f\u0438\u0441\u044c"),t.xp6(3),t.Q6J("ngIf",e.isPermissionRemove)}}function _e(o,i){1&o&&t._UZ(0,"tr",32)}const pe=function(o){return{selected:o}};function ge(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"tr",33),t.NdJ("dblclick",function(){const s=t.CHM(e).$implicit,l=t.oxw(2);return t.KtG(l.onEditRow(null,s))}),t.qZA()}2&o&&t.Q6J("ngClass",t.VKq(1,pe,i.$implicit.selected))}function fe(o,i){1&o&&(t.TgZ(0,"div",34),t._uU(1," \u041d\u0435\u0442 \u0434\u0430\u043d\u043d\u044b\u0445 "),t.qZA())}function he(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"div",2)(1,"div",3)(2,"div",4),t._uU(3,"\u0421\u043f\u0440\u0430\u0432\u043e\u0447\u043d\u0438\u043a\u0438"),t.qZA(),t._UZ(4,"div",5)(5,"mat-paginator",6),t.TgZ(6,"button",7),t.NdJ("click",function(){t.CHM(e);const u=t.oxw();return t.KtG(u.onReload())}),t.TgZ(7,"mat-icon"),t._uU(8,"autorenew"),t.qZA()(),t.YNc(9,se,5,0,"button",8),t.qZA(),t.TgZ(10,"div",9)(11,"div",10)(12,"div",11)(13,"table",12),t.YNc(14,re,3,1,"ng-container",13),t.ynx(15,14),t.YNc(16,ae,2,0,"th",15),t.YNc(17,me,6,2,"td",16),t.BQk(),t.YNc(18,_e,1,0,"tr",17),t.YNc(19,ge,1,3,"tr",18),t.qZA(),t.YNc(20,fe,2,0,"div",19),t.qZA()()()()}if(2&o){const e=t.oxw();t.xp6(4),t.Q6J("innerHTML",e.subTitle,t.oJD),t.xp6(1),t.Q6J("length",e.total)("hidePageSize",!0),t.xp6(4),t.Q6J("ngIf",e.isPermissionEdit),t.xp6(4),t.Q6J("dataSource",e.dataSource),t.xp6(1),t.Q6J("ngForOf",e.columns),t.xp6(4),t.Q6J("matHeaderRowDef",e.displayedColumns)("matHeaderRowDefSticky",!0),t.xp6(1),t.Q6J("matRowDefColumns",e.displayedColumns),t.xp6(1),t.Q6J("ngIf",0===e.dataSource.length)}}class S extends D{constructor(i,e,n,u,s,l){super(),this.titleService=i,this.router=e,this.activatedRoute=n,this.dialogService=u,this.userService=s,this.apiAdminService=l,this.is404=!1,this.subTitle="",this.columns=[],this.viewCode=null,this.ngUnsubscribe=new O.x}get isPermissionEdit(){return this.userService.hasPermissions(g.j.dictiEdit)}get isPermissionRemove(){return this.userService.hasPermissions(g.j.dictiRemove)}ngOnInit(){this.activatedRoute.paramMap.pipe((0,nt.R)(this.ngUnsubscribe)).subscribe(i=>{const e=i.get("code");this.setViewByCode(e)})}onReload(){this.getList()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}onAddRecord(){this.editRecord()}onEditRow(i,e){i?.stopPropagation(),this.editRecord(e)}onRemoveRow(i,e){i.stopPropagation(),this.viewCode&&this.dialogService.showConfirm("\u0412\u044b \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u0445\u043e\u0442\u0438\u0442\u0435 \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u044d\u0442\u0443 \u0437\u0430\u043f\u0438\u0441\u044c?").subscribe(n=>{n&&e.id&&(this.dialogService.showWait("\u0423\u0434\u0430\u043b\u0435\u043d\u0438\u0435..."),this.apiAdminService.removeDictiByCode(this.viewCode,e.id).pipe((0,f.x)(()=>this.dialogService.hideWait())).subscribe({next:()=>{this.getList()},error:u=>this.dialogService.showToastError(u.message)}))})}getList(){this.viewCode&&(this.dialogService.showWait("\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430..."),this.apiAdminService.getDictiListByCode(this.viewCode).pipe((0,f.x)(()=>this.dialogService.hideWait())).subscribe({next:i=>{this.total=i.count,this.dataSource=i.values},error:i=>this.dialogService.showToastError(i.message)}))}setViewByCode(i){if(this.viewCode=i,!i)return void this.router.navigate([`admin/dictionaries/${ut[0].code}`]);const e=ut.find(n=>n.code===i);e?(this.is404=!1,this.subTitle=`&nbsp;&#10148;&nbsp;${e.name}`,this.titleService.setTitle(`${e.name} | \u0421\u043f\u0438\u0441\u043e\u043a \u0441\u043f\u0440\u0430\u0432\u043e\u0447\u043d\u0438\u043a\u043e\u0432 | \u0410\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 | ${E.X}`),this.displayedColumns=[...e.displayedColumns],this.columns=[...e.columns],this.userService.hasPermissions([g.j.dictiEdit,g.j.dictiView])&&this.displayedColumns.push("buttons"),this.getList()):this.is404=!0}editRecord(i){const e=ut.find(l=>l.code===this.viewCode);if(!e)return;const n={listUnits:()=>this.apiAdminService.getDictiListByCode("units").pipe((0,ie.U)(l=>(l.values||[]).map(d=>({value:d.id,title:d.name}))))};let u;u=i?{...e.values,...i}:{...e.values};let s=i?"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0437\u0430\u043f\u0438\u0441\u0438":"\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0437\u0430\u043f\u0438\u0441\u0438";this.isPermissionEdit||(s="\u041f\u0440\u043e\u0441\u043c\u043e\u0442\u0440 \u0437\u0430\u043f\u0438\u0441\u0438"),this.dialogService.showModal(s,K,{fieldsRows:e.fieldsRows,fieldsService:n,values:u},!0).subscribe(l=>{l&&(this.dialogService.showWait("\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435..."),this.apiAdminService.saveDictiByCode(e.code,{...u}).pipe((0,f.x)(()=>this.dialogService.hideWait())).subscribe({next:()=>this.getList(),error:d=>this.dialogService.showToastError(d.message)}))})}}S.\u0275fac=function(i){return new(i||S)(t.Y36(k.Dx),t.Y36(b.F0),t.Y36(b.gz),t.Y36(a.xA),t.Y36(h.KD),t.Y36(h.ib))},S.\u0275cmp=t.Xpm({type:S,selectors:[["adm-dictionary-list"]],features:[t.qOj],decls:2,vars:2,consts:[[4,"ngIf"],["class","page-list",4,"ngIf"],[1,"page-list"],[1,"page-list__head"],[1,"page-title"],[1,"page-subtitle",3,"innerHTML"],[3,"length","hidePageSize"],["mat-icon-button","","color","primary",3,"click"],["mat-raised-button","","color","primary","class","mat-button-with-icon head-button ml-10",3,"click",4,"ngIf"],[1,"page-list__content"],[1,"scroll-container"],[1,"scroll"],["mat-table","",1,"table","with-borders",3,"dataSource"],[3,"matColumnDef",4,"ngFor","ngForOf"],["matColumnDef","buttons"],["mat-header-cell","","class","buttons-cell",4,"matHeaderCellDef"],["mat-cell","","class","buttons-cell",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","","class","table-row",3,"ngClass","dblclick",4,"matRowDef","matRowDefColumns"],["class","text-center text-danger mt-10",4,"ngIf"],["mat-raised-button","","color","primary",1,"mat-button-with-icon","head-button","ml-10",3,"click"],[3,"matColumnDef"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["mat-header-cell",""],["mat-cell",""],["mat-header-cell","",1,"buttons-cell"],["mat-cell","",1,"buttons-cell"],[1,"container"],["mat-icon-button","","color","primary",3,"matTooltip","click"],["mat-icon-button","","color","accent","matTooltip","\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u0437\u0430\u043f\u0438\u0441\u044c",3,"click",4,"ngIf"],["mat-icon-button","","color","accent","matTooltip","\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u0437\u0430\u043f\u0438\u0441\u044c",3,"click"],["mat-header-row",""],["mat-row","",1,"table-row",3,"ngClass","dblclick"],[1,"text-center","text-danger","mt-10"]],template:function(i,e){1&i&&(t.YNc(0,ue,1,0,"app-page-not-found",0),t.YNc(1,he,21,10,"div",1)),2&i&&(t.Q6J("ngIf",e.is404),t.xp6(1),t.Q6J("ngIf",!e.is404))},dependencies:[_.mk,_.sg,_.O5,ne.r,x.Hw,p.lW,p.RK,c.BZ,c.fO,c.as,c.w1,c.Dz,c.nj,c.ge,c.ev,c.XQ,c.Gk,y.NW,C.gM],styles:["[_nghost-%COMP%]{flex:auto;display:flex;flex-direction:column}.cell-base-units[_ngcontent-%COMP%]{width:240px;text-align:center}.cell-coefficient[_ngcontent-%COMP%]{width:100px;text-align:center}"]});var W=m(9751),R=m(3848),w=m(7258);class z{constructor(i,e){this.dialogService=i,this.apiAdminService=e,this.goodsList=[],this.controlGoodsId=new a.jn(null,r.kI.required),this.controlQuantity=new a.jn(null,r.kI.required),this.controlPrice=new a.jn(null,r.kI.required),this.goodsListDef=[]}ngOnInit(){this.apiAdminService.getListGoods({type:"ingredient",deleted:!1}).subscribe({next:i=>{this.goodsListDef=i.values||[],this.goodsList=(i.values||[]).map(e=>({value:e.id,title:e.name}))},error:i=>this.dialogService.showToastError(i.message)})}onApply(){if(this.controlGoodsId.valid&&this.controlQuantity.valid&&this.controlPrice.valid){const i=this.goodsListDef.find(e=>e.id===this.controlGoodsId.value);i&&this.dialogRef?.close({...i,goodsId:this.controlGoodsId.value,quantity:this.controlQuantity.value,price:this.controlPrice.value})}else this.controlGoodsId.markAsTouched(),this.controlQuantity.markAsTouched(),this.controlPrice.markAsTouched()}onClose(){this.dialogRef?.close(null)}}function xe(o,i){if(1&o&&(t.TgZ(0,"th",19),t._uU(1),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.hij(" ",e.header," ")}}function Ce(o,i){if(1&o&&(t.TgZ(0,"td",20),t._uU(1),t.qZA()),2&o){const e=i.$implicit,n=t.oxw().$implicit;t.uIk("class",n.className),t.xp6(1),t.hij(" ",n.cell(e)," ")}}function ve(o,i){1&o&&(t.ynx(0,16),t.YNc(1,xe,2,1,"th",17),t.YNc(2,Ce,2,2,"td",18),t.BQk()),2&o&&t.Q6J("matColumnDef",i.$implicit.key)}function Ae(o,i){1&o&&(t.TgZ(0,"th",21),t._uU(1,"\u041a\u043e\u043b-\u0432\u043e"),t.qZA())}function be(o,i){if(1&o&&(t.TgZ(0,"div"),t._uU(1),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.hij(" ",e.quantity," ")}}function Te(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"div",25)(1,"button",26),t.NdJ("click",function(){t.CHM(e);const u=t.oxw(),s=u.index,l=u.$implicit,d=t.oxw();return t.KtG(d.onSpeedDecrementClick(s,l,"quantity"))}),t.TgZ(2,"mat-icon"),t._uU(3,"remove_circle_outline"),t.qZA()(),t.TgZ(4,"input",27),t.NdJ("keydown",function(u){t.CHM(e);const s=t.oxw().$implicit,l=t.oxw();return t.KtG(l.onTextNumberKeyDown(u,s,"quantity"))})("focus",function(u){t.CHM(e);const s=t.oxw(2);return t.KtG(s.onSelectText(u))})("blur",function(){t.CHM(e);const u=t.oxw(),s=u.index,l=u.$implicit,d=t.oxw();return t.KtG(d.onBlurText(s,l))})("ngModelChange",function(u){t.CHM(e);const s=t.oxw().$implicit;return t.KtG(s.quantity=u)}),t.qZA(),t.TgZ(5,"button",26),t.NdJ("click",function(){t.CHM(e);const u=t.oxw(),s=u.index,l=u.$implicit,d=t.oxw();return t.KtG(d.onSpeedIncrementClick(s,l,"quantity"))}),t.TgZ(6,"mat-icon"),t._uU(7,"add_circle_outline"),t.qZA()()()}if(2&o){const e=t.oxw().$implicit;t.xp6(4),t.Q6J("maxlength",5)("ngModel",e.quantity)}}function Ze(o,i){if(1&o&&(t.TgZ(0,"td",22),t.YNc(1,be,2,1,"div",23),t.YNc(2,Te,8,2,"div",24),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",!e.isPermissionEdit),t.xp6(1),t.Q6J("ngIf",e.isPermissionEdit)}}function we(o,i){1&o&&(t.TgZ(0,"th",21),t._uU(1,"\u0426\u0435\u043d\u0430"),t.qZA())}function Ee(o,i){if(1&o&&(t.TgZ(0,"div"),t._uU(1),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.hij(" ",e.price," ")}}function De(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"div",25)(1,"button",26),t.NdJ("click",function(){t.CHM(e);const u=t.oxw(),s=u.index,l=u.$implicit,d=t.oxw();return t.KtG(d.onSpeedDecrementClick(s,l,"price"))}),t.TgZ(2,"mat-icon"),t._uU(3,"remove_circle_outline"),t.qZA()(),t.TgZ(4,"input",27),t.NdJ("keydown",function(u){t.CHM(e);const s=t.oxw().$implicit,l=t.oxw();return t.KtG(l.onTextNumberKeyDown(u,s,"price"))})("focus",function(u){t.CHM(e);const s=t.oxw(2);return t.KtG(s.onSelectText(u))})("blur",function(){t.CHM(e);const u=t.oxw(),s=u.index,l=u.$implicit,d=t.oxw();return t.KtG(d.onBlurText(s,l))})("ngModelChange",function(u){t.CHM(e);const s=t.oxw().$implicit;return t.KtG(s.price=u)}),t.qZA(),t.TgZ(5,"button",26),t.NdJ("click",function(){t.CHM(e);const u=t.oxw(),s=u.index,l=u.$implicit,d=t.oxw();return t.KtG(d.onSpeedIncrementClick(s,l,"price"))}),t.TgZ(6,"mat-icon"),t._uU(7,"add_circle_outline"),t.qZA()()()}if(2&o){const e=t.oxw().$implicit;t.xp6(4),t.Q6J("maxlength",5)("ngModel",e.price)}}function ye(o,i){if(1&o&&(t.TgZ(0,"td",22),t.YNc(1,Ee,2,1,"div",23),t.YNc(2,De,8,2,"div",24),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",!e.isPermissionEdit),t.xp6(1),t.Q6J("ngIf",e.isPermissionEdit)}}function Ie(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"th",28)(1,"button",29),t.NdJ("click",function(){t.CHM(e);const u=t.oxw();return t.KtG(u.onAddRecord())}),t.TgZ(2,"mat-icon"),t._uU(3,"add_circle_outline"),t.qZA()()()}}function ke(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"td",30)(1,"div",31)(2,"button",32),t.NdJ("click",function(){const u=t.CHM(e),s=u.index,l=u.$implicit,d=t.oxw();return t.KtG(d.onRemove(s,l))}),t.TgZ(3,"mat-icon"),t._uU(4,"highlight_off"),t.qZA()()()()}}function Ne(o,i){if(1&o&&(t.TgZ(0,"td",33)(1,"div",34),t._uU(2,"\u041d\u0435\u0442 \u0434\u0430\u043d\u043d\u044b\u0445"),t.qZA()()),2&o){const e=t.oxw();t.uIk("colspan",e.colspanTable)}}function Se(o,i){1&o&&t._UZ(0,"tr",35)}function Re(o,i){1&o&&t._UZ(0,"tr",36)}function Le(o,i){1&o&&t._UZ(0,"tr",37)}z.\u0275fac=function(i){return new(i||z)(t.Y36(a.xA),t.Y36(h.ib))},z.\u0275cmp=t.Xpm({type:z,selectors:[["app-incoming-goods-edit"]],decls:12,vars:13,consts:[[1,"inside-modal-body-container"],["label","\u0422\u043e\u0432\u0430\u0440",3,"formControl","options","clearButton"],[1,"flex-row"],[1,"w-touchspin"],["label","\u041a\u043e\u043b-\u0432\u043e",3,"formControl","min","allowDecimals","decimals","clearButton"],[1,"w-touchspin","ml-10"],["label","\u0426\u0435\u043d\u0430",3,"formControl","min","allowDecimals","decimals","clearButton"],[1,"footer-buttons"],["mat-raised-button","","color","primary",3,"click"],["mat-raised-button","","color","accent",3,"click"]],template:function(i,e){1&i&&(t.TgZ(0,"div",0),t._UZ(1,"kui-select",1),t.TgZ(2,"div",2)(3,"div",3),t._UZ(4,"kui-touchspin",4),t.qZA(),t.TgZ(5,"div",5),t._UZ(6,"kui-touchspin",6),t.qZA()()(),t.TgZ(7,"div",7)(8,"button",8),t.NdJ("click",function(){return e.onApply()}),t._uU(9," \u041f\u0440\u0438\u043c\u0435\u043d\u0438\u0442\u044c "),t.qZA(),t.TgZ(10,"button",9),t.NdJ("click",function(){return e.onClose()}),t._uU(11,"\u0417\u0430\u043a\u0440\u044b\u0442\u044c"),t.qZA()()),2&i&&(t.xp6(1),t.Q6J("formControl",e.controlGoodsId)("options",e.goodsList)("clearButton",!1),t.xp6(3),t.Q6J("formControl",e.controlQuantity)("min",0)("allowDecimals",!0)("decimals",3)("clearButton",!1),t.xp6(2),t.Q6J("formControl",e.controlPrice)("min",0)("allowDecimals",!0)("decimals",3)("clearButton",!1))},dependencies:[r.JJ,r.oH,a.f5,a.os,p.lW],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;width:450px}.w-touchspin[_ngcontent-%COMP%]{width:210px}"]});const Ue=function(){return[]},Je=function(){return["notFound"]};class X extends D{constructor(i){super(),this.dialogService=i,this.goodsList=[],this.isPermissionEdit=!0,this.changeGoodsEvent=new t.vpe,this.removeGoodsEvent=new t.vpe,this.columns=[{key:"goodsName",header:"\u041d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u0435",cell:e=>`${e.goodsName}`},{key:"goodsCode",header:"\u0410\u0440\u0442\u0438\u043a\u0443\u043b",className:"cell-code",cell:e=>`${e.goodsCode}`},{key:"goodsUnit",header:"\u0415\u0434\u0438\u043d\u0438\u0446\u0430 \u0438\u0437\u043c\u0435\u0440\u0435\u043d\u0438\u044f",className:"cell-unit",cell:e=>`${e.goodsUnit}`},{key:"summa",header:"\u0421\u0443\u043c\u043c\u0430",className:"cell-summa",cell:e=>{let n=Number(e.quantity);n=isNaN(n)?0:n;let u=Number(e.price);return u=isNaN(u)?0:u,a.ZH.numberFormat(n*u,3)}}],this.stepIncrement=1}ngOnChanges(i){Object.prototype.hasOwnProperty.call(i,"goodsList")&&(this.dataSource=[...this.goodsList])}ngOnInit(){this.displayedColumns=["goodsCode","goodsName","goodsUnit","quantity","price","summa"],this.isPermissionEdit&&this.displayedColumns.push("buttons")}onRemove(i,e){e.id?this.dialogService.showConfirm("\u0412\u044b \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u0445\u043e\u0442\u0438\u0442\u0435 \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u044d\u0442\u043e\u0442 \u0442\u043e\u0432\u0430\u0440?").subscribe(n=>{n&&e.id&&this.removeGoodsEvent.emit({idx:i,id:e.id})}):this.removeGoodsEvent.emit({idx:i})}onSpeedIncrementClick(i,e,n){this.increment(e,n),this.changeGoodsEvent.emit({idx:i,goods:e})}onSpeedDecrementClick(i,e,n){this.decrement(e,n),this.changeGoodsEvent.emit({idx:i,goods:e})}onBlurText(i,e){this.changeGoodsEvent.emit({idx:i,goods:e})}onSelectText(i){i.target?.select()}onTextNumberKeyDown(i,e,n){if(!["ArrowLeft","ArrowRight","ArrowUp","ArrowDown","ArrowUp","Backspace","Delete"].includes(i.key)){if("."===i.key)return void((!a.ZH.hasValue(e[n])||String(e[n]).indexOf(".")>=0)&&i.preventDefault());/[0-9]/.test(i.key)||i.preventDefault()}}onAddRecord(){this.dialogService.showModal("\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0442\u043e\u0432\u0430\u0440\u0430",z,{},!0).subscribe(i=>{i&&this.changeGoodsEvent.emit({idx:null,goods:{goodsId:i.goodsId,quantity:i.quantity,price:i.price,goodsName:i.name,goodsCode:i.code,goodsUnit:i.unit}})})}increment(i,e){let n=new w.Z(i[e]?i[e]:0);n=n.plus(this.stepIncrement),i[e]=Number(n.toFixed(3))}decrement(i,e){let n=new w.Z(i[e]?i[e]:0);n=n.minus(this.stepIncrement),i[e]=n.lessThan(0)?0:Number(n.toFixed(3))}}function Pe(o,i){1&o&&(t.TgZ(0,"div",6),t._UZ(1,"div",7),t.qZA())}function Me(o,i){1&o&&(t.TgZ(0,"div",6),t._UZ(1,"div",7),t.qZA())}function qe(o,i){1&o&&(t.TgZ(0,"div",22),t._uU(1," \u0414\u043b\u044f \u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u044f \u044d\u043b\u0435\u043c\u0435\u043d\u0442\u0430\u043c\u0438 \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430 \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u0441\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c \u043d\u0430\u043a\u043b\u0430\u0434\u043d\u0443\u044e "),t.qZA())}function Fe(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"adm-elements-incoming",23),t.NdJ("changeGoodsEvent",function(u){t.CHM(e);const s=t.oxw(2);return t.KtG(s.onChangeGoods(u))})("removeGoodsEvent",function(u){t.CHM(e);const s=t.oxw(2);return t.KtG(s.onRemoveGoods(u))}),t.qZA()}if(2&o){const e=t.oxw(2);t.Q6J("goodsList",e.goodsList)("isPermissionEdit",e.isPermissionEdit&&!e.readonly)}}function Ge(o,i){if(1&o&&(t.TgZ(0,"div",8)(1,"div",9)(2,"div",10)(3,"div",11),t._UZ(4,"kui-input",12),t.qZA(),t.TgZ(5,"div",13),t._UZ(6,"kui-datepicker",14),t.qZA(),t.TgZ(7,"div",15),t._UZ(8,"kui-input",16),t.qZA()()(),t.TgZ(9,"div",17)(10,"mat-tab-group",18)(11,"mat-tab",19),t.YNc(12,Me,2,0,"div",1),t.YNc(13,qe,2,0,"div",20),t.YNc(14,Fe,1,2,"adm-elements-incoming",21),t.qZA()()()()),2&o){const e=t.oxw();t.xp6(1),t.Q6J("formGroup",e.formGroup),t.xp6(3),t.Q6J("clearButton",!1)("readonly",!e.isPermissionEdit||e.readonly),t.xp6(2),t.Q6J("clearButton",!1)("readonly",!e.isPermissionEdit||e.readonly),t.xp6(2),t.Q6J("clearButton",!1)("readonly",!e.isPermissionEdit||e.readonly),t.xp6(2),t.Q6J("mat-stretch-tabs",!1),t.xp6(2),t.Q6J("ngIf",e.loadingGoods),t.xp6(1),t.Q6J("ngIf",!e.docId),t.xp6(1),t.Q6J("ngIf",e.docId)}}function Qe(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"button",24),t.NdJ("click",function(){t.CHM(e);const u=t.oxw();return t.KtG(u.onApply())}),t._uU(1," \u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c "),t.qZA()}if(2&o){const e=t.oxw();t.Q6J("disabled",e.savedState)}}function Oe(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"button",24),t.NdJ("click",function(){t.CHM(e);const u=t.oxw();return t.KtG(u.onApply(!0))}),t._uU(1," \u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c \u0438 \u0437\u0430\u043a\u0440\u044b\u0442\u044c "),t.qZA()}if(2&o){const e=t.oxw();t.Q6J("disabled",e.savedState)}}X.\u0275fac=function(i){return new(i||X)(t.Y36(a.xA))},X.\u0275cmp=t.Xpm({type:X,selectors:[["adm-elements-incoming"]],inputs:{goodsList:"goodsList",isPermissionEdit:"isPermissionEdit"},outputs:{changeGoodsEvent:"changeGoodsEvent",removeGoodsEvent:"removeGoodsEvent"},features:[t.qOj,t.TTD],decls:18,vars:8,consts:[[1,"scroll-container","content"],[1,"scroll"],["mat-table","",1,"table","with-borders",3,"dataSource"],[3,"matColumnDef",4,"ngFor","ngForOf"],["matColumnDef","quantity"],["mat-header-cell","","class","cell-count",4,"matHeaderCellDef"],["mat-cell","","class","cell-count",4,"matCellDef"],["matColumnDef","price"],["matColumnDef","buttons"],["mat-header-cell","","class","buttons-cell",4,"matHeaderCellDef"],["mat-cell","","class","buttons-cell",4,"matCellDef"],["matColumnDef","notFound"],["mat-footer-cell","",4,"matFooterCellDef"],["mat-header-row","",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","","class","table-row","draggable","true",4,"matRowDef","matRowDefColumns"],["mat-footer-row","",4,"matFooterRowDef"],[3,"matColumnDef"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["mat-header-cell",""],["mat-cell",""],["mat-header-cell","",1,"cell-count"],["mat-cell","",1,"cell-count"],[4,"ngIf"],["class","flex-row-centered",4,"ngIf"],[1,"flex-row-centered"],["mat-icon-button","","color","primary",3,"click"],["type","number","min","0","step","1",1,"table-input",3,"maxlength","ngModel","keydown","focus","blur","ngModelChange"],["mat-header-cell","",1,"buttons-cell"],["mat-icon-button","","matTooltip","\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0442\u043e\u0432\u0430\u0440",3,"click"],["mat-cell","",1,"buttons-cell"],[1,"container"],["mat-icon-button","","color","accent",3,"click"],["mat-footer-cell",""],[1,"text-center","text-danger"],["mat-header-row",""],["mat-row","","draggable","true",1,"table-row"],["mat-footer-row",""]],template:function(i,e){1&i&&(t.TgZ(0,"div",0)(1,"div",1)(2,"table",2),t.YNc(3,ve,3,1,"ng-container",3),t.ynx(4,4),t.YNc(5,Ae,2,0,"th",5),t.YNc(6,Ze,3,2,"td",6),t.BQk(),t.ynx(7,7),t.YNc(8,we,2,0,"th",5),t.YNc(9,ye,3,2,"td",6),t.BQk(),t.ynx(10,8),t.YNc(11,Ie,4,0,"th",9),t.YNc(12,ke,5,0,"td",10),t.BQk(),t.ynx(13,11),t.YNc(14,Ne,3,1,"td",12),t.BQk(),t.YNc(15,Se,1,0,"tr",13),t.YNc(16,Re,1,0,"tr",14),t.YNc(17,Le,1,0,"tr",15),t.qZA()()()),2&i&&(t.xp6(2),t.Q6J("dataSource",e.dataSource),t.xp6(1),t.Q6J("ngForOf",e.columns),t.xp6(12),t.Q6J("matHeaderRowDef",e.displayedColumns)("matHeaderRowDefSticky",!0),t.xp6(1),t.Q6J("matRowDefColumns",e.displayedColumns),t.xp6(1),t.Q6J("matFooterRowDef",e.dataSource&&e.dataSource.length?t.DdM(6,Ue):t.DdM(7,Je)))},dependencies:[_.sg,_.O5,r.Fj,r.wV,r.JJ,r.nD,r.qQ,r.On,x.Hw,p.RK,c.BZ,c.fO,c.as,c.w1,c.Dz,c.nj,c.mD,c.Ke,c.ge,c.ev,c.yh,c.XQ,c.Gk,c.Q2,C.gM],styles:["[_nghost-%COMP%]{flex:auto;display:flex;flex-direction:column}.table-input[_ngcontent-%COMP%]{border:none;text-align:center;font-size:16px;width:100px;outline:none;background:transparent;appearance:textfield;-webkit-appearance:none;-moz-appearance:textfield}.cell-code[_ngcontent-%COMP%]{width:100px;text-align:center}.cell-unit[_ngcontent-%COMP%]{width:170px;text-align:center}.cell-count[_ngcontent-%COMP%], .cell-summa[_ngcontent-%COMP%]{width:180px;text-align:center}"]});class V{constructor(i,e,n,u){this.router=i,this.dialogService=e,this.userService=n,this.apiAdminService=u,this.loading=!0,this.formGroup=new r.cw({docNumber:new a.jn(null,r.kI.required),receiptDate:new a.jn(null,r.kI.required),supplierName:new a.jn(null,r.kI.required)}),this.docId=null,this.savedState=!0,this.hasSaved=!1,this.goodsList=[],this.loadingGoods=!1,this.readonly=!1,this.ngUnSubscribe=new O.x,this.removingGoodsList=[]}get isPermissionEdit(){return this.userService.hasPermissions(g.j.docIncomingEdit)}ngOnInit(){this.formGroup.valueChanges.pipe((0,nt.R)(this.ngUnSubscribe)).subscribe(()=>this.savedState=!1),this.docId=this.modalChildData?.docId??null,this.docId?this.apiAdminService.getDocIncoming(this.docId).pipe((0,f.x)(()=>this.loading=!1)).subscribe({next:i=>{this.readonly=i.posting,this.formGroup.patchValue(i),this.savedState=!0,this.loadGoods().subscribe({error:e=>this.dialogService.showToastError(e.message,"\u042d\u043b\u0435\u043c\u0435\u043d\u0442\u044b \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430")})},error:i=>this.dialogService.showToastError(i.message)}):this.loading=!1}ngOnDestroy(){this.ngUnSubscribe.next(),this.ngUnSubscribe.complete()}onRemoveGoods(i){i.id&&this.removingGoodsList.push(i.id),this.goodsList.splice(i.idx,1),this.goodsList=[...this.goodsList],this.savedState=!1}onChangeGoods(i){null===i.idx||void 0===this.goodsList[i.idx]?this.goodsList.push(i.goods):this.goodsList[i.idx]=i.goods,this.goodsList=[...this.goodsList],this.savedState=!1}onApply(i=!1){this.formGroup.valid?(this.dialogService.showWait("\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435..."),this.saveGoods().pipe((0,f.x)(()=>this.dialogService.hideWait())).subscribe({next:()=>{this.dialogService.showToastSuccess("\u041d\u0430\u043a\u043b\u0430\u0434\u043d\u0430\u044f \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0430"),i&&this.dialogRef?.close(!0)},error:e=>this.dialogService.showToastError(e.message)})):this.formGroup.markAllAsTouched()}onClose(){this.dialogRef?.close(this.hasSaved)}saveGoods(){return new W.y(i=>{this.apiAdminService.saveDocIncoming({id:this.docId,...this.formGroup.value}).pipe((0,f.x)(()=>this.dialogService.hideWait())).subscribe({next:e=>{this.docId=e.id;const n=[];this.goodsList.length>0&&this.goodsList.forEach(u=>{this.docId&&n.push(this.apiAdminService.saveDocIncomingGoods({docId:this.docId,...u}))}),this.removingGoodsList.length>0&&this.removingGoodsList.forEach(u=>n.push(this.apiAdminService.removeDocIncomingGoods(u))),n.length>0?(0,N.D)(n).subscribe({next:()=>this.loadGoods().subscribe({next:()=>{this.savedState=!0,this.hasSaved=!0,i.next(),i.complete()},error:u=>i.error(u)}),error:u=>i.error(u)}):(i.next(),i.complete())},error:e=>i.error(e)})})}loadGoods(){return new W.y(i=>{if(!this.docId)return this.goodsList=[],i.next(),void i.complete();this.loadingGoods=!0,this.apiAdminService.getListDocIncomingGoods(this.docId).pipe((0,f.x)(()=>this.loadingGoods=!1)).subscribe({next:e=>{this.goodsList=e,i.next(),i.complete()},error:e=>i.error(e)})})}}function Ye(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"button",18),t.NdJ("click",function(){t.CHM(e);const u=t.oxw();return t.KtG(u.onAddRecord())}),t.TgZ(1,"mat-icon"),t._uU(2,"add"),t.qZA(),t.TgZ(3,"span"),t._uU(4,"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442"),t.qZA()()}}function Be(o,i){if(1&o&&(t.TgZ(0,"th",22),t._uU(1),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.hij(" ",e.header," ")}}function He(o,i){if(1&o&&(t.TgZ(0,"td",23),t._uU(1),t.qZA()),2&o){const e=i.$implicit,n=t.oxw().$implicit;t.uIk("class",n.className),t.xp6(1),t.hij(" ",n.cell(e)," ")}}function je(o,i){1&o&&(t.ynx(0,19),t.YNc(1,Be,2,1,"th",20),t.YNc(2,He,2,2,"td",21),t.BQk()),2&o&&t.Q6J("matColumnDef",i.$implicit.key)}function $e(o,i){1&o&&(t.TgZ(0,"th",24),t._uU(1," \xa0 "),t.qZA())}function Ke(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"button",29),t.NdJ("click",function(){t.CHM(e);const u=t.oxw().$implicit,s=t.oxw();return t.KtG(s.onPosting(u))}),t.TgZ(1,"mat-icon"),t._uU(2,"done"),t.qZA()()}if(2&o){const e=t.oxw().$implicit;t.Q6J("disabled",e.posting)}}function We(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"td",25)(1,"div",26)(2,"button",27),t.NdJ("click",function(u){const l=t.CHM(e).$implicit,d=t.oxw();return t.KtG(d.onEditRow(u,l))}),t.TgZ(3,"mat-icon"),t._uU(4,"edit"),t.qZA()(),t.YNc(5,Ke,3,1,"button",28),t.qZA()()}if(2&o){const e=t.oxw();t.xp6(2),t.s9C("matTooltip",e.isPermissionEdit?"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0437\u0430\u043f\u0438\u0441\u044c":"\u041f\u0440\u043e\u0441\u043c\u043e\u0442\u0440\u0435\u0442\u044c \u0437\u0430\u043f\u0438\u0441\u044c"),t.xp6(3),t.Q6J("ngIf",e.isPermissionEdit)}}function ze(o,i){1&o&&t._UZ(0,"tr",30)}function Xe(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"tr",31),t.NdJ("dblclick",function(){const s=t.CHM(e).$implicit,l=t.oxw();return t.KtG(l.onEditRow(null,s))}),t.qZA()}}function Ve(o,i){1&o&&(t.TgZ(0,"div",32),t._uU(1," \u041d\u0435\u0442 \u0434\u0430\u043d\u043d\u044b\u0445 "),t.qZA())}V.\u0275fac=function(i){return new(i||V)(t.Y36(b.F0),t.Y36(a.xA),t.Y36(h.KD),t.Y36(h.ib))},V.\u0275cmp=t.Xpm({type:V,selectors:[["adm-docs-incoming-edit"]],decls:8,vars:4,consts:[[1,"inside-modal-body-container"],["class","flex-col-centered flex-auto",4,"ngIf"],["class","flex-col flex-auto",4,"ngIf"],[1,"footer-buttons"],["mat-raised-button","","color","primary",3,"disabled","click",4,"ngIf"],["mat-raised-button","","color","accent",3,"click"],[1,"flex-col-centered","flex-auto"],[1,"loading-block"],[1,"flex-col","flex-auto"],[1,"flex-row-centered",3,"formGroup"],[1,"info-container"],[1,"w-150"],["label","\u041d\u043e\u043c\u0435\u0440 \u043d\u0430\u043a\u043b\u0430\u0434\u043d\u043e\u0439","formControlName","docNumber",3,"clearButton","readonly"],[1,"w-170","ml-10"],["label","\u0414\u0430\u0442\u0430 \u043f\u043e\u0441\u0442\u0443\u043f\u043b\u0435\u043d\u0438\u044f","formControlName","receiptDate",3,"clearButton","readonly"],[1,"flex-auto","ml-10"],["label","\u041f\u043e\u0441\u0442\u0430\u0432\u0449\u0438\u043a","formControlName","supplierName",3,"clearButton","readonly"],[1,"flex-col","flex-auto","mt-10"],[1,"tabs-panel-container","flex-auto",3,"mat-stretch-tabs"],["label","\u042d\u043b\u0435\u043c\u0435\u043d\u0442\u044b \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430"],["class","flex-col-centered flex-auto text-danger",4,"ngIf"],["class","mt-10",3,"goodsList","isPermissionEdit","changeGoodsEvent","removeGoodsEvent",4,"ngIf"],[1,"flex-col-centered","flex-auto","text-danger"],[1,"mt-10",3,"goodsList","isPermissionEdit","changeGoodsEvent","removeGoodsEvent"],["mat-raised-button","","color","primary",3,"disabled","click"]],template:function(i,e){1&i&&(t.TgZ(0,"div",0),t.YNc(1,Pe,2,0,"div",1),t.YNc(2,Ge,15,11,"div",2),t.qZA(),t.TgZ(3,"div",3),t.YNc(4,Qe,2,1,"button",4),t.YNc(5,Oe,2,1,"button",4),t.TgZ(6,"button",5),t.NdJ("click",function(){return e.onClose()}),t._uU(7,"\u0417\u0430\u043a\u0440\u044b\u0442\u044c"),t.qZA()()),2&i&&(t.xp6(1),t.Q6J("ngIf",e.loading),t.xp6(1),t.Q6J("ngIf",!e.loading),t.xp6(2),t.Q6J("ngIf",e.isPermissionEdit&&!e.readonly),t.xp6(1),t.Q6J("ngIf",e.isPermissionEdit&&!e.readonly))},dependencies:[_.O5,r.JJ,r.JL,r.sg,r.u,a.y0,a.qC,p.lW,R.uX,R.SP,X],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;width:1280px;height:500px}.mt-6[_ngcontent-%COMP%]{margin-top:6px}.info-container[_ngcontent-%COMP%]{width:670px;display:flex;background-color:#ffefd5;border-radius:6px;padding:5px 10px 0;border:1px solid #c6c6c6;box-shadow:2px 2px 2px #0006}.info-container[_ngcontent-%COMP%]   .w-150[_ngcontent-%COMP%]{width:150px}.info-container[_ngcontent-%COMP%]   .w-170[_ngcontent-%COMP%]{width:170px}"]});class tt extends D{constructor(i,e,n,u){super(),this.dialogService=i,this.userService=e,this.apiAdminService=n,this.columns=[{key:"docNumber",header:"\u041d\u043e\u043c\u0435\u0440 \u043d\u0430\u043a\u043b\u0430\u0434\u043d\u043e\u0439",className:"text-center",cell:s=>s.docNumber},{key:"receiptDate",header:"\u0414\u0430\u0442\u0430 \u043f\u043e\u0441\u0442\u0443\u043f\u043b\u0435\u043d\u0438\u044f",className:"text-center",cell:s=>s.receiptDate},{key:"supplierName",header:"\u041f\u043e\u0441\u0442\u0430\u0432\u0449\u0438\u043a",cell:s=>s.supplierName},{key:"posting",header:"\u041f\u0440\u043e\u0432\u0435\u0434\u0435\u043d",className:"text-center",cell:s=>s.posting?"\u0414\u0430":"\u041d\u0435\u0442"}],u.setTitle(`\u041f\u0440\u0438\u0445\u043e\u0434\u043d\u044b\u0435 \u043d\u0430\u043a\u043b\u0430\u0434\u043d\u044b\u0435 | \u0410\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 | ${E.X}`)}get isPermissionEdit(){return this.userService.hasPermissions(g.j.docIncomingEdit)}ngOnInit(){this.displayedColumns=["docNumber","receiptDate","supplierName","posting","buttons"],this.getList(0)}onReload(){this.getList(this.pageIndex)}onPosting(i){i.id&&(this.dialogService.showWait("\u041f\u0440\u043e\u0432\u0435\u0434\u0435\u043d\u0438\u0435 \u043d\u0430\u043a\u043b\u0430\u0434\u043d\u043e\u0439..."),this.apiAdminService.postingDocIncoming(i.id).pipe((0,f.x)(()=>this.dialogService.hideWait())).subscribe({next:()=>{i.posting=!0,this.dialogService.showToastSuccess("\u041d\u0430\u043a\u043b\u0430\u0434\u043d\u0430\u044f \u043f\u0440\u043e\u0432\u0435\u0434\u0435\u043d\u0430")},error:e=>this.dialogService.showToastError(e.message)}))}onAddRecord(){this.editRecord()}onEditRow(i,e){i?.stopPropagation(),this.editRecord(e)}getList(i){this.dialogService.showWait("\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u0434\u0430\u043d\u043d\u044b\u0445..."),this.apiAdminService.getDocIncomingList({page:i,pageSize:this.pageSize}).pipe((0,f.x)(()=>this.dialogService.hideWait())).subscribe({next:e=>{this.total=e.count,this.dataSource=e.values},error:e=>this.dialogService.showToastError(e.message)})}editRecord(i){let e=i?"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430":"\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430";this.isPermissionEdit||(e="\u041f\u0440\u043e\u0441\u043c\u043e\u0442\u0440 \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430"),this.dialogService.showModal(e,V,{docId:i?.id??null},!0).subscribe(n=>{n&&this.getList(this.pageIndex)})}}tt.\u0275fac=function(i){return new(i||tt)(t.Y36(a.xA),t.Y36(h.KD),t.Y36(h.ib),t.Y36(k.Dx))},tt.\u0275cmp=t.Xpm({type:tt,selectors:[["adm-docs-incoming-list"]],features:[t.qOj],decls:22,vars:9,consts:[[1,"page-list"],[1,"page-list__head"],[1,"page-title"],[1,"page-subtitle"],[3,"length","hidePageSize"],["mat-icon-button","","color","primary",3,"click"],["mat-raised-button","","color","primary","class","mat-button-with-icon head-button ml-10",3,"click",4,"ngIf"],[1,"page-list__content"],[1,"scroll-container"],[1,"scroll"],["mat-table","",1,"table","with-borders",3,"dataSource"],[3,"matColumnDef",4,"ngFor","ngForOf"],["matColumnDef","buttons"],["mat-header-cell","","class","buttons-cell",4,"matHeaderCellDef"],["mat-cell","","class","buttons-cell",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","","class","table-row",3,"dblclick",4,"matRowDef","matRowDefColumns"],["class","text-center text-danger mt-10",4,"ngIf"],["mat-raised-button","","color","primary",1,"mat-button-with-icon","head-button","ml-10",3,"click"],[3,"matColumnDef"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["mat-header-cell",""],["mat-cell",""],["mat-header-cell","",1,"buttons-cell"],["mat-cell","",1,"buttons-cell"],[1,"container"],["mat-icon-button","","color","primary",3,"matTooltip","click"],["mat-icon-button","","color","primary","matTooltip","\u041f\u0440\u043e\u0432\u0435\u0441\u0442\u0438 \u043f\u0440\u0438\u0445\u043e\u0434\u043d\u0443\u044e \u043d\u0430\u043a\u043b\u0430\u0434\u043d\u0443\u044e",3,"disabled","click",4,"ngIf"],["mat-icon-button","","color","primary","matTooltip","\u041f\u0440\u043e\u0432\u0435\u0441\u0442\u0438 \u043f\u0440\u0438\u0445\u043e\u0434\u043d\u0443\u044e \u043d\u0430\u043a\u043b\u0430\u0434\u043d\u0443\u044e",3,"disabled","click"],["mat-header-row",""],["mat-row","",1,"table-row",3,"dblclick"],[1,"text-center","text-danger","mt-10"]],template:function(i,e){1&i&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2),t._uU(3,"\u0421\u043a\u043b\u0430\u0434\u0441\u043a\u0438\u0435 \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u044b"),t.qZA(),t.TgZ(4,"div",3),t._uU(5,"\xa0\u27a4\xa0\u041f\u0440\u0438\u0445\u043e\u0434\u043d\u044b\u0435 \u043d\u0430\u043a\u043b\u0430\u0434\u043d\u044b\u0435"),t.qZA(),t._UZ(6,"mat-paginator",4),t.TgZ(7,"button",5),t.NdJ("click",function(){return e.onReload()}),t.TgZ(8,"mat-icon"),t._uU(9,"autorenew"),t.qZA()(),t.YNc(10,Ye,5,0,"button",6),t.qZA(),t.TgZ(11,"div",7)(12,"div",8)(13,"div",9)(14,"table",10),t.YNc(15,je,3,1,"ng-container",11),t.ynx(16,12),t.YNc(17,$e,2,0,"th",13),t.YNc(18,We,6,2,"td",14),t.BQk(),t.YNc(19,ze,1,0,"tr",15),t.YNc(20,Xe,1,0,"tr",16),t.qZA(),t.YNc(21,Ve,2,0,"div",17),t.qZA()()()()),2&i&&(t.xp6(6),t.Q6J("length",e.total)("hidePageSize",!0),t.xp6(4),t.Q6J("ngIf",e.isPermissionEdit),t.xp6(4),t.Q6J("dataSource",e.dataSource),t.xp6(1),t.Q6J("ngForOf",e.columns),t.xp6(4),t.Q6J("matHeaderRowDef",e.displayedColumns)("matHeaderRowDefSticky",!0),t.xp6(1),t.Q6J("matRowDefColumns",e.displayedColumns),t.xp6(1),t.Q6J("ngIf",0===e.dataSource.length))},dependencies:[_.sg,_.O5,x.Hw,p.lW,p.RK,c.BZ,c.fO,c.as,c.w1,c.Dz,c.nj,c.ge,c.ev,c.XQ,c.Gk,y.NW,C.gM],styles:["[_nghost-%COMP%]{flex:auto;display:flex;flex-direction:column}"]});class I extends D{constructor(i,e,n,u){super(),this.dialogService=i,this.userService=e,this.apiAdminService=n,this.titleService=u,this.modeStateValue="standart",this.columns=[{key:"name",header:"\u041d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u0435",cell:s=>s.name},{key:"code",header:"\u0410\u0440\u0442\u0438\u043a\u0443\u043b",className:"cell-code",cell:s=>s.code},{key:"storeQuantity",header:"\u041e\u0441\u0442\u0430\u0442\u043e\u043a, \u0435\u0434. \u0438\u0437\u043c\u0435\u0440\u0435\u043d\u0438\u044f",className:"cell-quantity",cell:s=>`${a.ZH.numberFormat(s.storeQuantity,3)} ${s.unit}`}],this.title="",this.typeGoods=null,this.editComponent=null}get modeState(){return this.modeStateValue}set modeState(i){this.modeStateValue=i,this.getList(this.pageIndex)}get isPermissionEdit(){return this.userService.hasPermissions(g.j.goodsEdit)}get isPermissionRemove(){return this.userService.hasPermissions(g.j.goodsRemove)}ngOnInit(){this.titleService.setTitle(`${this.title} | \u0410\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 | ${E.X}`),this.displayedColumns=this.isPermissionEdit||this.isPermissionRemove||this.userService.hasPermissions(g.j.goodsView)?["name","code","storeQuantity","buttons"]:["name","code","storeQuantity"],this.getList(0)}onReload(){this.getList(this.pageIndex)}onRestoreRow(i,e){i.stopPropagation(),this.dialogService.showConfirm("\u0412\u044b \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u0445\u043e\u0442\u0438\u0442\u0435 \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u044d\u0442\u043e\u0442 \u0442\u043e\u0432\u0430\u0440?").subscribe(n=>{n&&e.id&&(this.dialogService.showWait("\u0412\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435..."),this.apiAdminService.restoreGoods(e.id).pipe((0,f.x)(()=>this.dialogService.hideWait())).subscribe({next:()=>{this.getList(this.pageIndex)},error:u=>this.dialogService.showToastError(u.message)}))})}onAddRecord(){this.editRecord()}onEditRow(i,e){i?.stopPropagation(),this.editRecord(e)}onRemoveRow(i,e){i.stopPropagation(),this.dialogService.showConfirm("\u0412\u044b \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u0445\u043e\u0442\u0438\u0442\u0435 \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u044d\u0442\u043e\u0442 \u0442\u043e\u0432\u0430\u0440?").subscribe(n=>{n&&e.id&&(this.dialogService.showWait("\u0423\u0434\u0430\u043b\u0435\u043d\u0438\u0435..."),this.apiAdminService.removeGoods(e.id).pipe((0,f.x)(()=>this.dialogService.hideWait())).subscribe({next:()=>{this.getList(this.pageIndex)},error:u=>this.dialogService.showToastError(u.message)}))})}getList(i){this.typeGoods&&(this.dialogService.showWait("\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u0434\u0430\u043d\u043d\u044b\u0445..."),this.apiAdminService.getListGoods({type:this.typeGoods,page:i,pageSize:this.pageSize,deleted:"deleted"===this.modeState}).pipe((0,f.x)(()=>this.dialogService.hideWait())).subscribe({next:e=>{this.total=e.count,this.initialData=e.values,this.dataSource=this.groupBy(e.values,this.reducedGroups),this.dataSource.filter(n=>n.isGroup&&n.groupName!==dt).forEach(n=>this.reduceGroup(n))},error:e=>this.dialogService.showToastError(e.message)}))}editRecord(i){if(!this.editComponent)return;let e=i?"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0442\u043e\u0432\u0430\u0440\u0430":"\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0442\u043e\u0432\u0430\u0440\u0430";this.isPermissionEdit||(e="\u041f\u0440\u043e\u0441\u043c\u043e\u0442\u0440 \u0442\u043e\u0432\u0430\u0440\u0430"),this.dialogService.showModal(e,this.editComponent,{goodsId:i?.id??null},!0).subscribe(n=>{n&&this.getList(this.pageIndex)})}}I.\u0275fac=function(i){return new(i||I)(t.Y36(a.xA),t.Y36(h.KD),t.Y36(h.ib),t.Y36(k.Dx))},I.\u0275dir=t.lG2({type:I,features:[t.qOj]});var ti=m(5861),st=m(9808),mt=m(9646);class _t{static blurActiveElement(){document.activeElement.blur&&document.activeElement.blur()}}class L{constructor(i,e,n,u,s){this.router=i,this.dialogService=e,this.userService=n,this.apiAdminService=u,this.apiFilesService=s,this.loading=!0,this.unitList=[],this.storeQuantity="",this.parentItemList=[],this.goodsId=null,this.savedState=!0,this.routingList=[],this.routingLoading=!1,this.hasSaved=!1,this.typeGoods=null,this.ngUnSubscribe=new O.x,this.removingRoutingList=[],this.currentGoods=null}get isPermissionEdit(){return this.userService.hasPermissions(g.j.goodsEdit)}ngOnInit(){if(!this.typeGoods)return;let i;this.formGroup.valueChanges.pipe((0,nt.R)(this.ngUnSubscribe)).subscribe(()=>this.savedState=!1),this.goodsId=this.modalChildData?.goodsId??null,i=this.goodsId?[this.apiAdminService.getDictiUnitList(),this.apiAdminService.getGoodsGroups(this.typeGoods),this.apiAdminService.getGoods(this.goodsId),this.apiAdminService.getListRouting(this.goodsId)]:[this.apiAdminService.getDictiUnitList(),this.apiAdminService.getGoodsGroups(this.typeGoods)],(0,N.D)(i).pipe((0,f.x)(()=>this.loading=!1)).subscribe({next:e=>{if(this.unitList=(e[0]||[]).map(n=>({value:n.id,title:n.name})),this.parentItemList=e[1]||[],e[2]){this.currentGoods=e[2],this.formGroup.patchValue(this.currentGoods),this.savedState=!0;const n=Number(this.currentGoods.storeQuantity);this.storeQuantity=isNaN(n)?"0":a.ZH.numberFormat(n,3),this.loadRouting().subscribe()}else this.currentGoods=null;e[3]&&(this.routingList=e[3]),this.afterInit()},error:e=>this.dialogService.showToastError(e.message)})}ngOnDestroy(){this.ngUnSubscribe.next(),this.ngUnSubscribe.complete()}onRemoveRouting(i){i.id&&this.removingRoutingList.push(i.id),this.routingList.splice(i.idx,1),this.routingList=[...this.routingList],this.savedState=!1}onChangeRouting(i){null===i.idx||void 0===this.routingList[i.idx]?this.routingList.push(i.routing):this.routingList[i.idx]=i.routing,this.routingList=[...this.routingList],this.savedState=!1}onClearParentItem(i){_t.blurActiveElement(),i.stopPropagation(),this.formGroup.get("parentItem")?.setValue(null)}disabledClearParentItem(){const i=this.formGroup.get("parentItem")?.value;return!a.ZH.hasValue(i)}onApply(i=!1){this.formGroup.valid?(this.dialogService.showWait("\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435..."),this.beforeSave().subscribe({next:()=>{this.saveGoods().pipe((0,f.x)(()=>this.dialogService.hideWait())).subscribe({next:()=>{this.afterSave().subscribe({next:()=>{this.dialogService.showToastSuccess("\u0422\u043e\u0432\u0430\u0440 \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d"),i&&this.dialogRef?.close(!0)},error:e=>this.dialogService.showToastError(e.message)})},error:e=>this.dialogService.showToastError(e.message)})},error:e=>this.dialogService.showToastError(e.message)})):this.formGroup.markAllAsTouched()}onClose(){this.dialogRef?.close(this.hasSaved)}getGoodsSaveParams(){return{id:this.goodsId,type:this.typeGoods,...this.formGroup.value}}saveGoods(){return new W.y(i=>{const e=this.getGoodsSaveParams();this.apiAdminService.saveGoods(e).pipe((0,f.x)(()=>this.dialogService.hideWait())).subscribe({next:n=>{this.goodsId=n.id,this.currentGoods=n;const u=[];this.routingList.length>0&&this.routingList.forEach(s=>{this.goodsId&&u.push(this.apiAdminService.saveRouting({ownerId:this.goodsId,...s}))}),this.removingRoutingList.length>0&&this.removingRoutingList.forEach(s=>u.push(this.apiAdminService.removeRouting(s))),u.length>0?(0,N.D)(u).subscribe({next:()=>this.loadRouting().subscribe({next:()=>{this.savedState=!0,this.hasSaved=!0,i.next(),i.complete()},error:s=>i.error(s)}),error:s=>i.error(s)}):(i.next(),i.complete())},error:n=>i.error(n)})})}loadRouting(){return new W.y(i=>{if(!this.goodsId)return this.routingList=[],i.next(),void i.complete();this.routingLoading=!0,this.apiAdminService.getListRouting(this.goodsId).pipe((0,f.x)(()=>this.routingLoading=!1)).subscribe({next:e=>{this.routingList=e,i.next(),i.complete()},error:e=>i.error(e)})})}beforeSave(){return(0,mt.of)(void 0)}afterSave(){return(0,mt.of)(void 0)}afterInit(){}}L.\u0275fac=function(i){return new(i||L)(t.Y36(b.F0),t.Y36(a.xA),t.Y36(h.KD),t.Y36(h.ib),t.Y36(h.tX))},L.\u0275dir=t.lG2({type:L});var T=m(9549),ct=m(3238),A=m(811),lt=m(4144),U=m(3805);class et{constructor(i,e){this.dialogService=i,this.apiAdminService=e,this.goodsList=[],this.controlGoodsId=new a.jn(null,r.kI.required),this.controlCountUses=new a.jn(null,r.kI.required),this.goodsListDef=[]}ngOnInit(){this.apiAdminService.getListGoods({type:"ingredient",deleted:!1}).subscribe({next:i=>{this.goodsListDef=i.values||[],this.goodsList=(i.values||[]).map(e=>({value:e.id,title:e.name}))},error:i=>this.dialogService.showToastError(i.message)})}onApply(){if(this.controlGoodsId.valid&&this.controlCountUses.valid){const i=this.goodsListDef.find(e=>e.id===this.controlGoodsId.value);i&&this.dialogRef?.close({...i,goodsId:this.controlGoodsId.value,countUses:this.controlCountUses.value})}else this.controlGoodsId.markAsTouched(),this.controlCountUses.markAsTouched()}onClose(){this.dialogRef?.close(null)}}function ei(o,i){if(1&o&&(t.TgZ(0,"th",16),t._uU(1),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.hij(" ",e.header," ")}}function ii(o,i){if(1&o&&(t.TgZ(0,"td",17),t._uU(1),t.qZA()),2&o){const e=i.$implicit,n=t.oxw().$implicit;t.uIk("class",n.className),t.xp6(1),t.hij(" ",n.cell(e)," ")}}function oi(o,i){1&o&&(t.ynx(0,13),t.YNc(1,ei,2,1,"th",14),t.YNc(2,ii,2,2,"td",15),t.BQk()),2&o&&t.Q6J("matColumnDef",i.$implicit.key)}function ni(o,i){1&o&&(t.TgZ(0,"th",18),t._uU(1," \u041a\u043e\u043b-\u0432\u043e \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u044f "),t.qZA())}function ui(o,i){if(1&o&&(t.TgZ(0,"div"),t._uU(1),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.hij(" ",e.countUses," ")}}function si(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"div",22)(1,"button",23),t.NdJ("click",function(){t.CHM(e);const u=t.oxw(),s=u.index,l=u.$implicit,d=t.oxw();return t.KtG(d.onSpeedDecrementClick(s,l))}),t.TgZ(2,"mat-icon"),t._uU(3,"remove_circle_outline"),t.qZA()(),t.TgZ(4,"input",24),t.NdJ("keydown",function(u){t.CHM(e);const s=t.oxw().$implicit,l=t.oxw();return t.KtG(l.onTextNumberKeyDown(u,s))})("focus",function(u){t.CHM(e);const s=t.oxw(2);return t.KtG(s.onSelectText(u))})("blur",function(){t.CHM(e);const u=t.oxw(),s=u.index,l=u.$implicit,d=t.oxw();return t.KtG(d.onBlurText(s,l))})("ngModelChange",function(u){t.CHM(e);const s=t.oxw().$implicit;return t.KtG(s.countUses=u)}),t.qZA(),t.TgZ(5,"button",23),t.NdJ("click",function(){t.CHM(e);const u=t.oxw(),s=u.index,l=u.$implicit,d=t.oxw();return t.KtG(d.onSpeedIncrementClick(s,l))}),t.TgZ(6,"mat-icon"),t._uU(7,"add_circle_outline"),t.qZA()()()}if(2&o){const e=t.oxw().$implicit;t.xp6(4),t.Q6J("maxlength",5)("ngModel",e.countUses)}}function ci(o,i){if(1&o&&(t.TgZ(0,"td",19),t.YNc(1,ui,2,1,"div",20),t.YNc(2,si,8,2,"div",21),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",!e.isPermissionEdit),t.xp6(1),t.Q6J("ngIf",e.isPermissionEdit)}}function li(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"th",25)(1,"button",26),t.NdJ("click",function(){t.CHM(e);const u=t.oxw();return t.KtG(u.onAddRecord())}),t.TgZ(2,"mat-icon"),t._uU(3,"add_circle_outline"),t.qZA()()()}}function ri(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"td",27)(1,"div",28)(2,"button",29),t.NdJ("click",function(){const u=t.CHM(e),s=u.index,l=u.$implicit,d=t.oxw();return t.KtG(d.onRemove(s,l))}),t.TgZ(3,"mat-icon"),t._uU(4,"highlight_off"),t.qZA()()()()}}function ai(o,i){1&o&&t._UZ(0,"tr",30)}function di(o,i){1&o&&t._UZ(0,"tr",31)}function mi(o,i){1&o&&(t.TgZ(0,"div",32),t._uU(1," \u041d\u0435\u0442 \u0434\u0430\u043d\u043d\u044b\u0445 "),t.qZA())}et.\u0275fac=function(i){return new(i||et)(t.Y36(a.xA),t.Y36(h.ib))},et.\u0275cmp=t.Xpm({type:et,selectors:[["adm-routing-edit"]],decls:8,vars:8,consts:[[1,"inside-modal-body-container"],["label","\u0422\u043e\u0432\u0430\u0440",3,"formControl","options","clearButton"],["label","\u041a\u043e\u043b-\u0432\u043e \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u044f",3,"formControl","min","allowDecimals","decimals","clearButton"],[1,"footer-buttons"],["mat-raised-button","","color","primary",3,"click"],["mat-raised-button","","color","accent",3,"click"]],template:function(i,e){1&i&&(t.TgZ(0,"div",0),t._UZ(1,"kui-select",1)(2,"kui-touchspin",2),t.qZA(),t.TgZ(3,"div",3)(4,"button",4),t.NdJ("click",function(){return e.onApply()}),t._uU(5," \u041f\u0440\u0438\u043c\u0435\u043d\u0438\u0442\u044c "),t.qZA(),t.TgZ(6,"button",5),t.NdJ("click",function(){return e.onClose()}),t._uU(7,"\u0417\u0430\u043a\u0440\u044b\u0442\u044c"),t.qZA()()),2&i&&(t.xp6(1),t.Q6J("formControl",e.controlGoodsId)("options",e.goodsList)("clearButton",!1),t.xp6(1),t.Q6J("formControl",e.controlCountUses)("min",0)("allowDecimals",!0)("decimals",3)("clearButton",!1))},dependencies:[r.JJ,r.oH,a.f5,a.os,p.lW],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;width:450px}"]});class J extends D{constructor(i){super(),this.dialogService=i,this.routingList=[],this.isPermissionEdit=!0,this.changeRoutingEvent=new t.vpe,this.removeRoutingEvent=new t.vpe,this.columns=[{key:"goodsName",header:"\u041d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u0435",cell:e=>`${e.goodsName}`},{key:"goodsCode",header:"\u0410\u0440\u0442\u0438\u043a\u0443\u043b",className:"cell-code",cell:e=>`${e.goodsCode}`},{key:"unit",header:"\u0415\u0434\u0438\u043d\u0438\u0446\u0430 \u0438\u0437\u043c\u0435\u0440\u0435\u043d\u0438\u044f",className:"cell-unit",cell:e=>`${e.unit}`}],this.stepIncrement=1}ngOnChanges(i){Object.prototype.hasOwnProperty.call(i,"routingList")&&(this.dataSource=[...this.routingList])}ngOnInit(){this.displayedColumns=["goodsName","goodsCode","unit","countUses"],this.isPermissionEdit&&this.displayedColumns.push("buttons")}onRemove(i,e){e.id?this.dialogService.showConfirm("\u0412\u044b \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u0445\u043e\u0442\u0438\u0442\u0435 \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u044d\u0442\u0443 \u043a\u0430\u0440\u0442\u0443?").subscribe(n=>{n&&e.id&&this.removeRoutingEvent.emit({idx:i,id:e.id})}):this.removeRoutingEvent.emit({idx:i})}onSpeedIncrementClick(i,e){this.increment(e),this.changeRoutingEvent.emit({idx:i,routing:e})}onSpeedDecrementClick(i,e){this.decrement(e),this.changeRoutingEvent.emit({idx:i,routing:e})}onBlurText(i,e){this.changeRoutingEvent.emit({idx:i,routing:e})}onSelectText(i){i.target?.select()}onTextNumberKeyDown(i,e){if(!["ArrowLeft","ArrowRight","ArrowUp","ArrowDown","ArrowUp","Backspace","Delete"].includes(i.key)){if("."===i.key)return void((!a.ZH.hasValue(e.countUses)||String(e.countUses).indexOf(".")>=0)&&i.preventDefault());/[0-9]/.test(i.key)||i.preventDefault()}}onAddRecord(){this.dialogService.showModal("\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0442\u043e\u0432\u0430\u0440\u0430",et,{},!0).subscribe(i=>{i&&this.changeRoutingEvent.emit({idx:null,routing:{goodsId:i.goodsId,countUses:i.countUses,goodsName:i.name,goodsCode:i.code,unit:i.unit}})})}increment(i){let e=new w.Z(i.countUses?i.countUses:0);e=e.plus(this.stepIncrement),i.countUses=Number(e.toFixed(3))}decrement(i){let e=new w.Z(i.countUses?i.countUses:0);e=e.minus(this.stepIncrement),i.countUses=e.lessThan(0)?0:Number(e.toFixed(3))}}function _i(o,i){1&o&&(t.TgZ(0,"div",6),t._UZ(1,"div",7),t.qZA())}function pi(o,i){if(1&o&&t._UZ(0,"div",39),2&o){const e=t.oxw(2);t.Udp("background-image",e.imageBgUrl)}}function gi(o,i){1&o&&(t.TgZ(0,"div",40),t._uU(1,"\u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c"),t.qZA())}function fi(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"div",41),t.NdJ("click",function(u){t.CHM(e);const s=t.oxw(2);return t.KtG(s.onRemoveImage(u))}),t.TgZ(1,"mat-icon",42),t._uU(2,"cancel"),t.qZA()()}}function hi(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"div",43)(1,"button",44),t.NdJ("click",function(u){t.CHM(e);const s=t.oxw(2);return t.KtG(s.onClearParentItem(u))}),t.TgZ(2,"mat-icon"),t._uU(3,"highlight_off"),t.qZA()()()}if(2&o){const e=t.oxw(2);t.xp6(1),t.Q6J("disabled",e.disabledClearParentItem())}}function xi(o,i){if(1&o&&(t.TgZ(0,"mat-option",45),t._uU(1),t.qZA()),2&o){const e=i.$implicit;t.Q6J("value",e),t.xp6(1),t.hij(" ",e," ")}}function Ci(o,i){1&o&&(t.TgZ(0,"div",6),t._UZ(1,"div",7),t.qZA())}function vi(o,i){1&o&&(t.TgZ(0,"div",46),t._uU(1," \u0414\u043b\u044f \u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u044f \u0442\u0435\u0445. \u043a\u0430\u0440\u0442\u043e\u0439 \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u0441\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c \u0442\u043e\u0432\u0430\u0440 "),t.qZA())}function Ai(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"adm-routing-list",47),t.NdJ("changeRoutingEvent",function(u){t.CHM(e);const s=t.oxw(2);return t.KtG(s.onChangeRouting(u))})("removeRoutingEvent",function(u){t.CHM(e);const s=t.oxw(2);return t.KtG(s.onRemoveRouting(u))}),t.qZA()}if(2&o){const e=t.oxw(2);t.Q6J("routingList",e.routingList)("isPermissionEdit",e.isPermissionEdit)}}function bi(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"div",8)(1,"div",9)(2,"div",10),t.NdJ("click",function(){t.CHM(e);const u=t.oxw();return t.KtG(u.onUploadImage())}),t.YNc(3,pi,1,2,"div",11),t.YNc(4,gi,2,0,"div",12),t.YNc(5,fi,3,0,"div",13),t.qZA(),t.TgZ(6,"div",14)(7,"div",15)(8,"div"),t._UZ(9,"kui-input",16),t.qZA(),t.TgZ(10,"div",17)(11,"div"),t._UZ(12,"kui-input",18),t.qZA(),t.TgZ(13,"div"),t._UZ(14,"kui-select",19),t.qZA(),t.TgZ(15,"div"),t._UZ(16,"kui-touchspin",20),t.qZA()()()(),t.TgZ(17,"div",21)(18,"div")(19,"mat-form-field",22)(20,"mat-label"),t._uU(21,"\u0420\u043e\u0434\u0438\u0442\u0435\u043b\u044c\u0441\u043a\u0430\u044f \u0433\u0440\u0443\u043f\u043f\u0430"),t.qZA(),t._UZ(22,"input",23),t.YNc(23,hi,4,1,"div",24),t.TgZ(24,"mat-autocomplete",null,25),t.YNc(26,xi,2,2,"mat-option",26),t.qZA()()(),t.TgZ(27,"div",27)(28,"label",28),t._uU(29,"\u041c\u0435\u0442\u043e\u0434 \u0441\u043f\u0438\u0441\u0430\u043d\u0438\u044f"),t.qZA(),t.TgZ(30,"div",29)(31,"mat-button-toggle-group",30)(32,"mat-button-toggle",31),t._uU(33," \u041d\u0435 \u0441\u043f\u0438\u0441\u044b\u0432\u0430\u0442\u044c "),t.qZA(),t.TgZ(34,"mat-button-toggle",32),t._uU(35," \u041f\u043e \u0442\u0435\u0445. \u043a\u0430\u0440\u0442\u0435 "),t.qZA(),t.TgZ(36,"mat-button-toggle",33),t._uU(37," \u041f\u043e \u043f\u0440\u043e\u0434\u0443\u043a\u0442\u0443 "),t.qZA()()()()()(),t.TgZ(38,"div",34)(39,"mat-tab-group",35)(40,"mat-tab",36),t.YNc(41,Ci,2,0,"div",1),t.YNc(42,vi,2,0,"div",37),t.YNc(43,Ai,1,2,"adm-routing-list",38),t.qZA()()()()}if(2&o){const e=t.MAs(25),n=t.oxw();t.xp6(1),t.Q6J("formGroup",n.formGroup),t.xp6(1),t.ekj("cursor-pointer",n.isPermissionEdit),t.xp6(1),t.Q6J("ngIf",n.imageBgUrl),t.xp6(1),t.Q6J("ngIf",n.isPermissionEdit),t.xp6(1),t.Q6J("ngIf",n.imageBgUrl&&n.isPermissionEdit),t.xp6(4),t.Q6J("readonly",!n.isPermissionEdit),t.xp6(3),t.Q6J("readonly",!n.isPermissionEdit),t.xp6(2),t.Q6J("options",n.unitList)("clearButton",!1)("readonly",!n.isPermissionEdit),t.xp6(2),t.Q6J("min",0),t.xp6(6),t.Q6J("readonly",!n.isPermissionEdit)("matAutocomplete",e),t.xp6(1),t.Q6J("ngIf",n.isPermissionEdit),t.xp6(3),t.Q6J("ngForOf",n.parentItemList),t.xp6(13),t.Q6J("mat-stretch-tabs",!1),t.xp6(2),t.Q6J("ngIf",n.routingLoading),t.xp6(1),t.Q6J("ngIf",!n.goodsId&&!n.routingLoading),t.xp6(1),t.Q6J("ngIf",n.goodsId&&!n.routingLoading)}}function Ti(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"button",48),t.NdJ("click",function(){t.CHM(e);const u=t.oxw();return t.KtG(u.onApply())}),t._uU(1," \u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c "),t.qZA()}if(2&o){const e=t.oxw();t.Q6J("disabled",e.savedState)}}function Zi(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"button",48),t.NdJ("click",function(){t.CHM(e);const u=t.oxw();return t.KtG(u.onApply(!0))}),t._uU(1," \u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c \u0438 \u0437\u0430\u043a\u0440\u044b\u0442\u044c "),t.qZA()}if(2&o){const e=t.oxw();t.Q6J("disabled",e.savedState)}}J.\u0275fac=function(i){return new(i||J)(t.Y36(a.xA))},J.\u0275cmp=t.Xpm({type:J,selectors:[["adm-routing-list"]],inputs:{routingList:"routingList",isPermissionEdit:"isPermissionEdit"},outputs:{changeRoutingEvent:"changeRoutingEvent",removeRoutingEvent:"removeRoutingEvent"},features:[t.qOj,t.TTD],decls:13,vars:6,consts:[[1,"scroll-container","content"],[1,"scroll"],["mat-table","",1,"table","with-borders",3,"dataSource"],[3,"matColumnDef",4,"ngFor","ngForOf"],["matColumnDef","countUses"],["mat-header-cell","","class","cell-count",4,"matHeaderCellDef"],["mat-cell","","class","cell-count",4,"matCellDef"],["matColumnDef","buttons"],["mat-header-cell","","class","buttons-cell",4,"matHeaderCellDef"],["mat-cell","","class","buttons-cell",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","","class","table-row",4,"matRowDef","matRowDefColumns"],["class","text-center text-danger mt-10",4,"ngIf"],[3,"matColumnDef"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["mat-header-cell",""],["mat-cell",""],["mat-header-cell","",1,"cell-count"],["mat-cell","",1,"cell-count"],[4,"ngIf"],["class","flex-row-centered",4,"ngIf"],[1,"flex-row-centered"],["mat-icon-button","","color","primary",3,"click"],["type","number","min","0","step","1",1,"table-input",3,"maxlength","ngModel","keydown","focus","blur","ngModelChange"],["mat-header-cell","",1,"buttons-cell"],["mat-icon-button","","matTooltip","\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0442\u043e\u0432\u0430\u0440",3,"click"],["mat-cell","",1,"buttons-cell"],[1,"container"],["mat-icon-button","","color","accent",3,"click"],["mat-header-row",""],["mat-row","",1,"table-row"],[1,"text-center","text-danger","mt-10"]],template:function(i,e){1&i&&(t.TgZ(0,"div",0)(1,"div",1)(2,"table",2),t.YNc(3,oi,3,1,"ng-container",3),t.ynx(4,4),t.YNc(5,ni,2,0,"th",5),t.YNc(6,ci,3,2,"td",6),t.BQk(),t.ynx(7,7),t.YNc(8,li,4,0,"th",8),t.YNc(9,ri,5,0,"td",9),t.BQk(),t.YNc(10,ai,1,0,"tr",10),t.YNc(11,di,1,0,"tr",11),t.qZA(),t.YNc(12,mi,2,0,"div",12),t.qZA()()),2&i&&(t.xp6(2),t.Q6J("dataSource",e.dataSource),t.xp6(1),t.Q6J("ngForOf",e.columns),t.xp6(7),t.Q6J("matHeaderRowDef",e.displayedColumns)("matHeaderRowDefSticky",!0),t.xp6(1),t.Q6J("matRowDefColumns",e.displayedColumns),t.xp6(1),t.Q6J("ngIf",0===e.dataSource.length))},dependencies:[_.sg,_.O5,r.Fj,r.wV,r.JJ,r.nD,r.qQ,r.On,x.Hw,p.RK,c.BZ,c.fO,c.as,c.w1,c.Dz,c.nj,c.ge,c.ev,c.XQ,c.Gk,C.gM],styles:["[_nghost-%COMP%]{flex:auto;display:flex;flex-direction:column}.table-input[_ngcontent-%COMP%]{border:none;text-align:center;font-size:16px;width:100px;outline:none;background:transparent;appearance:textfield;-webkit-appearance:none;-moz-appearance:textfield}.cell-code[_ngcontent-%COMP%]{width:100px;text-align:center}.cell-unit[_ngcontent-%COMP%]{width:170px;text-align:center}.cell-count[_ngcontent-%COMP%], .cell-summa[_ngcontent-%COMP%]{width:180px;text-align:center}"]});class P extends L{constructor(){super(...arguments),this.formGroup=new r.cw({name:new a.jn(null,r.kI.required),code:new a.jn(null,r.kI.required),unitId:new a.jn(null,r.kI.required),price:new a.jn(null,r.kI.required),routeBy:new a.jn("bynull",r.kI.required),parentItem:new a.jn(null)}),this.imageBgUrl=null,this.typeGoods="dish",this.imageFile=null,this.imageId=null}onRemoveImage(i){i.stopPropagation(),this.imageBgUrl=null,this.savedState=!1}onUploadImage(){this.isPermissionEdit&&a.ZH.uploadFile("image/*").subscribe(i=>{this.imageFile=i,this.savedState=!1,this.imageBgUrl=`url(${URL.createObjectURL(this.imageFile)})`})}afterInit(){this.currentGoods?.imageId&&this.apiFilesService.getFile(this.currentGoods.imageId).subscribe({next:i=>{this.imageBgUrl=`url(${URL.createObjectURL(i.file)})`},error:i=>this.dialogService.showToastError(i.message)})}getGoodsSaveParams(){return{id:this.goodsId,type:this.typeGoods,imageId:this.imageId,...this.formGroup.value}}beforeSave(){return new W.y(i=>{this.saveImage().then(e=>{this.imageId=e,i.next(),i.complete()}).catch(e=>i.error(e))})}saveImage(){var i=this;return(0,ti.Z)(function*(){if(!i.imageFile&&!i.imageBgUrl){if(i.imageId)try{yield(0,st.n)(i.apiFilesService.removeFile(i.imageId))}catch{}return null}if(i.imageFile)try{return i.imageId?(yield(0,st.n)(i.apiFilesService.updateFile(i.imageId,i.imageFile)),i.imageId):yield(0,st.n)(i.apiFilesService.addFile(i.imageFile))}catch(e){throw new Error(e.message)}return i.imageId})()}}function wi(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"mat-button-toggle-group",22),t.NdJ("ngModelChange",function(u){t.CHM(e);const s=t.oxw();return t.KtG(s.modeState=u)}),t.TgZ(1,"mat-button-toggle",23)(2,"mat-icon"),t._uU(3,"home"),t.qZA()(),t.TgZ(4,"mat-button-toggle",24)(5,"mat-icon"),t._uU(6,"delete"),t.qZA()()()}if(2&o){const e=t.oxw();t.Q6J("ngModel",e.modeState)}}function Ei(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"button",25),t.NdJ("click",function(){t.CHM(e);const u=t.oxw();return t.KtG(u.onAddRecord())}),t.TgZ(1,"mat-icon"),t._uU(2,"add"),t.qZA(),t.TgZ(3,"span"),t._uU(4,"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0442\u043e\u0432\u0430\u0440"),t.qZA()()}}function Di(o,i){if(1&o&&(t.TgZ(0,"th",29),t._uU(1),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.hij(" ",e.header," ")}}function yi(o,i){if(1&o&&(t.TgZ(0,"td",30),t._uU(1),t.qZA()),2&o){const e=i.$implicit,n=t.oxw().$implicit;t.uIk("class",n.className),t.xp6(1),t.hij(" ",n.cell(e)," ")}}function Ii(o,i){1&o&&(t.ynx(0,26),t.YNc(1,Di,2,1,"th",27),t.YNc(2,yi,2,2,"td",28),t.BQk()),2&o&&t.Q6J("matColumnDef",i.$implicit.key)}function ki(o,i){1&o&&(t.TgZ(0,"th",31),t._uU(1," \xa0 "),t.qZA())}function Ni(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"div",34)(1,"button",35),t.NdJ("click",function(u){t.CHM(e);const s=t.oxw().$implicit,l=t.oxw();return t.KtG(l.onRestoreRow(u,s))}),t.TgZ(2,"mat-icon"),t._uU(3,"check"),t.qZA()()()}}function Si(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"button",38),t.NdJ("click",function(u){t.CHM(e);const s=t.oxw(2).$implicit,l=t.oxw();return t.KtG(l.onRemoveRow(u,s))}),t.TgZ(1,"mat-icon"),t._uU(2,"highlight_off"),t.qZA()()}}function Ri(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"div",34)(1,"button",36),t.NdJ("click",function(u){t.CHM(e);const s=t.oxw().$implicit,l=t.oxw();return t.KtG(l.onEditRow(u,s))}),t.TgZ(2,"mat-icon"),t._uU(3,"edit"),t.qZA()(),t.YNc(4,Si,3,0,"button",37),t.qZA()}if(2&o){const e=t.oxw(2);t.xp6(1),t.s9C("matTooltip",e.isPermissionEdit?"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0442\u043e\u0432\u0430\u0440":"\u041f\u0440\u043e\u0441\u043c\u043e\u0442\u0440\u0435\u0442\u044c \u0442\u043e\u0432\u0430\u0440"),t.xp6(3),t.Q6J("ngIf",e.isPermissionRemove)}}function Li(o,i){if(1&o&&(t.TgZ(0,"td",32),t.YNc(1,Ni,4,0,"div",33),t.YNc(2,Ri,5,2,"div",33),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.Q6J("ngIf","deleted"===e.modeState),t.xp6(1),t.Q6J("ngIf","standart"===e.modeState)}}function Ui(o,i){1&o&&t._UZ(0,"tr",39)}function Ji(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"tr",40),t.NdJ("dblclick",function(u){const l=t.CHM(e).$implicit,d=t.oxw();return t.KtG(d.onEditRow(u,l))}),t.qZA()}}function Pi(o,i){1&o&&(t.TgZ(0,"mat-icon"),t._uU(1,"expand_less"),t.qZA())}function Mi(o,i){1&o&&(t.TgZ(0,"mat-icon"),t._uU(1,"expand_more"),t.qZA())}function qi(o,i){if(1&o&&(t.TgZ(0,"td",41)(1,"div",42),t.YNc(2,Pi,2,0,"mat-icon",43),t.YNc(3,Mi,2,0,"mat-icon",43),t.TgZ(4,"strong"),t._uU(5),t.qZA()()()),2&o){const e=i.$implicit;t.xp6(2),t.Q6J("ngIf",!e.expanded),t.xp6(1),t.Q6J("ngIf",e.expanded),t.xp6(2),t.Oqu(e.groupName)}}function Fi(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"tr",44),t.NdJ("click",function(){const s=t.CHM(e).$implicit,l=t.oxw();return t.KtG(l.reduceGroup(s))}),t.qZA()}}function Gi(o,i){1&o&&(t.TgZ(0,"div",45),t._uU(1," \u041d\u0435\u0442 \u0434\u0430\u043d\u043d\u044b\u0445 "),t.qZA())}P.\u0275fac=function(){let o;return function(e){return(o||(o=t.n5z(P)))(e||P)}}(),P.\u0275cmp=t.Xpm({type:P,selectors:[["adm-dish-edit"]],features:[t.qOj],decls:8,vars:4,consts:[[1,"inside-modal-body-container"],["class","flex-col-centered flex-auto",4,"ngIf"],["class","flex-col flex-auto",4,"ngIf"],[1,"footer-buttons"],["mat-raised-button","","color","primary",3,"disabled","click",4,"ngIf"],["mat-raised-button","","color","accent",3,"click"],[1,"flex-col-centered","flex-auto"],[1,"loading-block"],[1,"flex-col","flex-auto"],[1,"flex-row",3,"formGroup"],[1,"image-container",3,"click"],["class","bg-image",3,"background-image",4,"ngIf"],["class","hover",4,"ngIf"],["class","remove","matTooltip","\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u0438\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435",3,"click",4,"ngIf"],[1,"flex-col","ml-10"],[1,"base-info-container"],["label","\u041d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u0435","formControlName","name",3,"readonly"],[1,"grid-3-cell"],["label","\u0410\u0440\u0442\u0438\u043a\u0443\u043b","formControlName","code",3,"readonly"],["label","\u0415\u0434\u0438\u043d\u0438\u0446\u0430 \u0438\u0437\u043c\u0435\u0440\u0435\u043d\u0438\u044f","formControlName","unitId",3,"options","clearButton","readonly"],["label","\u0411\u0430\u0437\u043e\u0432\u0430\u044f \u0446\u0435\u043d\u0430, \u0440\u0443\u0431","formControlName","price",3,"min"],[1,"flex-col","flex-auto","ml-10","mt-6"],["appearance","outline",2,"width","100%"],["type","text","matInput","","tabindex","-1","formControlName","parentItem",3,"readonly","matAutocomplete"],["matIconSuffix","","class","mr-10",4,"ngIf"],["auto","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],[1,"flex-col"],[1,"text-bold"],[1,"mt-10"],["formControlName","routeBy"],["value","bynull"],["value","byrouting"],["value","bygoods"],[1,"flex-col","flex-auto","mt-10"],[1,"tabs-panel-container","flex-auto",3,"mat-stretch-tabs"],["label","\u0422\u0435\u0445\u043d\u043e\u043b\u043e\u0433\u0438\u0447\u0435\u0441\u043a\u0430\u044f \u043a\u0430\u0440\u0442\u0430"],["class","flex-col-centered flex-auto text-danger",4,"ngIf"],["class","mt-10",3,"routingList","isPermissionEdit","changeRoutingEvent","removeRoutingEvent",4,"ngIf"],[1,"bg-image"],[1,"hover"],["matTooltip","\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u0438\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435",1,"remove",3,"click"],["color","accent"],["matIconSuffix","",1,"mr-10"],["mat-icon-button","","color","accent","tabindex","-1",3,"disabled","click"],[3,"value"],[1,"flex-col-centered","flex-auto","text-danger"],[1,"mt-10",3,"routingList","isPermissionEdit","changeRoutingEvent","removeRoutingEvent"],["mat-raised-button","","color","primary",3,"disabled","click"]],template:function(i,e){1&i&&(t.TgZ(0,"div",0),t.YNc(1,_i,2,0,"div",1),t.YNc(2,bi,44,20,"div",2),t.qZA(),t.TgZ(3,"div",3),t.YNc(4,Ti,2,1,"button",4),t.YNc(5,Zi,2,1,"button",4),t.TgZ(6,"button",5),t.NdJ("click",function(){return e.onClose()}),t._uU(7,"\u0417\u0430\u043a\u0440\u044b\u0442\u044c"),t.qZA()()),2&i&&(t.xp6(1),t.Q6J("ngIf",e.loading),t.xp6(1),t.Q6J("ngIf",!e.loading),t.xp6(2),t.Q6J("ngIf",e.isPermissionEdit),t.xp6(1),t.Q6J("ngIf",e.isPermissionEdit))},dependencies:[_.sg,_.O5,r.Fj,r.JJ,r.JL,r.sg,r.u,a.y0,a.f5,a.os,x.Hw,T.KE,T.hX,T.R9,ct.ey,A.A9,A.Yi,lt.Nt,p.lW,p.RK,R.uX,R.SP,U.XC,U.ZL,C.gM,J],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;width:1280px;height:500px}.mt-6[_ngcontent-%COMP%]{margin-top:6px}.image-container[_ngcontent-%COMP%]{position:relative;width:140px;height:140px;margin-top:8px;box-sizing:border-box;border:1px solid #c6c6c6;border-radius:6px;box-shadow:2px 2px 2px #0006;background-color:#ffefd5;background-repeat:no-repeat;background-position:center center;background-size:auto;background-image:url(ico-photo.c066a472b5ba8cd8.png)}.image-container[_ngcontent-%COMP%]:hover   .hover[_ngcontent-%COMP%], .image-container[_ngcontent-%COMP%]:hover   .remove[_ngcontent-%COMP%]{display:block}.image-container[_ngcontent-%COMP%]   .bg-image[_ngcontent-%COMP%]{position:absolute;inset:0;border-radius:6px;background-color:#ffefd5;background-repeat:no-repeat;background-position:center center;background-size:contain}.image-container[_ngcontent-%COMP%]   .remove[_ngcontent-%COMP%]{display:none;position:absolute;top:0;right:0;width:24px;height:24px;cursor:pointer}.image-container[_ngcontent-%COMP%]   .hover[_ngcontent-%COMP%]{display:none;position:absolute;left:0;right:0;bottom:0;height:36px;background-color:#00000080;line-height:36px;color:#fff;text-align:center;z-index:1}"]});const Qi=function(){return["groupHeader"]};class M extends I{constructor(){super(...arguments),this.title="\u0421\u043f\u0438\u0441\u043e\u043a \u0431\u043b\u044e\u0434",this.typeGoods="dish",this.editComponent=P}}function Oi(o,i){1&o&&(t.TgZ(0,"div",6),t._UZ(1,"div",7),t.qZA())}function Yi(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"div",40)(1,"button",41),t.NdJ("click",function(u){t.CHM(e);const s=t.oxw(2);return t.KtG(s.onClearParentItem(u))}),t.TgZ(2,"mat-icon"),t._uU(3,"highlight_off"),t.qZA()()()}if(2&o){const e=t.oxw(2);t.xp6(1),t.Q6J("disabled",e.disabledClearParentItem())}}function Bi(o,i){if(1&o&&(t.TgZ(0,"mat-option",42),t._uU(1),t.qZA()),2&o){const e=i.$implicit;t.Q6J("value",e),t.xp6(1),t.hij(" ",e," ")}}function Hi(o,i){1&o&&(t.TgZ(0,"div",6),t._UZ(1,"div",7),t.qZA())}function ji(o,i){1&o&&(t.TgZ(0,"div",43),t._uU(1," \u0414\u043b\u044f \u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u044f \u0442\u0435\u0445. \u043a\u0430\u0440\u0442\u043e\u0439 \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u0441\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c \u0442\u043e\u0432\u0430\u0440 "),t.qZA())}function $i(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"adm-routing-list",44),t.NdJ("changeRoutingEvent",function(u){t.CHM(e);const s=t.oxw(2);return t.KtG(s.onChangeRouting(u))})("removeRoutingEvent",function(u){t.CHM(e);const s=t.oxw(2);return t.KtG(s.onRemoveRouting(u))}),t.qZA()}if(2&o){const e=t.oxw(2);t.Q6J("routingList",e.routingList)("isPermissionEdit",e.isPermissionEdit)}}function Ki(o,i){if(1&o&&(t.TgZ(0,"div",8)(1,"div",9)(2,"div",10)(3,"div",11)(4,"div"),t._UZ(5,"kui-input",12),t.qZA(),t.TgZ(6,"div",13)(7,"div"),t._UZ(8,"kui-input",14),t.qZA(),t.TgZ(9,"div"),t._UZ(10,"kui-select",15),t.qZA(),t.TgZ(11,"div"),t._UZ(12,"kui-touchspin",16),t.qZA()()()(),t.TgZ(13,"div",17)(14,"div")(15,"mat-form-field",18)(16,"mat-label"),t._uU(17,"\u0420\u043e\u0434\u0438\u0442\u0435\u043b\u044c\u0441\u043a\u0430\u044f \u0433\u0440\u0443\u043f\u043f\u0430"),t.qZA(),t._UZ(18,"input",19),t.YNc(19,Yi,4,1,"div",20),t.TgZ(20,"mat-autocomplete",null,21),t.YNc(22,Bi,2,2,"mat-option",22),t.qZA()()(),t.TgZ(23,"div",23)(24,"div",24),t._UZ(25,"kui-touchspin",25),t.qZA(),t.TgZ(26,"div",24),t._UZ(27,"kui-touchspin",26),t.qZA(),t.TgZ(28,"div",24),t._UZ(29,"kui-touchspin",27),t.qZA()(),t.TgZ(30,"div",28)(31,"label",29),t._uU(32,"\u041c\u0435\u0442\u043e\u0434 \u0441\u043f\u0438\u0441\u0430\u043d\u0438\u044f"),t.qZA(),t.TgZ(33,"div",30)(34,"mat-button-toggle-group",31)(35,"mat-button-toggle",32),t._uU(36," \u041d\u0435 \u0441\u043f\u0438\u0441\u044b\u0432\u0430\u0442\u044c "),t.qZA(),t.TgZ(37,"mat-button-toggle",33),t._uU(38," \u041f\u043e \u0442\u0435\u0445. \u043a\u0430\u0440\u0442\u0435 "),t.qZA(),t.TgZ(39,"mat-button-toggle",34),t._uU(40," \u041f\u043e \u043f\u0440\u043e\u0434\u0443\u043a\u0442\u0443 "),t.qZA()()()()()(),t.TgZ(41,"div",35)(42,"mat-tab-group",36)(43,"mat-tab",37),t.YNc(44,Hi,2,0,"div",1),t.YNc(45,ji,2,0,"div",38),t.YNc(46,$i,1,2,"adm-routing-list",39),t.qZA()()()()),2&o){const e=t.MAs(21),n=t.oxw();t.xp6(1),t.Q6J("formGroup",n.formGroup),t.xp6(4),t.Q6J("readonly",!n.isPermissionEdit),t.xp6(3),t.Q6J("readonly",!n.isPermissionEdit),t.xp6(2),t.Q6J("options",n.unitList)("clearButton",!1)("readonly",!n.isPermissionEdit),t.xp6(2),t.Q6J("min",0),t.xp6(6),t.Q6J("readonly",!n.isPermissionEdit)("matAutocomplete",e),t.xp6(1),t.Q6J("ngIf",n.isPermissionEdit),t.xp6(3),t.Q6J("ngForOf",n.parentItemList),t.xp6(3),t.Q6J("min",0)("clearButton",!1),t.xp6(2),t.Q6J("min",0)("clearButton",!1),t.xp6(2),t.Q6J("min",0)("clearButton",!1),t.xp6(13),t.Q6J("mat-stretch-tabs",!1),t.xp6(2),t.Q6J("ngIf",n.routingLoading),t.xp6(1),t.Q6J("ngIf",!n.goodsId&&!n.routingLoading),t.xp6(1),t.Q6J("ngIf",n.goodsId&&!n.routingLoading)}}function Wi(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"button",45),t.NdJ("click",function(){t.CHM(e);const u=t.oxw();return t.KtG(u.onApply())}),t._uU(1," \u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c "),t.qZA()}if(2&o){const e=t.oxw();t.Q6J("disabled",e.savedState)}}function zi(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"button",45),t.NdJ("click",function(){t.CHM(e);const u=t.oxw();return t.KtG(u.onApply(!0))}),t._uU(1," \u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c \u0438 \u0437\u0430\u043a\u0440\u044b\u0442\u044c "),t.qZA()}if(2&o){const e=t.oxw();t.Q6J("disabled",e.savedState)}}M.\u0275fac=function(){let o;return function(e){return(o||(o=t.n5z(M)))(e||M)}}(),M.\u0275cmp=t.Xpm({type:M,selectors:[["adm-dish-list"]],features:[t.qOj],decls:26,vars:14,consts:[[1,"page-list"],[1,"page-list__head"],[3,"ngModel","ngModelChange",4,"ngIf"],[1,"page-title","ml-10"],[1,"page-subtitle"],[3,"length","hidePageSize"],["mat-icon-button","","color","primary",3,"click"],["mat-raised-button","","color","primary","class","mat-button-with-icon head-button ml-10",3,"click",4,"ngIf"],[1,"page-list__content"],[1,"scroll-container"],[1,"scroll"],["mat-table","",1,"table","with-borders",3,"dataSource"],[3,"matColumnDef",4,"ngFor","ngForOf"],["matColumnDef","buttons"],["mat-header-cell","","class","buttons-cell",4,"matHeaderCellDef"],["mat-cell","","class","buttons-cell",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","","class","table-row",3,"dblclick",4,"matRowDef","matRowDefColumns"],["matColumnDef","groupHeader"],["colspan","999","mat-cell","",4,"matCellDef"],["mat-row","","class","row-group",3,"click",4,"matRowDef","matRowDefColumns","matRowDefWhen"],["class","text-center text-danger mt-10",4,"ngIf"],[3,"ngModel","ngModelChange"],["value","standart","matTooltip","\u0421\u0442\u0430\u043d\u0434\u0430\u0440\u0442\u043d\u044b\u0439 \u0440\u0435\u0436\u0438\u043c"],["value","deleted","matTooltip","\u0420\u0435\u0436\u0438\u043c \u0443\u0434\u0430\u043b\u0435\u043d\u043d\u044b\u0445 \u0442\u043e\u0432\u0430\u0440\u043e\u0432"],["mat-raised-button","","color","primary",1,"mat-button-with-icon","head-button","ml-10",3,"click"],[3,"matColumnDef"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["mat-header-cell",""],["mat-cell",""],["mat-header-cell","",1,"buttons-cell"],["mat-cell","",1,"buttons-cell"],["class","container",4,"ngIf"],[1,"container"],["mat-icon-button","","color","primary","matTooltip","\u0412\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u0442\u043e\u0432\u0430\u0440",3,"click"],["mat-icon-button","","color","primary",3,"matTooltip","click"],["mat-icon-button","","color","accent","matTooltip","\u041f\u043e\u043c\u0435\u0442\u0438\u0442\u044c \u0442\u043e\u0432\u0430\u0440 \u043a\u0430\u043a \u0443\u0434\u0430\u043b\u0435\u043d\u043d\u044b\u0439",3,"click",4,"ngIf"],["mat-icon-button","","color","accent","matTooltip","\u041f\u043e\u043c\u0435\u0442\u0438\u0442\u044c \u0442\u043e\u0432\u0430\u0440 \u043a\u0430\u043a \u0443\u0434\u0430\u043b\u0435\u043d\u043d\u044b\u0439",3,"click"],["mat-header-row",""],["mat-row","",1,"table-row",3,"dblclick"],["colspan","999","mat-cell",""],[1,"flex-align-center"],[4,"ngIf"],["mat-row","",1,"row-group",3,"click"],[1,"text-center","text-danger","mt-10"]],template:function(i,e){1&i&&(t.TgZ(0,"div",0)(1,"div",1),t.YNc(2,wi,7,1,"mat-button-toggle-group",2),t.TgZ(3,"div",3),t._uU(4,"\u041d\u043e\u043c\u0435\u043d\u043a\u043b\u0430\u0442\u0443\u0440\u0430"),t.qZA(),t.TgZ(5,"div",4),t._uU(6),t.qZA(),t._UZ(7,"mat-paginator",5),t.TgZ(8,"button",6),t.NdJ("click",function(){return e.onReload()}),t.TgZ(9,"mat-icon"),t._uU(10,"autorenew"),t.qZA()(),t.YNc(11,Ei,5,0,"button",7),t.qZA(),t.TgZ(12,"div",8)(13,"div",9)(14,"div",10)(15,"table",11),t.YNc(16,Ii,3,1,"ng-container",12),t.ynx(17,13),t.YNc(18,ki,2,0,"th",14),t.YNc(19,Li,3,2,"td",15),t.BQk(),t.YNc(20,Ui,1,0,"tr",16),t.YNc(21,Ji,1,0,"tr",17),t.ynx(22,18),t.YNc(23,qi,6,3,"td",19),t.BQk(),t.YNc(24,Fi,1,0,"tr",20),t.qZA(),t.YNc(25,Gi,2,0,"div",21),t.qZA()()()()),2&i&&(t.xp6(2),t.Q6J("ngIf",e.isPermissionEdit),t.xp6(4),t.hij("\xa0\u27a4\xa0",e.title,""),t.xp6(1),t.Q6J("length",e.total)("hidePageSize",!0),t.xp6(4),t.Q6J("ngIf",e.isPermissionEdit),t.xp6(4),t.Q6J("dataSource",e.dataSource),t.xp6(1),t.Q6J("ngForOf",e.columns),t.xp6(4),t.Q6J("matHeaderRowDef",e.displayedColumns)("matHeaderRowDefSticky",!0),t.xp6(1),t.Q6J("matRowDefColumns",e.displayedColumns),t.xp6(3),t.Q6J("matRowDefColumns",t.DdM(13,Qi))("matRowDefWhen",e.isGroup),t.xp6(1),t.Q6J("ngIf",0===e.dataSource.length))},dependencies:[_.sg,_.O5,r.JJ,r.On,x.Hw,A.A9,A.Yi,p.lW,p.RK,c.BZ,c.fO,c.as,c.w1,c.Dz,c.nj,c.ge,c.ev,c.XQ,c.Gk,y.NW,C.gM],styles:["[_nghost-%COMP%]{flex:auto;display:flex;flex-direction:column}"]});class q extends L{constructor(){super(...arguments),this.formGroup=new r.cw({name:new a.jn(null,r.kI.required),code:new a.jn(null,r.kI.required),unitId:new a.jn(null,r.kI.required),price:new a.jn(null,r.kI.required),routeBy:new a.jn("bynull",r.kI.required),parentItem:new a.jn(null),minCount:new a.jn(null),maxCount:new a.jn(null),defCount:new a.jn(null)}),this.typeGoods="modifier"}}function Xi(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"mat-button-toggle-group",22),t.NdJ("ngModelChange",function(u){t.CHM(e);const s=t.oxw();return t.KtG(s.modeState=u)}),t.TgZ(1,"mat-button-toggle",23)(2,"mat-icon"),t._uU(3,"home"),t.qZA()(),t.TgZ(4,"mat-button-toggle",24)(5,"mat-icon"),t._uU(6,"delete"),t.qZA()()()}if(2&o){const e=t.oxw();t.Q6J("ngModel",e.modeState)}}function Vi(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"button",25),t.NdJ("click",function(){t.CHM(e);const u=t.oxw();return t.KtG(u.onAddRecord())}),t.TgZ(1,"mat-icon"),t._uU(2,"add"),t.qZA(),t.TgZ(3,"span"),t._uU(4,"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0442\u043e\u0432\u0430\u0440"),t.qZA()()}}function to(o,i){if(1&o&&(t.TgZ(0,"th",29),t._uU(1),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.hij(" ",e.header," ")}}function eo(o,i){if(1&o&&(t.TgZ(0,"td",30),t._uU(1),t.qZA()),2&o){const e=i.$implicit,n=t.oxw().$implicit;t.uIk("class",n.className),t.xp6(1),t.hij(" ",n.cell(e)," ")}}function io(o,i){1&o&&(t.ynx(0,26),t.YNc(1,to,2,1,"th",27),t.YNc(2,eo,2,2,"td",28),t.BQk()),2&o&&t.Q6J("matColumnDef",i.$implicit.key)}function oo(o,i){1&o&&(t.TgZ(0,"th",31),t._uU(1," \xa0 "),t.qZA())}function no(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"div",34)(1,"button",35),t.NdJ("click",function(u){t.CHM(e);const s=t.oxw().$implicit,l=t.oxw();return t.KtG(l.onRestoreRow(u,s))}),t.TgZ(2,"mat-icon"),t._uU(3,"check"),t.qZA()()()}}function uo(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"button",38),t.NdJ("click",function(u){t.CHM(e);const s=t.oxw(2).$implicit,l=t.oxw();return t.KtG(l.onRemoveRow(u,s))}),t.TgZ(1,"mat-icon"),t._uU(2,"highlight_off"),t.qZA()()}}function so(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"div",34)(1,"button",36),t.NdJ("click",function(u){t.CHM(e);const s=t.oxw().$implicit,l=t.oxw();return t.KtG(l.onEditRow(u,s))}),t.TgZ(2,"mat-icon"),t._uU(3,"edit"),t.qZA()(),t.YNc(4,uo,3,0,"button",37),t.qZA()}if(2&o){const e=t.oxw(2);t.xp6(1),t.s9C("matTooltip",e.isPermissionEdit?"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0442\u043e\u0432\u0430\u0440":"\u041f\u0440\u043e\u0441\u043c\u043e\u0442\u0440\u0435\u0442\u044c \u0442\u043e\u0432\u0430\u0440"),t.xp6(3),t.Q6J("ngIf",e.isPermissionRemove)}}function co(o,i){if(1&o&&(t.TgZ(0,"td",32),t.YNc(1,no,4,0,"div",33),t.YNc(2,so,5,2,"div",33),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.Q6J("ngIf","deleted"===e.modeState),t.xp6(1),t.Q6J("ngIf","standart"===e.modeState)}}function lo(o,i){1&o&&t._UZ(0,"tr",39)}function ro(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"tr",40),t.NdJ("dblclick",function(u){const l=t.CHM(e).$implicit,d=t.oxw();return t.KtG(d.onEditRow(u,l))}),t.qZA()}}function ao(o,i){1&o&&(t.TgZ(0,"mat-icon"),t._uU(1,"expand_less"),t.qZA())}function mo(o,i){1&o&&(t.TgZ(0,"mat-icon"),t._uU(1,"expand_more"),t.qZA())}function _o(o,i){if(1&o&&(t.TgZ(0,"td",41)(1,"div",42),t.YNc(2,ao,2,0,"mat-icon",43),t.YNc(3,mo,2,0,"mat-icon",43),t.TgZ(4,"strong"),t._uU(5),t.qZA()()()),2&o){const e=i.$implicit;t.xp6(2),t.Q6J("ngIf",!e.expanded),t.xp6(1),t.Q6J("ngIf",e.expanded),t.xp6(2),t.Oqu(e.groupName)}}function po(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"tr",44),t.NdJ("click",function(){const s=t.CHM(e).$implicit,l=t.oxw();return t.KtG(l.reduceGroup(s))}),t.qZA()}}function go(o,i){1&o&&(t.TgZ(0,"div",45),t._uU(1," \u041d\u0435\u0442 \u0434\u0430\u043d\u043d\u044b\u0445 "),t.qZA())}q.\u0275fac=function(){let o;return function(e){return(o||(o=t.n5z(q)))(e||q)}}(),q.\u0275cmp=t.Xpm({type:q,selectors:[["adm-mods-edit"]],features:[t.qOj],decls:8,vars:4,consts:[[1,"inside-modal-body-container"],["class","flex-col-centered flex-auto",4,"ngIf"],["class","flex-col flex-auto",4,"ngIf"],[1,"footer-buttons"],["mat-raised-button","","color","primary",3,"disabled","click",4,"ngIf"],["mat-raised-button","","color","accent",3,"click"],[1,"flex-col-centered","flex-auto"],[1,"loading-block"],[1,"flex-col","flex-auto"],[1,"flex-row",3,"formGroup"],[1,"flex-col"],[1,"base-info-container"],["label","\u041d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u0435","formControlName","name",3,"readonly"],[1,"grid-3-cell"],["label","\u0410\u0440\u0442\u0438\u043a\u0443\u043b","formControlName","code",3,"readonly"],["label","\u0415\u0434\u0438\u043d\u0438\u0446\u0430 \u0438\u0437\u043c\u0435\u0440\u0435\u043d\u0438\u044f","formControlName","unitId",3,"options","clearButton","readonly"],["label","\u0411\u0430\u0437\u043e\u0432\u0430\u044f \u0446\u0435\u043d\u0430, \u0440\u0443\u0431","formControlName","price",3,"min"],[1,"flex-col","flex-auto","ml-10","mt-6"],["appearance","outline",2,"width","100%"],["type","text","matInput","","tabindex","-1","formControlName","parentItem",3,"readonly","matAutocomplete"],["matIconSuffix","","class","mr-10",4,"ngIf"],["auto","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],[1,"flex-row"],[1,"minmax-width"],["label","\u041c\u0438\u043d. \u043a\u043e\u043b-\u0432\u043e","formControlName","minCount",3,"min","clearButton"],["label","\u041c\u0430\u043a\u0441. \u043a\u043e\u043b-\u0432\u043e","formControlName","maxCount",3,"min","clearButton"],["label","\u041f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e","formControlName","defCount",3,"min","clearButton"],[1,"flex-row-centered"],[1,"text-bold"],[1,"ml-10"],["formControlName","routeBy"],["value","bynull"],["value","byrouting"],["value","bygoods"],[1,"flex-col","flex-auto","mt-10"],[1,"tabs-panel-container","flex-auto",3,"mat-stretch-tabs"],["label","\u0422\u0435\u0445\u043d\u043e\u043b\u043e\u0433\u0438\u0447\u0435\u0441\u043a\u0430\u044f \u043a\u0430\u0440\u0442\u0430"],["class","flex-col-centered flex-auto text-danger",4,"ngIf"],["class","mt-10",3,"routingList","isPermissionEdit","changeRoutingEvent","removeRoutingEvent",4,"ngIf"],["matIconSuffix","",1,"mr-10"],["mat-icon-button","","color","accent","tabindex","-1",3,"disabled","click"],[3,"value"],[1,"flex-col-centered","flex-auto","text-danger"],[1,"mt-10",3,"routingList","isPermissionEdit","changeRoutingEvent","removeRoutingEvent"],["mat-raised-button","","color","primary",3,"disabled","click"]],template:function(i,e){1&i&&(t.TgZ(0,"div",0),t.YNc(1,Oi,2,0,"div",1),t.YNc(2,Ki,47,21,"div",2),t.qZA(),t.TgZ(3,"div",3),t.YNc(4,Wi,2,1,"button",4),t.YNc(5,zi,2,1,"button",4),t.TgZ(6,"button",5),t.NdJ("click",function(){return e.onClose()}),t._uU(7,"\u0417\u0430\u043a\u0440\u044b\u0442\u044c"),t.qZA()()),2&i&&(t.xp6(1),t.Q6J("ngIf",e.loading),t.xp6(1),t.Q6J("ngIf",!e.loading),t.xp6(2),t.Q6J("ngIf",e.isPermissionEdit),t.xp6(1),t.Q6J("ngIf",e.isPermissionEdit))},dependencies:[_.sg,_.O5,r.Fj,r.JJ,r.JL,r.sg,r.u,a.y0,a.f5,a.os,x.Hw,T.KE,T.hX,T.R9,ct.ey,A.A9,A.Yi,lt.Nt,p.lW,p.RK,R.uX,R.SP,U.XC,U.ZL,J],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;width:1280px;height:500px}.minmax-width[_ngcontent-%COMP%]{width:185px}.mt-6[_ngcontent-%COMP%]{margin-top:6px}"]});const fo=function(){return["groupHeader"]};class F extends I{constructor(){super(...arguments),this.title="\u0421\u043f\u0438\u0441\u043e\u043a \u043c\u043e\u0434\u0438\u0444\u0438\u043a\u0430\u0442\u043e\u0440\u043e\u0432",this.typeGoods="modifier",this.editComponent=q}}function ho(o,i){1&o&&(t.TgZ(0,"div",6),t._UZ(1,"div",7),t.qZA())}function xo(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"div",20)(1,"button",21),t.NdJ("click",function(u){t.CHM(e);const s=t.oxw(2);return t.KtG(s.onClearParentItem(u))}),t.TgZ(2,"mat-icon"),t._uU(3,"highlight_off"),t.qZA()()()}if(2&o){const e=t.oxw(2);t.xp6(1),t.Q6J("disabled",e.disabledClearParentItem())}}function Co(o,i){if(1&o&&(t.TgZ(0,"mat-option",22),t._uU(1),t.qZA()),2&o){const e=i.$implicit;t.Q6J("value",e),t.xp6(1),t.hij(" ",e," ")}}function vo(o,i){if(1&o&&(t.TgZ(0,"div",8)(1,"div")(2,"mat-form-field",9)(3,"mat-label"),t._uU(4,"\u0420\u043e\u0434\u0438\u0442\u0435\u043b\u044c\u0441\u043a\u0430\u044f \u0433\u0440\u0443\u043f\u043f\u0430"),t.qZA(),t._UZ(5,"input",10),t.YNc(6,xo,4,1,"div",11),t.TgZ(7,"mat-autocomplete",null,12),t.YNc(9,Co,2,2,"mat-option",13),t.qZA()()(),t.TgZ(10,"div",14)(11,"div"),t._UZ(12,"kui-input",15),t.qZA(),t.TgZ(13,"div",16)(14,"div"),t._UZ(15,"kui-input",17),t.qZA(),t.TgZ(16,"div"),t._UZ(17,"kui-select",18),t.qZA(),t.TgZ(18,"div"),t._UZ(19,"kui-input",19),t.qZA()()()()),2&o){const e=t.MAs(8),n=t.oxw();t.Q6J("formGroup",n.formGroup),t.xp6(5),t.Q6J("readonly",!n.isPermissionEdit)("matAutocomplete",e),t.xp6(1),t.Q6J("ngIf",n.isPermissionEdit),t.xp6(3),t.Q6J("ngForOf",n.parentItemList),t.xp6(3),t.Q6J("readonly",!n.isPermissionEdit),t.xp6(3),t.Q6J("readonly",!n.isPermissionEdit),t.xp6(2),t.Q6J("options",n.unitList)("clearButton",!1)("readonly",!n.isPermissionEdit),t.xp6(2),t.Q6J("readonly",!0)("value",n.storeQuantity)}}function Ao(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"button",23),t.NdJ("click",function(){t.CHM(e);const u=t.oxw();return t.KtG(u.onApply())}),t._uU(1," \u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c "),t.qZA()}}F.\u0275fac=function(){let o;return function(e){return(o||(o=t.n5z(F)))(e||F)}}(),F.\u0275cmp=t.Xpm({type:F,selectors:[["adm-mods-list"]],features:[t.qOj],decls:26,vars:14,consts:[[1,"page-list"],[1,"page-list__head"],[3,"ngModel","ngModelChange",4,"ngIf"],[1,"page-title","ml-10"],[1,"page-subtitle"],[3,"length","hidePageSize"],["mat-icon-button","","color","primary",3,"click"],["mat-raised-button","","color","primary","class","mat-button-with-icon head-button ml-10",3,"click",4,"ngIf"],[1,"page-list__content"],[1,"scroll-container"],[1,"scroll"],["mat-table","",1,"table","with-borders",3,"dataSource"],[3,"matColumnDef",4,"ngFor","ngForOf"],["matColumnDef","buttons"],["mat-header-cell","","class","buttons-cell",4,"matHeaderCellDef"],["mat-cell","","class","buttons-cell",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","","class","table-row",3,"dblclick",4,"matRowDef","matRowDefColumns"],["matColumnDef","groupHeader"],["colspan","999","mat-cell","",4,"matCellDef"],["mat-row","","class","row-group",3,"click",4,"matRowDef","matRowDefColumns","matRowDefWhen"],["class","text-center text-danger mt-10",4,"ngIf"],[3,"ngModel","ngModelChange"],["value","standart","matTooltip","\u0421\u0442\u0430\u043d\u0434\u0430\u0440\u0442\u043d\u044b\u0439 \u0440\u0435\u0436\u0438\u043c"],["value","deleted","matTooltip","\u0420\u0435\u0436\u0438\u043c \u0443\u0434\u0430\u043b\u0435\u043d\u043d\u044b\u0445 \u0442\u043e\u0432\u0430\u0440\u043e\u0432"],["mat-raised-button","","color","primary",1,"mat-button-with-icon","head-button","ml-10",3,"click"],[3,"matColumnDef"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["mat-header-cell",""],["mat-cell",""],["mat-header-cell","",1,"buttons-cell"],["mat-cell","",1,"buttons-cell"],["class","container",4,"ngIf"],[1,"container"],["mat-icon-button","","color","primary","matTooltip","\u0412\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u0442\u043e\u0432\u0430\u0440",3,"click"],["mat-icon-button","","color","primary",3,"matTooltip","click"],["mat-icon-button","","color","accent","matTooltip","\u041f\u043e\u043c\u0435\u0442\u0438\u0442\u044c \u0442\u043e\u0432\u0430\u0440 \u043a\u0430\u043a \u0443\u0434\u0430\u043b\u0435\u043d\u043d\u044b\u0439",3,"click",4,"ngIf"],["mat-icon-button","","color","accent","matTooltip","\u041f\u043e\u043c\u0435\u0442\u0438\u0442\u044c \u0442\u043e\u0432\u0430\u0440 \u043a\u0430\u043a \u0443\u0434\u0430\u043b\u0435\u043d\u043d\u044b\u0439",3,"click"],["mat-header-row",""],["mat-row","",1,"table-row",3,"dblclick"],["colspan","999","mat-cell",""],[1,"flex-align-center"],[4,"ngIf"],["mat-row","",1,"row-group",3,"click"],[1,"text-center","text-danger","mt-10"]],template:function(i,e){1&i&&(t.TgZ(0,"div",0)(1,"div",1),t.YNc(2,Xi,7,1,"mat-button-toggle-group",2),t.TgZ(3,"div",3),t._uU(4,"\u041d\u043e\u043c\u0435\u043d\u043a\u043b\u0430\u0442\u0443\u0440\u0430"),t.qZA(),t.TgZ(5,"div",4),t._uU(6),t.qZA(),t._UZ(7,"mat-paginator",5),t.TgZ(8,"button",6),t.NdJ("click",function(){return e.onReload()}),t.TgZ(9,"mat-icon"),t._uU(10,"autorenew"),t.qZA()(),t.YNc(11,Vi,5,0,"button",7),t.qZA(),t.TgZ(12,"div",8)(13,"div",9)(14,"div",10)(15,"table",11),t.YNc(16,io,3,1,"ng-container",12),t.ynx(17,13),t.YNc(18,oo,2,0,"th",14),t.YNc(19,co,3,2,"td",15),t.BQk(),t.YNc(20,lo,1,0,"tr",16),t.YNc(21,ro,1,0,"tr",17),t.ynx(22,18),t.YNc(23,_o,6,3,"td",19),t.BQk(),t.YNc(24,po,1,0,"tr",20),t.qZA(),t.YNc(25,go,2,0,"div",21),t.qZA()()()()),2&i&&(t.xp6(2),t.Q6J("ngIf",e.isPermissionEdit),t.xp6(4),t.hij("\xa0\u27a4\xa0",e.title,""),t.xp6(1),t.Q6J("length",e.total)("hidePageSize",!0),t.xp6(4),t.Q6J("ngIf",e.isPermissionEdit),t.xp6(4),t.Q6J("dataSource",e.dataSource),t.xp6(1),t.Q6J("ngForOf",e.columns),t.xp6(4),t.Q6J("matHeaderRowDef",e.displayedColumns)("matHeaderRowDefSticky",!0),t.xp6(1),t.Q6J("matRowDefColumns",e.displayedColumns),t.xp6(3),t.Q6J("matRowDefColumns",t.DdM(13,fo))("matRowDefWhen",e.isGroup),t.xp6(1),t.Q6J("ngIf",0===e.dataSource.length))},dependencies:[_.sg,_.O5,r.JJ,r.On,x.Hw,A.A9,A.Yi,p.lW,p.RK,c.BZ,c.fO,c.as,c.w1,c.Dz,c.nj,c.ge,c.ev,c.XQ,c.Gk,y.NW,C.gM],styles:["[_nghost-%COMP%]{flex:auto;display:flex;flex-direction:column}"]});class it{constructor(i,e,n){this.dialogService=i,this.userService=e,this.apiAdminService=n,this.loading=!0,this.unitList=[],this.formGroup=new r.cw({name:new a.jn(null,r.kI.required),code:new a.jn(null,r.kI.required),unitId:new a.jn(null,r.kI.required),parentItem:new a.jn(null)}),this.storeQuantity="",this.parentItemList=[]}get goodsId(){return this.modalChildData?.goodsId??null}get isPermissionEdit(){return this.userService.hasPermissions(g.j.goodsEdit)}ngOnInit(){let i;i=this.goodsId?[this.apiAdminService.getDictiUnitList(),this.apiAdminService.getGoodsGroups("ingredient"),this.apiAdminService.getGoods(this.goodsId)]:[this.apiAdminService.getDictiUnitList(),this.apiAdminService.getGoodsGroups("ingredient")],(0,N.D)(i).pipe((0,f.x)(()=>this.loading=!1)).subscribe({next:e=>{if(this.unitList=(e[0]||[]).map(n=>({value:n.id,title:n.name})),this.parentItemList=e[1]||[],e[2]){const n=e[2];this.formGroup.patchValue(n);const u=Number(n.storeQuantity);this.storeQuantity=isNaN(u)?"0":a.ZH.numberFormat(u,3)}},error:e=>this.dialogService.showToastError(e.message)})}onClearParentItem(i){_t.blurActiveElement(),i.stopPropagation(),this.formGroup.get("parentItem")?.setValue(null)}disabledClearParentItem(){const i=this.formGroup.get("parentItem")?.value;return!a.ZH.hasValue(i)}onApply(){if(!this.formGroup.valid)return void this.formGroup.markAllAsTouched();this.dialogService.showWait("\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435...");const i={id:this.goodsId,type:"ingredient",...this.formGroup.value};this.apiAdminService.saveGoods(i).pipe((0,f.x)(()=>this.dialogService.hideWait())).subscribe({next:()=>this.dialogRef?.close(!0),error:e=>this.dialogService.showToastError(e.message)})}onClose(){this.dialogRef?.close(!1)}}function bo(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"mat-button-toggle-group",22),t.NdJ("ngModelChange",function(u){t.CHM(e);const s=t.oxw();return t.KtG(s.modeState=u)}),t.TgZ(1,"mat-button-toggle",23)(2,"mat-icon"),t._uU(3,"home"),t.qZA()(),t.TgZ(4,"mat-button-toggle",24)(5,"mat-icon"),t._uU(6,"delete"),t.qZA()()()}if(2&o){const e=t.oxw();t.Q6J("ngModel",e.modeState)}}function To(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"button",25),t.NdJ("click",function(){t.CHM(e);const u=t.oxw();return t.KtG(u.onAddRecord())}),t.TgZ(1,"mat-icon"),t._uU(2,"add"),t.qZA(),t.TgZ(3,"span"),t._uU(4,"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0442\u043e\u0432\u0430\u0440"),t.qZA()()}}function Zo(o,i){if(1&o&&(t.TgZ(0,"th",29),t._uU(1),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.hij(" ",e.header," ")}}function wo(o,i){if(1&o&&(t.TgZ(0,"td",30),t._uU(1),t.qZA()),2&o){const e=i.$implicit,n=t.oxw().$implicit;t.uIk("class",n.className),t.xp6(1),t.hij(" ",n.cell(e)," ")}}function Eo(o,i){1&o&&(t.ynx(0,26),t.YNc(1,Zo,2,1,"th",27),t.YNc(2,wo,2,2,"td",28),t.BQk()),2&o&&t.Q6J("matColumnDef",i.$implicit.key)}function Do(o,i){1&o&&(t.TgZ(0,"th",31),t._uU(1," \xa0 "),t.qZA())}function yo(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"div",34)(1,"button",35),t.NdJ("click",function(u){t.CHM(e);const s=t.oxw().$implicit,l=t.oxw();return t.KtG(l.onRestoreRow(u,s))}),t.TgZ(2,"mat-icon"),t._uU(3,"check"),t.qZA()()()}}function Io(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"button",38),t.NdJ("click",function(u){t.CHM(e);const s=t.oxw(2).$implicit,l=t.oxw();return t.KtG(l.onRemoveRow(u,s))}),t.TgZ(1,"mat-icon"),t._uU(2,"highlight_off"),t.qZA()()}}function ko(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"div",34)(1,"button",36),t.NdJ("click",function(u){t.CHM(e);const s=t.oxw().$implicit,l=t.oxw();return t.KtG(l.onEditRow(u,s))}),t.TgZ(2,"mat-icon"),t._uU(3,"edit"),t.qZA()(),t.YNc(4,Io,3,0,"button",37),t.qZA()}if(2&o){const e=t.oxw(2);t.xp6(1),t.s9C("matTooltip",e.isPermissionEdit?"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0442\u043e\u0432\u0430\u0440":"\u041f\u0440\u043e\u0441\u043c\u043e\u0442\u0440\u0435\u0442\u044c \u0442\u043e\u0432\u0430\u0440"),t.xp6(3),t.Q6J("ngIf",e.isPermissionRemove)}}function No(o,i){if(1&o&&(t.TgZ(0,"td",32),t.YNc(1,yo,4,0,"div",33),t.YNc(2,ko,5,2,"div",33),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.Q6J("ngIf","deleted"===e.modeState),t.xp6(1),t.Q6J("ngIf","standart"===e.modeState)}}function So(o,i){1&o&&t._UZ(0,"tr",39)}function Ro(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"tr",40),t.NdJ("dblclick",function(u){const l=t.CHM(e).$implicit,d=t.oxw();return t.KtG(d.onEditRow(u,l))}),t.qZA()}}function Lo(o,i){1&o&&(t.TgZ(0,"mat-icon"),t._uU(1,"expand_less"),t.qZA())}function Uo(o,i){1&o&&(t.TgZ(0,"mat-icon"),t._uU(1,"expand_more"),t.qZA())}function Jo(o,i){if(1&o&&(t.TgZ(0,"td",41)(1,"div",42),t.YNc(2,Lo,2,0,"mat-icon",43),t.YNc(3,Uo,2,0,"mat-icon",43),t.TgZ(4,"strong"),t._uU(5),t.qZA()()()),2&o){const e=i.$implicit;t.xp6(2),t.Q6J("ngIf",!e.expanded),t.xp6(1),t.Q6J("ngIf",e.expanded),t.xp6(2),t.Oqu(e.groupName)}}function Po(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"tr",44),t.NdJ("click",function(){const s=t.CHM(e).$implicit,l=t.oxw();return t.KtG(l.reduceGroup(s))}),t.qZA()}}function Mo(o,i){1&o&&(t.TgZ(0,"div",45),t._uU(1," \u041d\u0435\u0442 \u0434\u0430\u043d\u043d\u044b\u0445 "),t.qZA())}it.\u0275fac=function(i){return new(i||it)(t.Y36(a.xA),t.Y36(h.KD),t.Y36(h.ib))},it.\u0275cmp=t.Xpm({type:it,selectors:[["adm-ingredients-edit"]],decls:7,vars:3,consts:[[1,"inside-modal-body-container"],["class","flex-col-centered",4,"ngIf"],["class","flex-col flex-auto",3,"formGroup",4,"ngIf"],[1,"footer-buttons"],["mat-raised-button","","color","primary",3,"click",4,"ngIf"],["mat-raised-button","","color","accent",3,"click"],[1,"flex-col-centered"],[1,"loading-block"],[1,"flex-col","flex-auto",3,"formGroup"],["appearance","outline",2,"width","100%"],["type","text","matInput","","tabindex","-1","formControlName","parentItem",3,"readonly","matAutocomplete"],["matIconSuffix","","class","mr-10",4,"ngIf"],["auto","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],[1,"base-info-container"],["label","\u041d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u0435","formControlName","name",3,"readonly"],[1,"grid-3-cell"],["label","\u0410\u0440\u0442\u0438\u043a\u0443\u043b","formControlName","code",3,"readonly"],["label","\u0415\u0434\u0438\u043d\u0438\u0446\u0430 \u0438\u0437\u043c\u0435\u0440\u0435\u043d\u0438\u044f","formControlName","unitId",3,"options","clearButton","readonly"],["label","\u041e\u0441\u0442\u0430\u0442\u043e\u043a \u043d\u0430 \u0441\u043a\u043b\u0430\u0434\u0435, \u0435\u0434.\u0438\u0437\u043c.",3,"readonly","value"],["matIconSuffix","",1,"mr-10"],["mat-icon-button","","color","accent","tabindex","-1",3,"disabled","click"],[3,"value"],["mat-raised-button","","color","primary",3,"click"]],template:function(i,e){1&i&&(t.TgZ(0,"div",0),t.YNc(1,ho,2,0,"div",1),t.YNc(2,vo,20,12,"div",2),t.qZA(),t.TgZ(3,"div",3),t.YNc(4,Ao,2,0,"button",4),t.TgZ(5,"button",5),t.NdJ("click",function(){return e.onClose()}),t._uU(6,"\u0417\u0430\u043a\u0440\u044b\u0442\u044c"),t.qZA()()),2&i&&(t.xp6(1),t.Q6J("ngIf",e.loading),t.xp6(1),t.Q6J("ngIf",!e.loading),t.xp6(2),t.Q6J("ngIf",e.isPermissionEdit))},dependencies:[_.sg,_.O5,r.Fj,r.JJ,r.JL,r.sg,r.u,a.y0,a.os,x.Hw,T.KE,T.hX,T.R9,ct.ey,lt.Nt,p.lW,p.RK,U.XC,U.ZL],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;width:715px;height:335px}"]});const qo=function(){return["groupHeader"]};class G extends I{constructor(){super(...arguments),this.title="\u0421\u043f\u0438\u0441\u043e\u043a \u0438\u043d\u0433\u0440\u0435\u0434\u0438\u0435\u043d\u0442\u043e\u0432",this.typeGoods="ingredient",this.editComponent=it}}G.\u0275fac=function(){let o;return function(e){return(o||(o=t.n5z(G)))(e||G)}}(),G.\u0275cmp=t.Xpm({type:G,selectors:[["adm-ingredients-list"]],features:[t.qOj],decls:26,vars:14,consts:[[1,"page-list"],[1,"page-list__head"],[3,"ngModel","ngModelChange",4,"ngIf"],[1,"page-title","ml-10"],[1,"page-subtitle"],[3,"length","hidePageSize"],["mat-icon-button","","color","primary",3,"click"],["mat-raised-button","","color","primary","class","mat-button-with-icon head-button ml-10",3,"click",4,"ngIf"],[1,"page-list__content"],[1,"scroll-container"],[1,"scroll"],["mat-table","",1,"table","with-borders",3,"dataSource"],[3,"matColumnDef",4,"ngFor","ngForOf"],["matColumnDef","buttons"],["mat-header-cell","","class","buttons-cell",4,"matHeaderCellDef"],["mat-cell","","class","buttons-cell",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","","class","table-row",3,"dblclick",4,"matRowDef","matRowDefColumns"],["matColumnDef","groupHeader"],["colspan","999","mat-cell","",4,"matCellDef"],["mat-row","","class","row-group",3,"click",4,"matRowDef","matRowDefColumns","matRowDefWhen"],["class","text-center text-danger mt-10",4,"ngIf"],[3,"ngModel","ngModelChange"],["value","standart","matTooltip","\u0421\u0442\u0430\u043d\u0434\u0430\u0440\u0442\u043d\u044b\u0439 \u0440\u0435\u0436\u0438\u043c"],["value","deleted","matTooltip","\u0420\u0435\u0436\u0438\u043c \u0443\u0434\u0430\u043b\u0435\u043d\u043d\u044b\u0445 \u0442\u043e\u0432\u0430\u0440\u043e\u0432"],["mat-raised-button","","color","primary",1,"mat-button-with-icon","head-button","ml-10",3,"click"],[3,"matColumnDef"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["mat-header-cell",""],["mat-cell",""],["mat-header-cell","",1,"buttons-cell"],["mat-cell","",1,"buttons-cell"],["class","container",4,"ngIf"],[1,"container"],["mat-icon-button","","color","primary","matTooltip","\u0412\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u0442\u043e\u0432\u0430\u0440",3,"click"],["mat-icon-button","","color","primary",3,"matTooltip","click"],["mat-icon-button","","color","accent","matTooltip","\u041f\u043e\u043c\u0435\u0442\u0438\u0442\u044c \u0442\u043e\u0432\u0430\u0440 \u043a\u0430\u043a \u0443\u0434\u0430\u043b\u0435\u043d\u043d\u044b\u0439",3,"click",4,"ngIf"],["mat-icon-button","","color","accent","matTooltip","\u041f\u043e\u043c\u0435\u0442\u0438\u0442\u044c \u0442\u043e\u0432\u0430\u0440 \u043a\u0430\u043a \u0443\u0434\u0430\u043b\u0435\u043d\u043d\u044b\u0439",3,"click"],["mat-header-row",""],["mat-row","",1,"table-row",3,"dblclick"],["colspan","999","mat-cell",""],[1,"flex-align-center"],[4,"ngIf"],["mat-row","",1,"row-group",3,"click"],[1,"text-center","text-danger","mt-10"]],template:function(i,e){1&i&&(t.TgZ(0,"div",0)(1,"div",1),t.YNc(2,bo,7,1,"mat-button-toggle-group",2),t.TgZ(3,"div",3),t._uU(4,"\u041d\u043e\u043c\u0435\u043d\u043a\u043b\u0430\u0442\u0443\u0440\u0430"),t.qZA(),t.TgZ(5,"div",4),t._uU(6),t.qZA(),t._UZ(7,"mat-paginator",5),t.TgZ(8,"button",6),t.NdJ("click",function(){return e.onReload()}),t.TgZ(9,"mat-icon"),t._uU(10,"autorenew"),t.qZA()(),t.YNc(11,To,5,0,"button",7),t.qZA(),t.TgZ(12,"div",8)(13,"div",9)(14,"div",10)(15,"table",11),t.YNc(16,Eo,3,1,"ng-container",12),t.ynx(17,13),t.YNc(18,Do,2,0,"th",14),t.YNc(19,No,3,2,"td",15),t.BQk(),t.YNc(20,So,1,0,"tr",16),t.YNc(21,Ro,1,0,"tr",17),t.ynx(22,18),t.YNc(23,Jo,6,3,"td",19),t.BQk(),t.YNc(24,Po,1,0,"tr",20),t.qZA(),t.YNc(25,Mo,2,0,"div",21),t.qZA()()()()),2&i&&(t.xp6(2),t.Q6J("ngIf",e.isPermissionEdit),t.xp6(4),t.hij("\xa0\u27a4\xa0",e.title,""),t.xp6(1),t.Q6J("length",e.total)("hidePageSize",!0),t.xp6(4),t.Q6J("ngIf",e.isPermissionEdit),t.xp6(4),t.Q6J("dataSource",e.dataSource),t.xp6(1),t.Q6J("ngForOf",e.columns),t.xp6(4),t.Q6J("matHeaderRowDef",e.displayedColumns)("matHeaderRowDefSticky",!0),t.xp6(1),t.Q6J("matRowDefColumns",e.displayedColumns),t.xp6(3),t.Q6J("matRowDefColumns",t.DdM(13,qo))("matRowDefWhen",e.isGroup),t.xp6(1),t.Q6J("ngIf",0===e.dataSource.length))},dependencies:[_.sg,_.O5,r.JJ,r.On,x.Hw,A.A9,A.Yi,p.lW,p.RK,c.BZ,c.fO,c.as,c.w1,c.Dz,c.nj,c.ge,c.ev,c.XQ,c.Gk,y.NW,C.gM],styles:["[_nghost-%COMP%]{flex:auto;display:flex;flex-direction:column}"]});const Fo=[{path:"",component:Y,children:[{path:"goods-ingredients",component:G},{path:"goods-mods",component:F},{path:"goods-dish",component:M},{path:"store-docs-incoming",component:tt},{path:"dictionaries/:code",component:S},{path:"dictionaries",component:S},{path:"users",component:$},{path:"roles",component:H}]}];class Q{}Q.\u0275fac=function(i){return new(i||Q)},Q.\u0275mod=t.oAB({type:Q}),Q.\u0275inj=t.cJS({imports:[_.ez,r.u5,r.UX,b.Bz.forChild(Fo),pt.m]})}}]);