import{$c as te,Ab as de,B as ye,Ba as m,Ca as g,D as ue,Da as Be,Ea as xe,Eb as fe,G as E,Ga as K,Gb as Le,Gc as Ae,Ha as X,Hc as ke,Ia as Y,K as f,Kb as $,La as Z,M as y,N as b,Na as d,Oa as I,P as W,Pa as Re,Q as be,R as Q,Ra as v,Rc as ee,Sa as S,T as G,Ta as C,U as ge,Uc as _,Vc as w,X as _e,Xa as Me,Y as u,Ya as Fe,a as se,ad as ie,ba as we,ca as h,cb as N,dd as j,ed as he,fa as De,g as le,ha as k,j as Se,jd as x,k as ve,ka as q,kc as P,kd as O,lc as V,ld as je,ma as M,md as Oe,na as F,oa as Ee,p as U,q as Ce,qa as Te,ra as Pe,sa as p,ta as s,ua as l,va as R,vb as Ie,vc as L,wb as pe,wc as H,x as z,xc as B,ya as Ve,yb as ce,za as T,zb as me}from"./chunk-SGQHKCG3.js";var Ye=["content"],Ze=o=>({width:o}),$e=(o,i)=>({value:o,params:i}),We=(()=>{let i=class i{constructor(){this.componentRef=null,this.panelWidth="0",this.isOpen=!1,this.isShowing=!1,this.selfElementRef=f(ge),this.panelParams=null,this.afterClosed=new ve,this.afterClosed$=this.afterClosed.asObservable(),this.closeData=null,this.closeCallback=null}get show(){return this.isShowing}onHostClick(n){n.target===this.selfElementRef.nativeElement&&!this.panelParams?.disabledClose&&this.closePanel()}setComponent(n,t,e,a){this.panelParams=e,setTimeout(()=>{this.viewContainerRef.clear(),this.componentRef=this.viewContainerRef.createComponent(n),t&&Object.keys(t).forEach(r=>{this.componentRef?.setInput(r,t[r])}),this.componentRef.instance.closePanel=(r=null)=>this.closePanel(r,!0,a),this.isShowing=!0,setTimeout(()=>{let r=this.componentRef?.location.nativeElement.getBoundingClientRect();this.panelWidth=`${r.width}px`,this.isOpen=!0})})}onAnimationDoneEvent(n){n.phaseName==="done"&&n.toState==="closed"&&n.totalTime>0&&this.clearComponent()}closePanel(n=null,t=!0,e=null){this.closeCallback=e,this.closeData=n,this.isOpen=!1,t||this.clearComponent()}ngOnDestroy(){this.viewContainerRef.clear()}clearComponent(){this.isShowing=!1,this.viewContainerRef.clear(),this.componentRef=null,this.afterClosed.next(this.closeData),typeof this.closeCallback=="function"&&this.closeCallback()}};i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=h({type:i,selectors:[["ng-component"]],viewQuery:function(t,e){if(t&1&&K(Ye,5,we),t&2){let a;X(a=Y())&&(e.viewContainerRef=a.first)}},hostVars:2,hostBindings:function(t,e){t&1&&m("click",function(r){return e.onHostClick(r)}),t&2&&Z("show",e.show)},decls:3,vars:6,consts:[["content",""],[1,"sliding-panel"]],template:function(t,e){if(t&1){let a=T();s(0,"div",1),m("@openClose.done",function(A){return y(a),b(e.onAnimationDoneEvent(A))}),Ve(1,null,0),l()}t&2&&p("@openClose",Fe(3,$e,e.isOpen?"open":"closed",Me(1,Ze,e.panelWidth)))},styles:["[_nghost-%COMP%]{display:none;position:fixed;top:0;left:0;width:100vw;height:100vh;background:#0003;z-index:1}.show[_nghost-%COMP%]{display:block}.sliding-panel[_ngcontent-%COMP%]{position:absolute;display:flex;flex-direction:column;top:0;right:0;bottom:0;background:#fff;box-shadow:-2px 0 5px #0003;transition:width .3s ease-in-out}"],data:{animation:[Ie("openClose",[me("open",ce({width:"{{width}}",opacity:1}),{params:{width:"40vw"}}),me("closed",ce({width:"0",opacity:.5})),de("open => closed",[pe("0.1s")]),de("closed => open",[pe("0.3s")])])]}});let o=i;return o})();var qe={disabledClose:!1,once:!1},wt=(()=>{let i=class i{constructor(){this.document=f(W),this.appRef=f(q)}showPanel$(n,t,e=qe){return this.showPanel(n,t,e).afterClosed$}showPanel(n,t,e=qe){let a=N(We,{environmentInjector:this.appRef.injector});return this.document.body.appendChild(a.location.nativeElement),this.appRef.attachView(a.hostView),a.instance.setComponent(n,t??{},e,()=>{this.appRef.detachView(a.hostView),a.destroy()}),a.instance}};i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=E({token:i,factory:i.\u0275fac,providedIn:"root"});let o=i;return o})();var ne=class{closePanel(i){}};var Ne=(()=>{let i=class i extends je{constructor(){super(...arguments),this.tableName="source-data",this.formsDBService=f(Oe)}remove(n){return super.remove(n).pipe(ue(()=>{this.removeDataSourceForForms(n)}))}update(n,t){return super.update(n,t).pipe(ue(e=>{this.updateDataSourceForForms(e)}))}removeDataSourceForForms(n){return le(this,null,function*(){let t=yield U(this.formsDBService.getList());for(let e of t)this.removeDataSourceForForm(e.rows,n)&&(yield U(this.formsDBService.update(Number(e.id),e)))})}removeDataSourceForForm(n,t){let e=!1;for(let a of n)if(a.type===void 0&&a.children)a.children&&this.removeDataSourceForForm(a.children,t)&&(e=!0);else switch(a.type){case j.Tabs:if(a.children)for(let A of a.children)A.children&&this.removeDataSourceForForm(A.children,t)&&(e=!0);break;case j.Panel:a.children&&this.removeDataSourceForForm(a.children,t)&&(e=!0);break;case j.Control:let r=a;r.controlType===he.List&&r.controlProperties?.dataSource?.id===t&&(r.controlProperties.dataSource.id=null,e=!0);break}return e}updateDataSourceForForms(n){return le(this,null,function*(){let t=yield U(this.formsDBService.getList());for(let e of t)this.updateDataSourceForForm(e.rows,n)&&(yield U(this.formsDBService.update(Number(e.id),e)))})}updateDataSourceForForm(n,t){let e=!1;for(let a of n)if(a.type===void 0&&a.children)a.children&&this.updateDataSourceForForm(a.children,t)&&(e=!0);else switch(a.type){case j.Tabs:if(a.children)for(let A of a.children)A.children&&this.updateDataSourceForForm(A.children,t)&&(e=!0);break;case j.Panel:a.children&&this.updateDataSourceForForm(a.children,t)&&(e=!0);break;case j.Control:let r=a;r.controlType===he.List&&r.controlProperties?.dataSource?.id===t.id&&(r.controlProperties.dataSource.source=t.source,e=!0);break}return e}};i.\u0275fac=(()=>{let n;return function(e){return(n||(n=G(i)))(e||i)}})(),i.\u0275prov=E({token:i,factory:i.\u0275fac,providedIn:"root"});let o=i;return o})();var et={sources:[],isLoadingState:!1},He=(()=>{let i=class i extends Le{constructor(){super(et),this.isLoadingState=this.selectSignal(n=>n.isLoadingState),this.sourcesList$=this.select(n=>n.sources),this.sourceDataDBService=f(Ne)}ngrxOnStoreInit(){this.patchState({sources:[],isLoadingState:!0}),this.sourceDataDBService.getList().pipe(z(()=>this.patchState({isLoadingState:!1}))).subscribe(n=>this.patchState({sources:n}))}importDataSource(n){this.patchState({isLoadingState:!0}),this.sourceDataDBService.insert(n).pipe(z(()=>this.patchState({isLoadingState:!1}))).subscribe(t=>{this.setState(e=>(e.sources.push(t),se({},e)))})}saveDataSource(n,t){this.patchState({isLoadingState:!0}),(n.id?this.sourceDataDBService.update(n.id,n):this.sourceDataDBService.insert(n)).pipe(ye(a=>this.sourceDataDBService.getList().pipe(Ce(r=>({ds:a,sources:r})))),z(()=>this.patchState({isLoadingState:!1}))).subscribe(a=>{this.patchState({sources:a.sources}),typeof t=="function"&&t(a.ds)})}removeDataSource(n){this.patchState({isLoadingState:!0}),this.sourceDataDBService.remove(n).pipe(z(()=>this.patchState({isLoadingState:!1}))).subscribe(()=>{this.setState(t=>(t.sources=t.sources.filter(e=>e.id!==n),se({},t)))})}};i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=E({token:i,factory:i.\u0275fac,providedIn:"root"});let o=i;return o})();var tt=["*"],Je=(()=>{let i=class i{constructor(){this.title="\u041F\u0430\u043D\u0435\u043B\u044C",this.applyButtonTitle="\u041F\u0440\u0438\u043C\u0435\u043D\u0438\u0442\u044C",this.cancelButtonTitle="\u041E\u0442\u043C\u0435\u043D\u0430",this.closeByEscape=!1,this.closeEvent=new k,this.applyEvent=new k}doKeyEscape(){this.closeByEscape&&this.onClosePanel()}onClosePanel(){this.closeEvent.emit()}onApplyPanel(){this.applyEvent.emit()}};i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=h({type:i,selectors:[["panel-container"]],hostBindings:function(t,e){t&1&&m("keyup.escape",function(){return e.doKeyEscape()},_e)},inputs:{title:"title",applyButtonTitle:"applyButtonTitle",cancelButtonTitle:"cancelButtonTitle",closeByEscape:"closeByEscape"},outputs:{closeEvent:"closeEvent",applyEvent:"applyEvent"},ngContentSelectors:tt,decls:13,vars:3,consts:[[1,"head"],[1,"head-title"],["mat-icon-button","","color","accent",3,"click"],[1,"content"],[1,"footer"],["mat-button","","color","accent",3,"click"],["matButton","tonal","color","primary",1,"ml-10",3,"click"]],template:function(t,e){t&1&&(Be(),s(0,"div",0)(1,"div",1),d(2),l(),s(3,"button",2),m("click",function(){return e.onClosePanel()}),s(4,"mat-icon"),d(5,"close"),l()()(),s(6,"div",3),xe(7),l(),s(8,"div",4)(9,"button",5),m("click",function(){return e.onClosePanel()}),d(10),l(),s(11,"button",6),m("click",function(){return e.onApplyPanel()}),d(12),l()()),t&2&&(u(2),I(e.title),u(8),I(e.cancelButtonTitle),u(2),I(e.applyButtonTitle))},dependencies:[V,P,B,H,L],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;width:800px;background-color:#fff;box-sizing:border-box}.head[_ngcontent-%COMP%]{display:flex;align-items:center;border-bottom:1px solid #c6c6c6;padding:5px 10px;box-sizing:border-box}.head-title[_ngcontent-%COMP%]{flex:auto;font-size:18px;font-weight:700}.content[_ngcontent-%COMP%]{flex:auto;display:flex;flex-direction:column;padding:10px}.footer[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:flex-end;border-top:1px solid #c6c6c6;padding:10px;box-sizing:border-box}"],changeDetection:0});let o=i;return o})();var J=class{static notEmptyValue(i){let c=i.value;return[void 0,null].includes(c)||String(c).trim()===""?{emptyValue:!0}:null}};var it=(()=>{let i=class i{constructor(){this.visible=!0}get visibleClass(){return this.visible}};i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=h({type:i,selectors:[["ng-component"]],hostVars:2,hostBindings:function(t,e){t&2&&Z("visible",e.visibleClass)},decls:1,vars:0,template:function(t,e){t&1&&R(0,"mat-spinner")},dependencies:[ke,Ae],styles:["[_nghost-%COMP%]{display:none;position:fixed;inset:0;z-index:1001;background-color:#0003;flex-direction:column;align-items:center;justify-content:center}.visible[_nghost-%COMP%]{display:flex}"]});let o=i;return o})(),Ue=(()=>{let i=class i{constructor(){this.document=f(W),this.appRef=f(q),this.waitRef=null}showWait(){this.waitRef?this.waitRef.instance.visible=!0:(this.waitRef=N(it,{environmentInjector:this.appRef.injector}),this.document.body.appendChild(this.waitRef.location.nativeElement),this.appRef.attachView(this.waitRef.hostView))}hideWait(){this.waitRef&&(this.waitRef.instance.visible=!1)}};i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=E({token:i,factory:i.\u0275fac,providedIn:"root"});let o=i;return o})();var nt=(()=>{let i=class i{constructor(){this.title="",this.label="",this.control=new ee(null,[$.required,J.notEmptyValue]),this.onClose=()=>{},this.onApply=()=>{}}ngAfterViewInit(){this.inputRef&&this.inputRef.focus()}};i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=h({type:i,selectors:[["ng-component"]],viewQuery:function(t,e){if(t&1&&K(_,5),t&2){let a;X(a=Y())&&(e.inputRef=a.first)}},decls:15,vars:4,consts:[["inputRef",""],[1,"popup-container"],[1,"popup-title-container"],[1,"popup-title"],["matIconButton","","color","accent",3,"click"],[1,"popup-content"],[3,"label","formControl"],[1,"popup-buttons"],["matButton","filled","color","primary",3,"click","disabled"],["matButton","filled","color","accent",1,"ml-10",3,"click"]],template:function(t,e){if(t&1){let a=T();s(0,"div",1)(1,"div",2)(2,"div",3),d(3),l(),s(4,"button",4),m("click",function(){return y(a),b(e.onClose())}),s(5,"mat-icon"),d(6,"highlight_off"),l()()(),s(7,"div",5),R(8,"jst-input",6,0),l(),s(10,"div",7)(11,"button",8),m("click",function(){return y(a),b(e.onApply())}),d(12,"\u041F\u0440\u0438\u043C\u0435\u043D\u0438\u0442\u044C"),l(),s(13,"button",9),m("click",function(){return y(a),b(e.onClose())}),d(14,"\u041E\u0442\u043C\u0435\u043D\u0430"),l()()()}t&2&&(u(3),I(e.title),u(5),p("label",e.label)("formControl",e.control),u(3),p("disabled",!e.control.valid))},dependencies:[B,H,L,V,P,w,_],styles:["[_nghost-%COMP%]{display:flex;position:fixed;inset:0;z-index:1001;background-color:#0003;flex-direction:column;align-items:center;justify-content:center}[_nghost-%COMP%]     .mat-mdc-form-field-subscript-wrapper, [_nghost-%COMP%]     .mat-mdc-form-field-bottom-align{display:none}.popup-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;box-shadow:-2px 2px 5px #0003;background-color:#fff;border-radius:6px;width:360px}.popup-title-container[_ngcontent-%COMP%]{display:flex;align-items:center;padding:0 5px 0 10px;border-bottom:1px solid #0275d8}.popup-title[_ngcontent-%COMP%]{flex:auto;line-height:36px}.popup-content[_ngcontent-%COMP%]{padding:20px 10px}.popup-buttons[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:flex-end;padding:10px;border-top:1px solid #0275d8}"]});let o=i;return o})(),ze=(()=>{let i=class i{constructor(){this.document=f(W),this.appRef=f(q)}showPopup(n,t,e){return new Se(a=>{let r=N(nt,{environmentInjector:this.appRef.injector});this.document.body.appendChild(r.location.nativeElement),this.appRef.attachView(r.hostView),r.instance.title=n,r.instance.label=t,r.instance.control.setValue(e??null),r.instance.onClose=()=>{this.appRef.detachView(r.hostView),r.destroy(),a.next(void 0),a.complete()},r.instance.onApply=()=>{r.instance.control.valid&&(this.appRef.detachView(r.hostView),r.destroy(),a.next(r.instance.control.value),a.complete())}})}};i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=E({token:i,factory:i.\u0275fac,providedIn:"root"});let o=i;return o})();var Qe=(()=>{let i=class i{constructor(){this.disabledState=!1}};i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=h({type:i,selectors:[["bind-response"]],inputs:{bindResponse:"bindResponse",disabledState:"disabledState"},decls:10,vars:6,consts:[[1,"flex-auto","flex-col"],[1,"flex-row","mt-10"],[1,"flex-auto"],["label","\u0421\u0432\u043E\u0439\u0441\u0442\u0432\u043E \u0441\u043E \u0441\u043F\u0438\u0441\u043A\u043E\u043C",3,"valueChange","disabledState","value"],[1,"flex-auto","ml-10"],["label","\u041F\u0440\u0438\u0432\u044F\u0437\u043A\u0430 \u0437\u043D\u0430\u0447\u0435\u043D\u0438\u044F",3,"valueChange","disabledState","value"],["label","\u041F\u0440\u0438\u0432\u044F\u0437\u043A\u0430 \u0437\u0430\u0433\u043E\u043B\u043E\u0432\u043A\u0430",3,"valueChange","disabledState","value"]],template:function(t,e){t&1&&(s(0,"fieldset",0)(1,"legend"),d(2,"\u041F\u0440\u0438\u0432\u044F\u0437\u043A\u0430 \u043E\u0442\u0432\u0435\u0442\u0430"),l(),s(3,"div",1)(4,"div",2)(5,"jst-input",3),C("valueChange",function(r){return S(e.bindResponse.root,r)||(e.bindResponse.root=r),r}),l()(),s(6,"div",4)(7,"jst-input",5),C("valueChange",function(r){return S(e.bindResponse.value,r)||(e.bindResponse.value=r),r}),l()(),s(8,"div",4)(9,"jst-input",6),C("valueChange",function(r){return S(e.bindResponse.title,r)||(e.bindResponse.title=r),r}),l()()()()),t&2&&(u(5),p("disabledState",e.disabledState),v("value",e.bindResponse.root),u(2),p("disabledState",e.disabledState),v("value",e.bindResponse.value),u(2),p("disabledState",e.disabledState),v("value",e.bindResponse.title))},dependencies:[w,_],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column}"],changeDetection:0});let o=i;return o})();var Ge=(()=>{let i=class i{constructor(){this.disabledState=!1,this.methodHttpList=[{value:O.Get,title:O.Get},{value:O.Post,title:O.Post}]}};i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=h({type:i,selectors:[["params-http-request"]],inputs:{request:"request",disabledState:"disabledState"},decls:7,vars:7,consts:[[1,"mb-10"],["label","URL \u0434\u043B\u044F API",3,"valueChange","disabledState","value"],[1,"flex-row","mt-10"],["label","\u041C\u0435\u0442\u043E\u0434 HTTP",3,"valueChange","options","disabledState","value"],[1,"flex-auto","ml-10"],["label","\u041C\u0435\u0442\u043E\u0434 API",3,"valueChange","disabledState","value"]],template:function(t,e){t&1&&(s(0,"div",0)(1,"jst-input",1),C("valueChange",function(r){return S(e.request.apiUrl,r)||(e.request.apiUrl=r),r}),l()(),s(2,"div",2)(3,"div")(4,"jst-select",3),C("valueChange",function(r){return S(e.request.methodHttp,r)||(e.request.methodHttp=r),r}),l()(),s(5,"div",4)(6,"jst-input",5),C("valueChange",function(r){return S(e.request.methodApi,r)||(e.request.methodApi=r),r}),l()()()),t&2&&(u(),p("disabledState",e.disabledState),v("value",e.request.apiUrl),u(3),p("options",e.methodHttpList)("disabledState",e.disabledState),v("value",e.request.methodHttp),u(2),p("disabledState",e.disabledState),v("value",e.request.methodApi))},dependencies:[w,_,ie,te],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column}"],changeDetection:0});let o=i;return o})();function ot(o,i){if(o&1){let c=T();s(0,"button",4),m("click",function(){y(c);let t=g();return b(t.onRemove())}),s(1,"mat-icon"),d(2,"cancel"),l()()}}var Ke=(()=>{let i=class i{constructor(){this.paramName="",this.paramValue="",this.titleParam="\u041F\u0430\u0440\u0430\u043C\u0435\u0442\u0440",this.titleValue="\u0417\u043D\u0430\u0447\u0435\u043D\u0438\u0435",this.disabledState=!1,this.paramNameChange=new k,this.paramValueChange=new k,this.removeEvent=new k}get paramNameValue(){return this.paramName}set paramNameValue(n){this.paramNameChange.emit(n)}get paramValueValue(){return this.paramValue}set paramValueValue(n){this.paramValueChange.emit(n)}onRemove(){this.removeEvent.emit()}};i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=h({type:i,selectors:[["param-value-item"]],inputs:{paramName:"paramName",paramValue:"paramValue",titleParam:"titleParam",titleValue:"titleValue",disabledState:"disabledState"},outputs:{paramNameChange:"paramNameChange",paramValueChange:"paramValueChange",removeEvent:"removeEvent"},decls:5,vars:7,consts:[[1,"flex-auto"],[3,"valueChange","label","disabledState","value"],[1,"flex-auto","ml-10"],["mat-icon-button","","color","accent",1,"ml-10"],["mat-icon-button","","color","accent",1,"ml-10",3,"click"]],template:function(t,e){t&1&&(s(0,"div",0)(1,"jst-input",1),C("valueChange",function(r){return S(e.paramNameValue,r)||(e.paramNameValue=r),r}),l()(),s(2,"div",2)(3,"jst-input",1),C("valueChange",function(r){return S(e.paramValueValue,r)||(e.paramValueValue=r),r}),l()(),M(4,ot,3,0,"button",3)),t&2&&(u(),p("label",e.titleParam)("disabledState",e.disabledState),v("value",e.paramNameValue),u(2),p("label",e.titleValue)("disabledState",e.disabledState),v("value",e.paramValueValue),u(),F(e.disabledState?-1:4))},dependencies:[B,L,V,P,w,_],styles:["[_nghost-%COMP%]{display:flex;align-items:center}[_nghost-%COMP%]     .mat-mdc-form-field-subscript-wrapper, [_nghost-%COMP%]     .mat-mdc-form-field-bottom-align{display:none}"],changeDetection:0});let o=i;return o})();function at(o,i){o&1&&(s(0,"div",3),d(1,"\u041D\u0435\u0442 \u0434\u0430\u043D\u043D\u044B\u0445"),l())}function rt(o,i){if(o&1){let c=T();s(0,"param-value-item",7),C("paramNameChange",function(t){let e=y(c).$implicit;return S(e.title,t)||(e.title=t),b(t)})("paramValueChange",function(t){let e=y(c).$implicit;return S(e.value,t)||(e.value=t),b(t)}),m("removeEvent",function(){let t=y(c).$index,e=g(2);return b(e.onRemoveItem(t))}),l()}if(o&2){let c=i.$implicit,n=g(2);p("titleParam",n.titleParam)("titleValue",n.titleValue)("disabledState",n.disabledState),v("paramName",c.title)("paramValue",c.value)}}function st(o,i){if(o&1&&(s(0,"div",4)(1,"div",5),Te(2,rt,1,5,"param-value-item",6,Ee),l()()),o&2){let c=g();u(2),Pe(c.params)}}var Xe=(()=>{let i=class i{constructor(){this.params=[],this.titleAddButton="\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C \u043F\u0430\u0440\u0430\u043C\u0435\u0442\u0440",this.titleList="\u0421\u043F\u0438\u0441\u043E\u043A \u043F\u0430\u0440\u0430\u043C\u0435\u0442\u0440\u043E\u0432",this.titleParam="\u041F\u0430\u0440\u0430\u043C\u0435\u0442\u0440",this.titleValue="\u0417\u043D\u0430\u0447\u0435\u043D\u0438\u0435",this.disabledState=!1}onRemoveItem(n){this.params.splice(n,1)}onAddParam(){this.params.push({title:"",value:""})}};i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=h({type:i,selectors:[["params-value-list"]],inputs:{params:"params",titleAddButton:"titleAddButton",titleList:"titleList",titleParam:"titleParam",titleValue:"titleValue",disabledState:"disabledState"},decls:10,vars:4,consts:[[1,"flex-justify-end"],["matButton","outlined","color","primary",3,"click","disabled"],[1,"flex-auto","flex-col"],[1,"empty-message"],[1,"scroll-container"],[1,"scroll"],[1,"mt-10",3,"titleParam","titleValue","disabledState","paramName","paramValue"],[1,"mt-10",3,"paramNameChange","paramValueChange","removeEvent","titleParam","titleValue","disabledState","paramName","paramValue"]],template:function(t,e){t&1&&(s(0,"div",0)(1,"button",1),m("click",function(){return e.onAddParam()}),s(2,"mat-icon"),d(3,"add"),l(),d(4),l()(),s(5,"fieldset",2)(6,"legend"),d(7),l(),M(8,at,2,0,"div",3)(9,st,4,0,"div",4),l()),t&2&&(u(),p("disabled",e.disabledState),u(3),Re(" ",e.titleAddButton," "),u(3),I(e.titleList),u(),F(e.params.length===0?8:9))},dependencies:[B,H,V,P,w,Ke],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column}"],changeDetection:0});let o=i;return o})();function lt(o,i){if(o&1){let c=T();s(0,"jst-select",10),m("valueChange",function(t){y(c);let e=g();return b(e.setAvaialbleSource(t))}),l()}if(o&2){let c=g();p("options",c.avaialbleSourcesList)("value",c.avaialbleSource())}}function ut(o,i){if(o&1&&R(0,"jst-input",5),o&2){let c=g();p("controlRequred",!0)("formControl",c.controlName)}}function pt(o,i){if(o&1&&R(0,"params-http-request",7),o&2){let c=g();p("request",c.sourceHttpRequest)("disabledState",c.hasAvaialbleSource())}}function ct(o,i){if(o&1&&R(0,"bind-response",9),o&2){let c=g();p("bindResponse",c.sourceHttpRequest.bindResponse)("disabledState",c.hasAvaialbleSource())}}var nn=(()=>{let i=class i extends ne{constructor(){super(...arguments),this.editSourceAsValue=!1,this.title="\u0418\u0441\u0442\u043E\u0447\u043D\u0438\u043A \u0434\u0430\u043D\u043D\u044B\u0445",this.applyButtonTitle="\u0421\u043E\u0445\u0440\u0430\u043D\u0438\u0442\u044C \u0438\u0441\u0442\u043E\u0447\u043D\u0438\u043A \u0434\u0430\u043D\u043D\u044B\u0445",this.paramsTitleAddButton="\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C \u043F\u0430\u0440\u0430\u043C\u0435\u0442\u0440",this.paramsTitleList="\u0421\u043F\u0438\u0441\u043E\u043A \u043F\u0430\u0440\u0430\u043C\u0435\u0442\u0440\u043E\u0432",this.paramItemTitle="\u041F\u0430\u0440\u0430\u043C\u0435\u0442\u0440",this.isHttpRequest=Q(!1),this.hasAvaialbleSource=Q(!1),this.controlName=new ee("",[$.required,J.notEmptyValue]),this.avaialbleSourcesList=[],this.sourceTypesList=[{value:x.List,title:"\u041F\u0440\u043E\u0441\u0442\u043E\u0439 \u0441\u043F\u0438\u0441\u043E\u043A"},{value:x.Request,title:"\u0417\u0430\u043F\u0440\u043E\u0441"}],this.sourcesList=[],this.avaialbleSource=Q(0),this.destroyRef=f(be),this.sourceDataStore=f(He),this.globalWaitService=f(Ue),this.popupEditStringService=f(ze),this.avaialbleSources=[]}get sourceType(){return this.dataSource.type}set sourceType(n){n!==this.sourceType&&(this.setSourceType(n),this.setTitlesByType())}get paramsList(){return this.sourceType===x.List?this.dataSource.source:this.dataSource.source.params}get sourceHttpRequest(){return this.dataSource.source}ngOnInit(){this.isHttpRequest.set(this.sourceType===x.Request),this.setTitlesByType(),this.controlName.setValue(this.dataSource.name),this.controlName.valueChanges.pipe(fe(this.destroyRef)).subscribe(n=>this.dataSource.name=n.trim()),this.editSourceAsValue?(this.title="\u0418\u0441\u0442\u043E\u0447\u043D\u0438\u043A \u0434\u0430\u043D\u043D\u044B\u0445",this.hasAvaialbleSource.set(!!this.dataSource.id),this.avaialbleSource.set(this.dataSource.id||0),this.sourceDataStore.sourcesList$.pipe(fe(this.destroyRef)).subscribe(n=>{this.avaialbleSources=n,this.avaialbleSourcesList=n.map(t=>({value:t.id,title:t.name})),this.avaialbleSourcesList.unshift({value:0,title:"<\u041D\u0435 \u0443\u043A\u0430\u0437\u0430\u043D>"})})):this.title=this.dataSource.id?"\u0420\u0435\u0434\u0430\u043A\u0442\u0438\u0440\u043E\u0432\u0430\u043D\u0438\u0435 \u0438\u0441\u0442\u043E\u0447\u043D\u0438\u043A\u0430 \u0434\u0430\u043D\u043D\u044B\u0445":"\u041D\u043E\u0432\u044B\u0439 \u0438\u0441\u0442\u043E\u0447\u043D\u0438\u043A \u0434\u0430\u043D\u043D\u044B\u0445"}setAvaialbleSource(n){if(this.avaialbleSource.set(n),n>0){let t=this.avaialbleSources.find(e=>e.id===n);if(t){this.dataSource.id=t.id,this.dataSource.type=t.type,this.dataSource.source=JSON.parse(JSON.stringify(t.source)),this.isHttpRequest.set(this.dataSource.type===x.Request),this.setTitlesByType(),this.hasAvaialbleSource.set(!0);return}}this.dataSource.id=null,this.hasAvaialbleSource.set(!1)}onSaveAsTemplate(){this.popupEditStringService.showPopup("\u0421\u043E\u0445\u0440\u0430\u043D\u0438\u0442\u044C \u043A\u0430\u043A \u0448\u0430\u0431\u043B\u043E\u043D","\u041D\u0430\u0438\u043C\u0435\u043D\u043E\u0432\u0430\u043D\u0438\u0435 \u0448\u0430\u0431\u043B\u043E\u043D\u0430").subscribe(n=>{if(n){this.globalWaitService.showWait();let t=JSON.parse(JSON.stringify(this.dataSource));delete t.id,t.name=n,this.sourceDataStore.saveDataSource(t,e=>{this.avaialbleSource.set(Number(e.id)),this.globalWaitService.hideWait()})}})}onApply(){(this.editSourceAsValue||this.controlName.valid)&&this.closePanel(this.dataSource)}onClosePanel(){this.closePanel(null)}setSourceType(n){switch(n){case x.List:this.dataSource.source=[];break;case x.Request:this.dataSource.source={apiUrl:"",methodHttp:O.Get,methodApi:"",params:[],bindResponse:{root:null,value:"",title:""}};break}this.dataSource.type=n,this.isHttpRequest.set(this.sourceType===x.Request)}setTitlesByType(){this.sourceType===x.List?(this.paramsTitleAddButton="\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C \u0437\u043D\u0430\u0447\u0435\u043D\u0438\u0435",this.paramsTitleList="\u0421\u043F\u0438\u0441\u043E\u043A \u0437\u043D\u0430\u0447\u0435\u043D\u0438\u0439",this.paramItemTitle="\u0417\u0430\u0433\u043E\u043B\u043E\u0432\u043E\u043A"):(this.paramsTitleAddButton="\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C \u043F\u0430\u0440\u0430\u043C\u0435\u0442\u0440",this.paramsTitleList="\u0421\u043F\u0438\u0441\u043E\u043A \u043F\u0430\u0440\u0430\u043C\u0435\u0442\u0440\u043E\u0432",this.paramItemTitle="\u041F\u0430\u0440\u0430\u043C\u0435\u0442\u0440")}};i.\u0275fac=(()=>{let n;return function(e){return(n||(n=G(i)))(e||i)}})(),i.\u0275cmp=h({type:i,selectors:[["source-data-edit"]],inputs:{dataSource:"dataSource",editSourceAsValue:"editSourceAsValue"},features:[De],decls:13,vars:14,consts:[[1,"flex-auto",3,"closeEvent","applyEvent","title","applyButtonTitle"],[1,"flex-items-center","mt-10","mb-10"],["label","\u0422\u0438\u043F \u0438\u0441\u0442\u043E\u0447\u043D\u0438\u043A\u0430 \u0434\u0430\u043D\u043D\u044B\u0445",3,"valueChange","options","disabledState","value"],[1,"flex-auto","ml-10"],["label","\u0414\u043E\u0441\u0442\u0443\u043F\u043D\u044B\u0435 \u0438\u0441\u0442\u043E\u0447\u043D\u0438\u043A\u0438 \u0434\u0430\u043D\u043D\u044B\u0445",3,"options","value"],["label","\u041D\u0430\u0438\u043C\u0435\u043D\u043E\u0432\u0430\u043D\u0438\u0435 \u0438\u0441\u0442\u043E\u0447\u043D\u0438\u043A\u0430 \u0434\u0430\u043D\u043D\u044B\u0445",3,"controlRequred","formControl"],["matIconButton","","color","primary","title","\u0421\u043E\u0445\u0440\u0430\u043D\u0438\u0442\u044C \u043A\u0430\u043A \u0448\u0430\u0431\u043B\u043E\u043D",1,"ml-10",3,"click","disabled"],[1,"mt-10","mb-10",3,"request","disabledState"],[1,"flex-auto",3,"params","titleAddButton","titleList","titleParam","disabledState"],[1,"mt-10","mb-10",3,"bindResponse","disabledState"],["label","\u0414\u043E\u0441\u0442\u0443\u043F\u043D\u044B\u0435 \u0438\u0441\u0442\u043E\u0447\u043D\u0438\u043A\u0438 \u0434\u0430\u043D\u043D\u044B\u0445",3,"valueChange","options","value"]],template:function(t,e){t&1&&(s(0,"panel-container",0),m("closeEvent",function(){return e.onClosePanel()})("applyEvent",function(){return e.onApply()}),s(1,"div",1)(2,"div")(3,"jst-select",2),C("valueChange",function(r){return S(e.sourceType,r)||(e.sourceType=r),r}),l()(),s(4,"div",3),M(5,lt,1,2,"jst-select",4)(6,ut,1,2,"jst-input",5),l(),s(7,"button",6),m("click",function(){return e.onSaveAsTemplate()}),s(8,"mat-icon"),d(9,"save_as"),l()()(),M(10,pt,1,2,"params-http-request",7),R(11,"params-value-list",8),M(12,ct,1,2,"bind-response",9),l()),t&2&&(p("title",e.title)("applyButtonTitle",e.applyButtonTitle),u(3),p("options",e.sourceTypesList)("disabledState",e.hasAvaialbleSource()),v("value",e.sourceType),u(2),F(e.editSourceAsValue?5:6),u(2),p("disabled",e.hasAvaialbleSource()),u(3),F(e.isHttpRequest()?10:-1),u(),p("params",e.paramsList)("titleAddButton",e.paramsTitleAddButton)("titleList",e.paramsTitleList)("titleParam",e.paramItemTitle)("disabledState",e.hasAvaialbleSource()),u(),F(e.isHttpRequest()?12:-1))},dependencies:[B,L,V,P,Je,ie,te,w,_,Xe,Ge,Qe],styles:["[_nghost-%COMP%]{flex:auto;display:flex;flex-direction:column;width:800px;background-color:#fff;box-sizing:border-box}[_nghost-%COMP%]     .mat-mdc-form-field-subscript-wrapper, [_nghost-%COMP%]     .mat-mdc-form-field-bottom-align{display:none}"],changeDetection:0});let o=i;return o})();export{He as a,ne as b,wt as c,Je as d,J as e,nn as f};
