(self.webpackChunkbatman=self.webpackChunkbatman||[]).push([[179],{847:(Pe,tt,ne)=>{"use strict";function O(t){return"function"==typeof t}function ve(t){const n=t(r=>{Error.call(r),r.stack=(new Error).stack});return n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,n}const Ee=ve(t=>function(n){t(this),this.message=n?`${n.length} errors occurred during unsubscription:\n${n.map((r,i)=>`${i+1}) ${r.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=n});function xe(t,e){if(t){const n=t.indexOf(e);0<=n&&t.splice(n,1)}}class ie{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;const{_parentage:n}=this;if(n)if(this._parentage=null,Array.isArray(n))for(const s of n)s.remove(this);else n.remove(this);const{initialTeardown:r}=this;if(O(r))try{r()}catch(s){e=s instanceof Ee?s.errors:[s]}const{_finalizers:i}=this;if(i){this._finalizers=null;for(const s of i)try{me(s)}catch(o){e=e??[],o instanceof Ee?e=[...e,...o.errors]:e.push(o)}}if(e)throw new Ee(e)}}add(e){var n;if(e&&e!==this)if(this.closed)me(e);else{if(e instanceof ie){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=null!==(n=this._finalizers)&&void 0!==n?n:[]).push(e)}}_hasParent(e){const{_parentage:n}=this;return n===e||Array.isArray(n)&&n.includes(e)}_addParent(e){const{_parentage:n}=this;this._parentage=Array.isArray(n)?(n.push(e),n):n?[n,e]:e}_removeParent(e){const{_parentage:n}=this;n===e?this._parentage=null:Array.isArray(n)&&xe(n,e)}remove(e){const{_finalizers:n}=this;n&&xe(n,e),e instanceof ie&&e._removeParent(this)}}ie.EMPTY=(()=>{const t=new ie;return t.closed=!0,t})();const se=ie.EMPTY;function te(t){return t instanceof ie||t&&"closed"in t&&O(t.remove)&&O(t.add)&&O(t.unsubscribe)}function me(t){O(t)?t():t.unsubscribe()}const le={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},Me={setTimeout(t,e,...n){const{delegate:r}=Me;return r?.setTimeout?r.setTimeout(t,e,...n):setTimeout(t,e,...n)},clearTimeout(t){const{delegate:e}=Me;return(e?.clearTimeout||clearTimeout)(t)},delegate:void 0};function we(t){Me.setTimeout(()=>{const{onUnhandledError:e}=le;if(!e)throw t;e(t)})}function oe(){}const be=pe("C",void 0,void 0);function pe(t,e,n){return{kind:t,value:e,error:n}}let R=null;function S(t){if(le.useDeprecatedSynchronousErrorHandling){const e=!R;if(e&&(R={errorThrown:!1,error:null}),t(),e){const{errorThrown:n,error:r}=R;if(R=null,n)throw r}}else t()}class B extends ie{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,te(e)&&e.add(this)):this.destination=rt}static create(e,n,r){return new Z(e,n,r)}next(e){this.isStopped?Le(function De(t){return pe("N",t,void 0)}(e),this):this._next(e)}error(e){this.isStopped?Le(function L(t){return pe("E",void 0,t)}(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?Le(be,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const z=Function.prototype.bind;function G(t,e){return z.call(t,e)}class T{constructor(e){this.partialObserver=e}next(e){const{partialObserver:n}=this;if(n.next)try{n.next(e)}catch(r){E(r)}}error(e){const{partialObserver:n}=this;if(n.error)try{n.error(e)}catch(r){E(r)}else E(e)}complete(){const{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(n){E(n)}}}class Z extends B{constructor(e,n,r){let i;if(super(),O(e)||!e)i={next:e??void 0,error:n??void 0,complete:r??void 0};else{let s;this&&le.useDeprecatedNextContext?(s=Object.create(e),s.unsubscribe=()=>this.unsubscribe(),i={next:e.next&&G(e.next,s),error:e.error&&G(e.error,s),complete:e.complete&&G(e.complete,s)}):i=e}this.destination=new T(i)}}function E(t){le.useDeprecatedSynchronousErrorHandling?function k(t){le.useDeprecatedSynchronousErrorHandling&&R&&(R.errorThrown=!0,R.error=t)}(t):we(t)}function Le(t,e){const{onStoppedNotification:n}=le;n&&Me.setTimeout(()=>n(t,e))}const rt={closed:!0,next:oe,error:function He(t){throw t},complete:oe},Ne="function"==typeof Symbol&&Symbol.observable||"@@observable";function j(t){return t}let x=(()=>{class t{constructor(n){n&&(this._subscribe=n)}lift(n){const r=new t;return r.source=this,r.operator=n,r}subscribe(n,r,i){const s=function b(t){return t&&t instanceof B||function P(t){return t&&O(t.next)&&O(t.error)&&O(t.complete)}(t)&&te(t)}(n)?n:new Z(n,r,i);return S(()=>{const{operator:o,source:a}=this;s.add(o?o.call(s,a):a?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(n){try{return this._subscribe(n)}catch(r){n.error(r)}}forEach(n,r){return new(r=C(r))((i,s)=>{const o=new Z({next:a=>{try{n(a)}catch(l){s(l),o.unsubscribe()}},error:s,complete:i});this.subscribe(o)})}_subscribe(n){var r;return null===(r=this.source)||void 0===r?void 0:r.subscribe(n)}[Ne](){return this}pipe(...n){return function w(t){return 0===t.length?j:1===t.length?t[0]:function(n){return t.reduce((r,i)=>i(r),n)}}(n)(this)}toPromise(n){return new(n=C(n))((r,i)=>{let s;this.subscribe(o=>s=o,o=>i(o),()=>r(s))})}}return t.create=e=>new t(e),t})();function C(t){var e;return null!==(e=t??le.Promise)&&void 0!==e?e:Promise}const I=ve(t=>function(){t(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let F=(()=>{class t extends x{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(n){const r=new V(this,this);return r.operator=n,r}_throwIfClosed(){if(this.closed)throw new I}next(n){S(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const r of this.currentObservers)r.next(n)}})}error(n){S(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=n;const{observers:r}=this;for(;r.length;)r.shift().error(n)}})}complete(){S(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:n}=this;for(;n.length;)n.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var n;return(null===(n=this.observers)||void 0===n?void 0:n.length)>0}_trySubscribe(n){return this._throwIfClosed(),super._trySubscribe(n)}_subscribe(n){return this._throwIfClosed(),this._checkFinalizedStatuses(n),this._innerSubscribe(n)}_innerSubscribe(n){const{hasError:r,isStopped:i,observers:s}=this;return r||i?se:(this.currentObservers=null,s.push(n),new ie(()=>{this.currentObservers=null,xe(s,n)}))}_checkFinalizedStatuses(n){const{hasError:r,thrownError:i,isStopped:s}=this;r?n.error(i):s&&n.complete()}asObservable(){const n=new x;return n.source=this,n}}return t.create=(e,n)=>new V(e,n),t})();class V extends F{constructor(e,n){super(),this.destination=e,this.source=n}next(e){var n,r;null===(r=null===(n=this.destination)||void 0===n?void 0:n.next)||void 0===r||r.call(n,e)}error(e){var n,r;null===(r=null===(n=this.destination)||void 0===n?void 0:n.error)||void 0===r||r.call(n,e)}complete(){var e,n;null===(n=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===n||n.call(e)}_subscribe(e){var n,r;return null!==(r=null===(n=this.source)||void 0===n?void 0:n.subscribe(e))&&void 0!==r?r:se}}class W extends F{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){const n=super._subscribe(e);return!n.closed&&e.next(this._value),n}getValue(){const{hasError:e,thrownError:n,_value:r}=this;if(e)throw n;return this._throwIfClosed(),r}next(e){super.next(this._value=e)}}function q(t){return e=>{if(function H(t){return O(t?.lift)}(e))return e.lift(function(n){try{return t(n,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function ae(t,e,n,r,i){return new Ie(t,e,n,r,i)}class Ie extends B{constructor(e,n,r,i,s,o){super(e),this.onFinalize=s,this.shouldUnsubscribe=o,this._next=n?function(a){try{n(a)}catch(l){e.error(l)}}:super._next,this._error=i?function(a){try{i(a)}catch(l){e.error(l)}finally{this.unsubscribe()}}:super._error,this._complete=r?function(){try{r()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:n}=this;super.unsubscribe(),!n&&(null===(e=this.onFinalize)||void 0===e||e.call(this))}}}function vr(t){return this instanceof vr?(this.v=t,this):new vr(t)}function Ni(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,e=t[Symbol.asyncIterator];return e?e.call(t):(t=function ms(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}(t),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(s){n[s]=t[s]&&function(o){return new Promise(function(a,l){!function i(s,o,a,l){Promise.resolve(l).then(function(u){s({value:u,done:a})},o)}(a,l,(o=t[s](o)).done,o.value)})}}}"function"==typeof SuppressedError&&SuppressedError;const zr=t=>t&&"number"==typeof t.length&&"function"!=typeof t;function bn(t){return O(t?.then)}function Po(t){return O(t[Ne])}function No(t){return Symbol.asyncIterator&&O(t?.[Symbol.asyncIterator])}function Oo(t){return new TypeError(`You provided ${null!==t&&"object"==typeof t?"an invalid object":`'${t}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const ys=function Oi(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function Fi(t){return O(t?.[ys])}function _s(t){return function pl(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i,r=n.apply(t,e||[]),s=[];return i={},o("next"),o("throw"),o("return"),i[Symbol.asyncIterator]=function(){return this},i;function o(d){r[d]&&(i[d]=function(f){return new Promise(function(p,g){s.push([d,f,p,g])>1||a(d,f)})})}function a(d,f){try{!function l(d){d.value instanceof vr?Promise.resolve(d.value.v).then(u,c):h(s[0][2],d)}(r[d](f))}catch(p){h(s[0][3],p)}}function u(d){a("next",d)}function c(d){a("throw",d)}function h(d,f){d(f),s.shift(),s.length&&a(s[0][0],s[0][1])}}(this,arguments,function*(){const n=t.getReader();try{for(;;){const{value:r,done:i}=yield vr(n.read());if(i)return yield vr(void 0);yield yield vr(r)}}finally{n.releaseLock()}})}function vs(t){return O(t?.getReader)}function Qn(t){if(t instanceof x)return t;if(null!=t){if(Po(t))return function ml(t){return new x(e=>{const n=t[Ne]();if(O(n.subscribe))return n.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(t);if(zr(t))return function Fo(t){return new x(e=>{for(let n=0;n<t.length&&!e.closed;n++)e.next(t[n]);e.complete()})}(t);if(bn(t))return function yl(t){return new x(e=>{t.then(n=>{e.closed||(e.next(n),e.complete())},n=>e.error(n)).then(null,we)})}(t);if(No(t))return ko(t);if(Fi(t))return function Lo(t){return new x(e=>{for(const n of t)if(e.next(n),e.closed)return;e.complete()})}(t);if(vs(t))return function hh(t){return ko(_s(t))}(t)}throw Oo(t)}function ko(t){return new x(e=>{(function Bo(t,e){var n,r,i,s;return function hl(t,e,n,r){return new(n||(n=Promise))(function(s,o){function a(c){try{u(r.next(c))}catch(h){o(h)}}function l(c){try{u(r.throw(c))}catch(h){o(h)}}function u(c){c.done?s(c.value):function i(s){return s instanceof n?s:new n(function(o){o(s)})}(c.value).then(a,l)}u((r=r.apply(t,e||[])).next())})}(this,void 0,void 0,function*(){try{for(n=Ni(t);!(r=yield n.next()).done;)if(e.next(r.value),e.closed)return}catch(o){i={error:o}}finally{try{r&&!r.done&&(s=n.return)&&(yield s.call(n))}finally{if(i)throw i.error}}e.complete()})})(t,e).catch(n=>e.error(n))})}function gn(t,e,n,r=0,i=!1){const s=e.schedule(function(){n(),i?t.add(this.schedule(null,r)):this.unsubscribe()},r);if(t.add(s),!i)return s}function _l(t,e,n=1/0){return O(e)?_l((r,i)=>function Ce(t,e){return q((n,r)=>{let i=0;n.subscribe(ae(r,s=>{r.next(t.call(e,s,i++))}))})}((s,o)=>e(r,s,i,o))(Qn(t(r,i))),n):("number"==typeof e&&(n=e),q((r,i)=>function xs(t,e,n,r,i,s,o,a){const l=[];let u=0,c=0,h=!1;const d=()=>{h&&!l.length&&!u&&e.complete()},f=g=>u<r?p(g):l.push(g),p=g=>{s&&e.next(g),u++;let m=!1;Qn(n(g,c++)).subscribe(ae(e,_=>{i?.(_),s?f(_):e.next(_)},()=>{m=!0},void 0,()=>{if(m)try{for(u--;l.length&&u<r;){const _=l.shift();o?gn(e,o,()=>p(_)):p(_)}d()}catch(_){e.error(_)}}))};return t.subscribe(ae(e,f,()=>{h=!0,d()})),()=>{a?.()}}(r,i,t,n)))}const qg=new x(t=>t.complete());function dh(t){return t[t.length-1]}function Zg(t){return function WD(t){return t&&O(t.schedule)}(dh(t))?t.pop():void 0}function Kg(t,e=0){return q((n,r)=>{n.subscribe(ae(r,i=>gn(r,t,()=>r.next(i),e),()=>gn(r,t,()=>r.complete(),e),i=>gn(r,t,()=>r.error(i),e)))})}function Qg(t,e=0){return q((n,r)=>{r.add(t.schedule(()=>n.subscribe(r),e))})}function Jg(t,e){if(!t)throw new Error("Iterable cannot be null");return new x(n=>{gn(n,e,()=>{const r=t[Symbol.asyncIterator]();gn(n,e,()=>{r.next().then(i=>{i.done?n.complete():n.next(i.value)})},0,!0)})})}function em(t,e){return e?function JD(t,e){if(null!=t){if(Po(t))return function YD(t,e){return Qn(t).pipe(Qg(e),Kg(e))}(t,e);if(zr(t))return function ZD(t,e){return new x(n=>{let r=0;return e.schedule(function(){r===t.length?n.complete():(n.next(t[r++]),n.closed||this.schedule())})})}(t,e);if(bn(t))return function qD(t,e){return Qn(t).pipe(Qg(e),Kg(e))}(t,e);if(No(t))return Jg(t,e);if(Fi(t))return function KD(t,e){return new x(n=>{let r;return gn(n,e,()=>{r=t[ys](),gn(n,e,()=>{let i,s;try{({value:i,done:s}=r.next())}catch(o){return void n.error(o)}s?n.complete():n.next(i)},0,!0)}),()=>O(r?.return)&&r.return()})}(t,e);if(vs(t))return function QD(t,e){return Jg(_s(t),e)}(t,e)}throw Oo(t)}(t,e):Qn(t)}function eS(...t){const e=Zg(t),n=function XD(t,e){return"number"==typeof dh(t)?t.pop():e}(t,1/0),r=t;return r.length?1===r.length?Qn(r[0]):function vl(t=1/0){return _l(j,t)}(n)(em(r,e)):qg}function tm(t={}){const{connector:e=(()=>new F),resetOnError:n=!0,resetOnComplete:r=!0,resetOnRefCountZero:i=!0}=t;return s=>{let o,a,l,u=0,c=!1,h=!1;const d=()=>{a?.unsubscribe(),a=void 0},f=()=>{d(),o=l=void 0,c=h=!1},p=()=>{const g=o;f(),g?.unsubscribe()};return q((g,m)=>{u++,!h&&!c&&d();const _=l=l??e();m.add(()=>{u--,0===u&&!h&&!c&&(a=fh(p,i))}),_.subscribe(m),!o&&u>0&&(o=new Z({next:v=>_.next(v),error:v=>{h=!0,d(),a=fh(f,n,v),_.error(v)},complete:()=>{c=!0,d(),a=fh(f,r),_.complete()}}),Qn(g).subscribe(o))})(s)}}function fh(t,e,...n){if(!0===e)return void t();if(!1===e)return;const r=new Z({next:()=>{r.unsubscribe(),t()}});return e(...n).subscribe(r)}function iS(t,e){return t===e}function xt(t){for(let e in t)if(t[e]===xt)return e;throw Error("Could not find renamed property on target object.")}function Yt(t){if("string"==typeof t)return t;if(Array.isArray(t))return"["+t.map(Yt).join(", ")+"]";if(null==t)return""+t;if(t.overriddenName)return`${t.overriddenName}`;if(t.name)return`${t.name}`;const e=t.toString();if(null==e)return""+e;const n=e.indexOf("\n");return-1===n?e:e.substring(0,n)}function ph(t,e){return null==t||""===t?null===e?"":e:null==e||""===e?t:t+" "+e}const sS=xt({__forward_ref__:xt});function gh(t){return t.__forward_ref__=gh,t.toString=function(){return Yt(this())},t}function Ue(t){return function mh(t){return"function"==typeof t&&t.hasOwnProperty(sS)&&t.__forward_ref__===gh}(t)?t():t}function yh(t){return t&&!!t.\u0275providers}class ye extends Error{constructor(e,n){super(function wl(t,e){return`NG0${Math.abs(t)}${e?": "+e:""}`}(e,n)),this.code=e}}function yt(t){return"function"==typeof t?t.name||t.toString():"object"==typeof t&&null!=t&&"function"==typeof t.type?t.type.name||t.type.toString():function Ge(t){return"string"==typeof t?t:null==t?"":String(t)}(t)}function _h(t,e){throw new ye(-201,!1)}function Gn(t,e){null==t&&function ke(t,e,n,r){throw new Error(`ASSERTION ERROR: ${t}`+(null==r?"":` [Expected=> ${n} ${r} ${e} <=Actual]`))}(e,t,null,"!=")}function Et(t){return{token:t.token,providedIn:t.providedIn||null,factory:t.factory,value:void 0}}function El(t){return rm(t,Dl)||rm(t,im)}function rm(t,e){return t.hasOwnProperty(e)?t[e]:null}function bl(t){return t&&(t.hasOwnProperty(xh)||t.hasOwnProperty(dS))?t[xh]:null}const Dl=xt({\u0275prov:xt}),xh=xt({\u0275inj:xt}),im=xt({ngInjectableDef:xt}),dS=xt({ngInjectorDef:xt});var ot=function(t){return t[t.Default=0]="Default",t[t.Host=1]="Host",t[t.Self=2]="Self",t[t.SkipSelf=4]="SkipSelf",t[t.Optional=8]="Optional",t}(ot||{});let wh;function Dn(t){const e=wh;return wh=t,e}function om(t,e,n){const r=El(t);return r&&"root"==r.providedIn?void 0===r.value?r.value=r.factory():r.value:n&ot.Optional?null:void 0!==e?e:void _h(Yt(t))}const bt=globalThis,Uo={},Th="__NG_DI_FLAG__",Sl="ngTempTokenPath",gS=/\n/gm,lm="__source";let ws;function di(t){const e=ws;return ws=t,e}function _S(t,e=ot.Default){if(void 0===ws)throw new ye(-203,!1);return null===ws?om(t,void 0,e):ws.get(t,e&ot.Optional?null:void 0,e)}function dt(t,e=ot.Default){return(function sm(){return wh}()||_S)(Ue(t),e)}function Ct(t,e=ot.Default){return dt(t,Tl(e))}function Tl(t){return typeof t>"u"||"number"==typeof t?t:0|(t.optional&&8)|(t.host&&1)|(t.self&&2)|(t.skipSelf&&4)}function Ch(t){const e=[];for(let n=0;n<t.length;n++){const r=Ue(t[n]);if(Array.isArray(r)){if(0===r.length)throw new ye(900,!1);let i,s=ot.Default;for(let o=0;o<r.length;o++){const a=r[o],l=vS(a);"number"==typeof l?-1===l?i=a.token:s|=l:i=a}e.push(dt(i,s))}else e.push(dt(r))}return e}function vS(t){return t[Th]}var Cl=function(t){return t[t.OnPush=0]="OnPush",t[t.Default=1]="Default",t}(Cl||{}),Jn=function(t){return t[t.Emulated=0]="Emulated",t[t.None=2]="None",t[t.ShadowDom=3]="ShadowDom",t}(Jn||{});const Er={},pt=[],Il=xt({\u0275cmp:xt}),Ih=xt({\u0275dir:xt}),Ah=xt({\u0275pipe:xt}),Xr=xt({\u0275fac:xt}),Vo=xt({__NG_ELEMENT_ID__:xt}),hm=xt({__NG_ENV_ID__:xt});function Mh(t,e,n){let r=0;for(;r<n.length;){const i=n[r];if("number"==typeof i){if(0!==i)break;r++;const s=n[r++],o=n[r++],a=n[r++];t.setAttribute(e,o,a,s)}else{const s=i,o=n[++r];pm(s)?t.setProperty(e,s,o):t.setAttribute(e,s,o),r++}}return r}function pm(t){return 64===t.charCodeAt(0)}function Go(t,e){if(null!==e&&0!==e.length)if(null===t||0===t.length)t=e.slice();else{let n=-1;for(let r=0;r<e.length;r++){const i=e[r];"number"==typeof i?n=i:0===n||gm(t,n,i,null,-1===n||2===n?e[++r]:null)}}return t}function gm(t,e,n,r,i){let s=0,o=t.length;if(-1===e)o=-1;else for(;s<t.length;){const a=t[s++];if("number"==typeof a){if(a===e){o=-1;break}if(a>e){o=s-1;break}}}for(;s<t.length;){const a=t[s];if("number"==typeof a)break;if(a===n){if(null===r)return void(null!==i&&(t[s+1]=i));if(r===t[s+1])return void(t[s+2]=i)}s++,null!==r&&s++,null!==i&&s++}-1!==o&&(t.splice(o,0,e),s=o+1),t.splice(s++,0,n),null!==r&&t.splice(s++,0,r),null!==i&&t.splice(s++,0,i)}const mm="ng-template";function ym(t){return 4===t.type&&t.value!==mm}function er(t){return 0==(1&t)}function vm(t,e){return t?":not("+e.trim()+")":e}function MS(t){let e=t[0],n=1,r=2,i="",s=!1;for(;n<t.length;){let o=t[n];if("string"==typeof o)if(2&r){const a=t[++n];i+="["+o+(a.length>0?'="'+a+'"':"")+"]"}else 8&r?i+="."+o:4&r&&(i+=" "+o);else""!==i&&!er(o)&&(e+=vm(s,i),i=""),r=o,s=s||!er(r);n++}return""!==i&&(e+=vm(s,i)),e}function xm(t){return function Wr(t){return{toString:t}.toString()}(()=>{const e=function bm(t){const e={};return{type:t.type,providersResolver:null,factory:null,hostBindings:t.hostBindings||null,hostVars:t.hostVars||0,hostAttrs:t.hostAttrs||null,contentQueries:t.contentQueries||null,declaredInputs:e,inputTransforms:null,inputConfig:t.inputs||Er,exportAs:t.exportAs||null,standalone:!0===t.standalone,signals:!0===t.signals,selectors:t.selectors||pt,viewQuery:t.viewQuery||null,features:t.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:Em(t.inputs,e),outputs:Em(t.outputs)}}(t),n={...e,decls:t.decls,vars:t.vars,template:t.template,consts:t.consts||null,ngContentSelectors:t.ngContentSelectors,onPush:t.changeDetection===Cl.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&t.dependencies||null,getStandaloneInjector:null,signals:t.signals??!1,data:t.data||{},encapsulation:t.encapsulation||Jn.Emulated,styles:t.styles||pt,_:null,schemas:t.schemas||null,tView:null,id:""};!function Dm(t){t.features?.forEach(e=>e(t))}(n);const r=t.dependencies;return n.directiveDefs=Al(r,!1),n.pipeDefs=Al(r,!0),n.id=function BS(t){let e=0;const n=[t.selectors,t.ngContentSelectors,t.hostVars,t.hostAttrs,t.consts,t.vars,t.decls,t.encapsulation,t.standalone,t.signals,t.exportAs,JSON.stringify(t.inputs),JSON.stringify(t.outputs),Object.getOwnPropertyNames(t.type.prototype),!!t.contentQueries,!!t.viewQuery].join("|");for(const i of n)e=Math.imul(31,e)+i.charCodeAt(0)<<0;return e+=2147483648,"c"+e}(n),n})}function OS(t){return at(t)||en(t)}function FS(t){return null!==t}function Em(t,e){if(null==t)return Er;const n={};for(const r in t)if(t.hasOwnProperty(r)){let i=t[r],s=i;Array.isArray(i)&&(s=i[1],i=i[0]),n[i]=r,e&&(e[i]=s)}return n}function at(t){return t[Il]||null}function en(t){return t[Ih]||null}function mn(t){return t[Ah]||null}function Al(t,e){if(!t)return null;const n=e?mn:OS;return()=>("function"==typeof t?t():t).map(r=>n(r)).filter(FS)}const Ut=0,ue=1,ze=2,Rt=3,tr=4,$o=5,ln=6,Es=7,Ht=8,fi=9,bs=10,je=11,zo=12,Ds=14,Vt=15,Wo=16,Ss=17,br=18,Xo=19,Tm=20,pi=21,Yr=22,Ml=23,Rl=24,it=25,Rh=1,Cm=2,Dr=7,Ts=9,tn=11;function Tn(t){return Array.isArray(t)&&"object"==typeof t[Rh]}function Cn(t){return Array.isArray(t)&&!0===t[Rh]}function ki(t){return t.componentOffset>-1}function nr(t){return!!t.template}function Nh(t){return 0!=(512&t[ze])}function Bi(t,e){return t.hasOwnProperty(Xr)?t[Xr]:null}let $S=bt.WeakRef??class jS{constructor(e){this.ref=e}deref(){return this.ref}},WS=0,Sr=null,Ol=!1;function Qt(t){const e=Sr;return Sr=t,e}class Pm{constructor(){this.id=WS++,this.ref=function zS(t){return new $S(t)}(this),this.producers=new Map,this.consumers=new Map,this.trackingVersion=0,this.valueVersion=0}consumerPollProducersForChange(){for(const[e,n]of this.producers){const r=n.producerNode.deref();if(null!=r&&n.atTrackingVersion===this.trackingVersion){if(r.producerPollStatus(n.seenValueVersion))return!0}else this.producers.delete(e),r?.consumers.delete(this.id)}return!1}producerMayHaveChanged(){const e=Ol;Ol=!0;try{for(const[n,r]of this.consumers){const i=r.consumerNode.deref();null!=i&&i.trackingVersion===r.atTrackingVersion?i.onConsumerDependencyMayHaveChanged():(this.consumers.delete(n),i?.producers.delete(this.id))}}finally{Ol=e}}producerAccessed(){if(Ol)throw new Error("");if(null===Sr)return;let e=Sr.producers.get(this.id);void 0===e?(e={consumerNode:Sr.ref,producerNode:this.ref,seenValueVersion:this.valueVersion,atTrackingVersion:Sr.trackingVersion},Sr.producers.set(this.id,e),this.consumers.set(Sr.id,e)):(e.seenValueVersion=this.valueVersion,e.atTrackingVersion=Sr.trackingVersion)}get hasProducers(){return this.producers.size>0}get producerUpdatesAllowed(){return!1!==Sr?.consumerAllowSignalWrites}producerPollStatus(e){return this.valueVersion!==e||(this.onProducerUpdateValueVersion(),this.valueVersion!==e)}}let Nm=null;const Fm=()=>{};class ZS extends Pm{constructor(e,n,r){super(),this.watch=e,this.schedule=n,this.dirty=!1,this.cleanupFn=Fm,this.registerOnCleanup=i=>{this.cleanupFn=i},this.consumerAllowSignalWrites=r}notify(){this.dirty||this.schedule(this),this.dirty=!0}onConsumerDependencyMayHaveChanged(){this.notify()}onProducerUpdateValueVersion(){}run(){if(this.dirty=!1,0!==this.trackingVersion&&!this.consumerPollProducersForChange())return;const e=Qt(this);this.trackingVersion++;try{this.cleanupFn(),this.cleanupFn=Fm,this.watch(this.registerOnCleanup)}finally{Qt(e)}}cleanup(){this.cleanupFn()}}class KS{constructor(e,n,r){this.previousValue=e,this.currentValue=n,this.firstChange=r}isFirstChange(){return this.firstChange}}function Lm(t){return t.type.prototype.ngOnChanges&&(t.setInput=JS),QS}function QS(){const t=Bm(this),e=t?.current;if(e){const n=t.previous;if(n===Er)t.previous=e;else for(let r in e)n[r]=e[r];t.current=null,this.ngOnChanges(e)}}function JS(t,e,n,r){const i=this.declaredInputs[n],s=Bm(t)||function eT(t,e){return t[km]=e}(t,{previous:Er,current:null}),o=s.current||(s.current={}),a=s.previous,l=a[i];o[i]=new KS(l&&l.currentValue,e,a===Er),t[r]=e}const km="__ngSimpleChanges__";function Bm(t){return t[km]||null}const Tr=function(t,e,n){};function It(t){for(;Array.isArray(t);)t=t[Ut];return t}function In(t,e){return It(e[t.index])}function Ln(t,e){const n=e[t];return Tn(n)?n:n[Ut]}function Gm(t){t[Ss]=0}function aT(t){1024&t[ze]||(t[ze]|=1024,$m(t,1))}function jm(t){1024&t[ze]&&(t[ze]&=-1025,$m(t,-1))}function $m(t,e){let n=t[Rt];if(null===n)return;n[$o]+=e;let r=n;for(n=n[Rt];null!==n&&(1===e&&1===r[$o]||-1===e&&0===r[$o]);)n[$o]+=e,r=n,n=n[Rt]}const Be={lFrame:ty(null),bindingsEnabled:!0,skipHydrationRootTNode:null};function U(){return Be.lFrame.lView}function nn(){let t=Ym();for(;null!==t&&64===t.type;)t=t.parent;return t}function Ym(){return Be.lFrame.currentTNode}function wT(t,e){const n=Be.lFrame;n.bindingIndex=n.bindingRootIndex=t,Vh(e)}function Vh(t){Be.lFrame.currentDirectiveIndex=t}function jh(t){Be.lFrame.currentQueryIndex=t}function bT(t){const e=t[ue];return 2===e.type?e.declTNode:1===e.type?t[ln]:null}function Jm(t,e,n){if(n&ot.SkipSelf){let i=e,s=t;for(;!(i=i.parent,null!==i||n&ot.Host||(i=bT(s),null===i||(s=s[Ds],10&i.type))););if(null===i)return!1;e=i,t=s}const r=Be.lFrame=ey();return r.currentTNode=e,r.lView=t,!0}function $h(t){const e=ey(),n=t[ue];Be.lFrame=e,e.currentTNode=n.firstChild,e.lView=t,e.tView=n,e.contextLView=t,e.bindingIndex=n.bindingStartIndex,e.inI18n=!1}function ey(){const t=Be.lFrame,e=null===t?null:t.child;return null===e?ty(t):e}function ty(t){const e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:t,child:null,inI18n:!1};return null!==t&&(t.child=e),e}function ny(){const t=Be.lFrame;return Be.lFrame=t.parent,t.currentTNode=null,t.lView=null,t}const ry=ny;function zh(){const t=ny();t.isParent=!0,t.tView=null,t.selectedIndex=-1,t.contextLView=null,t.elementDepthCount=0,t.currentDirectiveIndex=-1,t.currentNamespace=null,t.bindingRootIndex=-1,t.bindingIndex=-1,t.currentQueryIndex=0}function Ui(t){Be.lFrame.selectedIndex=t}function Vl(t,e,n){oy(t,e,3,n)}function Gl(t,e,n,r){(3&t[ze])===n&&oy(t,e,n,r)}function Wh(t,e){let n=t[ze];(3&n)===e&&(n&=8191,n+=1,t[ze]=n)}function oy(t,e,n,r){const s=r??-1,o=e.length-1;let a=0;for(let l=void 0!==r?65535&t[Ss]:0;l<o;l++)if("number"==typeof e[l+1]){if(a=e[l],null!=r&&a>=r)break}else e[l]<0&&(t[Ss]+=65536),(a<s||-1==s)&&(RT(t,n,e,l),t[Ss]=(4294901760&t[Ss])+l+2),l++}function ay(t,e){Tr(4,t,e);const n=Qt(null);try{e.call(t)}finally{Qt(n),Tr(5,t,e)}}function RT(t,e,n,r){const i=n[r]<0,s=n[r+1],a=t[i?-n[r]:n[r]];i?t[ze]>>13<t[Ss]>>16&&(3&t[ze])===e&&(t[ze]+=8192,ay(a,s)):ay(a,s)}const Ms=-1;class Zo{constructor(e,n,r){this.factory=e,this.resolving=!1,this.canSeeViewProviders=n,this.injectImpl=r}}function Ko(t){return 32767&t}function Qo(t,e){let n=function FT(t){return t>>16}(t),r=e;for(;n>0;)r=r[Ds],n--;return r}let qh=!0;function jl(t){const e=qh;return qh=t,e}const ly=255,uy=5;let LT=0;const Ir={};function $l(t,e){const n=cy(t,e);if(-1!==n)return n;const r=e[ue];r.firstCreatePass&&(t.injectorIndex=e.length,Zh(r.data,t),Zh(e,null),Zh(r.blueprint,null));const i=zl(t,e),s=t.injectorIndex;if(function Yh(t){return t!==Ms}(i)){const o=Ko(i),a=Qo(i,e),l=a[ue].data;for(let u=0;u<8;u++)e[s+u]=a[o+u]|l[o+u]}return e[s+8]=i,s}function Zh(t,e){t.push(0,0,0,0,0,0,0,0,e)}function cy(t,e){return-1===t.injectorIndex||t.parent&&t.parent.injectorIndex===t.injectorIndex||null===e[t.injectorIndex+8]?-1:t.injectorIndex}function zl(t,e){if(t.parent&&-1!==t.parent.injectorIndex)return t.parent.injectorIndex;let n=0,r=null,i=e;for(;null!==i;){if(r=yy(i),null===r)return Ms;if(n++,i=i[Ds],-1!==r.injectorIndex)return r.injectorIndex|n<<16}return Ms}function Kh(t,e,n){!function kT(t,e,n){let r;"string"==typeof n?r=n.charCodeAt(0)||0:n.hasOwnProperty(Vo)&&(r=n[Vo]),null==r&&(r=n[Vo]=LT++);const i=r&ly;e.data[t+(i>>uy)]|=1<<i}(t,e,n)}function hy(t,e,n){if(n&ot.Optional||void 0!==t)return t;_h()}function dy(t,e,n,r){if(n&ot.Optional&&void 0===r&&(r=null),!(n&(ot.Self|ot.Host))){const i=t[fi],s=Dn(void 0);try{return i?i.get(e,r,n&ot.Optional):om(e,r,n&ot.Optional)}finally{Dn(s)}}return hy(r,0,n)}function fy(t,e,n,r=ot.Default,i){if(null!==t){if(2048&e[ze]&&!(r&ot.Self)){const o=function $T(t,e,n,r,i){let s=t,o=e;for(;null!==s&&null!==o&&2048&o[ze]&&!(512&o[ze]);){const a=py(s,o,n,r|ot.Self,Ir);if(a!==Ir)return a;let l=s.parent;if(!l){const u=o[Tm];if(u){const c=u.get(n,Ir,r);if(c!==Ir)return c}l=yy(o),o=o[Ds]}s=l}return i}(t,e,n,r,Ir);if(o!==Ir)return o}const s=py(t,e,n,r,Ir);if(s!==Ir)return s}return dy(e,n,r,i)}function py(t,e,n,r,i){const s=function HT(t){if("string"==typeof t)return t.charCodeAt(0)||0;const e=t.hasOwnProperty(Vo)?t[Vo]:void 0;return"number"==typeof e?e>=0?e&ly:GT:e}(n);if("function"==typeof s){if(!Jm(e,t,r))return r&ot.Host?hy(i,0,r):dy(e,n,r,i);try{let o;if(o=s(r),null!=o||r&ot.Optional)return o;_h()}finally{ry()}}else if("number"==typeof s){let o=null,a=cy(t,e),l=Ms,u=r&ot.Host?e[Vt][ln]:null;for((-1===a||r&ot.SkipSelf)&&(l=-1===a?zl(t,e):e[a+8],l!==Ms&&my(r,!1)?(o=e[ue],a=Ko(l),e=Qo(l,e)):a=-1);-1!==a;){const c=e[ue];if(gy(s,a,c.data)){const h=UT(a,e,n,o,r,u);if(h!==Ir)return h}l=e[a+8],l!==Ms&&my(r,e[ue].data[a+8]===u)&&gy(s,a,e)?(o=c,a=Ko(l),e=Qo(l,e)):a=-1}}return i}function UT(t,e,n,r,i,s){const o=e[ue],a=o.data[t+8],c=function Wl(t,e,n,r,i){const s=t.providerIndexes,o=e.data,a=1048575&s,l=t.directiveStart,c=s>>20,d=i?a+c:t.directiveEnd;for(let f=r?a:a+c;f<d;f++){const p=o[f];if(f<l&&n===p||f>=l&&p.type===n)return f}if(i){const f=o[l];if(f&&nr(f)&&f.type===n)return l}return null}(a,o,n,null==r?ki(a)&&qh:r!=o&&0!=(3&a.type),i&ot.Host&&s===a);return null!==c?Hi(e,o,c,a):Ir}function Hi(t,e,n,r){let i=t[n];const s=e.data;if(function PT(t){return t instanceof Zo}(i)){const o=i;o.resolving&&function oS(t,e){const n=e?`. Dependency path: ${e.join(" > ")} > ${t}`:"";throw new ye(-200,`Circular dependency in DI detected for ${t}${n}`)}(yt(s[n]));const a=jl(o.canSeeViewProviders);o.resolving=!0;const u=o.injectImpl?Dn(o.injectImpl):null;Jm(t,r,ot.Default);try{i=t[n]=o.factory(void 0,s,t,r),e.firstCreatePass&&n>=r.directiveStart&&function MT(t,e,n){const{ngOnChanges:r,ngOnInit:i,ngDoCheck:s}=e.type.prototype;if(r){const o=Lm(e);(n.preOrderHooks??=[]).push(t,o),(n.preOrderCheckHooks??=[]).push(t,o)}i&&(n.preOrderHooks??=[]).push(0-t,i),s&&((n.preOrderHooks??=[]).push(t,s),(n.preOrderCheckHooks??=[]).push(t,s))}(n,s[n],e)}finally{null!==u&&Dn(u),jl(a),o.resolving=!1,ry()}}return i}function gy(t,e,n){return!!(n[e+(t>>uy)]&1<<t)}function my(t,e){return!(t&ot.Self||t&ot.Host&&e)}class vn{constructor(e,n){this._tNode=e,this._lView=n}get(e,n,r){return fy(this._tNode,this._lView,e,Tl(r),n)}}function GT(){return new vn(nn(),U())}function yy(t){const e=t[ue],n=e.type;return 2===n?e.declTNode:1===n?t[ln]:null}function Ls(t,e){t.forEach(n=>Array.isArray(n)?Ls(n,e):e(n))}function Xl(t,e){return e>=t.length-1?t.pop():t.splice(e,1)[0]}var yi=function(t){return t[t.Important=1]="Important",t[t.DashCase=2]="DashCase",t}(yi||{});const ld=new Map;let wC=0;const cd="__ngContext__";function un(t,e){Tn(e)?(t[cd]=e[Xo],function bC(t){ld.set(t[Xo],t)}(e)):t[cd]=e}let hd,wd;function dd(t,e){return hd(t,e)}function ia(t){const e=t[Rt];return Cn(e)?e[Rt]:e}function Hy(t){return Gy(t[zo])}function Vy(t){return Gy(t[tr])}function Gy(t){for(;null!==t&&!Cn(t);)t=t[tr];return t}function Hs(t,e,n,r,i){if(null!=r){let s,o=!1;Cn(r)?s=r:Tn(r)&&(o=!0,r=r[Ut]);const a=It(r);0===t&&null!==n?null==i?function Wy(t,e,n){t.appendChild(e,n)}(e,n,a):Vi(e,n,a,i||null,!0):1===t&&null!==n?Vi(e,n,a,i||null,!0):2===t?function ou(t,e,n){const r=function iu(t,e){return t.parentNode(e)}(t,e);r&&function GC(t,e,n,r){t.removeChild(e,n,r)}(t,r,e,n)}(e,a,o):3===t&&e.destroyNode(a),null!=s&&function zC(t,e,n,r,i){const s=n[Dr];s!==It(n)&&Hs(e,t,r,s,i);for(let a=tn;a<n.length;a++){const l=n[a];oa(l[ue],l,t,e,r,s)}}(e,t,s,n,i)}}function $y(t,e){const n=t[Ts],r=n.indexOf(e);jm(e),n.splice(r,1)}function gd(t,e){if(!(256&e[ze])){e[ze]&=-129,e[ze]|=256,function VC(t,e){let n;if(null!=t&&null!=(n=t.destroyHooks))for(let r=0;r<n.length;r+=2){const i=e[n[r]];if(!(i instanceof Zo)){const s=n[r+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){const a=i[s[o]],l=s[o+1];Tr(4,a,l);try{l.call(a)}finally{Tr(5,a,l)}}else{Tr(4,i,s);try{s.call(i)}finally{Tr(5,i,s)}}}}}(t,e),function HC(t,e){const n=t.cleanup,r=e[Es];if(null!==n)for(let s=0;s<n.length-1;s+=2)if("string"==typeof n[s]){const o=n[s+3];o>=0?r[o]():r[-o].unsubscribe(),s+=2}else n[s].call(r[n[s+1]]);null!==r&&(e[Es]=null);const i=e[pi];if(null!==i){e[pi]=null;for(let s=0;s<i.length;s++)(0,i[s])()}}(t,e),1===e[ue].type&&e[je].destroy();const n=e[Wo];if(null!==n&&Cn(e[Rt])){n!==e[Rt]&&$y(n,e);const r=e[br];null!==r&&r.detachView(t)}!function DC(t){ld.delete(t[Xo])}(e)}}function Vi(t,e,n,r,i){t.insertBefore(e,n,r,i)}function Qy(t,e){return null!==e?t[Vt][ln].projection[e.projection]:null}function vd(t,e,n,r,i,s,o){for(;null!=n;){const a=r[n.index],l=n.type;if(o&&0===e&&(a&&un(It(a),r),n.flags|=2),32!=(32&n.flags))if(8&l)vd(t,e,n.child,r,i,s,!1),Hs(e,t,i,a,s);else if(32&l){const u=dd(n,r);let c;for(;c=u();)Hs(e,t,i,c,s);Hs(e,t,i,a,s)}else 16&l?e_(t,e,r,n,i,s):Hs(e,t,i,a,s);n=o?n.projectionNext:n.next}}function oa(t,e,n,r,i,s){vd(n,r,t.firstChild,e,i,s,!1)}function e_(t,e,n,r,i,s){const o=n[Vt],l=o[ln].projection[r.projection];if(Array.isArray(l))for(let u=0;u<l.length;u++)Hs(e,t,i,l[u],s);else{let u=l;const c=o[Rt];(function Jl(t){return 128==(128&t.flags)})(r)&&(u.flags|=128),vd(t,e,u,c,i,s,!0)}}function t_(t,e,n){""===n?t.removeAttribute(e,"class"):t.setAttribute(e,"class",n)}class We{constructor(e,n){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof n?this.__NG_ELEMENT_ID__=n:void 0!==n&&(this.\u0275prov=Et({token:this,providedIn:n.providedIn||"root",factory:n.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}const cu=new We("ENVIRONMENT_INITIALIZER"),g_=new We("INJECTOR",-1),m_=new We("INJECTOR_DEF_TYPES");class Cd{get(e,n=Uo){if(n===Uo){const r=new Error(`NullInjectorError: No provider for ${Yt(e)}!`);throw r.name="NullInjectorError",r}return n}}function wI(...t){return{\u0275providers:__(0,t),\u0275fromNgModule:!0}}function __(t,...e){const n=[],r=new Set;let i;const s=o=>{n.push(o)};return Ls(e,o=>{const a=o;hu(a,s,[],r)&&(i||=[],i.push(a))}),void 0!==i&&v_(i,s),n}function v_(t,e){for(let n=0;n<t.length;n++){const{ngModule:r,providers:i}=t[n];Id(i,s=>{e(s,r)})}}function hu(t,e,n,r){if(!(t=Ue(t)))return!1;let i=null,s=bl(t);const o=!s&&at(t);if(s||o){if(o&&!o.standalone)return!1;i=t}else{const l=t.ngModule;if(s=bl(l),!s)return!1;i=l}const a=r.has(i);if(o){if(a)return!1;if(r.add(i),o.dependencies){const l="function"==typeof o.dependencies?o.dependencies():o.dependencies;for(const u of l)hu(u,e,n,r)}}else{if(!s)return!1;{if(null!=s.imports&&!a){let u;r.add(i);try{Ls(s.imports,c=>{hu(c,e,n,r)&&(u||=[],u.push(c))})}finally{}void 0!==u&&v_(u,e)}if(!a){const u=Bi(i)||(()=>new i);e({provide:i,useFactory:u,deps:pt},i),e({provide:m_,useValue:i,multi:!0},i),e({provide:cu,useValue:()=>dt(i),multi:!0},i)}const l=s.providers;if(null!=l&&!a){const u=t;Id(l,c=>{e(c,u)})}}}return i!==t&&void 0!==t.providers}function Id(t,e){for(let n of t)yh(n)&&(n=n.\u0275providers),Array.isArray(n)?Id(n,e):e(n)}const EI=xt({provide:String,useValue:xt});function Ad(t){return null!==t&&"object"==typeof t&&EI in t}function Gi(t){return"function"==typeof t}const Md=new We("Set Injector scope."),du={},DI={};let Rd;function fu(){return void 0===Rd&&(Rd=new Cd),Rd}class Qr{}class pu extends Qr{get destroyed(){return this._destroyed}constructor(e,n,r,i){super(),this.parent=n,this.source=r,this.scopes=i,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,Nd(e,o=>this.processProvider(o)),this.records.set(g_,$s(void 0,this)),i.has("environment")&&this.records.set(Qr,$s(void 0,this));const s=this.records.get(Md);null!=s&&"string"==typeof s.value&&this.scopes.add(s.value),this.injectorDefTypes=new Set(this.get(m_.multi,pt,ot.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const n of this._ngOnDestroyHooks)n.ngOnDestroy();const e=this._onDestroyHooks;this._onDestroyHooks=[];for(const n of e)n()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear()}}onDestroy(e){return this.assertNotDestroyed(),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){this.assertNotDestroyed();const n=di(this),r=Dn(void 0);try{return e()}finally{di(n),Dn(r)}}get(e,n=Uo,r=ot.Default){if(this.assertNotDestroyed(),e.hasOwnProperty(hm))return e[hm](this);r=Tl(r);const s=di(this),o=Dn(void 0);try{if(!(r&ot.SkipSelf)){let l=this.records.get(e);if(void 0===l){const u=function AI(t){return"function"==typeof t||"object"==typeof t&&t instanceof We}(e)&&El(e);l=u&&this.injectableDefInScope(u)?$s(Pd(e),du):null,this.records.set(e,l)}if(null!=l)return this.hydrate(e,l)}return(r&ot.Self?fu():this.parent).get(e,n=r&ot.Optional&&n===Uo?null:n)}catch(a){if("NullInjectorError"===a.name){if((a[Sl]=a[Sl]||[]).unshift(Yt(e)),s)throw a;return function xS(t,e,n,r){const i=t[Sl];throw e[lm]&&i.unshift(e[lm]),t.message=function wS(t,e,n,r=null){t=t&&"\n"===t.charAt(0)&&"\u0275"==t.charAt(1)?t.slice(2):t;let i=Yt(e);if(Array.isArray(e))i=e.map(Yt).join(" -> ");else if("object"==typeof e){let s=[];for(let o in e)if(e.hasOwnProperty(o)){let a=e[o];s.push(o+":"+("string"==typeof a?JSON.stringify(a):Yt(a)))}i=`{${s.join(", ")}}`}return`${n}${r?"("+r+")":""}[${i}]: ${t.replace(gS,"\n  ")}`}("\n"+t.message,i,n,r),t.ngTokenPath=i,t[Sl]=null,t}(a,e,"R3InjectorError",this.source)}throw a}finally{Dn(o),di(s)}}resolveInjectorInitializers(){const e=di(this),n=Dn(void 0);try{const i=this.get(cu.multi,pt,ot.Self);for(const s of i)s()}finally{di(e),Dn(n)}}toString(){const e=[],n=this.records;for(const r of n.keys())e.push(Yt(r));return`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new ye(205,!1)}processProvider(e){let n=Gi(e=Ue(e))?e:Ue(e&&e.provide);const r=function TI(t){return Ad(t)?$s(void 0,t.useValue):$s(function E_(t,e,n){let r;if(Gi(t)){const i=Ue(t);return Bi(i)||Pd(i)}if(Ad(t))r=()=>Ue(t.useValue);else if(function w_(t){return!(!t||!t.useFactory)}(t))r=()=>t.useFactory(...Ch(t.deps||[]));else if(function x_(t){return!(!t||!t.useExisting)}(t))r=()=>dt(Ue(t.useExisting));else{const i=Ue(t&&(t.useClass||t.provide));if(!function CI(t){return!!t.deps}(t))return Bi(i)||Pd(i);r=()=>new i(...Ch(t.deps))}return r}(t),du)}(e);if(Gi(e)||!0!==e.multi)this.records.get(n);else{let i=this.records.get(n);i||(i=$s(void 0,du,!0),i.factory=()=>Ch(i.multi),this.records.set(n,i)),n=e,i.multi.push(e)}this.records.set(n,r)}hydrate(e,n){return n.value===du&&(n.value=DI,n.value=n.factory()),"object"==typeof n.value&&n.value&&function II(t){return null!==t&&"object"==typeof t&&"function"==typeof t.ngOnDestroy}(n.value)&&this._ngOnDestroyHooks.add(n.value),n.value}injectableDefInScope(e){if(!e.providedIn)return!1;const n=Ue(e.providedIn);return"string"==typeof n?"any"===n||this.scopes.has(n):this.injectorDefTypes.has(n)}removeOnDestroy(e){const n=this._onDestroyHooks.indexOf(e);-1!==n&&this._onDestroyHooks.splice(n,1)}}function Pd(t){const e=El(t),n=null!==e?e.factory:Bi(t);if(null!==n)return n;if(t instanceof We)throw new ye(204,!1);if(t instanceof Function)return function SI(t){const e=t.length;if(e>0)throw function ta(t,e){const n=[];for(let r=0;r<t;r++)n.push(e);return n}(e,"?"),new ye(204,!1);const n=function hS(t){return t&&(t[Dl]||t[im])||null}(t);return null!==n?()=>n.factory(t):()=>new t}(t);throw new ye(204,!1)}function $s(t,e,n=!1){return{factory:t,value:e,multi:n?[]:void 0}}function Nd(t,e){for(const n of t)Array.isArray(n)?Nd(n,e):n&&yh(n)?Nd(n.\u0275providers,e):e(n)}const Od=new We("AppId",{providedIn:"root",factory:()=>MI}),MI="ng",b_=new We("Platform Initializer"),zs=new We("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),D_=new We("CSP nonce",{providedIn:"root",factory:()=>function Gs(){if(void 0!==wd)return wd;if(typeof document<"u")return document;throw new ye(210,!1)}().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});let T_=(t,e,n)=>null;function Vd(t,e,n=!1){return T_(t,e,n)}class HI{}class A_{}class GI{resolveComponentFactory(e){throw function VI(t){const e=Error(`No component factory found for ${Yt(t)}.`);return e.ngComponent=t,e}(e)}}let xu=(()=>{class e{}return e.NULL=new GI,e})();function jI(){return Xs(nn(),U())}function Xs(t,e){return new ji(In(t,e))}let ji=(()=>{class e{constructor(r){this.nativeElement=r}}return e.__NG_ELEMENT_ID__=jI,e})();class R_{}let WI=(()=>{var t;class e{}return(t=e).\u0275prov=Et({token:t,providedIn:"root",factory:()=>null}),e})();class $d{constructor(e){this.full=e,this.major=e.split(".")[0],this.minor=e.split(".")[1],this.patch=e.split(".").slice(2).join(".")}}const XI=new $d("16.2.2"),zd={};function L_(t,e=null,n=null,r){const i=function k_(t,e=null,n=null,r,i=new Set){const s=[n||pt,wI(t)];return r=r||("object"==typeof t?void 0:Yt(t)),new pu(s,e||fu(),r||null,i)}(t,e,n,r);return i.resolveInjectorInitializers(),i}let Ar=(()=>{var t;class e{static create(r,i){if(Array.isArray(r))return L_({name:""},i,r,"");{const s=r.name??"";return L_({name:s},r.parent,r.providers,s)}}}return(t=e).THROW_IF_NOT_FOUND=Uo,t.NULL=new Cd,t.\u0275prov=Et({token:t,providedIn:"any",factory:()=>dt(g_)}),t.__NG_ELEMENT_ID__=-1,e})(),Yd=(()=>{var t;class e{constructor(){this.callbacks=new Set,this.deferredCallbacks=new Set,this.renderDepth=0,this.runningCallbacks=!1}begin(){if(this.runningCallbacks)throw new ye(102,!1);this.renderDepth++}end(){if(this.renderDepth--,0===this.renderDepth)try{this.runningCallbacks=!0;for(const r of this.callbacks)r.invoke()}finally{this.runningCallbacks=!1;for(const r of this.deferredCallbacks)this.callbacks.add(r);this.deferredCallbacks.clear()}}register(r){(this.runningCallbacks?this.deferredCallbacks:this.callbacks).add(r)}unregister(r){this.callbacks.delete(r),this.deferredCallbacks.delete(r)}ngOnDestroy(){this.callbacks.clear(),this.deferredCallbacks.clear()}}return(t=e).\u0275prov=Et({token:t,providedIn:"root",factory:()=>new t}),e})();function fa(t){for(;t;){t[ze]|=64;const e=ia(t);if(Nh(t)&&!e)return t;t=e}return null}function qd(t){return t.ngOriginalError}class $i{constructor(){this._console=console}handleError(e){const n=this._findOriginalError(e);this._console.error("ERROR",e),n&&this._console.error("ORIGINAL ERROR",n)}_findOriginalError(e){let n=e&&qd(e);for(;n&&qd(n);)n=qd(n);return n||null}}const G_=new We("",{providedIn:"root",factory:()=>!1});class W_ extends Pm{constructor(){super(...arguments),this.consumerAllowSignalWrites=!1,this._lView=null}set lView(e){this._lView=e}onConsumerDependencyMayHaveChanged(){fa(this._lView)}onProducerUpdateValueVersion(){}get hasReadASignal(){return this.hasProducers}runInContext(e,n,r){const i=Qt(this);this.trackingVersion++;try{e(n,r)}finally{Qt(i)}}destroy(){this.trackingVersion++}}let Eu=null;function X_(){return Eu??=new W_,Eu}function Y_(t,e){return t[e]??X_()}function q_(t,e){const n=X_();n.hasReadASignal&&(t[e]=Eu,n.lView=t,Eu=new W_)}const Xe={};function Ke(t,e=ot.Default){const n=U();return null===n?dt(t,e):fy(nn(),n,Ue(t),e)}function bu(t,e,n,r,i,s,o,a,l,u,c){const h=e.blueprint.slice();return h[Ut]=i,h[ze]=140|r,(null!==u||t&&2048&t[ze])&&(h[ze]|=2048),Gm(h),h[Rt]=h[Ds]=t,h[Ht]=n,h[bs]=o||t&&t[bs],h[je]=a||t&&t[je],h[fi]=l||t&&t[fi]||null,h[ln]=s,h[Xo]=function EC(){return wC++}(),h[Yr]=c,h[Tm]=u,h[Vt]=2==e.type?t[Vt]:h,h}function Zs(t,e,n,r,i){let s=t.data[e];if(null===s)s=function Zd(t,e,n,r,i){const s=Ym(),o=function Uh(){return Be.lFrame.isParent}(),l=t.data[e]=function _1(t,e,n,r,i,s){let o=e?e.injectorIndex:-1,a=0;return function Is(){return null!==Be.skipHydrationRootTNode}()&&(a|=128),{type:n,index:r,insertBeforeIndex:null,injectorIndex:o,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:i,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,o?s:s&&s.parent,n,e,r,i);return null===t.firstChild&&(t.firstChild=l),null!==s&&(o?null==s.child&&null!==l.parent&&(s.child=l):null===s.next&&(s.next=l,l.prev=s)),l}(t,e,n,r,i),function xT(){return Be.lFrame.inI18n}()&&(s.flags|=32);else if(64&s.type){s.type=n,s.value=r,s.attrs=i;const o=function qo(){const t=Be.lFrame,e=t.currentTNode;return t.isParent?e:e.parent}();s.injectorIndex=null===o?-1:o.injectorIndex}return function Cr(t,e){const n=Be.lFrame;n.currentTNode=t,n.isParent=e}(s,!0),s}function pa(t,e,n,r){if(0===n)return-1;const i=e.length;for(let s=0;s<n;s++)e.push(r),t.blueprint.push(r),t.data.push(null);return i}function K_(t,e,n,r,i){const s=Y_(e,Ml),o=function _n(){return Be.lFrame.selectedIndex}(),a=2&r;try{if(Ui(-1),a&&e.length>it&&function Z_(t,e,n,r){if(!r)if(3==(3&e[ze])){const s=t.preOrderCheckHooks;null!==s&&Vl(e,s,n)}else{const s=t.preOrderHooks;null!==s&&Gl(e,s,0,n)}Ui(n)}(t,e,it,!1),Tr(a?2:0,i),a)s.runInContext(n,r,i);else{const u=Qt(null);try{n(r,i)}finally{Qt(u)}}}finally{a&&null===e[Ml]&&q_(e,Ml),Ui(o),Tr(a?3:1,i)}}function ef(t,e,n,r,i,s,o,a,l,u,c){const h=it+r,d=h+i,f=function d1(t,e){const n=[];for(let r=0;r<e;r++)n.push(r<t?null:Xe);return n}(h,d),p="function"==typeof u?u():u;return f[ue]={type:t,blueprint:f,template:n,queries:null,viewQuery:a,declTNode:e,data:f.slice().fill(null,h),bindingStartIndex:h,expandoStartIndex:d,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof s?s():s,pipeRegistry:"function"==typeof o?o():o,firstChild:null,schemas:l,consts:p,incompleteFirstPass:!1,ssrId:c}}let J_=t=>null;function ev(t,e,n,r){for(let i in t)if(t.hasOwnProperty(i)){n=null===n?{}:n;const s=t[i];null===r?tv(n,e,i,s):r.hasOwnProperty(i)&&tv(n,e,r[i],s)}return n}function tv(t,e,n,r){t.hasOwnProperty(n)?t[n].push(e,r):t[n]=[e,r]}function T1(t,e){null!==t.hostBindings&&t.hostBindings(1,e)}function A1(t,e,n){if(n){if(e.exportAs)for(let r=0;r<e.exportAs.length;r++)n[e.exportAs[r]]=t;nr(e)&&(n[""]=t)}}function R1(t,e,n,r,i){t.data[r]=i;const s=i.factory||(i.factory=Bi(i.type)),o=new Zo(s,nr(i),Ke);t.blueprint[r]=o,n[r]=o,function b1(t,e,n,r,i){const s=i.hostBindings;if(s){let o=t.hostBindingOpCodes;null===o&&(o=t.hostBindingOpCodes=[]);const a=~e.index;(function D1(t){let e=t.length;for(;e>0;){const n=t[--e];if("number"==typeof n&&n<0)return n}return 0})(o)!=a&&o.push(a),o.push(n,r,s)}}(t,e,r,pa(t,n,i.hostVars,Xe),i)}function iv(t,e,n,r,i){const s=Qt(null);try{const o=t.inputTransforms;null!==o&&o.hasOwnProperty(r)&&(i=o[r].call(e,i)),null!==t.setInput?t.setInput(e,i,n,r):e[r]=i}finally{Qt(s)}}function O1(t,e,n){let r=null,i=0;for(;i<n.length;){const s=n[i];if(0!==s)if(5!==s){if("number"==typeof s)break;if(t.hasOwnProperty(s)){null===r&&(r=[]);const o=t[s];for(let a=0;a<o.length;a+=2)if(o[a]===e){r.push(s,o[a+1],n[i+1]);break}}i+=2}else i+=2;else i+=4}return r}function ov(t,e){const n=t.contentQueries;if(null!==n)for(let r=0;r<n.length;r+=2){const s=n[r+1];if(-1!==s){const o=t.data[s];jh(n[r]),o.contentQueries(2,e[s],s)}}}function sf(t,e,n){jh(0);const r=Qt(null);try{e(t,n)}finally{Qt(r)}}function F1(t,e){const n=Ln(e,t),r=n[ue];!function L1(t,e){for(let n=e.length;n<t.blueprint.length;n++)e.push(t.blueprint[n])}(r,n);const i=n[Ut];null!==i&&null===n[Yr]&&(n[Yr]=Vd(i,n[fi])),af(r,n,n[Ht])}function af(t,e,n){$h(e);try{const r=t.viewQuery;null!==r&&sf(1,r,n);const i=t.template;null!==i&&K_(t,e,i,1,n),t.firstCreatePass&&(t.firstCreatePass=!1),t.staticContentQueries&&ov(t,e),t.staticViewQueries&&sf(2,t.viewQuery,n);const s=t.components;null!==s&&function k1(t,e){for(let n=0;n<e.length;n++)F1(t,e[n])}(e,s)}catch(r){throw t.firstCreatePass&&(t.incompleteFirstPass=!0,t.firstCreatePass=!1),r}finally{e[ze]&=-5,zh()}}let hv=(()=>{var t;class e{constructor(){this.all=new Set,this.queue=new Map}create(r,i,s){const o=typeof Zone>"u"?null:Zone.current,a=new ZS(r,c=>{this.all.has(c)&&this.queue.set(c,o)},s);let l;this.all.add(a),a.notify();const u=()=>{a.cleanup(),l?.(),this.all.delete(a),this.queue.delete(a)};return l=i?.onDestroy(u),{destroy:u}}flush(){if(0!==this.queue.size)for(const[r,i]of this.queue)this.queue.delete(r),i?i.run(()=>r.run()):r.run()}get isQueueEmpty(){return 0===this.queue.size}}return(t=e).\u0275prov=Et({token:t,providedIn:"root",factory:()=>new t}),e})();function ga(t,e,n,r,i=!1){for(;null!==n;){const s=e[n.index];if(null!==s&&r.push(It(s)),Cn(s)){for(let a=tn;a<s.length;a++){const l=s[a],u=l[ue].firstChild;null!==u&&ga(l[ue],l,u,r)}s[Dr]!==s[Ut]&&r.push(s[Dr])}const o=n.type;if(8&o)ga(t,e,n.child,r);else if(32&o){const a=dd(n,e);let l;for(;l=a();)r.push(l)}else if(16&o){const a=Qy(e,n);if(Array.isArray(a))r.push(...a);else{const l=ia(e[Vt]);ga(l[ue],l,a,r,!0)}}n=i?n.projectionNext:n.next}return r}function Tu(t,e,n,r=!0){const i=e[bs],s=i.rendererFactory,o=i.afterRenderEventManager;s.begin?.(),o?.begin();try{dv(t,e,t.template,n)}catch(l){throw r&&function cv(t,e){const n=t[fi],r=n?n.get($i,null):null;r&&r.handleError(e)}(e,l),l}finally{s.end?.(),i.effectManager?.flush(),o?.end()}}function dv(t,e,n,r){const i=e[ze];if(256!=(256&i)){e[bs].effectManager?.flush(),$h(e);try{Gm(e),function Zm(t){return Be.lFrame.bindingIndex=t}(t.bindingStartIndex),null!==n&&K_(t,e,n,2,r);const o=3==(3&i);if(o){const u=t.preOrderCheckHooks;null!==u&&Vl(e,u,null)}else{const u=t.preOrderHooks;null!==u&&Gl(e,u,0,null),Wh(e,0)}if(function H1(t){for(let e=Hy(t);null!==e;e=Vy(e)){if(!e[Cm])continue;const n=e[Ts];for(let r=0;r<n.length;r++){aT(n[r])}}}(e),fv(e,2),null!==t.contentQueries&&ov(t,e),o){const u=t.contentCheckHooks;null!==u&&Vl(e,u)}else{const u=t.contentHooks;null!==u&&Gl(e,u,1),Wh(e,1)}!function h1(t,e){const n=t.hostBindingOpCodes;if(null===n)return;const r=Y_(e,Rl);try{for(let i=0;i<n.length;i++){const s=n[i];if(s<0)Ui(~s);else{const o=s,a=n[++i],l=n[++i];wT(a,o),r.runInContext(l,2,e[o])}}}finally{null===e[Rl]&&q_(e,Rl),Ui(-1)}}(t,e);const a=t.components;null!==a&&gv(e,a,0);const l=t.viewQuery;if(null!==l&&sf(2,l,r),o){const u=t.viewCheckHooks;null!==u&&Vl(e,u)}else{const u=t.viewHooks;null!==u&&Gl(e,u,2),Wh(e,2)}!0===t.firstUpdatePass&&(t.firstUpdatePass=!1),e[ze]&=-73,jm(e)}finally{zh()}}}function fv(t,e){for(let n=Hy(t);null!==n;n=Vy(n))for(let r=tn;r<n.length;r++)pv(n[r],e)}function V1(t,e,n){pv(Ln(e,t),n)}function pv(t,e){if(!function sT(t){return 128==(128&t[ze])}(t))return;const n=t[ue];if(80&t[ze]&&0===e||1024&t[ze]||2===e)dv(n,t,n.template,t[Ht]);else if(t[$o]>0){fv(t,1);const i=t[ue].components;null!==i&&gv(t,i,1)}}function gv(t,e,n){for(let r=0;r<e.length;r++)V1(t,e[r],n)}class ma{get rootNodes(){const e=this._lView,n=e[ue];return ga(n,e,n.firstChild,[])}constructor(e,n){this._lView=e,this._cdRefInjectingView=n,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[Ht]}set context(e){this._lView[Ht]=e}get destroyed(){return 256==(256&this._lView[ze])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const e=this._lView[Rt];if(Cn(e)){const n=e[8],r=n?n.indexOf(this):-1;r>-1&&(function ru(t,e){if(t.length<=tn)return;const n=tn+e,r=t[n];if(r){const i=r[Wo];null!==i&&i!==t&&$y(i,r),e>0&&(t[n-1][tr]=r[tr]);const s=Xl(t,tn+e);!function OC(t,e){oa(t,e,e[je],2,null,null),e[Ut]=null,e[ln]=null}(r[ue],r);const o=s[br];null!==o&&o.detachView(s[ue]),r[Rt]=null,r[tr]=null,r[ze]&=-129}return r}(e,r),Xl(n,r))}this._attachedToViewContainer=!1}!function pd(t,e){if(!(256&e[ze])){const n=e[je];e[Ml]?.destroy(),e[Rl]?.destroy(),n.destroyNode&&oa(t,e,n,3,null,null),function kC(t){let e=t[zo];if(!e)return gd(t[ue],t);for(;e;){let n=null;if(Tn(e))n=e[zo];else{const r=e[tn];r&&(n=r)}if(!n){for(;e&&!e[tr]&&e!==t;)Tn(e)&&gd(e[ue],e),e=e[Rt];null===e&&(e=t),Tn(e)&&gd(e[ue],e),n=e&&e[tr]}e=n}}(e)}}(this._lView[ue],this._lView)}onDestroy(e){!function zm(t,e){if(256==(256&t[ze]))throw new ye(911,!1);null===t[pi]&&(t[pi]=[]),t[pi].push(e)}(this._lView,e)}markForCheck(){fa(this._cdRefInjectingView||this._lView)}detach(){this._lView[ze]&=-129}reattach(){this._lView[ze]|=128}detectChanges(){Tu(this._lView[ue],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new ye(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function LC(t,e){oa(t,e,e[je],2,null,null)}(this._lView[ue],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new ye(902,!1);this._appRef=e}}class G1 extends ma{constructor(e){super(e),this._view=e}detectChanges(){const e=this._view;Tu(e[ue],e,e[Ht],!1)}checkNoChanges(){}get context(){return null}}class mv extends xu{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){const n=at(e);return new ya(n,this.ngModule)}}function yv(t){const e=[];for(let n in t)t.hasOwnProperty(n)&&e.push({propName:t[n],templateName:n});return e}class $1{constructor(e,n){this.injector=e,this.parentInjector=n}get(e,n,r){r=Tl(r);const i=this.injector.get(e,zd,r);return i!==zd||n===zd?i:this.parentInjector.get(e,n,r)}}class ya extends A_{get inputs(){const e=this.componentDef,n=e.inputTransforms,r=yv(e.inputs);if(null!==n)for(const i of r)n.hasOwnProperty(i.propName)&&(i.transform=n[i.propName]);return r}get outputs(){return yv(this.componentDef.outputs)}constructor(e,n){super(),this.componentDef=e,this.ngModule=n,this.componentType=e.type,this.selector=function RS(t){return t.map(MS).join(",")}(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!n}create(e,n,r,i){let s=(i=i||this.ngModule)instanceof Qr?i:i?.injector;s&&null!==this.componentDef.getStandaloneInjector&&(s=this.componentDef.getStandaloneInjector(s)||s);const o=s?new $1(e,s):e,a=o.get(R_,null);if(null===a)throw new ye(407,!1);const h={rendererFactory:a,sanitizer:o.get(WI,null),effectManager:o.get(hv,null),afterRenderEventManager:o.get(Yd,null)},d=a.createRenderer(null,this.componentDef),f=this.componentDef.selectors[0][0]||"div",p=r?function f1(t,e,n,r){const s=r.get(G_,!1)||n===Jn.ShadowDom,o=t.selectRootElement(e,s);return function p1(t){J_(t)}(o),o}(d,r,this.componentDef.encapsulation,o):function nu(t,e,n){return t.createElement(e,n)}(d,f,function j1(t){const e=t.toLowerCase();return"svg"===e?"svg":"math"===e?"math":null}(f)),_=this.componentDef.signals?4608:this.componentDef.onPush?576:528;let v=null;null!==p&&(v=Vd(p,o,!0));const D=ef(0,null,null,1,0,null,null,null,null,null,null),A=bu(null,D,null,_,null,null,h,d,o,null,v);let $,ge;$h(A);try{const Q=this.componentDef;let J,Ve=null;Q.findHostDirectiveDefs?(J=[],Ve=new Map,Q.findHostDirectiveDefs(Q,J,Ve),J.push(Q)):J=[Q];const ee=function W1(t,e){const n=t[ue],r=it;return t[r]=e,Zs(n,r,2,"#host",null)}(A,p),he=function X1(t,e,n,r,i,s,o){const a=i[ue];!function Y1(t,e,n,r){for(const i of t)e.mergedAttrs=Go(e.mergedAttrs,i.hostAttrs);null!==e.mergedAttrs&&(function Su(t,e,n){let r=n?t.styles:null,i=n?t.classes:null,s=0;if(null!==e)for(let o=0;o<e.length;o++){const a=e[o];"number"==typeof a?s=a:1==s?i=ph(i,a):2==s&&(r=ph(r,a+": "+e[++o]+";"))}n?t.styles=r:t.stylesWithoutHost=r,n?t.classes=i:t.classesWithoutHost=i}(e,e.mergedAttrs,!0),null!==n&&function n_(t,e,n){const{mergedAttrs:r,classes:i,styles:s}=n;null!==r&&Mh(t,e,r),null!==i&&t_(t,e,i),null!==s&&function XC(t,e,n){t.setAttribute(e,"style",n)}(t,e,s)}(r,n,e))}(r,t,e,o);let l=null;null!==e&&(l=Vd(e,i[fi]));const u=s.rendererFactory.createRenderer(e,n);let c=16;n.signals?c=4096:n.onPush&&(c=64);const h=bu(i,function Q_(t){const e=t.tView;return null===e||e.incompleteFirstPass?t.tView=ef(1,null,t.template,t.decls,t.vars,t.directiveDefs,t.pipeDefs,t.viewQuery,t.schemas,t.consts,t.id):e}(n),null,c,i[t.index],t,s,u,null,null,l);return a.firstCreatePass&&function nf(t,e,n){e.componentOffset=n,(t.components??=[]).push(e.index)}(a,t,r.length-1),function Du(t,e){return t[zo]?t[13][tr]=e:t[zo]=e,t[13]=e,e}(i,h),i[t.index]=h}(ee,p,Q,J,A,h,d);ge=function Vm(t,e){return t.data[e]}(D,it),p&&function Z1(t,e,n,r){if(r)Mh(t,n,["ng-version",XI.full]);else{const{attrs:i,classes:s}=function PS(t){const e=[],n=[];let r=1,i=2;for(;r<t.length;){let s=t[r];if("string"==typeof s)2===i?""!==s&&e.push(s,t[++r]):8===i&&n.push(s);else{if(!er(i))break;i=s}r++}return{attrs:e,classes:n}}(e.selectors[0]);i&&Mh(t,n,i),s&&s.length>0&&t_(t,n,s.join(" "))}}(d,Q,p,r),void 0!==n&&function K1(t,e,n){const r=t.projection=[];for(let i=0;i<e.length;i++){const s=n[i];r.push(null!=s?Array.from(s):null)}}(ge,this.ngContentSelectors,n),$=function q1(t,e,n,r,i,s){const o=nn(),a=i[ue],l=In(o,i);!function nv(t,e,n,r,i,s){for(let u=0;u<r.length;u++)Kh($l(n,e),t,r[u].type);!function M1(t,e,n){t.flags|=1,t.directiveStart=e,t.directiveEnd=e+n,t.providerIndexes=e}(n,t.data.length,r.length);for(let u=0;u<r.length;u++){const c=r[u];c.providersResolver&&c.providersResolver(c)}let o=!1,a=!1,l=pa(t,e,r.length,null);for(let u=0;u<r.length;u++){const c=r[u];n.mergedAttrs=Go(n.mergedAttrs,c.hostAttrs),R1(t,n,e,l,c),A1(l,c,i),null!==c.contentQueries&&(n.flags|=4),(null!==c.hostBindings||null!==c.hostAttrs||0!==c.hostVars)&&(n.flags|=64);const h=c.type.prototype;!o&&(h.ngOnChanges||h.ngOnInit||h.ngDoCheck)&&((t.preOrderHooks??=[]).push(n.index),o=!0),!a&&(h.ngOnChanges||h.ngDoCheck)&&((t.preOrderCheckHooks??=[]).push(n.index),a=!0),l++}!function v1(t,e,n){const i=e.directiveEnd,s=t.data,o=e.attrs,a=[];let l=null,u=null;for(let c=e.directiveStart;c<i;c++){const h=s[c],d=n?n.get(h):null,p=d?d.outputs:null;l=ev(h.inputs,c,l,d?d.inputs:null),u=ev(h.outputs,c,u,p);const g=null===l||null===o||ym(e)?null:O1(l,c,o);a.push(g)}null!==l&&(l.hasOwnProperty("class")&&(e.flags|=8),l.hasOwnProperty("style")&&(e.flags|=16)),e.initialInputs=a,e.inputs=l,e.outputs=u}(t,n,s)}(a,i,o,n,null,r);for(let c=0;c<n.length;c++)un(Hi(i,a,o.directiveStart+c,o),i);(function rv(t,e,n){const r=n.directiveStart,i=n.directiveEnd,s=n.index,o=function ET(){return Be.lFrame.currentDirectiveIndex}();try{Ui(s);for(let a=r;a<i;a++){const l=t.data[a],u=e[a];Vh(a),(null!==l.hostBindings||0!==l.hostVars||null!==l.hostAttrs)&&T1(l,u)}}finally{Ui(-1),Vh(o)}})(a,i,o),l&&un(l,i);const u=Hi(i,a,o.directiveStart+o.componentOffset,o);if(t[Ht]=i[Ht]=u,null!==s)for(const c of s)c(u,e);return function Kd(t,e,n){if(function Ph(t){return 0!=(4&t.flags)}(e)){const r=Qt(null);try{const s=e.directiveEnd;for(let o=e.directiveStart;o<s;o++){const a=t.data[o];a.contentQueries&&a.contentQueries(1,n[o],o)}}finally{Qt(r)}}}(a,o,t),u}(he,Q,J,Ve,A,[Q1]),af(D,A,null)}finally{zh()}return new z1(this.componentType,$,Xs(ge,A),A,ge)}}class z1 extends HI{constructor(e,n,r,i,s){super(),this.location=r,this._rootLView=i,this._tNode=s,this.previousInputValues=null,this.instance=n,this.hostView=this.changeDetectorRef=new G1(i),this.componentType=e}setInput(e,n){const r=this._tNode.inputs;let i;if(null!==r&&(i=r[e])){if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),n))return;const s=this._rootLView;(function of(t,e,n,r,i){for(let s=0;s<n.length;){const o=n[s++],a=n[s++];iv(t.data[o],e[o],r,a,i)}})(s[ue],s,i,e,n),this.previousInputValues.set(e,n),fa(Ln(this._tNode.index,s))}}get injector(){return new vn(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}}function Q1(){const t=nn();!function Hl(t,e){for(let n=e.directiveStart,r=e.directiveEnd;n<r;n++){const s=t.data[n].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:a,ngAfterViewInit:l,ngAfterViewChecked:u,ngOnDestroy:c}=s;o&&(t.contentHooks??=[]).push(-n,o),a&&((t.contentHooks??=[]).push(n,a),(t.contentCheckHooks??=[]).push(n,a)),l&&(t.viewHooks??=[]).push(-n,l),u&&((t.viewHooks??=[]).push(n,u),(t.viewCheckHooks??=[]).push(n,u)),null!=c&&(t.destroyHooks??=[]).push(n,c)}}(U()[ue],t)}function vf(t){return!!t&&"function"==typeof t.then}function jv(t){return!!t&&"function"==typeof t.subscribe}const lo="en-US";let j0=lo;class Yi{}class gx extends Yi{constructor(e){super(),this.componentFactoryResolver=new mv(this),this.instance=null;const n=new pu([...e.providers,{provide:Yi,useValue:this},{provide:xu,useValue:this.componentFactoryResolver}],e.parent||fu(),e.debugName,new Set(["environment"]));this.injector=n,e.runEnvironmentInitializers&&n.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}}let VR=(()=>{var t;class e{constructor(r){this._injector=r,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(r){if(!r.standalone)return null;if(!this.cachedInjectors.has(r)){const i=__(0,r.type),s=i.length>0?function HR(t,e,n=null){return new gx({providers:t,parent:e,debugName:n,runEnvironmentInitializers:!0}).injector}([i],this._injector,`Standalone[${r.type.name}]`):null;this.cachedInjectors.set(r,s)}return this.cachedInjectors.get(r)}ngOnDestroy(){try{for(const r of this.cachedInjectors.values())null!==r&&r.destroy()}finally{this.cachedInjectors.clear()}}}return(t=e).\u0275prov=Et({token:t,providedIn:"environment",factory:()=>new t(dt(Qr))}),e})();function mx(t){t.getStandaloneInjector=e=>e.get(VR).getOrCreateStandaloneInjector(t)}function Ff(t){return e=>{setTimeout(t,void 0,e)}}const Or=class fP extends F{constructor(e=!1){super(),this.__isAsync=e}emit(e){super.next(e)}subscribe(e,n,r){let i=e,s=n||(()=>null),o=r;if(e&&"object"==typeof e){const l=e;i=l.next?.bind(l),s=l.error?.bind(l),o=l.complete?.bind(l)}this.__isAsync&&(s=Ff(s),i&&(i=Ff(i)),o&&(o=Ff(o)));const a=super.subscribe({next:i,error:s,complete:o});return e instanceof ie&&e.add(a),a}},aN=new We("Application Initializer");let Xf=(()=>{var t;class e{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((r,i)=>{this.resolve=r,this.reject=i}),this.appInits=Ct(aN,{optional:!0})??[]}runInitializers(){if(this.initialized)return;const r=[];for(const s of this.appInits){const o=s();if(vf(o))r.push(o);else if(jv(o)){const a=new Promise((l,u)=>{o.subscribe({complete:l,error:u})});r.push(a)}}const i=()=>{this.done=!0,this.resolve()};Promise.all(r).then(()=>{i()}).catch(s=>{this.reject(s)}),0===r.length&&i(),this.initialized=!0}}return(t=e).\u0275fac=function(r){return new(r||t)},t.\u0275prov=Et({token:t,factory:t.\u0275fac,providedIn:"root"}),e})();const ni=new We("LocaleId",{providedIn:"root",factory:()=>Ct(ni,ot.Optional|ot.SkipSelf)||function uN(){return typeof $localize<"u"&&$localize.locale||lo}()});let dN=(()=>{var t;class e{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new W(!1)}add(){this.hasPendingTasks.next(!0);const r=this.taskId++;return this.pendingTasks.add(r),r}remove(r){this.pendingTasks.delete(r),0===this.pendingTasks.size&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this.hasPendingTasks.next(!1)}}return(t=e).\u0275fac=function(r){return new(r||t)},t.\u0275prov=Et({token:t,factory:t.\u0275fac,providedIn:"root"}),e})();function lw(...t){}class $t{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:n=!1,shouldCoalesceRunChangeDetection:r=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Or(!1),this.onMicrotaskEmpty=new Or(!1),this.onStable=new Or(!1),this.onError=new Or(!1),typeof Zone>"u")throw new ye(908,!1);Zone.assertZonePatched();const i=this;i._nesting=0,i._outer=i._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(i._inner=i._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(i._inner=i._inner.fork(Zone.longStackTraceZoneSpec)),i.shouldCoalesceEventChangeDetection=!r&&n,i.shouldCoalesceRunChangeDetection=r,i.lastRequestAnimationFrameId=-1,i.nativeRequestAnimationFrame=function NN(){const t="function"==typeof bt.requestAnimationFrame;let e=bt[t?"requestAnimationFrame":"setTimeout"],n=bt[t?"cancelAnimationFrame":"clearTimeout"];if(typeof Zone<"u"&&e&&n){const r=e[Zone.__symbol__("OriginalDelegate")];r&&(e=r);const i=n[Zone.__symbol__("OriginalDelegate")];i&&(n=i)}return{nativeRequestAnimationFrame:e,nativeCancelAnimationFrame:n}}().nativeRequestAnimationFrame,function LN(t){const e=()=>{!function FN(t){t.isCheckStableRunning||-1!==t.lastRequestAnimationFrameId||(t.lastRequestAnimationFrameId=t.nativeRequestAnimationFrame.call(bt,()=>{t.fakeTopEventTask||(t.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{t.lastRequestAnimationFrameId=-1,Kf(t),t.isCheckStableRunning=!0,Zf(t),t.isCheckStableRunning=!1},void 0,()=>{},()=>{})),t.fakeTopEventTask.invoke()}),Kf(t))}(t)};t._inner=t._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(n,r,i,s,o,a)=>{try{return uw(t),n.invokeTask(i,s,o,a)}finally{(t.shouldCoalesceEventChangeDetection&&"eventTask"===s.type||t.shouldCoalesceRunChangeDetection)&&e(),cw(t)}},onInvoke:(n,r,i,s,o,a,l)=>{try{return uw(t),n.invoke(i,s,o,a,l)}finally{t.shouldCoalesceRunChangeDetection&&e(),cw(t)}},onHasTask:(n,r,i,s)=>{n.hasTask(i,s),r===i&&("microTask"==s.change?(t._hasPendingMicrotasks=s.microTask,Kf(t),Zf(t)):"macroTask"==s.change&&(t.hasPendingMacrotasks=s.macroTask))},onHandleError:(n,r,i,s)=>(n.handleError(i,s),t.runOutsideAngular(()=>t.onError.emit(s)),!1)})}(i)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!$t.isInAngularZone())throw new ye(909,!1)}static assertNotInAngularZone(){if($t.isInAngularZone())throw new ye(909,!1)}run(e,n,r){return this._inner.run(e,n,r)}runTask(e,n,r,i){const s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+i,e,ON,lw,lw);try{return s.runTask(o,n,r)}finally{s.cancelTask(o)}}runGuarded(e,n,r){return this._inner.runGuarded(e,n,r)}runOutsideAngular(e){return this._outer.run(e)}}const ON={};function Zf(t){if(0==t._nesting&&!t.hasPendingMicrotasks&&!t.isStable)try{t._nesting++,t.onMicrotaskEmpty.emit(null)}finally{if(t._nesting--,!t.hasPendingMicrotasks)try{t.runOutsideAngular(()=>t.onStable.emit(null))}finally{t.isStable=!0}}}function Kf(t){t.hasPendingMicrotasks=!!(t._hasPendingMicrotasks||(t.shouldCoalesceEventChangeDetection||t.shouldCoalesceRunChangeDetection)&&-1!==t.lastRequestAnimationFrameId)}function uw(t){t._nesting++,t.isStable&&(t.isStable=!1,t.onUnstable.emit(null))}function cw(t){t._nesting--,Zf(t)}const hw=new We("",{providedIn:"root",factory:dw});function dw(){const t=Ct($t);let e=!0;return eS(new x(i=>{e=t.isStable&&!t.hasPendingMacrotasks&&!t.hasPendingMicrotasks,t.runOutsideAngular(()=>{i.next(e),i.complete()})}),new x(i=>{let s;t.runOutsideAngular(()=>{s=t.onStable.subscribe(()=>{$t.assertNotInAngularZone(),queueMicrotask(()=>{!e&&!t.hasPendingMacrotasks&&!t.hasPendingMicrotasks&&(e=!0,i.next(!0))})})});const o=t.onUnstable.subscribe(()=>{$t.assertInAngularZone(),e&&(e=!1,t.runOutsideAngular(()=>{i.next(!1)}))});return()=>{s.unsubscribe(),o.unsubscribe()}}).pipe(tm()))}const fw=new We("");let xi=null;const tp=new We("PlatformDestroyListeners"),gw=new We("appBootstrapListener");function jN(t){try{const{rootComponent:e,appProviders:n,platformProviders:r}=t,i=function GN(t=[]){if(xi)return xi;const e=function _w(t=[],e){return Ar.create({name:e,providers:[{provide:Md,useValue:"platform"},{provide:tp,useValue:new Set([()=>xi=null])},...t]})}(t);return xi=e,function mw(){!function YS(t){Nm=t}(()=>{throw new ye(600,!1)})}(),function yw(t){t.get(b_,null)?.forEach(n=>n())}(e),e}(r),s=[YN(),...n||[]],a=new gx({providers:s,parent:i,debugName:"",runEnvironmentInitializers:!1}).injector,l=a.get($t);return l.run(()=>{a.resolveInjectorInitializers();const u=a.get($i,null);let c;l.runOutsideAngular(()=>{c=l.onError.subscribe({next:f=>{u.handleError(f)}})});const h=()=>a.destroy(),d=i.get(tp);return d.add(h),a.onDestroy(()=>{c.unsubscribe(),d.delete(h)}),function ww(t,e,n){try{const r=n();return vf(r)?r.catch(i=>{throw e.runOutsideAngular(()=>t.handleError(i)),i}):r}catch(r){throw e.runOutsideAngular(()=>t.handleError(r)),r}}(u,l,()=>{const f=a.get(Xf);return f.runInitializers(),f.donePromise.then(()=>{!function $0(t){Gn(t,"Expected localeId to be defined"),"string"==typeof t&&(j0=t.toLowerCase().replace(/_/g,"-"))}(a.get(ni,lo)||lo);const g=a.get(Pa);return void 0!==e&&g.bootstrap(e),g})})})}catch(e){return Promise.reject(e)}}let Pa=(()=>{var t;class e{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=Ct(Dw),this.zoneIsStable=Ct(hw),this.componentTypes=[],this.components=[],this.isStable=Ct(dN).hasPendingTasks.pipe(function nS(t,e){return q((n,r)=>{let i=null,s=0,o=!1;const a=()=>o&&!i&&r.complete();n.subscribe(ae(r,l=>{i?.unsubscribe();let u=0;const c=s++;Qn(t(l,c)).subscribe(i=ae(r,h=>r.next(e?e(l,h,c,u++):h),()=>{i=null,a()}))},()=>{o=!0,a()}))})}(r=>r?function tS(...t){return em(t,Zg(t))}(!1):this.zoneIsStable),function rS(t,e=j){return t=t??iS,q((n,r)=>{let i,s=!0;n.subscribe(ae(r,o=>{const a=e(o);(s||!t(i,a))&&(s=!1,i=a,r.next(o))}))})}(),tm()),this._injector=Ct(Qr)}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(r,i){const s=r instanceof A_;if(!this._injector.get(Xf).done)throw!s&&function jo(t){const e=at(t)||en(t)||mn(t);return null!==e&&e.standalone}(r),new ye(405,!1);let a;a=s?r:this._injector.get(xu).resolveComponentFactory(r),this.componentTypes.push(a.componentType);const l=function HN(t){return t.isBoundToModule}(a)?void 0:this._injector.get(Yi),c=a.create(Ar.NULL,[],i||a.selector,l),h=c.location.nativeElement,d=c.injector.get(fw,null);return d?.registerApplication(h),c.onDestroy(()=>{this.detachView(c.hostView),$u(this.components,c),d?.unregisterApplication(h)}),this._loadComponent(c),c}tick(){if(this._runningTick)throw new ye(101,!1);try{this._runningTick=!0;for(let r of this._views)r.detectChanges()}catch(r){this.internalErrorHandler(r)}finally{this._runningTick=!1}}attachView(r){const i=r;this._views.push(i),i.attachToAppRef(this)}detachView(r){const i=r;$u(this._views,i),i.detachFromAppRef()}_loadComponent(r){this.attachView(r.hostView),this.tick(),this.components.push(r);const i=this._injector.get(gw,[]);i.push(...this._bootstrapListeners),i.forEach(s=>s(r))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(r=>r()),this._views.slice().forEach(r=>r.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(r){return this._destroyListeners.push(r),()=>$u(this._destroyListeners,r)}destroy(){if(this._destroyed)throw new ye(406,!1);const r=this._injector;r.destroy&&!r.destroyed&&r.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}}return(t=e).\u0275fac=function(r){return new(r||t)},t.\u0275prov=Et({token:t,factory:t.\u0275fac,providedIn:"root"}),e})();function $u(t,e){const n=t.indexOf(e);n>-1&&t.splice(n,1)}const Dw=new We("",{providedIn:"root",factory:()=>Ct($i).handleError.bind(void 0)});function WN(){const t=Ct($t),e=Ct($i);return n=>t.runOutsideAngular(()=>e.handleError(n))}let XN=(()=>{var t;class e{constructor(){this.zone=Ct($t),this.applicationRef=Ct(Pa)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}}return(t=e).\u0275fac=function(r){return new(r||t)},t.\u0275prov=Et({token:t,factory:t.\u0275fac,providedIn:"root"}),e})();function Sw(t){return[{provide:$t,useFactory:t},{provide:cu,multi:!0,useFactory:()=>{const e=Ct(XN,{optional:!0});return()=>e.initialize()}},{provide:Dw,useFactory:WN},{provide:hw,useFactory:dw}]}function YN(t){return function y_(t){return{\u0275providers:t}}([[],Sw(()=>new $t(function xw(t){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:t?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:t?.runCoalescing??!1}}(t)))])}let Cw=(()=>{class e{}return e.__NG_ELEMENT_ID__=qN,e})();function qN(t){return function ZN(t,e,n){if(ki(t)&&!n){const r=Ln(t.index,e);return new ma(r,r)}return 47&t.type?new ma(e[Vt],e):null}(nn(),U(),16==(16&t))}let lp=null;function up(){return lp}class wO{}const Zi=new We("DocumentToken");function iE(t){return"server"===t}class hL extends wO{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class Tp extends hL{static makeCurrent(){!function xO(t){lp||(lp=t)}(new Tp)}onAndCancel(e,n,r){return e.addEventListener(n,r),()=>{e.removeEventListener(n,r)}}dispatchEvent(e,n){e.dispatchEvent(n)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,n){return(n=n||this.getDefaultDocument()).createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,n){return"window"===n?window:"document"===n?e:"body"===n?e.body:null}getBaseHref(e){const n=function dL(){return ka=ka||document.querySelector("base"),ka?ka.getAttribute("href"):null}();return null==n?null:function fL(t){ac=ac||document.createElement("a"),ac.setAttribute("href",t);const e=ac.pathname;return"/"===e.charAt(0)?e:`/${e}`}(n)}resetBaseElement(){ka=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return function aF(t,e){e=encodeURIComponent(e);for(const n of t.split(";")){const r=n.indexOf("="),[i,s]=-1==r?[n,""]:[n.slice(0,r),n.slice(r+1)];if(i.trim()===e)return decodeURIComponent(s)}return null}(document.cookie,e)}}let ac,ka=null,gL=(()=>{var t;class e{build(){return new XMLHttpRequest}}return(t=e).\u0275fac=function(r){return new(r||t)},t.\u0275prov=Et({token:t,factory:t.\u0275fac}),e})();const Cp=new We("EventManagerPlugins");let uE=(()=>{var t;class e{constructor(r,i){this._zone=i,this._eventNameToPlugin=new Map,r.forEach(s=>{s.manager=this}),this._plugins=r.slice().reverse()}addEventListener(r,i,s){return this._findPluginFor(i).addEventListener(r,i,s)}getZone(){return this._zone}_findPluginFor(r){let i=this._eventNameToPlugin.get(r);if(i)return i;if(i=this._plugins.find(o=>o.supports(r)),!i)throw new ye(5101,!1);return this._eventNameToPlugin.set(r,i),i}}return(t=e).\u0275fac=function(r){return new(r||t)(dt(Cp),dt($t))},t.\u0275prov=Et({token:t,factory:t.\u0275fac}),e})();class cE{constructor(e){this._doc=e}}const Ip="ng-app-id";let hE=(()=>{var t;class e{constructor(r,i,s,o={}){this.doc=r,this.appId=i,this.nonce=s,this.platformId=o,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=iE(o),this.resetHostNodes()}addStyles(r){for(const i of r)1===this.changeUsageCount(i,1)&&this.onStyleAdded(i)}removeStyles(r){for(const i of r)this.changeUsageCount(i,-1)<=0&&this.onStyleRemoved(i)}ngOnDestroy(){const r=this.styleNodesInDOM;r&&(r.forEach(i=>i.remove()),r.clear());for(const i of this.getAllStyles())this.onStyleRemoved(i);this.resetHostNodes()}addHost(r){this.hostNodes.add(r);for(const i of this.getAllStyles())this.addStyleToHost(r,i)}removeHost(r){this.hostNodes.delete(r)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(r){for(const i of this.hostNodes)this.addStyleToHost(i,r)}onStyleRemoved(r){const i=this.styleRef;i.get(r)?.elements?.forEach(s=>s.remove()),i.delete(r)}collectServerRenderedStyles(){const r=this.doc.head?.querySelectorAll(`style[${Ip}="${this.appId}"]`);if(r?.length){const i=new Map;return r.forEach(s=>{null!=s.textContent&&i.set(s.textContent,s)}),i}return null}changeUsageCount(r,i){const s=this.styleRef;if(s.has(r)){const o=s.get(r);return o.usage+=i,o.usage}return s.set(r,{usage:i,elements:[]}),i}getStyleElement(r,i){const s=this.styleNodesInDOM,o=s?.get(i);if(o?.parentNode===r)return s.delete(i),o.removeAttribute(Ip),o;{const a=this.doc.createElement("style");return this.nonce&&a.setAttribute("nonce",this.nonce),a.textContent=i,this.platformIsServer&&a.setAttribute(Ip,this.appId),a}}addStyleToHost(r,i){const s=this.getStyleElement(r,i);r.appendChild(s);const o=this.styleRef,a=o.get(i)?.elements;a?a.push(s):o.set(i,{elements:[s],usage:1})}resetHostNodes(){const r=this.hostNodes;r.clear(),r.add(this.doc.head)}}return(t=e).\u0275fac=function(r){return new(r||t)(dt(Zi),dt(Od),dt(D_,8),dt(zs))},t.\u0275prov=Et({token:t,factory:t.\u0275fac}),e})();const Ap={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},Mp=/%COMP%/g,vL=new We("RemoveStylesOnCompDestroy",{providedIn:"root",factory:()=>!1});function fE(t,e){return e.map(n=>n.replace(Mp,t))}let pE=(()=>{var t;class e{constructor(r,i,s,o,a,l,u,c=null){this.eventManager=r,this.sharedStylesHost=i,this.appId=s,this.removeStylesOnCompDestroy=o,this.doc=a,this.platformId=l,this.ngZone=u,this.nonce=c,this.rendererByCompId=new Map,this.platformIsServer=iE(l),this.defaultRenderer=new Rp(r,a,u,this.platformIsServer)}createRenderer(r,i){if(!r||!i)return this.defaultRenderer;this.platformIsServer&&i.encapsulation===Jn.ShadowDom&&(i={...i,encapsulation:Jn.Emulated});const s=this.getOrCreateRenderer(r,i);return s instanceof mE?s.applyToHost(r):s instanceof Pp&&s.applyStyles(),s}getOrCreateRenderer(r,i){const s=this.rendererByCompId;let o=s.get(i.id);if(!o){const a=this.doc,l=this.ngZone,u=this.eventManager,c=this.sharedStylesHost,h=this.removeStylesOnCompDestroy,d=this.platformIsServer;switch(i.encapsulation){case Jn.Emulated:o=new mE(u,c,i,this.appId,h,a,l,d);break;case Jn.ShadowDom:return new bL(u,c,r,i,a,l,this.nonce,d);default:o=new Pp(u,c,i,h,a,l,d)}s.set(i.id,o)}return o}ngOnDestroy(){this.rendererByCompId.clear()}}return(t=e).\u0275fac=function(r){return new(r||t)(dt(uE),dt(hE),dt(Od),dt(vL),dt(Zi),dt(zs),dt($t),dt(D_))},t.\u0275prov=Et({token:t,factory:t.\u0275fac}),e})();class Rp{constructor(e,n,r,i){this.eventManager=e,this.doc=n,this.ngZone=r,this.platformIsServer=i,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(e,n){return n?this.doc.createElementNS(Ap[n]||n,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,n){(gE(e)?e.content:e).appendChild(n)}insertBefore(e,n,r){e&&(gE(e)?e.content:e).insertBefore(n,r)}removeChild(e,n){e&&e.removeChild(n)}selectRootElement(e,n){let r="string"==typeof e?this.doc.querySelector(e):e;if(!r)throw new ye(-5104,!1);return n||(r.textContent=""),r}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,n,r,i){if(i){n=i+":"+n;const s=Ap[i];s?e.setAttributeNS(s,n,r):e.setAttribute(n,r)}else e.setAttribute(n,r)}removeAttribute(e,n,r){if(r){const i=Ap[r];i?e.removeAttributeNS(i,n):e.removeAttribute(`${r}:${n}`)}else e.removeAttribute(n)}addClass(e,n){e.classList.add(n)}removeClass(e,n){e.classList.remove(n)}setStyle(e,n,r,i){i&(yi.DashCase|yi.Important)?e.style.setProperty(n,r,i&yi.Important?"important":""):e.style[n]=r}removeStyle(e,n,r){r&yi.DashCase?e.style.removeProperty(n):e.style[n]=""}setProperty(e,n,r){e[n]=r}setValue(e,n){e.nodeValue=n}listen(e,n,r){if("string"==typeof e&&!(e=up().getGlobalEventTarget(this.doc,e)))throw new Error(`Unsupported event target ${e} for event ${n}`);return this.eventManager.addEventListener(e,n,this.decoratePreventDefault(r))}decoratePreventDefault(e){return n=>{if("__ngUnwrap__"===n)return e;!1===(this.platformIsServer?this.ngZone.runGuarded(()=>e(n)):e(n))&&n.preventDefault()}}}function gE(t){return"TEMPLATE"===t.tagName&&void 0!==t.content}class bL extends Rp{constructor(e,n,r,i,s,o,a,l){super(e,s,o,l),this.sharedStylesHost=n,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const u=fE(i.id,i.styles);for(const c of u){const h=document.createElement("style");a&&h.setAttribute("nonce",a),h.textContent=c,this.shadowRoot.appendChild(h)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,n){return super.appendChild(this.nodeOrShadowRoot(e),n)}insertBefore(e,n,r){return super.insertBefore(this.nodeOrShadowRoot(e),n,r)}removeChild(e,n){return super.removeChild(this.nodeOrShadowRoot(e),n)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}}class Pp extends Rp{constructor(e,n,r,i,s,o,a,l){super(e,s,o,a),this.sharedStylesHost=n,this.removeStylesOnCompDestroy=i,this.styles=l?fE(l,r.styles):r.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}}class mE extends Pp{constructor(e,n,r,i,s,o,a,l){const u=i+"-"+r.id;super(e,n,r,s,o,a,l,u),this.contentAttr=function xL(t){return"_ngcontent-%COMP%".replace(Mp,t)}(u),this.hostAttr=function wL(t){return"_nghost-%COMP%".replace(Mp,t)}(u)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,n){const r=super.createElement(e,n);return super.setAttribute(r,this.contentAttr,""),r}}let DL=(()=>{var t;class e extends cE{constructor(r){super(r)}supports(r){return!0}addEventListener(r,i,s){return r.addEventListener(i,s,!1),()=>this.removeEventListener(r,i,s)}removeEventListener(r,i,s){return r.removeEventListener(i,s)}}return(t=e).\u0275fac=function(r){return new(r||t)(dt(Zi))},t.\u0275prov=Et({token:t,factory:t.\u0275fac}),e})();const yE=["alt","control","meta","shift"],SL={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},TL={alt:t=>t.altKey,control:t=>t.ctrlKey,meta:t=>t.metaKey,shift:t=>t.shiftKey};let CL=(()=>{var t;class e extends cE{constructor(r){super(r)}supports(r){return null!=e.parseEventName(r)}addEventListener(r,i,s){const o=e.parseEventName(i),a=e.eventCallback(o.fullKey,s,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>up().onAndCancel(r,o.domEventName,a))}static parseEventName(r){const i=r.toLowerCase().split("."),s=i.shift();if(0===i.length||"keydown"!==s&&"keyup"!==s)return null;const o=e._normalizeKey(i.pop());let a="",l=i.indexOf("code");if(l>-1&&(i.splice(l,1),a="code."),yE.forEach(c=>{const h=i.indexOf(c);h>-1&&(i.splice(h,1),a+=c+".")}),a+=o,0!=i.length||0===o.length)return null;const u={};return u.domEventName=s,u.fullKey=a,u}static matchEventFullKeyCode(r,i){let s=SL[r.key]||r.key,o="";return i.indexOf("code.")>-1&&(s=r.code,o="code."),!(null==s||!s)&&(s=s.toLowerCase()," "===s?s="space":"."===s&&(s="dot"),yE.forEach(a=>{a!==s&&(0,TL[a])(r)&&(o+=a+".")}),o+=s,o===i)}static eventCallback(r,i,s){return o=>{e.matchEventFullKeyCode(o,r)&&s.runGuarded(()=>i(o))}}static _normalizeKey(r){return"esc"===r?"escape":r}}return(t=e).\u0275fac=function(r){return new(r||t)(dt(Zi))},t.\u0275prov=Et({token:t,factory:t.\u0275fac}),e})();function _E(t){return{appProviders:[...OL,...t?.providers??[]],platformProviders:PL}}const PL=[{provide:zs,useValue:"browser"},{provide:b_,useValue:function AL(){Tp.makeCurrent()},multi:!0},{provide:Zi,useFactory:function RL(){return function KC(t){wd=t}(document),document},deps:[]}],OL=[{provide:Md,useValue:"root"},{provide:$i,useFactory:function ML(){return new $i},deps:[]},{provide:Cp,useClass:DL,multi:!0,deps:[Zi,$t,zs]},{provide:Cp,useClass:CL,multi:!0,deps:[Zi]},pE,hE,uE,{provide:R_,useExisting:pE},{provide:class GF{},useClass:gL,deps:[]},[]];typeof window<"u"&&window;var Ki=(t=>(t[t.WEBGL_LEGACY=0]="WEBGL_LEGACY",t[t.WEBGL=1]="WEBGL",t[t.WEBGL2=2]="WEBGL2",t))(Ki||{}),EE=(t=>(t[t.UNKNOWN=0]="UNKNOWN",t[t.WEBGL=1]="WEBGL",t[t.CANVAS=2]="CANVAS",t))(EE||{}),Op=(t=>(t[t.COLOR=16384]="COLOR",t[t.DEPTH=256]="DEPTH",t[t.STENCIL=1024]="STENCIL",t))(Op||{}),Oe=(t=>(t[t.NORMAL=0]="NORMAL",t[t.ADD=1]="ADD",t[t.MULTIPLY=2]="MULTIPLY",t[t.SCREEN=3]="SCREEN",t[t.OVERLAY=4]="OVERLAY",t[t.DARKEN=5]="DARKEN",t[t.LIGHTEN=6]="LIGHTEN",t[t.COLOR_DODGE=7]="COLOR_DODGE",t[t.COLOR_BURN=8]="COLOR_BURN",t[t.HARD_LIGHT=9]="HARD_LIGHT",t[t.SOFT_LIGHT=10]="SOFT_LIGHT",t[t.DIFFERENCE=11]="DIFFERENCE",t[t.EXCLUSION=12]="EXCLUSION",t[t.HUE=13]="HUE",t[t.SATURATION=14]="SATURATION",t[t.COLOR=15]="COLOR",t[t.LUMINOSITY=16]="LUMINOSITY",t[t.NORMAL_NPM=17]="NORMAL_NPM",t[t.ADD_NPM=18]="ADD_NPM",t[t.SCREEN_NPM=19]="SCREEN_NPM",t[t.NONE=20]="NONE",t[t.SRC_OVER=0]="SRC_OVER",t[t.SRC_IN=21]="SRC_IN",t[t.SRC_OUT=22]="SRC_OUT",t[t.SRC_ATOP=23]="SRC_ATOP",t[t.DST_OVER=24]="DST_OVER",t[t.DST_IN=25]="DST_IN",t[t.DST_OUT=26]="DST_OUT",t[t.DST_ATOP=27]="DST_ATOP",t[t.ERASE=26]="ERASE",t[t.SUBTRACT=28]="SUBTRACT",t[t.XOR=29]="XOR",t))(Oe||{}),Lr=(t=>(t[t.POINTS=0]="POINTS",t[t.LINES=1]="LINES",t[t.LINE_LOOP=2]="LINE_LOOP",t[t.LINE_STRIP=3]="LINE_STRIP",t[t.TRIANGLES=4]="TRIANGLES",t[t.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",t[t.TRIANGLE_FAN=6]="TRIANGLE_FAN",t))(Lr||{}),K=(t=>(t[t.RGBA=6408]="RGBA",t[t.RGB=6407]="RGB",t[t.RG=33319]="RG",t[t.RED=6403]="RED",t[t.RGBA_INTEGER=36249]="RGBA_INTEGER",t[t.RGB_INTEGER=36248]="RGB_INTEGER",t[t.RG_INTEGER=33320]="RG_INTEGER",t[t.RED_INTEGER=36244]="RED_INTEGER",t[t.ALPHA=6406]="ALPHA",t[t.LUMINANCE=6409]="LUMINANCE",t[t.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",t[t.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",t[t.DEPTH_STENCIL=34041]="DEPTH_STENCIL",t))(K||{}),fo=(t=>(t[t.TEXTURE_2D=3553]="TEXTURE_2D",t[t.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",t[t.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",t[t.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",t[t.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",t[t.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",t[t.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",t))(fo||{}),Re=(t=>(t[t.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",t[t.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",t[t.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",t[t.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",t[t.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",t[t.UNSIGNED_INT=5125]="UNSIGNED_INT",t[t.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",t[t.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",t[t.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",t[t.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",t[t.BYTE=5120]="BYTE",t[t.SHORT=5122]="SHORT",t[t.INT=5124]="INT",t[t.FLOAT=5126]="FLOAT",t[t.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",t[t.HALF_FLOAT=36193]="HALF_FLOAT",t))(Re||{}),Fp=(t=>(t[t.FLOAT=0]="FLOAT",t[t.INT=1]="INT",t[t.UINT=2]="UINT",t))(Fp||{}),kr=(t=>(t[t.NEAREST=0]="NEAREST",t[t.LINEAR=1]="LINEAR",t))(kr||{}),Ei=(t=>(t[t.CLAMP=33071]="CLAMP",t[t.REPEAT=10497]="REPEAT",t[t.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",t))(Ei||{}),Br=(t=>(t[t.OFF=0]="OFF",t[t.POW2=1]="POW2",t[t.ON=2]="ON",t[t.ON_MANUAL=3]="ON_MANUAL",t))(Br||{}),ar=(t=>(t[t.NPM=0]="NPM",t[t.UNPACK=1]="UNPACK",t[t.PMA=2]="PMA",t[t.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",t[t.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",t[t.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA",t))(ar||{}),Ur=(t=>(t[t.NO=0]="NO",t[t.YES=1]="YES",t[t.AUTO=2]="AUTO",t[t.BLEND=0]="BLEND",t[t.CLEAR=1]="CLEAR",t[t.BLIT=2]="BLIT",t))(Ur||{}),Lp=(t=>(t[t.AUTO=0]="AUTO",t[t.MANUAL=1]="MANUAL",t))(Lp||{}),Yn=(t=>(t.LOW="lowp",t.MEDIUM="mediump",t.HIGH="highp",t))(Yn||{}),Kt=(t=>(t[t.NONE=0]="NONE",t[t.SCISSOR=1]="SCISSOR",t[t.STENCIL=2]="STENCIL",t[t.SPRITE=3]="SPRITE",t[t.COLOR=4]="COLOR",t))(Kt||{}),Wt=(t=>(t[t.NONE=0]="NONE",t[t.LOW=2]="LOW",t[t.MEDIUM=4]="MEDIUM",t[t.HIGH=8]="HIGH",t))(Wt||{}),Hr=(t=>(t[t.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",t[t.ARRAY_BUFFER=34962]="ARRAY_BUFFER",t[t.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",t))(Hr||{});const ce={ADAPTER:{createCanvas:(t,e)=>{const n=document.createElement("canvas");return n.width=t,n.height=e,n},getCanvasRenderingContext2D:()=>CanvasRenderingContext2D,getWebGLRenderingContext:()=>WebGLRenderingContext,getNavigator:()=>navigator,getBaseUrl:()=>document.baseURI??window.location.href,getFontFaceSet:()=>document.fonts,fetch:(t,e)=>fetch(t,e),parseXML:t=>(new DOMParser).parseFromString(t,"text/xml")},RESOLUTION:1,CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1};var kp=/iPhone/i,bE=/iPod/i,DE=/iPad/i,SE=/\biOS-universal(?:.+)Mac\b/i,Bp=/\bAndroid(?:.+)Mobile\b/i,TE=/Android/i,po=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,lc=/Silk/i,si=/Windows Phone/i,CE=/\bWindows(?:.+)ARM\b/i,IE=/BlackBerry/i,AE=/BB10/i,ME=/Opera Mini/i,RE=/\b(CriOS|Chrome)(?:.+)Mobile/i,PE=/Mobile(?:.+)Firefox\b/i,NE=function(t){return typeof t<"u"&&"MacIntel"===t.platform&&"number"==typeof t.maxTouchPoints&&t.maxTouchPoints>1&&typeof MSStream>"u"};function OE(t){var e={userAgent:"",platform:"",maxTouchPoints:0};!t&&typeof navigator<"u"?e={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0}:"string"==typeof t?e.userAgent=t:t&&t.userAgent&&(e={userAgent:t.userAgent,platform:t.platform,maxTouchPoints:t.maxTouchPoints||0});var n=e.userAgent,r=n.split("[FBAN");typeof r[1]<"u"&&(n=r[0]),typeof(r=n.split("Twitter"))[1]<"u"&&(n=r[0]);var i=function GL(t){return function(e){return e.test(t)}}(n),s={apple:{phone:i(kp)&&!i(si),ipod:i(bE),tablet:!i(kp)&&(i(DE)||NE(e))&&!i(si),universal:i(SE),device:(i(kp)||i(bE)||i(DE)||i(SE)||NE(e))&&!i(si)},amazon:{phone:i(po),tablet:!i(po)&&i(lc),device:i(po)||i(lc)},android:{phone:!i(si)&&i(po)||!i(si)&&i(Bp),tablet:!i(si)&&!i(po)&&!i(Bp)&&(i(lc)||i(TE)),device:!i(si)&&(i(po)||i(lc)||i(Bp)||i(TE))||i(/\bokhttp\b/i)},windows:{phone:i(si),tablet:i(CE),device:i(si)||i(CE)},other:{blackberry:i(IE),blackberry10:i(AE),opera:i(ME),firefox:i(PE),chrome:i(RE),device:i(IE)||i(AE)||i(ME)||i(PE)||i(RE)},any:!1,phone:!1,tablet:!1};return s.any=s.apple.device||s.android.device||s.windows.device||s.other.device,s.phone=s.apple.phone||s.android.phone||s.windows.phone,s.tablet=s.apple.tablet||s.android.tablet||s.windows.tablet,s}const oi=(OE.default??OE)(globalThis.navigator);ce.RETINA_PREFIX=/@([0-9\.]+)x/,ce.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!1;var Ba=ne(472),jL=ne(145),Up=ne(445);const $L={parse:Up.Qc,format:Up.WU,resolve:Up.DB};function lr(t){if("string"!=typeof t)throw new TypeError(`Path must be a string. Received ${JSON.stringify(t)}`)}function Ua(t){return t.split("?")[0].split("#")[0]}const hn={toPosix:t=>function WL(t,e,n){return t.replace(new RegExp(function zL(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}(e),"g"),n)}(t,"\\","/"),isUrl(t){return/^https?:/.test(this.toPosix(t))},isDataUrl:t=>/^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test(t),hasProtocol(t){return/^[^/:]+:\//.test(this.toPosix(t))},getProtocol(t){lr(t),t=this.toPosix(t);let e="";const n=/^file:\/\/\//.exec(t),r=/^[^/:]+:\/\//.exec(t),i=/^[^/:]+:\//.exec(t);if(n||r||i){const s=n?.[0]||r?.[0]||i?.[0];e=s,t=t.slice(s.length)}return e},toAbsolute(t,e,n){if(this.isDataUrl(t))return t;const r=Ua(this.toPosix(e??ce.ADAPTER.getBaseUrl())),i=Ua(this.toPosix(n??this.rootname(r)));return lr(t),(t=this.toPosix(t)).startsWith("/")?hn.join(i,t.slice(1)):this.isAbsolute(t)?t:this.join(r,t)},normalize(t){if(lr(t=this.toPosix(t)),0===t.length)return".";let e="";const n=t.startsWith("/");this.hasProtocol(t)&&(e=this.rootname(t),t=t.slice(e.length));const r=t.endsWith("/");return t=function XL(t,e){let n="",r=0,i=-1,s=0,o=-1;for(let a=0;a<=t.length;++a){if(a<t.length)o=t.charCodeAt(a);else{if(47===o)break;o=47}if(47===o){if(i!==a-1&&1!==s)if(i!==a-1&&2===s){if(n.length<2||2!==r||46!==n.charCodeAt(n.length-1)||46!==n.charCodeAt(n.length-2))if(n.length>2){const l=n.lastIndexOf("/");if(l!==n.length-1){-1===l?(n="",r=0):(n=n.slice(0,l),r=n.length-1-n.lastIndexOf("/")),i=a,s=0;continue}}else if(2===n.length||1===n.length){n="",r=0,i=a,s=0;continue}e&&(n.length>0?n+="/..":n="..",r=2)}else n.length>0?n+=`/${t.slice(i+1,a)}`:n=t.slice(i+1,a),r=a-i-1;i=a,s=0}else 46===o&&-1!==s?++s:s=-1}return n}(t,!1),t.length>0&&r&&(t+="/"),n?`/${t}`:e+t},isAbsolute(t){return lr(t),t=this.toPosix(t),!!this.hasProtocol(t)||t.startsWith("/")},join(...t){if(0===t.length)return".";let e;for(let n=0;n<t.length;++n){const r=t[n];lr(r),r.length>0&&(void 0===e?e=r:this.extname(t[n-1]??"")?e+=`/../${r}`:e+=`/${r}`)}return void 0===e?".":this.normalize(e)},dirname(t){if(lr(t),0===t.length)return".";let e=(t=this.toPosix(t)).charCodeAt(0);const n=47===e;let r=-1,i=!0;const s=this.getProtocol(t),o=t;for(let a=(t=t.slice(s.length)).length-1;a>=1;--a)if(e=t.charCodeAt(a),47===e){if(!i){r=a;break}}else i=!1;return-1===r?n?"/":this.isUrl(o)?s+t:s:n&&1===r?"//":s+t.slice(0,r)},rootname(t){lr(t);let e="";if(e=(t=this.toPosix(t)).startsWith("/")?"/":this.getProtocol(t),this.isUrl(t)){const n=t.indexOf("/",e.length);e=-1!==n?t.slice(0,n):t,e.endsWith("/")||(e+="/")}return e},basename(t,e){lr(t),e&&lr(e),t=Ua(this.toPosix(t));let s,n=0,r=-1,i=!0;if(void 0!==e&&e.length>0&&e.length<=t.length){if(e.length===t.length&&e===t)return"";let o=e.length-1,a=-1;for(s=t.length-1;s>=0;--s){const l=t.charCodeAt(s);if(47===l){if(!i){n=s+1;break}}else-1===a&&(i=!1,a=s+1),o>=0&&(l===e.charCodeAt(o)?-1==--o&&(r=s):(o=-1,r=a))}return n===r?r=a:-1===r&&(r=t.length),t.slice(n,r)}for(s=t.length-1;s>=0;--s)if(47===t.charCodeAt(s)){if(!i){n=s+1;break}}else-1===r&&(i=!1,r=s+1);return-1===r?"":t.slice(n,r)},extname(t){lr(t);let e=-1,n=0,r=-1,i=!0,s=0;for(let o=(t=Ua(this.toPosix(t))).length-1;o>=0;--o){const a=t.charCodeAt(o);if(47!==a)-1===r&&(i=!1,r=o+1),46===a?-1===e?e=o:1!==s&&(s=1):-1!==e&&(s=-1);else if(!i){n=o+1;break}}return-1===e||-1===r||0===s||1===s&&e===r-1&&e===n+1?"":t.slice(e,r)},parse(t){lr(t);const e={root:"",dir:"",base:"",ext:"",name:""};if(0===t.length)return e;let n=(t=Ua(this.toPosix(t))).charCodeAt(0);const r=this.isAbsolute(t);let i;e.root=this.rootname(t),i=r||this.hasProtocol(t)?1:0;let o=-1,a=0,l=-1,u=!0,c=t.length-1,h=0;for(;c>=i;--c)if(n=t.charCodeAt(c),47!==n)-1===l&&(u=!1,l=c+1),46===n?-1===o?o=c:1!==h&&(h=1):-1!==o&&(h=-1);else if(!u){a=c+1;break}return-1===o||-1===l||0===h||1===h&&o===l-1&&o===a+1?-1!==l&&(e.base=e.name=t.slice(0===a&&r?1:a,l)):(0===a&&r?(e.name=t.slice(1,o),e.base=t.slice(1,l)):(e.name=t.slice(a,o),e.base=t.slice(a,l)),e.ext=t.slice(o,l)),e.dir=this.dirname(t),e},sep:"/",delimiter:":"},FE={};function Ye(t,e,n=3){if(FE[e])return;let r=(new Error).stack;typeof r>"u"?console.warn("PixiJS Deprecation Warning: ",`${e}\nDeprecated since v${t}`):(r=r.split("\n").splice(n).join("\n"),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",`${e}\nDeprecated since v${t}`),console.warn(r),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",`${e}\nDeprecated since v${t}`),console.warn(r))),FE[e]=!0}let Hp;var qL={grad:.9,turn:360,rad:360/(2*Math.PI)},ai=function(t){return"string"==typeof t?t.length>0:"number"==typeof t},Jt=function(t,e,n){return void 0===e&&(e=0),void 0===n&&(n=Math.pow(10,e)),Math.round(n*t)/n+0},qn=function(t,e,n){return void 0===e&&(e=0),void 0===n&&(n=1),t>n?n:t>e?t:e},LE=function(t){return(t=isFinite(t)?t%360:0)>0?t:t+360},kE=function(t){return{r:qn(t.r,0,255),g:qn(t.g,0,255),b:qn(t.b,0,255),a:qn(t.a)}},Vp=function(t){return{r:Jt(t.r),g:Jt(t.g),b:Jt(t.b),a:Jt(t.a,3)}},ZL=/^#([0-9a-f]{3,8})$/i,uc=function(t){var e=t.toString(16);return e.length<2?"0"+e:e},BE=function(t){var e=t.r,n=t.g,r=t.b,i=t.a,s=Math.max(e,n,r),o=s-Math.min(e,n,r),a=o?s===e?(n-r)/o:s===n?2+(r-e)/o:4+(e-n)/o:0;return{h:60*(a<0?a+6:a),s:s?o/s*100:0,v:s/255*100,a:i}},UE=function(t){var e=t.h,n=t.s,r=t.v,i=t.a;e=e/360*6,n/=100,r/=100;var s=Math.floor(e),o=r*(1-n),a=r*(1-(e-s)*n),l=r*(1-(1-e+s)*n),u=s%6;return{r:255*[r,a,o,o,l,r][u],g:255*[l,r,r,a,o,o][u],b:255*[o,o,l,r,r,a][u],a:i}},HE=function(t){return{h:LE(t.h),s:qn(t.s,0,100),l:qn(t.l,0,100),a:qn(t.a)}},VE=function(t){return{h:Jt(t.h),s:Jt(t.s),l:Jt(t.l),a:Jt(t.a,3)}},GE=function(t){return UE((n=(e=t).s,{h:e.h,s:(n*=((r=e.l)<50?r:100-r)/100)>0?2*n/(r+n)*100:0,v:r+n,a:e.a}));var e,n,r},Ha=function(t){return{h:(e=BE(t)).h,s:(i=(200-(n=e.s))*(r=e.v)/100)>0&&i<200?n*r/100/(i<=100?i:200-i)*100:0,l:i/2,a:e.a};var e,n,r,i},KL=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,QL=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,JL=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,ek=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Gp={string:[[function(t){var e=ZL.exec(t);return e?(t=e[1]).length<=4?{r:parseInt(t[0]+t[0],16),g:parseInt(t[1]+t[1],16),b:parseInt(t[2]+t[2],16),a:4===t.length?Jt(parseInt(t[3]+t[3],16)/255,2):1}:6===t.length||8===t.length?{r:parseInt(t.substr(0,2),16),g:parseInt(t.substr(2,2),16),b:parseInt(t.substr(4,2),16),a:8===t.length?Jt(parseInt(t.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(t){var e=JL.exec(t)||ek.exec(t);return e?e[2]!==e[4]||e[4]!==e[6]?null:kE({r:Number(e[1])/(e[2]?100/255:1),g:Number(e[3])/(e[4]?100/255:1),b:Number(e[5])/(e[6]?100/255:1),a:void 0===e[7]?1:Number(e[7])/(e[8]?100:1)}):null},"rgb"],[function(t){var e=KL.exec(t)||QL.exec(t);if(!e)return null;var n,r,i=HE({h:(n=e[1],r=e[2],void 0===r&&(r="deg"),Number(n)*(qL[r]||1)),s:Number(e[3]),l:Number(e[4]),a:void 0===e[5]?1:Number(e[5])/(e[6]?100:1)});return GE(i)},"hsl"]],object:[[function(t){var e=t.r,n=t.g,r=t.b,i=t.a,s=void 0===i?1:i;return ai(e)&&ai(n)&&ai(r)?kE({r:Number(e),g:Number(n),b:Number(r),a:Number(s)}):null},"rgb"],[function(t){var e=t.h,n=t.s,r=t.l,i=t.a,s=void 0===i?1:i;if(!ai(e)||!ai(n)||!ai(r))return null;var o=HE({h:Number(e),s:Number(n),l:Number(r),a:Number(s)});return GE(o)},"hsl"],[function(t){var e=t.h,n=t.s,r=t.v,i=t.a,s=void 0===i?1:i;if(!ai(e)||!ai(n)||!ai(r))return null;var a,o=(a={h:Number(e),s:Number(n),v:Number(r),a:Number(s)},{h:LE(a.h),s:qn(a.s,0,100),v:qn(a.v,0,100),a:qn(a.a)});return UE(o)},"hsv"]]},jE=function(t,e){for(var n=0;n<e.length;n++){var r=e[n][0](t);if(r)return[r,e[n][1]]}return[null,void 0]},jp=function(t,e){var n=Ha(t);return{h:n.h,s:qn(n.s+100*e,0,100),l:n.l,a:n.a}},$p=function(t){return(299*t.r+587*t.g+114*t.b)/1e3/255},zE=function(t,e){var n=Ha(t);return{h:n.h,s:n.s,l:qn(n.l+100*e,0,100),a:n.a}},cc=function(){function t(e){this.parsed=function(t){return"string"==typeof t?jE(t.trim(),Gp.string):"object"==typeof t&&null!==t?jE(t,Gp.object):[null,void 0]}(e)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return t.prototype.isValid=function(){return null!==this.parsed},t.prototype.brightness=function(){return Jt($p(this.rgba),2)},t.prototype.isDark=function(){return $p(this.rgba)<.5},t.prototype.isLight=function(){return $p(this.rgba)>=.5},t.prototype.toHex=function(){return n=(e=Vp(this.rgba)).r,r=e.g,i=e.b,o=(s=e.a)<1?uc(Jt(255*s)):"","#"+uc(n)+uc(r)+uc(i)+o;var e,n,r,i,s,o},t.prototype.toRgb=function(){return Vp(this.rgba)},t.prototype.toRgbString=function(){return n=(e=Vp(this.rgba)).r,r=e.g,i=e.b,(s=e.a)<1?"rgba("+n+", "+r+", "+i+", "+s+")":"rgb("+n+", "+r+", "+i+")";var e,n,r,i,s},t.prototype.toHsl=function(){return VE(Ha(this.rgba))},t.prototype.toHslString=function(){return n=(e=VE(Ha(this.rgba))).h,r=e.s,i=e.l,(s=e.a)<1?"hsla("+n+", "+r+"%, "+i+"%, "+s+")":"hsl("+n+", "+r+"%, "+i+"%)";var e,n,r,i,s},t.prototype.toHsv=function(){return e=BE(this.rgba),{h:Jt(e.h),s:Jt(e.s),v:Jt(e.v),a:Jt(e.a,3)};var e},t.prototype.invert=function(){return Vr({r:255-(e=this.rgba).r,g:255-e.g,b:255-e.b,a:e.a});var e},t.prototype.saturate=function(e){return void 0===e&&(e=.1),Vr(jp(this.rgba,e))},t.prototype.desaturate=function(e){return void 0===e&&(e=.1),Vr(jp(this.rgba,-e))},t.prototype.grayscale=function(){return Vr(jp(this.rgba,-1))},t.prototype.lighten=function(e){return void 0===e&&(e=.1),Vr(zE(this.rgba,e))},t.prototype.darken=function(e){return void 0===e&&(e=.1),Vr(zE(this.rgba,-e))},t.prototype.rotate=function(e){return void 0===e&&(e=15),this.hue(this.hue()+e)},t.prototype.alpha=function(e){return"number"==typeof e?Vr({r:(n=this.rgba).r,g:n.g,b:n.b,a:e}):Jt(this.rgba.a,3);var n},t.prototype.hue=function(e){var n=Ha(this.rgba);return"number"==typeof e?Vr({h:e,s:n.s,l:n.l,a:n.a}):Jt(n.h)},t.prototype.isEqual=function(e){return this.toHex()===Vr(e).toHex()},t}(),Vr=function(t){return t instanceof cc?t:new cc(t)},WE=[];[function nk(t,e){var n={white:"#ffffff",bisque:"#ffe4c4",blue:"#0000ff",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",antiquewhite:"#faebd7",aqua:"#00ffff",azure:"#f0ffff",whitesmoke:"#f5f5f5",papayawhip:"#ffefd5",plum:"#dda0dd",blanchedalmond:"#ffebcd",black:"#000000",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",cornsilk:"#fff8dc",cornflowerblue:"#6495ed",burlywood:"#deb887",aquamarine:"#7fffd4",beige:"#f5f5dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkkhaki:"#bdb76b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",peachpuff:"#ffdab9",darkmagenta:"#8b008b",darkred:"#8b0000",darkorchid:"#9932cc",darkorange:"#ff8c00",darkslateblue:"#483d8b",gray:"#808080",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",deeppink:"#ff1493",deepskyblue:"#00bfff",wheat:"#f5deb3",firebrick:"#b22222",floralwhite:"#fffaf0",ghostwhite:"#f8f8ff",darkviolet:"#9400d3",magenta:"#ff00ff",green:"#008000",dodgerblue:"#1e90ff",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",blueviolet:"#8a2be2",forestgreen:"#228b22",lawngreen:"#7cfc00",indianred:"#cd5c5c",indigo:"#4b0082",fuchsia:"#ff00ff",brown:"#a52a2a",maroon:"#800000",mediumblue:"#0000cd",lightcoral:"#f08080",darkturquoise:"#00ced1",lightcyan:"#e0ffff",ivory:"#fffff0",lightyellow:"#ffffe0",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",linen:"#faf0e6",mediumaquamarine:"#66cdaa",lemonchiffon:"#fffacd",lime:"#00ff00",khaki:"#f0e68c",mediumseagreen:"#3cb371",limegreen:"#32cd32",mediumspringgreen:"#00fa9a",lightskyblue:"#87cefa",lightblue:"#add8e6",midnightblue:"#191970",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",mintcream:"#f5fffa",lightslategray:"#778899",lightslategrey:"#778899",navajowhite:"#ffdead",navy:"#000080",mediumvioletred:"#c71585",powderblue:"#b0e0e6",palegoldenrod:"#eee8aa",oldlace:"#fdf5e6",paleturquoise:"#afeeee",mediumturquoise:"#48d1cc",mediumorchid:"#ba55d3",rebeccapurple:"#663399",lightsteelblue:"#b0c4de",mediumslateblue:"#7b68ee",thistle:"#d8bfd8",tan:"#d2b48c",orchid:"#da70d6",mediumpurple:"#9370db",purple:"#800080",pink:"#ffc0cb",skyblue:"#87ceeb",springgreen:"#00ff7f",palegreen:"#98fb98",red:"#ff0000",yellow:"#ffff00",slateblue:"#6a5acd",lavenderblush:"#fff0f5",peru:"#cd853f",palevioletred:"#db7093",violet:"#ee82ee",teal:"#008080",slategray:"#708090",slategrey:"#708090",aliceblue:"#f0f8ff",darkseagreen:"#8fbc8f",darkolivegreen:"#556b2f",greenyellow:"#adff2f",seagreen:"#2e8b57",seashell:"#fff5ee",tomato:"#ff6347",silver:"#c0c0c0",sienna:"#a0522d",lavender:"#e6e6fa",lightgreen:"#90ee90",orange:"#ffa500",orangered:"#ff4500",steelblue:"#4682b4",royalblue:"#4169e1",turquoise:"#40e0d0",yellowgreen:"#9acd32",salmon:"#fa8072",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",darksalmon:"#e9967a",lightgoldenrodyellow:"#fafad2",snow:"#fffafa",lightgrey:"#d3d3d3",lightgray:"#d3d3d3",dimgray:"#696969",dimgrey:"#696969",olivedrab:"#6b8e23",olive:"#808000"},r={};for(var i in n)r[n[i]]=i;var s={};t.prototype.toName=function(o){if(!(this.rgba.a||this.rgba.r||this.rgba.g||this.rgba.b))return"transparent";var a,l,u=r[this.toHex()];if(u)return u;if(o?.closest){var c=this.toRgb(),h=1/0,d="black";if(!s.length)for(var f in n)s[f]=new t(n[f]).toRgb();for(var p in n){var g=(a=c,l=s[p],Math.pow(a.r-l.r,2)+Math.pow(a.g-l.g,2)+Math.pow(a.b-l.b,2));g<h&&(h=g,d=p)}return d}},e.string.push([function(o){var a=o.toLowerCase(),l="transparent"===a?"#0000":n[a];return l?new t(l).toRgb():null},"name"])}].forEach(function(e){WE.indexOf(e)<0&&(e(cc,Gp),WE.push(e))});const go=class{constructor(t=16777215){this._value=null,this._components=new Float32Array(4),this._components.fill(1),this._int=16777215,this.value=t}get red(){return this._components[0]}get green(){return this._components[1]}get blue(){return this._components[2]}get alpha(){return this._components[3]}setValue(t){return this.value=t,this}set value(t){if(t instanceof go)this._value=this.cloneSource(t._value),this._int=t._int,this._components.set(t._components);else{if(null===t)throw new Error("Cannot set PIXI.Color#value to null");(null===this._value||!this.isSourceEqual(this._value,t))&&(this.normalize(t),this._value=this.cloneSource(t))}}get value(){return this._value}cloneSource(t){return"string"==typeof t||"number"==typeof t||t instanceof Number||null===t?t:Array.isArray(t)||ArrayBuffer.isView(t)?t.slice(0):"object"==typeof t&&null!==t?{...t}:t}isSourceEqual(t,e){const n=typeof t;if(n!==typeof e)return!1;if("number"===n||"string"===n||t instanceof Number)return t===e;if(Array.isArray(t)&&Array.isArray(e)||ArrayBuffer.isView(t)&&ArrayBuffer.isView(e))return t.length===e.length&&t.every((i,s)=>i===e[s]);if(null!==t&&null!==e){const i=Object.keys(t),s=Object.keys(e);return i.length===s.length&&i.every(o=>t[o]===e[o])}return t===e}toRgba(){const[t,e,n,r]=this._components;return{r:t,g:e,b:n,a:r}}toRgb(){const[t,e,n]=this._components;return{r:t,g:e,b:n}}toRgbaString(){const[t,e,n]=this.toUint8RgbArray();return`rgba(${t},${e},${n},${this.alpha})`}toUint8RgbArray(t){const[e,n,r]=this._components;return(t=t??[])[0]=Math.round(255*e),t[1]=Math.round(255*n),t[2]=Math.round(255*r),t}toRgbArray(t){t=t??[];const[e,n,r]=this._components;return t[0]=e,t[1]=n,t[2]=r,t}toNumber(){return this._int}toLittleEndianNumber(){const t=this._int;return(t>>16)+(65280&t)+((255&t)<<16)}multiply(t){const[e,n,r,i]=go.temp.setValue(t)._components;return this._components[0]*=e,this._components[1]*=n,this._components[2]*=r,this._components[3]*=i,this.refreshInt(),this._value=null,this}premultiply(t,e=!0){return e&&(this._components[0]*=t,this._components[1]*=t,this._components[2]*=t),this._components[3]=t,this.refreshInt(),this._value=null,this}toPremultiplied(t,e=!0){if(1===t)return(255<<24)+this._int;if(0===t)return e?0:this._int;let n=this._int>>16&255,r=this._int>>8&255,i=255&this._int;return e&&(n=n*t+.5|0,r=r*t+.5|0,i=i*t+.5|0),(255*t<<24)+(n<<16)+(r<<8)+i}toHex(){const t=this._int.toString(16);return`#${"000000".substring(0,6-t.length)+t}`}toHexa(){const e=Math.round(255*this._components[3]).toString(16);return this.toHex()+"00".substring(0,2-e.length)+e}setAlpha(t){return this._components[3]=this._clamp(t),this}round(t){const[e,n,r]=this._components;return this._components[0]=Math.round(e*t)/t,this._components[1]=Math.round(n*t)/t,this._components[2]=Math.round(r*t)/t,this.refreshInt(),this._value=null,this}toArray(t){t=t??[];const[e,n,r,i]=this._components;return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t}normalize(t){let e,n,r,i;if(("number"==typeof t||t instanceof Number)&&t>=0&&t<=16777215)e=(t>>16&255)/255,n=(t>>8&255)/255,r=(255&t)/255,i=1;else if((Array.isArray(t)||t instanceof Float32Array)&&t.length>=3&&t.length<=4)t=this._clamp(t),[e,n,r,i=1]=t;else if((t instanceof Uint8Array||t instanceof Uint8ClampedArray)&&t.length>=3&&t.length<=4)t=this._clamp(t,0,255),[e,n,r,i=255]=t,e/=255,n/=255,r/=255,i/=255;else if("string"==typeof t||"object"==typeof t){if("string"==typeof t){const o=go.HEX_PATTERN.exec(t);o&&(t=`#${o[2]}`)}const s=Vr(t);s.isValid()&&(({r:e,g:n,b:r,a:i}=s.rgba),e/=255,n/=255,r/=255)}if(void 0===e)throw new Error(`Unable to convert color ${t}`);this._components[0]=e,this._components[1]=n,this._components[2]=r,this._components[3]=i,this.refreshInt()}refreshInt(){this._clamp(this._components);const[t,e,n]=this._components;this._int=(255*t<<16)+(255*e<<8)+(255*n|0)}_clamp(t,e=0,n=1){return"number"==typeof t?Math.min(Math.max(t,e),n):(t.forEach((r,i)=>{t[i]=Math.min(Math.max(r,e),n)}),t)}};let ft=go;ft.shared=new go,ft.temp=new go,ft.HEX_PATTERN=/^(#|0x)?(([a-f0-9]{3}){1,2}([a-f0-9]{2})?)$/i;const XE=function sk(){const t=[],e=[];for(let r=0;r<32;r++)t[r]=r,e[r]=r;t[Oe.NORMAL_NPM]=Oe.NORMAL,t[Oe.ADD_NPM]=Oe.ADD,t[Oe.SCREEN_NPM]=Oe.SCREEN,e[Oe.NORMAL]=Oe.NORMAL_NPM,e[Oe.ADD]=Oe.ADD_NPM,e[Oe.SCREEN]=Oe.SCREEN_NPM;const n=[];return n.push(e),n.push(t),n}();function YE(t,e){return XE[e?1:0][t]}function zp(t){if(4===t.BYTES_PER_ELEMENT)return t instanceof Float32Array?"Float32Array":t instanceof Uint32Array?"Uint32Array":"Int32Array";if(2===t.BYTES_PER_ELEMENT){if(t instanceof Uint16Array)return"Uint16Array"}else if(1===t.BYTES_PER_ELEMENT&&t instanceof Uint8Array)return"Uint8Array";return null}function hc(t){return t+=0===t?1:0,--t,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,1+(t|=t>>>16)}function qE(t){return!(t&t-1||!t)}function ZE(t){let e=(t>65535?1:0)<<4,n=((t>>>=e)>255?1:0)<<3;return e|=n,n=((t>>>=n)>15?1:0)<<2,e|=n,n=((t>>>=n)>3?1:0)<<1,e|=n,e|(t>>>=n)>>1}function mo(t,e,n){const r=t.length;let i;if(e>=r||0===n)return;const s=r-(n=e+n>r?r-e:n);for(i=e;i<s;++i)t[i]=t[i+n];t.length=s}function bi(t){return 0===t?0:t<0?-1:1}Float32Array,Uint32Array,Int32Array,Uint8Array;let uk=0;function Qi(){return++uk}const KE=class{constructor(t,e,n,r){this.left=t,this.top=e,this.right=n,this.bottom=r}get width(){return this.right-this.left}get height(){return this.bottom-this.top}isEmpty(){return this.left===this.right||this.top===this.bottom}};let Wp=KE;Wp.EMPTY=new KE(0,0,0,0);const QE={},Pn=Object.create(null),Zn=Object.create(null);class ck{constructor(e,n,r){this._canvas=ce.ADAPTER.createCanvas(),this._context=this._canvas.getContext("2d"),this.resolution=r||ce.RESOLUTION,this.resize(e,n)}clear(){this._checkDestroyed(),this._context.setTransform(1,0,0,1,0,0),this._context.clearRect(0,0,this._canvas.width,this._canvas.height)}resize(e,n){this._checkDestroyed(),this._canvas.width=Math.round(e*this.resolution),this._canvas.height=Math.round(n*this.resolution)}destroy(){this._context=null,this._canvas=null}get width(){return this._checkDestroyed(),this._canvas.width}set width(e){this._checkDestroyed(),this._canvas.width=Math.round(e)}get height(){return this._checkDestroyed(),this._canvas.height}set height(e){this._checkDestroyed(),this._canvas.height=Math.round(e)}get canvas(){return this._checkDestroyed(),this._canvas}get context(){return this._checkDestroyed(),this._context}_checkDestroyed(){if(null===this._canvas)throw new TypeError("The CanvasRenderTarget has already been destroyed")}}function JE(t,e,n){for(let r=0,i=4*n*e;r<e;++r,i+=4)if(0!==t[i+3])return!1;return!0}function eb(t,e,n,r,i){const s=4*e;for(let o=r,a=r*s+4*n;o<=i;++o,a+=s)if(0!==t[a+3])return!1;return!0}let dc;function Di(t,e=1){const n=ce.RETINA_PREFIX?.exec(t);return n?parseFloat(n[1]):e}var fe=(t=>(t.Renderer="renderer",t.Application="application",t.RendererSystem="renderer-webgl-system",t.RendererPlugin="renderer-webgl-plugin",t.CanvasRendererSystem="renderer-canvas-system",t.CanvasRendererPlugin="renderer-canvas-plugin",t.Asset="asset",t.LoadParser="load-parser",t.ResolveParser="resolve-parser",t.CacheParser="cache-parser",t.DetectionParser="detection-parser",t))(fe||{});const Xp=t=>{if("function"==typeof t||"object"==typeof t&&t.extension){if(!t.extension)throw new Error("Extension class must have an extension object");t={..."object"!=typeof t.extension?{type:t.extension}:t.extension,ref:t}}if("object"!=typeof t)throw new Error("Invalid extension type");return"string"==typeof(t={...t}).type&&(t.type=[t.type]),t},tb=(t,e)=>Xp(t).priority??e,Te={_addHandlers:{},_removeHandlers:{},_queue:{},remove(...t){return t.map(Xp).forEach(e=>{e.type.forEach(n=>this._removeHandlers[n]?.(e))}),this},add(...t){return t.map(Xp).forEach(e=>{e.type.forEach(n=>{const r=this._addHandlers,i=this._queue;r[n]?r[n](e):(i[n]=i[n]||[],i[n].push(e))})}),this},handle(t,e,n){const r=this._addHandlers,i=this._removeHandlers;if(r[t]||i[t])throw new Error(`Extension type ${t} already has a handler`);r[t]=e,i[t]=n;const s=this._queue;return s[t]&&(s[t].forEach(o=>e(o)),delete s[t]),this},handleByMap(t,e){return this.handle(t,n=>{e[n.name]=n.ref},n=>{delete e[n.name]})},handleByList(t,e,n=-1){return this.handle(t,r=>{e.includes(r.ref)||(e.push(r.ref),e.sort((i,s)=>tb(s,n)-tb(i,n)))},r=>{const i=e.indexOf(r.ref);-1!==i&&e.splice(i,1)})}};class Yp{constructor(e){this.rawBinaryData="number"==typeof e?new ArrayBuffer(e):e instanceof Uint8Array?e.buffer:e,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}get int8View(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View}get uint8View(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View}get int16View(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View}get uint16View(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View}get int32View(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View}view(e){return this[`${e}View`]}destroy(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null}static sizeOf(e){switch(e){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(`${e} isn't a valid view type`)}}}const pk=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join("\n");function gk(t){let e="";for(let n=0;n<t;++n)n>0&&(e+="\nelse "),n<t-1&&(e+=`if(test == ${n}.0){}`);return e}class li{constructor(){this.data=0,this.blendMode=Oe.NORMAL,this.polygonOffset=0,this.blend=!0,this.depthMask=!0}get blend(){return!!(1&this.data)}set blend(e){!!(1&this.data)!==e&&(this.data^=1)}get offsets(){return!!(2&this.data)}set offsets(e){!!(2&this.data)!==e&&(this.data^=2)}get culling(){return!!(4&this.data)}set culling(e){!!(4&this.data)!==e&&(this.data^=4)}get depthTest(){return!!(8&this.data)}set depthTest(e){!!(8&this.data)!==e&&(this.data^=8)}get depthMask(){return!!(32&this.data)}set depthMask(e){!!(32&this.data)!==e&&(this.data^=32)}get clockwiseFrontFace(){return!!(16&this.data)}set clockwiseFrontFace(e){!!(16&this.data)!==e&&(this.data^=16)}get blendMode(){return this._blendMode}set blendMode(e){this.blend=e!==Oe.NONE,this._blendMode=e}get polygonOffset(){return this._polygonOffset}set polygonOffset(e){this.offsets=!!e,this._polygonOffset=e}toString(){return`[@pixi/core:State blendMode=${this.blendMode} clockwiseFrontFace=${this.clockwiseFrontFace} culling=${this.culling} depthMask=${this.depthMask} polygonOffset=${this.polygonOffset}]`}static for2d(){const e=new li;return e.depthTest=!1,e.blend=!0,e}}const tg=[];function nb(t,e){if(!t)return null;let n="";if("string"==typeof t){const r=/\.(\w{3,4})(?:$|\?|#)/i.exec(t);r&&(n=r[1].toLowerCase())}for(let r=tg.length-1;r>=0;--r){const i=tg[r];if(i.test&&i.test(t,n))return new i(t,e)}throw new Error("Unrecognized source type to auto-detect Resource")}class ur{constructor(e){this.items=[],this._name=e,this._aliasCount=0}emit(e,n,r,i,s,o,a,l){if(arguments.length>8)throw new Error("max arguments reached");const{name:u,items:c}=this;this._aliasCount++;for(let h=0,d=c.length;h<d;h++)c[h][u](e,n,r,i,s,o,a,l);return c===this.items&&this._aliasCount--,this}ensureNonAliasedItems(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0))}add(e){return e[this._name]&&(this.ensureNonAliasedItems(),this.remove(e),this.items.push(e)),this}remove(e){const n=this.items.indexOf(e);return-1!==n&&(this.ensureNonAliasedItems(),this.items.splice(n,1)),this}contains(e){return this.items.includes(e)}removeAll(){return this.ensureNonAliasedItems(),this.items.length=0,this}destroy(){this.removeAll(),this.items=null,this._name=null}get empty(){return 0===this.items.length}get name(){return this._name}}Object.defineProperties(ur.prototype,{dispatch:{value:ur.prototype.emit},run:{value:ur.prototype.emit}});class Va{constructor(e=0,n=0){this._width=e,this._height=n,this.destroyed=!1,this.internal=!1,this.onResize=new ur("setRealSize"),this.onUpdate=new ur("update"),this.onError=new ur("onError")}bind(e){this.onResize.add(e),this.onUpdate.add(e),this.onError.add(e),(this._width||this._height)&&this.onResize.emit(this._width,this._height)}unbind(e){this.onResize.remove(e),this.onUpdate.remove(e),this.onError.remove(e)}resize(e,n){(e!==this._width||n!==this._height)&&(this._width=e,this._height=n,this.onResize.emit(e,n))}get valid(){return!!this._width&&!!this._height}update(){this.destroyed||this.onUpdate.emit()}load(){return Promise.resolve(this)}get width(){return this._width}get height(){return this._height}style(e,n,r){return!1}dispose(){}destroy(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)}static test(e,n){return!1}}class Ga extends Va{constructor(e,n){const{width:r,height:i}=n||{};if(!r||!i)throw new Error("BufferResource width or height invalid");super(r,i),this.data=e}upload(e,n,r){const i=e.gl;i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,n.alphaMode===ar.UNPACK);const s=n.realWidth,o=n.realHeight;return r.width===s&&r.height===o?i.texSubImage2D(n.target,0,0,0,s,o,n.format,r.type,this.data):(r.width=s,r.height=o,i.texImage2D(n.target,0,r.internalFormat,s,o,0,n.format,r.type,this.data)),!0}dispose(){this.data=null}static test(e){return e instanceof Float32Array||e instanceof Uint8Array||e instanceof Uint32Array}}const yk={scaleMode:kr.NEAREST,format:K.RGBA,alphaMode:ar.NPM},yo=class extends Ba{constructor(t=null,e=null){super(),e=Object.assign({},yo.defaultOptions,e);const{alphaMode:n,mipmap:r,anisotropicLevel:i,scaleMode:s,width:o,height:a,wrapMode:l,format:u,type:c,target:h,resolution:d,resourceOptions:f}=e;t&&!(t instanceof Va)&&((t=nb(t,f)).internal=!0),this.resolution=d||ce.RESOLUTION,this.width=Math.round((o||0)*this.resolution)/this.resolution,this.height=Math.round((a||0)*this.resolution)/this.resolution,this._mipmap=r,this.anisotropicLevel=i,this._wrapMode=l,this._scaleMode=s,this.format=u,this.type=c,this.target=h,this.alphaMode=n,this.uid=Qi(),this.touched=0,this.isPowerOfTwo=!1,this._refreshPOT(),this._glTextures={},this.dirtyId=0,this.dirtyStyleId=0,this.cacheId=null,this.valid=o>0&&a>0,this.textureCacheIds=[],this.destroyed=!1,this.resource=null,this._batchEnabled=0,this._batchLocation=0,this.parentTextureArray=null,this.setResource(t)}get realWidth(){return Math.round(this.width*this.resolution)}get realHeight(){return Math.round(this.height*this.resolution)}get mipmap(){return this._mipmap}set mipmap(t){this._mipmap!==t&&(this._mipmap=t,this.dirtyStyleId++)}get scaleMode(){return this._scaleMode}set scaleMode(t){this._scaleMode!==t&&(this._scaleMode=t,this.dirtyStyleId++)}get wrapMode(){return this._wrapMode}set wrapMode(t){this._wrapMode!==t&&(this._wrapMode=t,this.dirtyStyleId++)}setStyle(t,e){let n;return void 0!==t&&t!==this.scaleMode&&(this.scaleMode=t,n=!0),void 0!==e&&e!==this.mipmap&&(this.mipmap=e,n=!0),n&&this.dirtyStyleId++,this}setSize(t,e,n){return this.setRealSize(t*(n=n||this.resolution),e*n,n)}setRealSize(t,e,n){return this.resolution=n||this.resolution,this.width=Math.round(t)/this.resolution,this.height=Math.round(e)/this.resolution,this._refreshPOT(),this.update(),this}_refreshPOT(){this.isPowerOfTwo=qE(this.realWidth)&&qE(this.realHeight)}setResolution(t){const e=this.resolution;return e===t||(this.resolution=t,this.valid&&(this.width=Math.round(this.width*e)/t,this.height=Math.round(this.height*e)/t,this.emit("update",this)),this._refreshPOT()),this}setResource(t){if(this.resource===t)return this;if(this.resource)throw new Error("Resource can be set only once");return t.bind(this),this.resource=t,this}update(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))}onError(t){this.emit("error",this,t)}destroy(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete Zn[this.cacheId],delete Pn[this.cacheId],this.cacheId=null),this.dispose(),yo.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0}dispose(){this.emit("dispose",this)}castToBaseTexture(){return this}static from(t,e,n=ce.STRICT_TEXTURE_CACHE){const r="string"==typeof t;let i=null;r?i=t:(t._pixiId||(t._pixiId=`${e?.pixiIdPrefix||"pixiid"}_${Qi()}`),i=t._pixiId);let s=Zn[i];if(r&&n&&!s)throw new Error(`The cacheId "${i}" does not exist in BaseTextureCache.`);return s||(s=new yo(t,e),s.cacheId=i,yo.addToCache(s,i)),s}static fromBuffer(t,e,n,r){t=t||new Float32Array(e*n*4);const i=new Ga(t,{width:e,height:n}),s=t instanceof Float32Array?Re.FLOAT:Re.UNSIGNED_BYTE;return new yo(i,Object.assign({},yk,{type:s},r))}static addToCache(t,e){e&&(t.textureCacheIds.includes(e)||t.textureCacheIds.push(e),Zn[e]&&Zn[e]!==t&&console.warn(`BaseTexture added to the cache with an id [${e}] that already had an entry`),Zn[e]=t)}static removeFromCache(t){if("string"==typeof t){const e=Zn[t];if(e){const n=e.textureCacheIds.indexOf(t);return n>-1&&e.textureCacheIds.splice(n,1),delete Zn[t],e}}else if(t?.textureCacheIds){for(let e=0;e<t.textureCacheIds.length;++e)delete Zn[t.textureCacheIds[e]];return t.textureCacheIds.length=0,t}return null}};let $e=yo;$e.defaultOptions={mipmap:Br.POW2,anisotropicLevel:0,scaleMode:kr.LINEAR,wrapMode:Ei.CLAMP,alphaMode:ar.UNPACK,target:fo.TEXTURE_2D,format:K.RGBA,type:Re.UNSIGNED_BYTE},$e._globalBatch=0;class ng{constructor(){this.texArray=null,this.blend=0,this.type=Lr.TRIANGLES,this.start=0,this.size=0,this.data=null}}let _k=0;class jt{constructor(e,n=!0,r=!1){this.data=e||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=r,this.static=n,this.id=_k++,this.disposeRunner=new ur("disposeBuffer")}update(e){e instanceof Array&&(e=new Float32Array(e)),this.data=e||this.data,this._updateID++}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.data=null}set index(e){this.type=e?Hr.ELEMENT_ARRAY_BUFFER:Hr.ARRAY_BUFFER}get index(){return this.type===Hr.ELEMENT_ARRAY_BUFFER}static from(e){return e instanceof Array&&(e=new Float32Array(e)),new jt(e)}}class fc{constructor(e,n=0,r=!1,i=Re.FLOAT,s,o,a,l=1){this.buffer=e,this.size=n,this.normalized=r,this.type=i,this.stride=s,this.start=o,this.instance=a,this.divisor=l}destroy(){this.buffer=null}static from(e,n,r,i,s){return new fc(e,n,r,i,s)}}const vk={Float32Array,Uint32Array,Int32Array,Uint8Array},rb={5126:4,5123:2,5121:1};let wk=0;const Ek={Float32Array,Uint32Array,Int32Array,Uint8Array,Uint16Array};class Si{constructor(e=[],n={}){this.buffers=e,this.indexBuffer=null,this.attributes=n,this.glVertexArrayObjects={},this.id=wk++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new ur("disposeGeometry"),this.refCount=0}addAttribute(e,n,r=0,i=!1,s,o,a,l=!1){if(!n)throw new Error("You must pass a buffer when creating an attribute");n instanceof jt||(n instanceof Array&&(n=new Float32Array(n)),n=new jt(n));const u=e.split("|");if(u.length>1){for(let h=0;h<u.length;h++)this.addAttribute(u[h],n,r,i,s);return this}let c=this.buffers.indexOf(n);return-1===c&&(this.buffers.push(n),c=this.buffers.length-1),this.attributes[e]=new fc(c,r,i,s,o,a,l),this.instanced=this.instanced||l,this}getAttribute(e){return this.attributes[e]}getBuffer(e){return this.buffers[this.getAttribute(e).buffer]}addIndex(e){return e instanceof jt||(e instanceof Array&&(e=new Uint16Array(e)),e=new jt(e)),e.type=Hr.ELEMENT_ARRAY_BUFFER,this.indexBuffer=e,this.buffers.includes(e)||this.buffers.push(e),this}getIndex(){return this.indexBuffer}interleave(){if(1===this.buffers.length||2===this.buffers.length&&this.indexBuffer)return this;const e=[],n=[],r=new jt;let i;for(i in this.attributes){const s=this.attributes[i];e.push(this.buffers[s.buffer].data),n.push(s.size*rb[s.type]/4),s.buffer=0}for(r.data=function xk(t,e){let n=0,r=0;const i={};for(let l=0;l<t.length;l++)r+=e[l],n+=t[l].length;const s=new ArrayBuffer(4*n);let o=null,a=0;for(let l=0;l<t.length;l++){const u=e[l],c=t[l],h=zp(c);i[h]||(i[h]=new vk[h](s)),o=i[h];for(let d=0;d<c.length;d++)o[(d/u|0)*r+a+d%u]=c[d];a+=u}return new Float32Array(s)}(e,n),i=0;i<this.buffers.length;i++)this.buffers[i]!==this.indexBuffer&&this.buffers[i].destroy();return this.buffers=[r],this.indexBuffer&&this.buffers.push(this.indexBuffer),this}getSize(){for(const e in this.attributes){const n=this.attributes[e];return this.buffers[n.buffer].data.length/(n.stride/4||n.size)}return 0}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null}clone(){const e=new Si;for(let n=0;n<this.buffers.length;n++)e.buffers[n]=new jt(this.buffers[n].data.slice(0));for(const n in this.attributes){const r=this.attributes[n];e.attributes[n]=new fc(r.buffer,r.size,r.normalized,r.type,r.stride,r.start,r.instance)}return this.indexBuffer&&(e.indexBuffer=e.buffers[this.buffers.indexOf(this.indexBuffer)],e.indexBuffer.type=Hr.ELEMENT_ARRAY_BUFFER),e}static merge(e){const n=new Si,r=[],i=[],s=[];let o;for(let a=0;a<e.length;a++){o=e[a];for(let l=0;l<o.buffers.length;l++)i[l]=i[l]||0,i[l]+=o.buffers[l].data.length,s[l]=0}for(let a=0;a<o.buffers.length;a++)r[a]=new(Ek[zp(o.buffers[a].data)])(i[a]),n.buffers[a]=new jt(r[a]);for(let a=0;a<e.length;a++){o=e[a];for(let l=0;l<o.buffers.length;l++)r[l].set(o.buffers[l].data,s[l]),s[l]+=o.buffers[l].data.length}if(n.attributes=o.attributes,o.indexBuffer){n.indexBuffer=n.buffers[o.buffers.indexOf(o.indexBuffer)],n.indexBuffer.type=Hr.ELEMENT_ARRAY_BUFFER;let a=0,l=0,u=0,c=0;for(let h=0;h<o.buffers.length;h++)if(o.buffers[h]!==o.indexBuffer){c=h;break}for(const h in o.attributes){const d=o.attributes[h];(0|d.buffer)===c&&(l+=d.size*rb[d.type]/4)}for(let h=0;h<e.length;h++){const d=e[h].indexBuffer.data;for(let f=0;f<d.length;f++)n.indexBuffer.data[f+u]+=a;a+=e[h].buffers[c].data.length/l,u+=d.length}}return n}}class ib extends Si{constructor(e=!1){super(),this._buffer=new jt(null,e,!1),this._indexBuffer=new jt(null,e,!0),this.addAttribute("aVertexPosition",this._buffer,2,!1,Re.FLOAT).addAttribute("aTextureCoord",this._buffer,2,!1,Re.FLOAT).addAttribute("aColor",this._buffer,4,!0,Re.UNSIGNED_BYTE).addAttribute("aTextureId",this._buffer,1,!0,Re.FLOAT).addIndex(this._indexBuffer)}}const ja=2*Math.PI,bk=180/Math.PI,Dk=Math.PI/180;var rn=(t=>(t[t.POLY=0]="POLY",t[t.RECT=1]="RECT",t[t.CIRC=2]="CIRC",t[t.ELIP=3]="ELIP",t[t.RREC=4]="RREC",t))(rn||{});class ut{constructor(e=0,n=0){this.x=0,this.y=0,this.x=e,this.y=n}clone(){return new ut(this.x,this.y)}copyFrom(e){return this.set(e.x,e.y),this}copyTo(e){return e.set(this.x,this.y),e}equals(e){return e.x===this.x&&e.y===this.y}set(e=0,n=e){return this.x=e,this.y=n,this}toString(){return`[@pixi/math:Point x=${this.x} y=${this.y}]`}}const pc=[new ut,new ut,new ut,new ut];class et{constructor(e=0,n=0,r=0,i=0){this.x=Number(e),this.y=Number(n),this.width=Number(r),this.height=Number(i),this.type=rn.RECT}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}static get EMPTY(){return new et(0,0,0,0)}clone(){return new et(this.x,this.y,this.width,this.height)}copyFrom(e){return this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height,this}copyTo(e){return e.x=this.x,e.y=this.y,e.width=this.width,e.height=this.height,e}contains(e,n){return!(this.width<=0||this.height<=0)&&e>=this.x&&e<this.x+this.width&&n>=this.y&&n<this.y+this.height}intersects(e,n){if(!n)return!((this.right>e.right?e.right:this.right)<=(this.x<e.x?e.x:this.x))&&(this.bottom>e.bottom?e.bottom:this.bottom)>(this.y<e.y?e.y:this.y);const r=this.left,i=this.right,s=this.top,o=this.bottom;if(i<=r||o<=s)return!1;const a=pc[0].set(e.left,e.top),l=pc[1].set(e.left,e.bottom),u=pc[2].set(e.right,e.top),c=pc[3].set(e.right,e.bottom);if(u.x<=a.x||l.y<=a.y)return!1;const h=Math.sign(n.a*n.d-n.b*n.c);if(0===h||(n.apply(a,a),n.apply(l,l),n.apply(u,u),n.apply(c,c),Math.max(a.x,l.x,u.x,c.x)<=r||Math.min(a.x,l.x,u.x,c.x)>=i||Math.max(a.y,l.y,u.y,c.y)<=s||Math.min(a.y,l.y,u.y,c.y)>=o))return!1;const d=h*(l.y-a.y),f=h*(a.x-l.x),p=d*r+f*s,g=d*i+f*s,m=d*r+f*o,_=d*i+f*o;if(Math.max(p,g,m,_)<=d*a.x+f*a.y||Math.min(p,g,m,_)>=d*c.x+f*c.y)return!1;const v=h*(a.y-u.y),D=h*(u.x-a.x),A=v*r+D*s,$=v*i+D*s,ge=v*r+D*o,Q=v*i+D*o;return!(Math.max(A,$,ge,Q)<=v*a.x+D*a.y||Math.min(A,$,ge,Q)>=v*c.x+D*c.y)}pad(e=0,n=e){return this.x-=e,this.y-=n,this.width+=2*e,this.height+=2*n,this}fit(e){const n=Math.max(this.x,e.x),r=Math.min(this.x+this.width,e.x+e.width),i=Math.max(this.y,e.y),s=Math.min(this.y+this.height,e.y+e.height);return this.x=n,this.width=Math.max(r-n,0),this.y=i,this.height=Math.max(s-i,0),this}ceil(e=1,n=.001){const r=Math.ceil((this.x+this.width-n)*e)/e,i=Math.ceil((this.y+this.height-n)*e)/e;return this.x=Math.floor((this.x+n)*e)/e,this.y=Math.floor((this.y+n)*e)/e,this.width=r-this.x,this.height=i-this.y,this}enlarge(e){const n=Math.min(this.x,e.x),r=Math.max(this.x+this.width,e.x+e.width),i=Math.min(this.y,e.y),s=Math.max(this.y+this.height,e.y+e.height);return this.x=n,this.width=r-n,this.y=i,this.height=s-i,this}toString(){return`[@pixi/math:Rectangle x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`}}class rg{constructor(e=0,n=0,r=0){this.x=e,this.y=n,this.radius=r,this.type=rn.CIRC}clone(){return new rg(this.x,this.y,this.radius)}contains(e,n){if(this.radius<=0)return!1;let i=this.x-e,s=this.y-n;return i*=i,s*=s,i+s<=this.radius*this.radius}getBounds(){return new et(this.x-this.radius,this.y-this.radius,2*this.radius,2*this.radius)}toString(){return`[@pixi/math:Circle x=${this.x} y=${this.y} radius=${this.radius}]`}}class ig{constructor(e=0,n=0,r=0,i=0){this.x=e,this.y=n,this.width=r,this.height=i,this.type=rn.ELIP}clone(){return new ig(this.x,this.y,this.width,this.height)}contains(e,n){if(this.width<=0||this.height<=0)return!1;let r=(e-this.x)/this.width,i=(n-this.y)/this.height;return r*=r,i*=i,r+i<=1}getBounds(){return new et(this.x-this.width,this.y-this.height,this.width,this.height)}toString(){return`[@pixi/math:Ellipse x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`}}class Ji{constructor(...e){let n=Array.isArray(e[0])?e[0]:e;if("number"!=typeof n[0]){const r=[];for(let i=0,s=n.length;i<s;i++)r.push(n[i].x,n[i].y);n=r}this.points=n,this.type=rn.POLY,this.closeStroke=!0}clone(){const e=this.points.slice(),n=new Ji(e);return n.closeStroke=this.closeStroke,n}contains(e,n){let r=!1;const i=this.points.length/2;for(let s=0,o=i-1;s<i;o=s++){const a=this.points[2*s],l=this.points[2*s+1],c=this.points[2*o+1];l>n!=c>n&&e<(n-l)/(c-l)*(this.points[2*o]-a)+a&&(r=!r)}return r}toString(){return`[@pixi/math:PolygoncloseStroke=${this.closeStroke}points=${this.points.reduce((e,n)=>`${e}, ${n}`,"")}]`}}class sg{constructor(e=0,n=0,r=0,i=0,s=20){this.x=e,this.y=n,this.width=r,this.height=i,this.radius=s,this.type=rn.RREC}clone(){return new sg(this.x,this.y,this.width,this.height,this.radius)}contains(e,n){if(this.width<=0||this.height<=0)return!1;if(e>=this.x&&e<=this.x+this.width&&n>=this.y&&n<=this.y+this.height){const r=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(n>=this.y+r&&n<=this.y+this.height-r||e>=this.x+r&&e<=this.x+this.width-r)return!0;let i=e-(this.x+r),s=n-(this.y+r);const o=r*r;if(i*i+s*s<=o||(i=e-(this.x+this.width-r),i*i+s*s<=o)||(s=n-(this.y+this.height-r),i*i+s*s<=o)||(i=e-(this.x+r),i*i+s*s<=o))return!0}return!1}toString(){return`[@pixi/math:RoundedRectangle x=${this.x} y=${this.y}width=${this.width} height=${this.height} radius=${this.radius}]`}}class Pt{constructor(e=1,n=0,r=0,i=1,s=0,o=0){this.array=null,this.a=e,this.b=n,this.c=r,this.d=i,this.tx=s,this.ty=o}fromArray(e){this.a=e[0],this.b=e[1],this.c=e[3],this.d=e[4],this.tx=e[2],this.ty=e[5]}set(e,n,r,i,s,o){return this.a=e,this.b=n,this.c=r,this.d=i,this.tx=s,this.ty=o,this}toArray(e,n){this.array||(this.array=new Float32Array(9));const r=n||this.array;return e?(r[0]=this.a,r[1]=this.b,r[2]=0,r[3]=this.c,r[4]=this.d,r[5]=0,r[6]=this.tx,r[7]=this.ty,r[8]=1):(r[0]=this.a,r[1]=this.c,r[2]=this.tx,r[3]=this.b,r[4]=this.d,r[5]=this.ty,r[6]=0,r[7]=0,r[8]=1),r}apply(e,n){n=n||new ut;const r=e.x,i=e.y;return n.x=this.a*r+this.c*i+this.tx,n.y=this.b*r+this.d*i+this.ty,n}applyInverse(e,n){n=n||new ut;const r=1/(this.a*this.d+this.c*-this.b),i=e.x,s=e.y;return n.x=this.d*r*i+-this.c*r*s+(this.ty*this.c-this.tx*this.d)*r,n.y=this.a*r*s+-this.b*r*i+(-this.ty*this.a+this.tx*this.b)*r,n}translate(e,n){return this.tx+=e,this.ty+=n,this}scale(e,n){return this.a*=e,this.d*=n,this.c*=e,this.b*=n,this.tx*=e,this.ty*=n,this}rotate(e){const n=Math.cos(e),r=Math.sin(e),i=this.a,s=this.c,o=this.tx;return this.a=i*n-this.b*r,this.b=i*r+this.b*n,this.c=s*n-this.d*r,this.d=s*r+this.d*n,this.tx=o*n-this.ty*r,this.ty=o*r+this.ty*n,this}append(e){const n=this.a,r=this.b,i=this.c,s=this.d;return this.a=e.a*n+e.b*i,this.b=e.a*r+e.b*s,this.c=e.c*n+e.d*i,this.d=e.c*r+e.d*s,this.tx=e.tx*n+e.ty*i+this.tx,this.ty=e.tx*r+e.ty*s+this.ty,this}setTransform(e,n,r,i,s,o,a,l,u){return this.a=Math.cos(a+u)*s,this.b=Math.sin(a+u)*s,this.c=-Math.sin(a-l)*o,this.d=Math.cos(a-l)*o,this.tx=e-(r*this.a+i*this.c),this.ty=n-(r*this.b+i*this.d),this}prepend(e){const n=this.tx;if(1!==e.a||0!==e.b||0!==e.c||1!==e.d){const r=this.a,i=this.c;this.a=r*e.a+this.b*e.c,this.b=r*e.b+this.b*e.d,this.c=i*e.a+this.d*e.c,this.d=i*e.b+this.d*e.d}return this.tx=n*e.a+this.ty*e.c+e.tx,this.ty=n*e.b+this.ty*e.d+e.ty,this}decompose(e){const n=this.a,r=this.b,i=this.c,s=this.d,o=e.pivot,a=-Math.atan2(-i,s),l=Math.atan2(r,n),u=Math.abs(a+l);return u<1e-5||Math.abs(ja-u)<1e-5?(e.rotation=l,e.skew.x=e.skew.y=0):(e.rotation=0,e.skew.x=a,e.skew.y=l),e.scale.x=Math.sqrt(n*n+r*r),e.scale.y=Math.sqrt(i*i+s*s),e.position.x=this.tx+(o.x*n+o.y*i),e.position.y=this.ty+(o.x*r+o.y*s),e}invert(){const e=this.a,n=this.b,r=this.c,i=this.d,s=this.tx,o=e*i-n*r;return this.a=i/o,this.b=-n/o,this.c=-r/o,this.d=e/o,this.tx=(r*this.ty-i*s)/o,this.ty=-(e*this.ty-n*s)/o,this}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}clone(){const e=new Pt;return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e}copyTo(e){return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e}copyFrom(e){return this.a=e.a,this.b=e.b,this.c=e.c,this.d=e.d,this.tx=e.tx,this.ty=e.ty,this}toString(){return`[@pixi/math:Matrix a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty}]`}static get IDENTITY(){return new Pt}static get TEMP_MATRIX(){return new Pt}}const es=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],ts=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],ns=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],rs=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],og=[],sb=[],gc=Math.sign;!function Sk(){for(let t=0;t<16;t++){const e=[];og.push(e);for(let n=0;n<16;n++){const r=gc(es[t]*es[n]+ns[t]*ts[n]),i=gc(ts[t]*es[n]+rs[t]*ts[n]),s=gc(es[t]*ns[n]+ns[t]*rs[n]),o=gc(ts[t]*ns[n]+rs[t]*rs[n]);for(let a=0;a<16;a++)if(es[a]===r&&ts[a]===i&&ns[a]===s&&rs[a]===o){e.push(a);break}}}for(let t=0;t<16;t++){const e=new Pt;e.set(es[t],ts[t],ns[t],rs[t],0,0),sb.push(e)}}();const Lt={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:t=>es[t],uY:t=>ts[t],vX:t=>ns[t],vY:t=>rs[t],inv:t=>8&t?15&t:7&-t,add:(t,e)=>og[t][e],sub:(t,e)=>og[t][Lt.inv(e)],rotate180:t=>4^t,isVertical:t=>2==(3&t),byDirection:(t,e)=>2*Math.abs(t)<=Math.abs(e)?e>=0?Lt.S:Lt.N:2*Math.abs(e)<=Math.abs(t)?t>0?Lt.E:Lt.W:e>0?t>0?Lt.SE:Lt.SW:t>0?Lt.NE:Lt.NW,matrixAppendRotationInv:(t,e,n=0,r=0)=>{const i=sb[Lt.inv(e)];i.tx=n,i.ty=r,t.append(i)}};class Ti{constructor(e,n,r=0,i=0){this._x=r,this._y=i,this.cb=e,this.scope=n}clone(e=this.cb,n=this.scope){return new Ti(e,n,this._x,this._y)}set(e=0,n=e){return(this._x!==e||this._y!==n)&&(this._x=e,this._y=n,this.cb.call(this.scope)),this}copyFrom(e){return(this._x!==e.x||this._y!==e.y)&&(this._x=e.x,this._y=e.y,this.cb.call(this.scope)),this}copyTo(e){return e.set(this._x,this._y),e}equals(e){return e.x===this._x&&e.y===this._y}toString(){return`[@pixi/math:ObservablePoint x=0 y=0 scope=${this.scope}]`}get x(){return this._x}set x(e){this._x!==e&&(this._x=e,this.cb.call(this.scope))}get y(){return this._y}set y(e){this._y!==e&&(this._y=e,this.cb.call(this.scope))}}const ob=class{constructor(){this.worldTransform=new Pt,this.localTransform=new Pt,this.position=new Ti(this.onChange,this,0,0),this.scale=new Ti(this.onChange,this,1,1),this.pivot=new Ti(this.onChange,this,0,0),this.skew=new Ti(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}onChange(){this._localID++}updateSkew(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++}toString(){return`[@pixi/math:Transform position=(${this.position.x}, ${this.position.y}) rotation=${this.rotation} scale=(${this.scale.x}, ${this.scale.y}) skew=(${this.skew.x}, ${this.skew.y}) ]`}updateLocalTransform(){const t=this.localTransform;this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1)}updateTransform(t){const e=this.localTransform;if(this._localID!==this._currentLocalID&&(e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(this.pivot.x*e.b+this.pivot.y*e.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==t._worldID){const n=t.worldTransform,r=this.worldTransform;r.a=e.a*n.a+e.b*n.c,r.b=e.a*n.b+e.b*n.d,r.c=e.c*n.a+e.d*n.c,r.d=e.c*n.b+e.d*n.d,r.tx=e.tx*n.a+e.ty*n.c+n.tx,r.ty=e.tx*n.b+e.ty*n.d+n.ty,this._parentID=t._worldID,this._worldID++}}setFromMatrix(t){t.decompose(this),this._localID++}get rotation(){return this._rotation}set rotation(t){this._rotation!==t&&(this._rotation=t,this.updateSkew())}};let mc=ob;mc.IDENTITY=new ob;const _o=[{test:t=>"float"===t.type&&1===t.size&&!t.isArray,code:t=>`\n            if(uv["${t}"] !== ud["${t}"].value)\n            {\n                ud["${t}"].value = uv["${t}"]\n                gl.uniform1f(ud["${t}"].location, uv["${t}"])\n            }\n            `},{test:(t,e)=>!("sampler2D"!==t.type&&"samplerCube"!==t.type&&"sampler2DArray"!==t.type||1!==t.size||t.isArray||null!=e&&void 0===e.castToBaseTexture),code:t=>`t = syncData.textureCount++;\n\n            renderer.texture.bind(uv["${t}"], t);\n\n            if(ud["${t}"].value !== t)\n            {\n                ud["${t}"].value = t;\n                gl.uniform1i(ud["${t}"].location, t);\n; // eslint-disable-line max-len\n            }`},{test:(t,e)=>"mat3"===t.type&&1===t.size&&!t.isArray&&void 0!==e.a,code:t=>`\n            gl.uniformMatrix3fv(ud["${t}"].location, false, uv["${t}"].toArray(true));\n            `,codeUbo:t=>`\n                var ${t}_matrix = uv.${t}.toArray(true);\n\n                data[offset] = ${t}_matrix[0];\n                data[offset+1] = ${t}_matrix[1];\n                data[offset+2] = ${t}_matrix[2];\n        \n                data[offset + 4] = ${t}_matrix[3];\n                data[offset + 5] = ${t}_matrix[4];\n                data[offset + 6] = ${t}_matrix[5];\n        \n                data[offset + 8] = ${t}_matrix[6];\n                data[offset + 9] = ${t}_matrix[7];\n                data[offset + 10] = ${t}_matrix[8];\n            `},{test:(t,e)=>"vec2"===t.type&&1===t.size&&!t.isArray&&void 0!==e.x,code:t=>`\n                cv = ud["${t}"].value;\n                v = uv["${t}"];\n\n                if(cv[0] !== v.x || cv[1] !== v.y)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    gl.uniform2f(ud["${t}"].location, v.x, v.y);\n                }`,codeUbo:t=>`\n                v = uv.${t};\n\n                data[offset] = v.x;\n                data[offset+1] = v.y;\n            `},{test:t=>"vec2"===t.type&&1===t.size&&!t.isArray,code:t=>`\n                cv = ud["${t}"].value;\n                v = uv["${t}"];\n\n                if(cv[0] !== v[0] || cv[1] !== v[1])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    gl.uniform2f(ud["${t}"].location, v[0], v[1]);\n                }\n            `},{test:(t,e)=>"vec4"===t.type&&1===t.size&&!t.isArray&&void 0!==e.width,code:t=>`\n                cv = ud["${t}"].value;\n                v = uv["${t}"];\n\n                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    cv[2] = v.width;\n                    cv[3] = v.height;\n                    gl.uniform4f(ud["${t}"].location, v.x, v.y, v.width, v.height)\n                }`,codeUbo:t=>`\n                    v = uv.${t};\n\n                    data[offset] = v.x;\n                    data[offset+1] = v.y;\n                    data[offset+2] = v.width;\n                    data[offset+3] = v.height;\n                `},{test:(t,e)=>"vec4"===t.type&&1===t.size&&!t.isArray&&void 0!==e.red,code:t=>`\n                cv = ud["${t}"].value;\n                v = uv["${t}"];\n\n                if(cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.alpha)\n                {\n                    cv[0] = v.red;\n                    cv[1] = v.green;\n                    cv[2] = v.blue;\n                    cv[3] = v.alpha;\n                    gl.uniform4f(ud["${t}"].location, v.red, v.green, v.blue, v.alpha)\n                }`,codeUbo:t=>`\n                    v = uv.${t};\n\n                    data[offset] = v.red;\n                    data[offset+1] = v.green;\n                    data[offset+2] = v.blue;\n                    data[offset+3] = v.alpha;\n                `},{test:(t,e)=>"vec3"===t.type&&1===t.size&&!t.isArray&&void 0!==e.red,code:t=>`\n                cv = ud["${t}"].value;\n                v = uv["${t}"];\n\n                if(cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.a)\n                {\n                    cv[0] = v.red;\n                    cv[1] = v.green;\n                    cv[2] = v.blue;\n    \n                    gl.uniform3f(ud["${t}"].location, v.red, v.green, v.blue)\n                }`,codeUbo:t=>`\n                    v = uv.${t};\n\n                    data[offset] = v.red;\n                    data[offset+1] = v.green;\n                    data[offset+2] = v.blue;\n                `},{test:t=>"vec4"===t.type&&1===t.size&&!t.isArray,code:t=>`\n                cv = ud["${t}"].value;\n                v = uv["${t}"];\n\n                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    cv[2] = v[2];\n                    cv[3] = v[3];\n\n                    gl.uniform4f(ud["${t}"].location, v[0], v[1], v[2], v[3])\n                }`}],Ik={float:"\n    if (cv !== v)\n    {\n        cu.value = v;\n        gl.uniform1f(location, v);\n    }",vec2:"\n    if (cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n\n        gl.uniform2f(location, v[0], v[1])\n    }",vec3:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3f(location, v[0], v[1], v[2])\n    }",vec4:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n        cv[3] = v[3];\n\n        gl.uniform4f(location, v[0], v[1], v[2], v[3]);\n    }",int:"\n    if (cv !== v)\n    {\n        cu.value = v;\n\n        gl.uniform1i(location, v);\n    }",ivec2:"\n    if (cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n\n        gl.uniform2i(location, v[0], v[1]);\n    }",ivec3:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3i(location, v[0], v[1], v[2]);\n    }",ivec4:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n        cv[3] = v[3];\n\n        gl.uniform4i(location, v[0], v[1], v[2], v[3]);\n    }",uint:"\n    if (cv !== v)\n    {\n        cu.value = v;\n\n        gl.uniform1ui(location, v);\n    }",uvec2:"\n    if (cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n\n        gl.uniform2ui(location, v[0], v[1]);\n    }",uvec3:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3ui(location, v[0], v[1], v[2]);\n    }",uvec4:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n        cv[3] = v[3];\n\n        gl.uniform4ui(location, v[0], v[1], v[2], v[3]);\n    }",bool:"\n    if (cv !== v)\n    {\n        cu.value = v;\n        gl.uniform1i(location, v);\n    }",bvec2:"\n    if (cv[0] != v[0] || cv[1] != v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n\n        gl.uniform2i(location, v[0], v[1]);\n    }",bvec3:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3i(location, v[0], v[1], v[2]);\n    }",bvec4:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n        cv[3] = v[3];\n\n        gl.uniform4i(location, v[0], v[1], v[2], v[3]);\n    }",mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:"\n    if (cv !== v)\n    {\n        cu.value = v;\n\n        gl.uniform1i(location, v);\n    }",samplerCube:"\n    if (cv !== v)\n    {\n        cu.value = v;\n\n        gl.uniform1i(location, v);\n    }",sampler2DArray:"\n    if (cv !== v)\n    {\n        cu.value = v;\n\n        gl.uniform1i(location, v);\n    }"},Ak={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",uint:"gl.uniform1uiv(location, v)",uvec2:"gl.uniform2uiv(location, v)",uvec3:"gl.uniform3uiv(location, v)",uvec4:"gl.uniform4uiv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"},ab={};let _c,yc=ab;const Nk={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,uint:1,uvec2:2,uvec3:3,uvec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function lb(t){return Nk[t]}let vc=null;const ub={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",UNSIGNED_INT:"uint",UNSIGNED_INT_VEC2:"uvec2",UNSIGNED_INT_VEC3:"uvec3",UNSIGNED_INT_VEC4:"uvec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",INT_SAMPLER_2D:"sampler2D",UNSIGNED_INT_SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",INT_SAMPLER_CUBE:"samplerCube",UNSIGNED_INT_SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray",INT_SAMPLER_2D_ARRAY:"sampler2DArray",UNSIGNED_INT_SAMPLER_2D_ARRAY:"sampler2DArray"};function cb(t,e){if(!vc){const n=Object.keys(ub);vc={};for(let r=0;r<n.length;++r){const i=n[r];vc[t[i]]=ub[i]}}return vc[e]}function hb(t,e,n){if("precision"!==t.substring(0,9)){let r=e;return e===Yn.HIGH&&n!==Yn.HIGH&&(r=Yn.MEDIUM),`precision ${r} float;\n${t}`}return n!==Yn.HIGH&&"precision highp"===t.substring(0,15)?t.replace("precision highp","precision mediump"):t}let Ok=0;const xc={},vo=class{constructor(t,e,n="pixi-shader",r={}){this.extra={},this.id=Ok++,this.vertexSrc=t||vo.defaultVertexSrc,this.fragmentSrc=e||vo.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),this.extra=r,"#version"!==this.vertexSrc.substring(0,8)&&(n=n.replace(/\s+/g,"-"),xc[n]?(xc[n]++,n+=`-${xc[n]}`):xc[n]=1,this.vertexSrc=`#define SHADER_NAME ${n}\n${this.vertexSrc}`,this.fragmentSrc=`#define SHADER_NAME ${n}\n${this.fragmentSrc}`,this.vertexSrc=hb(this.vertexSrc,vo.defaultVertexPrecision,Yn.HIGH),this.fragmentSrc=hb(this.fragmentSrc,vo.defaultFragmentPrecision,function Pk(){if(!_c){_c=Yn.MEDIUM;const t=function Rk(){if(yc===ab||yc?.isContextLost()){const t=ce.ADAPTER.createCanvas();let e;ce.PREFER_ENV>=Ki.WEBGL2&&(e=t.getContext("webgl2",{})),e||(e=t.getContext("webgl",{})||t.getContext("experimental-webgl",{}),e?e.getExtension("WEBGL_draw_buffers"):e=null),yc=e}return yc}();t&&t.getShaderPrecisionFormat&&(_c=t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT).precision?Yn.HIGH:Yn.MEDIUM)}return _c}())),this.glPrograms={},this.syncUniforms=null}static get defaultVertexSrc(){return"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void){\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n   vTextureCoord = aTextureCoord;\n}\n"}static get defaultFragmentSrc(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor *= texture2D(uSampler, vTextureCoord);\n}"}static from(t,e,n){const r=t+e;let i=QE[r];return i||(QE[r]=i=new vo(t,e,n)),i}};let cr=vo;cr.defaultVertexPrecision=Yn.HIGH,cr.defaultFragmentPrecision=oi.apple.device?Yn.HIGH:Yn.MEDIUM;let Fk=0;class hr{constructor(e,n,r){this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=Fk++,this.static=!!n,this.ubo=!!r,e instanceof jt?(this.buffer=e,this.buffer.type=Hr.UNIFORM_BUFFER,this.autoManage=!1,this.ubo=!0):(this.uniforms=e,this.ubo&&(this.buffer=new jt(new Float32Array(1)),this.buffer.type=Hr.UNIFORM_BUFFER,this.autoManage=!0))}update(){this.dirtyId++,!this.autoManage&&this.buffer&&this.buffer.update()}add(e,n,r){if(this.ubo)throw new Error("[UniformGroup] uniform groups in ubo mode cannot be modified, or have uniform groups nested in them");this.uniforms[e]=new hr(n,r)}static from(e,n,r){return new hr(e,n,r)}static uboFrom(e,n){return new hr(e,n??!0,!0)}}class Gr{constructor(e,n){this.uniformBindCount=0,this.program=e,this.uniformGroup=n?n instanceof hr?n:new hr(n):new hr({}),this.disposeRunner=new ur("disposeShader")}checkUniformExists(e,n){if(n.uniforms[e])return!0;for(const r in n.uniforms){const i=n.uniforms[r];if(i.group&&this.checkUniformExists(e,i))return!0}return!1}destroy(){this.uniformGroup=null,this.disposeRunner.emit(this),this.disposeRunner.destroy()}get uniforms(){return this.uniformGroup.uniforms}static from(e,n,r){const i=cr.from(e,n);return new Gr(i,r)}}class Lk{constructor(e,n){if(this.vertexSrc=e,this.fragTemplate=n,this.programCache={},this.defaultGroupCache={},!n.includes("%count%"))throw new Error('Fragment template must contain "%count%".');if(!n.includes("%forloop%"))throw new Error('Fragment template must contain "%forloop%".')}generateShader(e){if(!this.programCache[e]){const r=new Int32Array(e);for(let s=0;s<e;s++)r[s]=s;this.defaultGroupCache[e]=hr.from({uSamplers:r},!0);let i=this.fragTemplate;i=i.replace(/%count%/gi,`${e}`),i=i.replace(/%forloop%/gi,this.generateSampleSrc(e)),this.programCache[e]=new cr(this.vertexSrc,i)}const n={tint:new Float32Array([1,1,1,1]),translationMatrix:new Pt,default:this.defaultGroupCache[e]};return new Gr(this.programCache[e],n)}generateSampleSrc(e){let n="";n+="\n",n+="\n";for(let r=0;r<e;r++)r>0&&(n+="\nelse "),r<e-1&&(n+=`if(vTextureId < ${r}.5)`),n+="\n{",n+=`\n\tcolor = texture2D(uSamplers[${r}], vTextureCoord);`,n+="\n}";return n+="\n",n+="\n",n}}class ag{constructor(){this.elements=[],this.ids=[],this.count=0}clear(){for(let e=0;e<this.count;e++)this.elements[e]=null;this.count=0}}class wc{constructor(e){this.renderer=e}flush(){}destroy(){this.renderer=null}start(){}stop(){this.flush()}render(e){}}const dr=class extends wc{constructor(t){super(t),this.setShaderGenerator(),this.geometryClass=ib,this.vertexSize=6,this.state=li.for2d(),this.size=4*dr.defaultBatchSize,this._vertexCount=0,this._indexCount=0,this._bufferedElements=[],this._bufferedTextures=[],this._bufferSize=0,this._shader=null,this._packedGeometries=[],this._packedGeometryPoolSize=2,this._flushId=0,this._aBuffers={},this._iBuffers={},this.maxTextures=1,this.renderer.on("prerender",this.onPrerender,this),t.runners.contextChange.add(this),this._dcIndex=0,this._aIndex=0,this._iIndex=0,this._attributeBuffer=null,this._indexBuffer=null,this._tempBoundTextures=[]}static get defaultMaxTextures(){return this._defaultMaxTextures=this._defaultMaxTextures??function Bk(t){let e=!0;const n=ce.ADAPTER.getNavigator();if(oi.tablet||oi.phone){if(oi.apple.device){const r=n.userAgent.match(/OS (\d+)_(\d+)?/);r&&parseInt(r[1],10)<11&&(e=!1)}if(oi.android.device){const r=n.userAgent.match(/Android\s([0-9.]*)/);r&&parseInt(r[1],10)<7&&(e=!1)}}return e?t:4}(32),this._defaultMaxTextures}static set defaultMaxTextures(t){this._defaultMaxTextures=t}static get canUploadSameBuffer(){return this._canUploadSameBuffer=this._canUploadSameBuffer??function kk(){return!oi.apple.device}(),this._canUploadSameBuffer}static set canUploadSameBuffer(t){this._canUploadSameBuffer=t}get MAX_TEXTURES(){return Ye("7.1.0","BatchRenderer#MAX_TEXTURES renamed to BatchRenderer#maxTextures"),this.maxTextures}static get defaultVertexSrc(){return"precision highp float;\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\nattribute float aTextureId;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform vec4 tint;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\n\nvoid main(void){\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vTextureId = aTextureId;\n    vColor = aColor * tint;\n}\n"}static get defaultFragmentTemplate(){return"varying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\nuniform sampler2D uSamplers[%count%];\n\nvoid main(void){\n    vec4 color;\n    %forloop%\n    gl_FragColor = color * vColor;\n}\n"}setShaderGenerator({vertex:t=dr.defaultVertexSrc,fragment:e=dr.defaultFragmentTemplate}={}){this.shaderGenerator=new Lk(t,e)}contextChange(){const t=this.renderer.gl;ce.PREFER_ENV===Ki.WEBGL_LEGACY?this.maxTextures=1:(this.maxTextures=Math.min(t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),dr.defaultMaxTextures),this.maxTextures=function mk(t,e){if(0===t)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");const n=e.createShader(e.FRAGMENT_SHADER);for(;;){const r=pk.replace(/%forloop%/gi,gk(t));if(e.shaderSource(n,r),e.compileShader(n),e.getShaderParameter(n,e.COMPILE_STATUS))break;t=t/2|0}return t}(this.maxTextures,t)),this._shader=this.shaderGenerator.generateShader(this.maxTextures);for(let e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]=new this.geometryClass;this.initFlushBuffers()}initFlushBuffers(){const{_drawCallPool:t,_textureArrayPool:e}=dr,n=this.size/4,r=Math.floor(n/this.maxTextures)+1;for(;t.length<n;)t.push(new ng);for(;e.length<r;)e.push(new ag);for(let i=0;i<this.maxTextures;i++)this._tempBoundTextures[i]=null}onPrerender(){this._flushId=0}render(t){t._texture.valid&&(this._vertexCount+t.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=t.vertexData.length/2,this._indexCount+=t.indices.length,this._bufferedTextures[this._bufferSize]=t._texture.baseTexture,this._bufferedElements[this._bufferSize++]=t)}buildTexturesAndDrawCalls(){const{_bufferedTextures:t,maxTextures:e}=this,n=dr._textureArrayPool,r=this.renderer.batch,i=this._tempBoundTextures,s=this.renderer.textureGC.count;let o=++$e._globalBatch,a=0,l=n[0],u=0;r.copyBoundTextures(i,e);for(let c=0;c<this._bufferSize;++c){const h=t[c];t[c]=null,h._batchEnabled!==o&&(l.count>=e&&(r.boundArray(l,i,o,e),this.buildDrawCalls(l,u,c),u=c,l=n[++a],++o),h._batchEnabled=o,h.touched=s,l.elements[l.count++]=h)}l.count>0&&(r.boundArray(l,i,o,e),this.buildDrawCalls(l,u,this._bufferSize),++a,++o);for(let c=0;c<i.length;c++)i[c]=null;$e._globalBatch=o}buildDrawCalls(t,e,n){const{_bufferedElements:r,_attributeBuffer:i,_indexBuffer:s,vertexSize:o}=this,a=dr._drawCallPool;let l=this._dcIndex,u=this._aIndex,c=this._iIndex,h=a[l];h.start=this._iIndex,h.texArray=t;for(let d=e;d<n;++d){const f=r[d],g=XE[f._texture.baseTexture.alphaMode?1:0][f.blendMode];r[d]=null,e<d&&h.blend!==g&&(h.size=c-h.start,e=d,h=a[++l],h.texArray=t,h.start=c),this.packInterleavedGeometry(f,i,s,u,c),u+=f.vertexData.length/2*o,c+=f.indices.length,h.blend=g}e<n&&(h.size=c-h.start,++l),this._dcIndex=l,this._aIndex=u,this._iIndex=c}bindAndClearTexArray(t){const e=this.renderer.texture;for(let n=0;n<t.count;n++)e.bind(t.elements[n],t.ids[n]),t.elements[n]=null;t.count=0}updateGeometry(){const{_packedGeometries:t,_attributeBuffer:e,_indexBuffer:n}=this;dr.canUploadSameBuffer?(t[this._flushId]._buffer.update(e.rawBinaryData),t[this._flushId]._indexBuffer.update(n),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,t[this._flushId]=new this.geometryClass),t[this._flushId]._buffer.update(e.rawBinaryData),t[this._flushId]._indexBuffer.update(n),this.renderer.geometry.bind(t[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)}drawBatches(){const t=this._dcIndex,{gl:e,state:n}=this.renderer,r=dr._drawCallPool;let i=null;for(let s=0;s<t;s++){const{texArray:o,type:a,size:l,start:u,blend:c}=r[s];i!==o&&(i=o,this.bindAndClearTexArray(o)),this.state.blendMode=c,n.set(this.state),e.drawElements(a,l,e.UNSIGNED_SHORT,2*u)}}flush(){0!==this._vertexCount&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)}start(){this.renderer.state.set(this.state),this.renderer.texture.ensureSamplerType(this.maxTextures),this.renderer.shader.bind(this._shader),dr.canUploadSameBuffer&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])}stop(){this.flush()}destroy(){for(let t=0;t<this._packedGeometryPoolSize;t++)this._packedGeometries[t]&&this._packedGeometries[t].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),super.destroy()}getAttributeBuffer(t){const e=hc(Math.ceil(t/8)),n=ZE(e),r=8*e;this._aBuffers.length<=n&&(this._iBuffers.length=n+1);let i=this._aBuffers[r];return i||(this._aBuffers[r]=i=new Yp(r*this.vertexSize*4)),i}getIndexBuffer(t){const e=hc(Math.ceil(t/12)),n=ZE(e),r=12*e;this._iBuffers.length<=n&&(this._iBuffers.length=n+1);let i=this._iBuffers[n];return i||(this._iBuffers[n]=i=new Uint16Array(r)),i}packInterleavedGeometry(t,e,n,r,i){const{uint32View:s,float32View:o}=e,a=r/this.vertexSize,l=t.uvs,u=t.indices,c=t.vertexData,h=t._texture.baseTexture._batchLocation,d=Math.min(t.worldAlpha,1),f=ft.shared.setValue(t._tintRGB).toPremultiplied(d,t._texture.baseTexture.alphaMode>0);for(let p=0;p<c.length;p+=2)o[r++]=c[p],o[r++]=c[p+1],o[r++]=l[p],o[r++]=l[p+1],s[r++]=f,o[r++]=h;for(let p=0;p<u.length;p++)n[i++]=a+u[p]}};let fr=dr;fr.defaultBatchSize=4096,fr.extension={name:"batch",type:fe.RendererPlugin},fr._drawCallPool=[],fr._textureArrayPool=[],Te.add(fr);const $a=class extends Gr{constructor(t,e,n){super(cr.from(t||$a.defaultVertexSrc,e||$a.defaultFragmentSrc),n),this.padding=0,this.resolution=$a.defaultResolution,this.multisample=$a.defaultMultisample,this.enabled=!0,this.autoFit=!0,this.state=new li}apply(t,e,n,r,i){t.applyFilter(this,e,n,r)}get blendMode(){return this.state.blendMode}set blendMode(t){this.state.blendMode=t}get resolution(){return this._resolution}set resolution(t){this._resolution=t}static get defaultVertexSrc(){return"attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n"}static get defaultFragmentSrc(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor = texture2D(uSampler, vTextureCoord);\n}\n"}};let sn=$a;sn.defaultResolution=1,sn.defaultMultisample=Wt.NONE;class Ec{constructor(){this.clearBeforeRender=!0,this._backgroundColor=new ft(0),this.alpha=1}init(e){this.clearBeforeRender=e.clearBeforeRender;const{backgroundColor:n,background:r,backgroundAlpha:i}=e,s=r??n;void 0!==s&&(this.color=s),this.alpha=i}get color(){return this._backgroundColor.value}set color(e){this._backgroundColor.setValue(e)}get alpha(){return this._backgroundColor.alpha}set alpha(e){this._backgroundColor.setAlpha(e)}get backgroundColor(){return this._backgroundColor}destroy(){}}Ec.defaultOptions={backgroundAlpha:1,backgroundColor:0,clearBeforeRender:!0},Ec.extension={type:[fe.RendererSystem,fe.CanvasRendererSystem],name:"background"},Te.add(Ec);class db{constructor(e){this.renderer=e,this.emptyRenderer=new wc(e),this.currentRenderer=this.emptyRenderer}setObjectRenderer(e){this.currentRenderer!==e&&(this.currentRenderer.stop(),this.currentRenderer=e,this.currentRenderer.start())}flush(){this.setObjectRenderer(this.emptyRenderer)}reset(){this.setObjectRenderer(this.emptyRenderer)}copyBoundTextures(e,n){const{boundTextures:r}=this.renderer.texture;for(let i=n-1;i>=0;--i)e[i]=r[i]||null,e[i]&&(e[i]._batchLocation=i)}boundArray(e,n,r,i){const{elements:s,ids:o,count:a}=e;let l=0;for(let u=0;u<a;u++){const c=s[u],h=c._batchLocation;if(h>=0&&h<i&&n[h]===c)o[u]=h;else for(;l<i;){const d=n[l];if(!d||d._batchEnabled!==r||d._batchLocation!==l){o[u]=l,c._batchLocation=l,n[l]=c;break}l++}}}destroy(){this.renderer=null}}db.extension={type:fe.RendererSystem,name:"batch"},Te.add(db);let fb=0;class bc{constructor(e){this.renderer=e,this.webGLVersion=1,this.extensions={},this.supports={uint32Indices:!1},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this)}get isLost(){return!this.gl||this.gl.isContextLost()}contextChange(e){this.gl=e,this.renderer.gl=e,this.renderer.CONTEXT_UID=fb++}init(e){if(e.context)this.initFromContext(e.context);else{const n=this.renderer.background.alpha<1,r=e.premultipliedAlpha;this.preserveDrawingBuffer=e.preserveDrawingBuffer,this.useContextAlpha=e.useContextAlpha,this.powerPreference=e.powerPreference,this.initFromOptions({alpha:n,premultipliedAlpha:r,antialias:e.antialias,stencil:!0,preserveDrawingBuffer:e.preserveDrawingBuffer,powerPreference:e.powerPreference})}}initFromContext(e){this.gl=e,this.validateContext(e),this.renderer.gl=e,this.renderer.CONTEXT_UID=fb++,this.renderer.runners.contextChange.emit(e);const n=this.renderer.view;void 0!==n.addEventListener&&(n.addEventListener("webglcontextlost",this.handleContextLost,!1),n.addEventListener("webglcontextrestored",this.handleContextRestored,!1))}initFromOptions(e){const n=this.createContext(this.renderer.view,e);this.initFromContext(n)}createContext(e,n){let r;if(ce.PREFER_ENV>=Ki.WEBGL2&&(r=e.getContext("webgl2",n)),r)this.webGLVersion=2;else if(this.webGLVersion=1,r=e.getContext("webgl",n)||e.getContext("experimental-webgl",n),!r)throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=r,this.getExtensions(),this.gl}getExtensions(){const{gl:e}=this,n={loseContext:e.getExtension("WEBGL_lose_context"),anisotropicFiltering:e.getExtension("EXT_texture_filter_anisotropic"),floatTextureLinear:e.getExtension("OES_texture_float_linear"),s3tc:e.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:e.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:e.getExtension("WEBGL_compressed_texture_etc"),etc1:e.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:e.getExtension("WEBGL_compressed_texture_atc"),astc:e.getExtension("WEBGL_compressed_texture_astc")};1===this.webGLVersion?Object.assign(this.extensions,n,{drawBuffers:e.getExtension("WEBGL_draw_buffers"),depthTexture:e.getExtension("WEBGL_depth_texture"),vertexArrayObject:e.getExtension("OES_vertex_array_object")||e.getExtension("MOZ_OES_vertex_array_object")||e.getExtension("WEBKIT_OES_vertex_array_object"),uint32ElementIndex:e.getExtension("OES_element_index_uint"),floatTexture:e.getExtension("OES_texture_float"),floatTextureLinear:e.getExtension("OES_texture_float_linear"),textureHalfFloat:e.getExtension("OES_texture_half_float"),textureHalfFloatLinear:e.getExtension("OES_texture_half_float_linear")}):2===this.webGLVersion&&Object.assign(this.extensions,n,{colorBufferFloat:e.getExtension("EXT_color_buffer_float")})}handleContextLost(e){e.preventDefault(),setTimeout(()=>{this.gl.isContextLost()&&this.extensions.loseContext&&this.extensions.loseContext.restoreContext()},0)}handleContextRestored(){this.renderer.runners.contextChange.emit(this.gl)}destroy(){const e=this.renderer.view;this.renderer=null,void 0!==e.removeEventListener&&(e.removeEventListener("webglcontextlost",this.handleContextLost),e.removeEventListener("webglcontextrestored",this.handleContextRestored)),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()}postrender(){this.renderer.objectRenderer.renderingToScreen&&this.gl.flush()}validateContext(e){const n=e.getContextAttributes(),r="WebGL2RenderingContext"in globalThis&&e instanceof globalThis.WebGL2RenderingContext;r&&(this.webGLVersion=2),n&&!n.stencil&&console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly");const i=r||!!e.getExtension("OES_element_index_uint");this.supports.uint32Indices=i,i||console.warn("Provided WebGL context does not support 32 index buffer, complex graphics may not render correctly")}}bc.defaultOptions={context:null,antialias:!1,premultipliedAlpha:!0,preserveDrawingBuffer:!1,powerPreference:"default"},bc.extension={type:fe.RendererSystem,name:"context"},Te.add(bc);class jk extends Ga{upload(e,n,r){const i=e.gl;i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,n.alphaMode===ar.UNPACK);const s=n.realWidth,o=n.realHeight;return r.width===s&&r.height===o?i.texSubImage2D(n.target,0,0,0,s,o,n.format,r.type,this.data):(r.width=s,r.height=o,i.texImage2D(n.target,0,r.internalFormat,s,o,0,n.format,r.type,this.data)),!0}}class lg{constructor(e,n){this.width=Math.round(e||100),this.height=Math.round(n||100),this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new ur("disposeFramebuffer"),this.multisample=Wt.NONE}get colorTexture(){return this.colorTextures[0]}addColorTexture(e=0,n){return this.colorTextures[e]=n||new $e(null,{scaleMode:kr.NEAREST,resolution:1,mipmap:Br.OFF,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this}addDepthTexture(e){return this.depthTexture=e||new $e(new jk(null,{width:this.width,height:this.height}),{scaleMode:kr.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:Br.OFF,format:K.DEPTH_COMPONENT,type:Re.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this}enableDepth(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this}enableStencil(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this}resize(e,n){if(e=Math.round(e),n=Math.round(n),e!==this.width||n!==this.height){this.width=e,this.height=n,this.dirtyId++,this.dirtySize++;for(let r=0;r<this.colorTextures.length;r++){const i=this.colorTextures[r],s=i.resolution;i.setSize(e/s,n/s)}if(this.depthTexture){const r=this.depthTexture.resolution;this.depthTexture.setSize(e/r,n/r)}}}dispose(){this.disposeRunner.emit(this,!1)}destroyDepthTexture(){this.depthTexture&&(this.depthTexture.destroy(),this.depthTexture=null,++this.dirtyId,++this.dirtyFormat)}}class pb extends $e{constructor(e={}){"number"==typeof e&&(e={width:arguments[0],height:arguments[1],scaleMode:arguments[2],resolution:arguments[3]}),e.width=e.width||100,e.height=e.height||100,e.multisample??(e.multisample=Wt.NONE),super(null,e),this.mipmap=Br.OFF,this.valid=!0,this._clear=new ft([0,0,0,0]),this.framebuffer=new lg(this.realWidth,this.realHeight).addColorTexture(0,this),this.framebuffer.multisample=e.multisample,this.maskStack=[],this.filterStack=[{}]}set clearColor(e){this._clear.setValue(e)}get clearColor(){return this._clear.value}get clear(){return this._clear}resize(e,n){this.framebuffer.resize(e*this.resolution,n*this.resolution),this.setRealSize(this.framebuffer.width,this.framebuffer.height)}dispose(){this.framebuffer.dispose(),super.dispose()}destroy(){super.destroy(),this.framebuffer.destroyDepthTexture(),this.framebuffer=null}}class Ci extends Va{constructor(e){super(e.naturalWidth||e.videoWidth||e.width,e.naturalHeight||e.videoHeight||e.height),this.source=e,this.noSubImage=!1}static crossOrigin(e,n,r){void 0!==r||n.startsWith("data:")?!1!==r&&(e.crossOrigin="string"==typeof r?r:"anonymous"):e.crossOrigin=function fk(t,e=globalThis.location){if(t.startsWith("data:"))return"";e=e||globalThis.location,dc||(dc=document.createElement("a")),dc.href=t;const n=$L.parse(dc.href);return n.hostname!==e.hostname||(n.port||""!==e.port)&&n.port!==e.port||n.protocol!==e.protocol?"anonymous":""}(n)}upload(e,n,r,i){const s=e.gl,o=n.realWidth,a=n.realHeight;if(i=i||this.source,typeof HTMLImageElement<"u"&&i instanceof HTMLImageElement){if(!i.complete||0===i.naturalWidth)return!1}else if(typeof HTMLVideoElement<"u"&&i instanceof HTMLVideoElement&&i.readyState<=1&&0===i.buffered.length)return!1;return s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,n.alphaMode===ar.UNPACK),this.noSubImage||n.target!==s.TEXTURE_2D||r.width!==o||r.height!==a?(r.width=o,r.height=a,s.texImage2D(n.target,0,r.internalFormat,n.format,r.type,i)):s.texSubImage2D(s.TEXTURE_2D,0,0,0,n.format,r.type,i),!0}update(){if(this.destroyed)return;const e=this.source;this.resize(e.naturalWidth||e.videoWidth||e.width,e.naturalHeight||e.videoHeight||e.height),super.update()}dispose(){this.source=null}}class gb extends Ci{constructor(e,n){if(n=n||{},"string"==typeof e){const r=new Image;Ci.crossOrigin(r,e,n.crossorigin),r.src=e,e=r}super(e),!e.complete&&this._width&&this._height&&(this._width=0,this._height=0),this.url=e.src,this._process=null,this.preserveBitmap=!1,this.createBitmap=(n.createBitmap??ce.CREATE_IMAGE_BITMAP)&&!!globalThis.createImageBitmap,this.alphaMode="number"==typeof n.alphaMode?n.alphaMode:null,this.bitmap=null,this._load=null,!1!==n.autoLoad&&this.load()}load(e){return this._load||(void 0!==e&&(this.createBitmap=e),this._load=new Promise((n,r)=>{const i=this.source;this.url=i.src;const s=()=>{this.destroyed||(i.onload=null,i.onerror=null,this.resize(i.width,i.height),this._load=null,n(this.createBitmap?this.process():this))};i.complete&&i.src?s():(i.onload=s,i.onerror=o=>{r(o),this.onError.emit(o)})})),this._load}process(){const e=this.source;if(null!==this._process)return this._process;if(null!==this.bitmap||!globalThis.createImageBitmap)return Promise.resolve(this);const n=globalThis.createImageBitmap;return this._process=fetch(e.src,{mode:e.crossOrigin&&"anonymous"!==e.crossOrigin?"no-cors":"cors"}).then(i=>i.blob()).then(i=>n(i,0,0,e.width,e.height,{premultiplyAlpha:null===this.alphaMode||this.alphaMode===ar.UNPACK?"premultiply":"none"})).then(i=>this.destroyed?Promise.reject():(this.bitmap=i,this.update(),this._process=null,Promise.resolve(this))),this._process}upload(e,n,r){if("number"==typeof this.alphaMode&&(n.alphaMode=this.alphaMode),!this.createBitmap)return super.upload(e,n,r);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(super.upload(e,n,r,this.bitmap),!this.preserveBitmap){let i=!0;const s=n._glTextures;for(const o in s){const a=s[o];if(a!==r&&a.dirtyId!==n.dirtyId){i=!1;break}}i&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0}dispose(){this.source.onload=null,this.source.onerror=null,super.dispose(),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null}static test(e){return typeof HTMLImageElement<"u"&&("string"==typeof e||e instanceof HTMLImageElement)}}class mb{constructor(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)}set(e,n,r){const i=n.width,s=n.height;if(r){const o=e.width/2/i,a=e.height/2/s,l=e.x/i+o,u=e.y/s+a;r=Lt.add(r,Lt.NW),this.x0=l+o*Lt.uX(r),this.y0=u+a*Lt.uY(r),r=Lt.add(r,2),this.x1=l+o*Lt.uX(r),this.y1=u+a*Lt.uY(r),r=Lt.add(r,2),this.x2=l+o*Lt.uX(r),this.y2=u+a*Lt.uY(r),r=Lt.add(r,2),this.x3=l+o*Lt.uX(r),this.y3=u+a*Lt.uY(r)}else this.x0=e.x/i,this.y0=e.y/s,this.x1=(e.x+e.width)/i,this.y1=e.y/s,this.x2=(e.x+e.width)/i,this.y2=(e.y+e.height)/s,this.x3=e.x/i,this.y3=(e.y+e.height)/s;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3}toString(){return`[@pixi/core:TextureUvs x0=${this.x0} y0=${this.y0} x1=${this.x1} y1=${this.y1} x2=${this.x2} y2=${this.y2} x3=${this.x3} y3=${this.y3}]`}}const yb=new mb;function Dc(t){t.destroy=function(){},t.on=function(){},t.once=function(){},t.emit=function(){}}class _e extends Ba{constructor(e,n,r,i,s,o,a){if(super(),this.noFrame=!1,n||(this.noFrame=!0,n=new et(0,0,1,1)),e instanceof _e&&(e=e.baseTexture),this.baseTexture=e,this._frame=n,this.trim=i,this.valid=!1,this._uvs=yb,this.uvMatrix=null,this.orig=r||n,this._rotate=Number(s||0),!0===s)this._rotate=2;else if(this._rotate%2!=0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");this.defaultAnchor=o?new ut(o.x,o.y):new ut(0,0),this.defaultBorders=a,this._updateID=0,this.textureCacheIds=[],e.valid?this.noFrame?e.valid&&this.onBaseTextureUpdated(e):this.frame=n:e.once("loaded",this.onBaseTextureUpdated,this),this.noFrame&&e.on("update",this.onBaseTextureUpdated,this)}update(){this.baseTexture.resource&&this.baseTexture.resource.update()}onBaseTextureUpdated(e){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=e.width,this._frame.height=e.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)}destroy(e){if(this.baseTexture){if(e){const{resource:n}=this.baseTexture;n?.url&&Pn[n.url]&&_e.removeFromCache(n.url),this.baseTexture.destroy()}this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,_e.removeFromCache(this),this.textureCacheIds=null}clone(){const e=this._frame.clone(),n=this._frame===this.orig?e:this.orig.clone(),r=new _e(this.baseTexture,!this.noFrame&&e,n,this.trim?.clone(),this.rotate,this.defaultAnchor,this.defaultBorders);return this.noFrame&&(r._frame=e),r}updateUvs(){this._uvs===yb&&(this._uvs=new mb),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++}static from(e,n={},r=ce.STRICT_TEXTURE_CACHE){const i="string"==typeof e;let s=null;i?s=e:e instanceof $e?(e.cacheId||(e.cacheId=`${n?.pixiIdPrefix||"pixiid"}-${Qi()}`,$e.addToCache(e,e.cacheId)),s=e.cacheId):(e._pixiId||(e._pixiId=`${n?.pixiIdPrefix||"pixiid"}_${Qi()}`),s=e._pixiId);let o=Pn[s];if(i&&r&&!o)throw new Error(`The cacheId "${s}" does not exist in TextureCache.`);return o||e instanceof $e?!o&&e instanceof $e&&(o=new _e(e),_e.addToCache(o,s)):(n.resolution||(n.resolution=Di(e)),o=new _e(new $e(e,n)),o.baseTexture.cacheId=s,$e.addToCache(o.baseTexture,s),_e.addToCache(o,s)),o}static fromURL(e,n){const r=Object.assign({autoLoad:!1},n?.resourceOptions),i=_e.from(e,Object.assign({resourceOptions:r},n),!1),s=i.baseTexture.resource;return i.baseTexture.valid?Promise.resolve(i):s.load().then(()=>Promise.resolve(i))}static fromBuffer(e,n,r,i){return new _e($e.fromBuffer(e,n,r,i))}static fromLoader(e,n,r,i){const s=new $e(e,Object.assign({scaleMode:$e.defaultOptions.scaleMode,resolution:Di(n)},i)),{resource:o}=s;o instanceof gb&&(o.url=n);const a=new _e(s);return r||(r=n),$e.addToCache(a.baseTexture,r),_e.addToCache(a,r),r!==n&&($e.addToCache(a.baseTexture,n),_e.addToCache(a,n)),a.baseTexture.valid?Promise.resolve(a):new Promise(l=>{a.baseTexture.once("loaded",()=>l(a))})}static addToCache(e,n){n&&(e.textureCacheIds.includes(n)||e.textureCacheIds.push(n),Pn[n]&&Pn[n]!==e&&console.warn(`Texture added to the cache with an id [${n}] that already had an entry`),Pn[n]=e)}static removeFromCache(e){if("string"==typeof e){const n=Pn[e];if(n){const r=n.textureCacheIds.indexOf(e);return r>-1&&n.textureCacheIds.splice(r,1),delete Pn[e],n}}else if(e?.textureCacheIds){for(let n=0;n<e.textureCacheIds.length;++n)Pn[e.textureCacheIds[n]]===e&&delete Pn[e.textureCacheIds[n]];return e.textureCacheIds.length=0,e}return null}get resolution(){return this.baseTexture.resolution}get frame(){return this._frame}set frame(e){this._frame=e,this.noFrame=!1;const{x:n,y:r,width:i,height:s}=e,o=n+i>this.baseTexture.width,a=r+s>this.baseTexture.height;if(o||a)throw new Error(`Texture Error: frame does not fit inside the base Texture dimensions: X: ${n} + ${i} = ${n+i} > ${this.baseTexture.width} ${o&&a?"and":"or"} Y: ${r} + ${s} = ${r+s} > ${this.baseTexture.height}`);this.valid=i&&s&&this.baseTexture.valid,!this.trim&&!this.rotate&&(this.orig=e),this.valid&&this.updateUvs()}get rotate(){return this._rotate}set rotate(e){this._rotate=e,this.valid&&this.updateUvs()}get width(){return this.orig.width}get height(){return this.orig.height}castToBaseTexture(){return this.baseTexture}static get EMPTY(){return _e._EMPTY||(_e._EMPTY=new _e(new $e),Dc(_e._EMPTY),Dc(_e._EMPTY.baseTexture)),_e._EMPTY}static get WHITE(){if(!_e._WHITE){const e=ce.ADAPTER.createCanvas(16,16),n=e.getContext("2d");e.width=16,e.height=16,n.fillStyle="white",n.fillRect(0,0,16,16),_e._WHITE=new _e($e.from(e)),Dc(_e._WHITE),Dc(_e._WHITE.baseTexture)}return _e._WHITE}}class is extends _e{constructor(e,n){super(e,n),this.valid=!0,this.filterFrame=null,this.filterPoolKey=null,this.updateUvs()}get framebuffer(){return this.baseTexture.framebuffer}get multisample(){return this.framebuffer.multisample}set multisample(e){this.framebuffer.multisample=e}resize(e,n,r=!0){const i=this.baseTexture.resolution,s=Math.round(e*i)/i,o=Math.round(n*i)/i;this.valid=s>0&&o>0,this._frame.width=this.orig.width=s,this._frame.height=this.orig.height=o,r&&this.baseTexture.resize(s,o),this.updateUvs()}setResolution(e){const{baseTexture:n}=this;n.resolution!==e&&(n.setResolution(e),this.resize(n.width,n.height,!1))}static create(e){return new is(new pb(e))}}let $k=(()=>{class t{constructor(n){this.texturePool={},this.textureOptions=n||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}createTexture(n,r,i=Wt.NONE){const s=new pb(Object.assign({width:n,height:r,resolution:1,multisample:i},this.textureOptions));return new is(s)}getOptimalTexture(n,r,i=1,s=Wt.NONE){let o;n=Math.ceil(n*i-1e-6),r=Math.ceil(r*i-1e-6),this.enableFullScreen&&n===this._pixelsWidth&&r===this._pixelsHeight?o=s>1?-s:-1:(o=((65535&(n=hc(n)))<<16|65535&(r=hc(r)))>>>0,s>1&&(o+=4294967296*s)),this.texturePool[o]||(this.texturePool[o]=[]);let a=this.texturePool[o].pop();return a||(a=this.createTexture(n,r,s)),a.filterPoolKey=o,a.setResolution(i),a}getFilterTexture(n,r,i){const s=this.getOptimalTexture(n.width,n.height,r||n.resolution,i||Wt.NONE);return s.filterFrame=n.filterFrame,s}returnTexture(n){const r=n.filterPoolKey;n.filterFrame=null,this.texturePool[r].push(n)}returnFilterTexture(n){this.returnTexture(n)}clear(n){if(n=!1!==n)for(const r in this.texturePool){const i=this.texturePool[r];if(i)for(let s=0;s<i.length;s++)i[s].destroy(!0)}this.texturePool={}}setScreenSize(n){if(n.width!==this._pixelsWidth||n.height!==this._pixelsHeight){this.enableFullScreen=n.width>0&&n.height>0;for(const r in this.texturePool){if(!(Number(r)<0))continue;const i=this.texturePool[r];if(i)for(let s=0;s<i.length;s++)i[s].destroy(!0);this.texturePool[r]=[]}this._pixelsWidth=n.width,this._pixelsHeight=n.height}}}return t.SCREEN_KEY=-1,t})();class zk extends Si{constructor(){super(),this.addAttribute("aVertexPosition",new Float32Array([0,0,1,0,1,1,0,1])).addIndex([0,1,3,2])}}class _b extends Si{constructor(){super(),this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.vertexBuffer=new jt(this.vertices),this.uvBuffer=new jt(this.uvs),this.addAttribute("aVertexPosition",this.vertexBuffer).addAttribute("aTextureCoord",this.uvBuffer).addIndex([0,1,2,0,2,3])}map(e,n){let r=0,i=0;return this.uvs[0]=r,this.uvs[1]=i,this.uvs[2]=r+n.width/e.width,this.uvs[3]=i,this.uvs[4]=r+n.width/e.width,this.uvs[5]=i+n.height/e.height,this.uvs[6]=r,this.uvs[7]=i+n.height/e.height,r=n.x,i=n.y,this.vertices[0]=r,this.vertices[1]=i,this.vertices[2]=r+n.width,this.vertices[3]=i,this.vertices[4]=r+n.width,this.vertices[5]=i+n.height,this.vertices[6]=r,this.vertices[7]=i+n.height,this.invalidate(),this}invalidate(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this}}class Wk{constructor(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.multisample=Wt.NONE,this.sourceFrame=new et,this.destinationFrame=new et,this.bindingSourceFrame=new et,this.bindingDestinationFrame=new et,this.filters=[],this.transform=null}clear(){this.target=null,this.filters=null,this.renderTexture=null}}const Sc=[new ut,new ut,new ut,new ut],ug=new Pt;class vb{constructor(e){this.renderer=e,this.defaultFilterStack=[{}],this.texturePool=new $k,this.statePool=[],this.quad=new zk,this.quadUv=new _b,this.tempRect=new et,this.activeState={},this.globalUniforms=new hr({outputFrame:new et,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this.forceClear=!1,this.useMaxPadding=!1}init(){this.texturePool.setScreenSize(this.renderer.view)}push(e,n){const r=this.renderer,i=this.defaultFilterStack,s=this.statePool.pop()||new Wk,o=this.renderer.renderTexture;let a=n[0].resolution,l=n[0].multisample,u=n[0].padding,c=n[0].autoFit,h=n[0].legacy??!0;for(let p=1;p<n.length;p++){const g=n[p];a=Math.min(a,g.resolution),l=Math.min(l,g.multisample),u=this.useMaxPadding?Math.max(u,g.padding):u+g.padding,c=c&&g.autoFit,h=h||(g.legacy??!0)}1===i.length&&(this.defaultFilterStack[0].renderTexture=o.current),i.push(s),s.resolution=a,s.multisample=l,s.legacy=h,s.target=e,s.sourceFrame.copyFrom(e.filterArea||e.getBounds(!0)),s.sourceFrame.pad(u);const d=this.tempRect.copyFrom(o.sourceFrame);r.projection.transform&&this.transformAABB(ug.copyFrom(r.projection.transform).invert(),d),c?(s.sourceFrame.fit(d),(s.sourceFrame.width<=0||s.sourceFrame.height<=0)&&(s.sourceFrame.width=0,s.sourceFrame.height=0)):s.sourceFrame.intersects(d)||(s.sourceFrame.width=0,s.sourceFrame.height=0),this.roundFrame(s.sourceFrame,o.current?o.current.resolution:r.resolution,o.sourceFrame,o.destinationFrame,r.projection.transform),s.renderTexture=this.getOptimalFilterTexture(s.sourceFrame.width,s.sourceFrame.height,a,l),s.filters=n,s.destinationFrame.width=s.renderTexture.width,s.destinationFrame.height=s.renderTexture.height;const f=this.tempRect;f.x=0,f.y=0,f.width=s.sourceFrame.width,f.height=s.sourceFrame.height,s.renderTexture.filterFrame=s.sourceFrame,s.bindingSourceFrame.copyFrom(o.sourceFrame),s.bindingDestinationFrame.copyFrom(o.destinationFrame),s.transform=r.projection.transform,r.projection.transform=null,o.bind(s.renderTexture,s.sourceFrame,f),r.framebuffer.clear(0,0,0,0)}pop(){const e=this.defaultFilterStack,n=e.pop(),r=n.filters;this.activeState=n;const i=this.globalUniforms.uniforms;i.outputFrame=n.sourceFrame,i.resolution=n.resolution;const s=i.inputSize,o=i.inputPixel,a=i.inputClamp;if(s[0]=n.destinationFrame.width,s[1]=n.destinationFrame.height,s[2]=1/s[0],s[3]=1/s[1],o[0]=Math.round(s[0]*n.resolution),o[1]=Math.round(s[1]*n.resolution),o[2]=1/o[0],o[3]=1/o[1],a[0]=.5*o[2],a[1]=.5*o[3],a[2]=n.sourceFrame.width*s[2]-.5*o[2],a[3]=n.sourceFrame.height*s[3]-.5*o[3],n.legacy){const u=i.filterArea;u[0]=n.destinationFrame.width,u[1]=n.destinationFrame.height,u[2]=n.sourceFrame.x,u[3]=n.sourceFrame.y,i.filterClamp=i.inputClamp}this.globalUniforms.update();const l=e[e.length-1];if(this.renderer.framebuffer.blit(),1===r.length)r[0].apply(this,n.renderTexture,l.renderTexture,Ur.BLEND,n),this.returnFilterTexture(n.renderTexture);else{let u=n.renderTexture,c=this.getOptimalFilterTexture(u.width,u.height,n.resolution);c.filterFrame=u.filterFrame;let h=0;for(h=0;h<r.length-1;++h){1===h&&n.multisample>1&&(c=this.getOptimalFilterTexture(u.width,u.height,n.resolution),c.filterFrame=u.filterFrame),r[h].apply(this,u,c,Ur.CLEAR,n);const d=u;u=c,c=d}r[h].apply(this,u,l.renderTexture,Ur.BLEND,n),h>1&&n.multisample>1&&this.returnFilterTexture(n.renderTexture),this.returnFilterTexture(u),this.returnFilterTexture(c)}n.clear(),this.statePool.push(n)}bindAndClear(e,n=Ur.CLEAR){const{renderTexture:r,state:i}=this.renderer;if(this.renderer.projection.transform=e===this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?this.activeState.transform:null,e?.filterFrame){const o=this.tempRect;o.x=0,o.y=0,o.width=e.filterFrame.width,o.height=e.filterFrame.height,r.bind(e,e.filterFrame,o)}else e!==this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?r.bind(e):this.renderer.renderTexture.bind(e,this.activeState.bindingSourceFrame,this.activeState.bindingDestinationFrame);(n===Ur.CLEAR||n===Ur.BLIT&&(1&i.stateId||this.forceClear))&&this.renderer.framebuffer.clear(0,0,0,0)}applyFilter(e,n,r,i){const s=this.renderer;s.state.set(e.state),this.bindAndClear(r,i),e.uniforms.uSampler=n,e.uniforms.filterGlobals=this.globalUniforms,s.shader.bind(e),e.legacy=!!e.program.attributeData.aTextureCoord,e.legacy?(this.quadUv.map(n._frame,n.filterFrame),s.geometry.bind(this.quadUv),s.geometry.draw(Lr.TRIANGLES)):(s.geometry.bind(this.quad),s.geometry.draw(Lr.TRIANGLE_STRIP))}calculateSpriteMatrix(e,n){const{sourceFrame:r,destinationFrame:i}=this.activeState,{orig:s}=n._texture,o=e.set(i.width,0,0,i.height,r.x,r.y),a=n.worldTransform.copyTo(Pt.TEMP_MATRIX);return a.invert(),o.prepend(a),o.scale(1/s.width,1/s.height),o.translate(n.anchor.x,n.anchor.y),o}destroy(){this.renderer=null,this.texturePool.clear(!1)}getOptimalFilterTexture(e,n,r=1,i=Wt.NONE){return this.texturePool.getOptimalTexture(e,n,r,i)}getFilterTexture(e,n,r){if("number"==typeof e){const s=e;e=n,n=s}const i=this.texturePool.getOptimalTexture((e=e||this.activeState.renderTexture).width,e.height,n||e.resolution,r||Wt.NONE);return i.filterFrame=e.filterFrame,i}returnFilterTexture(e){this.texturePool.returnTexture(e)}emptyPool(){this.texturePool.clear(!0)}resize(){this.texturePool.setScreenSize(this.renderer.view)}transformAABB(e,n){const r=Sc[0],i=Sc[1],s=Sc[2],o=Sc[3];r.set(n.left,n.top),i.set(n.left,n.bottom),s.set(n.right,n.top),o.set(n.right,n.bottom),e.apply(r,r),e.apply(i,i),e.apply(s,s),e.apply(o,o);const a=Math.min(r.x,i.x,s.x,o.x),l=Math.min(r.y,i.y,s.y,o.y),u=Math.max(r.x,i.x,s.x,o.x),c=Math.max(r.y,i.y,s.y,o.y);n.x=a,n.y=l,n.width=u-a,n.height=c-l}roundFrame(e,n,r,i,s){if(!(e.width<=0||e.height<=0||r.width<=0||r.height<=0)){if(s){const{a:o,b:a,c:l,d:u}=s;if((Math.abs(a)>1e-4||Math.abs(l)>1e-4)&&(Math.abs(o)>1e-4||Math.abs(u)>1e-4))return}(s=s?ug.copyFrom(s):ug.identity()).translate(-r.x,-r.y).scale(i.width/r.width,i.height/r.height).translate(i.x,i.y),this.transformAABB(s,e),e.ceil(n),this.transformAABB(s.invert(),e)}}}vb.extension={type:fe.RendererSystem,name:"filter"},Te.add(vb);class Xk{constructor(e){this.framebuffer=e,this.stencil=null,this.dirtyId=-1,this.dirtyFormat=-1,this.dirtySize=-1,this.multisample=Wt.NONE,this.msaaBuffer=null,this.blitFramebuffer=null,this.mipLevel=0}}const Yk=new et;class xb{constructor(e){this.renderer=e,this.managedFramebuffers=[],this.unknownFramebuffer=new lg(10,10),this.msaaSamples=null}contextChange(){this.disposeAll(!0);const e=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new et,this.hasMRT=!0,this.writeDepthTexture=!0,1===this.renderer.context.webGLVersion){let n=this.renderer.context.extensions.drawBuffers,r=this.renderer.context.extensions.depthTexture;ce.PREFER_ENV===Ki.WEBGL_LEGACY&&(n=null,r=null),n?e.drawBuffers=i=>n.drawBuffersWEBGL(i):(this.hasMRT=!1,e.drawBuffers=()=>{}),r||(this.writeDepthTexture=!1)}else this.msaaSamples=e.getInternalformatParameter(e.RENDERBUFFER,e.RGBA8,e.SAMPLES)}bind(e,n,r=0){const{gl:i}=this;if(e){const s=e.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(e);this.current!==e&&(this.current=e,i.bindFramebuffer(i.FRAMEBUFFER,s.framebuffer)),s.mipLevel!==r&&(e.dirtyId++,e.dirtyFormat++,s.mipLevel=r),s.dirtyId!==e.dirtyId&&(s.dirtyId=e.dirtyId,s.dirtyFormat!==e.dirtyFormat?(s.dirtyFormat=e.dirtyFormat,s.dirtySize=e.dirtySize,this.updateFramebuffer(e,r)):s.dirtySize!==e.dirtySize&&(s.dirtySize=e.dirtySize,this.resizeFramebuffer(e)));for(let o=0;o<e.colorTextures.length;o++){const a=e.colorTextures[o];this.renderer.texture.unbind(a.parentTextureArray||a)}if(e.depthTexture&&this.renderer.texture.unbind(e.depthTexture),n){const o=n.width>>r,l=o/n.width;this.setViewport(n.x*l,n.y*l,o,n.height>>r)}else this.setViewport(0,0,e.width>>r,e.height>>r)}else this.current&&(this.current=null,i.bindFramebuffer(i.FRAMEBUFFER,null)),n?this.setViewport(n.x,n.y,n.width,n.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)}setViewport(e,n,r,i){const s=this.viewport;e=Math.round(e),n=Math.round(n),r=Math.round(r),i=Math.round(i),(s.width!==r||s.height!==i||s.x!==e||s.y!==n)&&(s.x=e,s.y=n,s.width=r,s.height=i,this.gl.viewport(e,n,r,i))}get size(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}}clear(e,n,r,i,s=Op.COLOR|Op.DEPTH){const{gl:o}=this;o.clearColor(e,n,r,i),o.clear(s)}initFramebuffer(e){const{gl:n}=this,r=new Xk(n.createFramebuffer());return r.multisample=this.detectSamples(e.multisample),e.glFramebuffers[this.CONTEXT_UID]=r,this.managedFramebuffers.push(e),e.disposeRunner.add(this),r}resizeFramebuffer(e){const{gl:n}=this,r=e.glFramebuffers[this.CONTEXT_UID];r.stencil&&(n.bindRenderbuffer(n.RENDERBUFFER,r.stencil),r.msaaBuffer?n.renderbufferStorageMultisample(n.RENDERBUFFER,r.multisample,n.DEPTH24_STENCIL8,e.width,e.height):n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_STENCIL,e.width,e.height));const i=e.colorTextures;let s=i.length;n.drawBuffers||(s=Math.min(s,1));for(let o=0;o<s;o++){const a=i[o],l=a.parentTextureArray||a;this.renderer.texture.bind(l,0),0===o&&r.msaaBuffer&&(n.bindRenderbuffer(n.RENDERBUFFER,r.msaaBuffer),n.renderbufferStorageMultisample(n.RENDERBUFFER,r.multisample,l._glTextures[this.CONTEXT_UID].internalFormat,e.width,e.height))}e.depthTexture&&this.writeDepthTexture&&this.renderer.texture.bind(e.depthTexture,0)}updateFramebuffer(e,n){const{gl:r}=this,i=e.glFramebuffers[this.CONTEXT_UID],s=e.colorTextures;let o=s.length;r.drawBuffers||(o=Math.min(o,1)),i.multisample>1&&this.canMultisampleFramebuffer(e)?i.msaaBuffer=i.msaaBuffer||r.createRenderbuffer():i.msaaBuffer&&(r.deleteRenderbuffer(i.msaaBuffer),i.msaaBuffer=null,i.blitFramebuffer&&(i.blitFramebuffer.dispose(),i.blitFramebuffer=null));const a=[];for(let l=0;l<o;l++){const u=s[l],c=u.parentTextureArray||u;this.renderer.texture.bind(c,0),0===l&&i.msaaBuffer?(r.bindRenderbuffer(r.RENDERBUFFER,i.msaaBuffer),r.renderbufferStorageMultisample(r.RENDERBUFFER,i.multisample,c._glTextures[this.CONTEXT_UID].internalFormat,e.width,e.height),r.framebufferRenderbuffer(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.RENDERBUFFER,i.msaaBuffer)):(r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0+l,u.target,c._glTextures[this.CONTEXT_UID].texture,n),a.push(r.COLOR_ATTACHMENT0+l))}if(a.length>1&&r.drawBuffers(a),e.depthTexture&&this.writeDepthTexture){const u=e.depthTexture;this.renderer.texture.bind(u,0),r.framebufferTexture2D(r.FRAMEBUFFER,r.DEPTH_ATTACHMENT,r.TEXTURE_2D,u._glTextures[this.CONTEXT_UID].texture,n)}!e.stencil&&!e.depth||e.depthTexture&&this.writeDepthTexture?i.stencil&&(r.deleteRenderbuffer(i.stencil),i.stencil=null):(i.stencil=i.stencil||r.createRenderbuffer(),r.bindRenderbuffer(r.RENDERBUFFER,i.stencil),i.msaaBuffer?r.renderbufferStorageMultisample(r.RENDERBUFFER,i.multisample,r.DEPTH24_STENCIL8,e.width,e.height):r.renderbufferStorage(r.RENDERBUFFER,r.DEPTH_STENCIL,e.width,e.height),r.framebufferRenderbuffer(r.FRAMEBUFFER,r.DEPTH_STENCIL_ATTACHMENT,r.RENDERBUFFER,i.stencil))}canMultisampleFramebuffer(e){return 1!==this.renderer.context.webGLVersion&&e.colorTextures.length<=1&&!e.depthTexture}detectSamples(e){const{msaaSamples:n}=this;let r=Wt.NONE;if(e<=1||null===n)return r;for(let i=0;i<n.length;i++)if(n[i]<=e){r=n[i];break}return 1===r&&(r=Wt.NONE),r}blit(e,n,r){const{current:i,renderer:s,gl:o,CONTEXT_UID:a}=this;if(2!==s.context.webGLVersion||!i)return;const l=i.glFramebuffers[a];if(!l)return;if(!e){if(!l.msaaBuffer)return;const c=i.colorTextures[0];if(!c)return;l.blitFramebuffer||(l.blitFramebuffer=new lg(i.width,i.height),l.blitFramebuffer.addColorTexture(0,c)),(e=l.blitFramebuffer).colorTextures[0]!==c&&(e.colorTextures[0]=c,e.dirtyId++,e.dirtyFormat++),(e.width!==i.width||e.height!==i.height)&&(e.width=i.width,e.height=i.height,e.dirtyId++,e.dirtySize++)}n||((n=Yk).width=i.width,n.height=i.height),r||(r=n);const u=n.width===r.width&&n.height===r.height;this.bind(e),o.bindFramebuffer(o.READ_FRAMEBUFFER,l.framebuffer),o.blitFramebuffer(n.left,n.top,n.right,n.bottom,r.left,r.top,r.right,r.bottom,o.COLOR_BUFFER_BIT,u?o.NEAREST:o.LINEAR),o.bindFramebuffer(o.READ_FRAMEBUFFER,e.glFramebuffers[this.CONTEXT_UID].framebuffer)}disposeFramebuffer(e,n){const r=e.glFramebuffers[this.CONTEXT_UID],i=this.gl;if(!r)return;delete e.glFramebuffers[this.CONTEXT_UID];const s=this.managedFramebuffers.indexOf(e);s>=0&&this.managedFramebuffers.splice(s,1),e.disposeRunner.remove(this),n||(i.deleteFramebuffer(r.framebuffer),r.msaaBuffer&&i.deleteRenderbuffer(r.msaaBuffer),r.stencil&&i.deleteRenderbuffer(r.stencil)),r.blitFramebuffer&&this.disposeFramebuffer(r.blitFramebuffer,n)}disposeAll(e){const n=this.managedFramebuffers;this.managedFramebuffers=[];for(let r=0;r<n.length;r++)this.disposeFramebuffer(n[r],e)}forceStencil(){const e=this.current;if(!e)return;const n=e.glFramebuffers[this.CONTEXT_UID];if(!n||n.stencil)return;e.stencil=!0;const r=e.width,i=e.height,s=this.gl,o=s.createRenderbuffer();s.bindRenderbuffer(s.RENDERBUFFER,o),n.msaaBuffer?s.renderbufferStorageMultisample(s.RENDERBUFFER,n.multisample,s.DEPTH24_STENCIL8,r,i):s.renderbufferStorage(s.RENDERBUFFER,s.DEPTH_STENCIL,r,i),n.stencil=o,s.framebufferRenderbuffer(s.FRAMEBUFFER,s.DEPTH_STENCIL_ATTACHMENT,s.RENDERBUFFER,o)}reset(){this.current=this.unknownFramebuffer,this.viewport=new et}destroy(){this.renderer=null}}xb.extension={type:fe.RendererSystem,name:"framebuffer"},Te.add(xb);const cg={5126:4,5123:2,5121:1};class wb{constructor(e){this.renderer=e,this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.managedGeometries={}}contextChange(){this.disposeAll(!0);const e=this.gl=this.renderer.gl,n=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,2!==n.webGLVersion){let r=this.renderer.context.extensions.vertexArrayObject;ce.PREFER_ENV===Ki.WEBGL_LEGACY&&(r=null),r?(e.createVertexArray=()=>r.createVertexArrayOES(),e.bindVertexArray=i=>r.bindVertexArrayOES(i),e.deleteVertexArray=i=>r.deleteVertexArrayOES(i)):(this.hasVao=!1,e.createVertexArray=()=>null,e.bindVertexArray=()=>null,e.deleteVertexArray=()=>null)}if(2!==n.webGLVersion){const r=e.getExtension("ANGLE_instanced_arrays");r?(e.vertexAttribDivisor=(i,s)=>r.vertexAttribDivisorANGLE(i,s),e.drawElementsInstanced=(i,s,o,a,l)=>r.drawElementsInstancedANGLE(i,s,o,a,l),e.drawArraysInstanced=(i,s,o,a)=>r.drawArraysInstancedANGLE(i,s,o,a)):this.hasInstance=!1}this.canUseUInt32ElementIndex=2===n.webGLVersion||!!n.extensions.uint32ElementIndex}bind(e,n){n=n||this.renderer.shader.shader;const{gl:r}=this;let i=e.glVertexArrayObjects[this.CONTEXT_UID],s=!1;i||(this.managedGeometries[e.id]=e,e.disposeRunner.add(this),e.glVertexArrayObjects[this.CONTEXT_UID]=i={},s=!0);const o=i[n.program.id]||this.initGeometryVao(e,n,s);this._activeGeometry=e,this._activeVao!==o&&(this._activeVao=o,this.hasVao?r.bindVertexArray(o):this.activateVao(e,n.program)),this.updateBuffers()}reset(){this.unbind()}updateBuffers(){const e=this._activeGeometry,n=this.renderer.buffer;for(let r=0;r<e.buffers.length;r++)n.update(e.buffers[r])}checkCompatibility(e,n){const r=e.attributes,i=n.attributeData;for(const s in i)if(!r[s])throw new Error(`shader and geometry incompatible, geometry missing the "${s}" attribute`)}getSignature(e,n){const r=e.attributes,i=n.attributeData,s=["g",e.id];for(const o in r)i[o]&&s.push(o,i[o].location);return s.join("-")}initGeometryVao(e,n,r=!0){const i=this.gl,s=this.CONTEXT_UID,o=this.renderer.buffer,a=n.program;a.glPrograms[s]||this.renderer.shader.generateProgram(n),this.checkCompatibility(e,a);const l=this.getSignature(e,a),u=e.glVertexArrayObjects[this.CONTEXT_UID];let c=u[l];if(c)return u[a.id]=c,c;const h=e.buffers,d=e.attributes,f={},p={};for(const g in h)f[g]=0,p[g]=0;for(const g in d)!d[g].size&&a.attributeData[g]?d[g].size=a.attributeData[g].size:d[g].size||console.warn(`PIXI Geometry attribute '${g}' size cannot be determined (likely the bound shader does not have the attribute)`),f[d[g].buffer]+=d[g].size*cg[d[g].type];for(const g in d){const m=d[g],_=m.size;void 0===m.stride&&(m.stride=f[m.buffer]===_*cg[m.type]?0:f[m.buffer]),void 0===m.start&&(m.start=p[m.buffer],p[m.buffer]+=_*cg[m.type])}c=i.createVertexArray(),i.bindVertexArray(c);for(let g=0;g<h.length;g++){const m=h[g];o.bind(m),r&&m._glBuffers[s].refCount++}return this.activateVao(e,a),u[a.id]=c,u[l]=c,i.bindVertexArray(null),o.unbind(Hr.ARRAY_BUFFER),c}disposeGeometry(e,n){if(!this.managedGeometries[e.id])return;delete this.managedGeometries[e.id];const r=e.glVertexArrayObjects[this.CONTEXT_UID],i=this.gl,s=e.buffers,o=this.renderer?.buffer;if(e.disposeRunner.remove(this),r){if(o)for(let a=0;a<s.length;a++){const l=s[a]._glBuffers[this.CONTEXT_UID];l&&(l.refCount--,0===l.refCount&&!n&&o.dispose(s[a],n))}if(!n)for(const a in r)if("g"===a[0]){const l=r[a];this._activeVao===l&&this.unbind(),i.deleteVertexArray(l)}delete e.glVertexArrayObjects[this.CONTEXT_UID]}}disposeAll(e){const n=Object.keys(this.managedGeometries);for(let r=0;r<n.length;r++)this.disposeGeometry(this.managedGeometries[n[r]],e)}activateVao(e,n){const r=this.gl,i=this.CONTEXT_UID,s=this.renderer.buffer,o=e.buffers,a=e.attributes;e.indexBuffer&&s.bind(e.indexBuffer);let l=null;for(const u in a){const c=a[u],h=o[c.buffer],d=h._glBuffers[i];if(n.attributeData[u]){l!==d&&(s.bind(h),l=d);const f=n.attributeData[u].location;if(r.enableVertexAttribArray(f),r.vertexAttribPointer(f,c.size,c.type||r.FLOAT,c.normalized,c.stride,c.start),c.instance){if(!this.hasInstance)throw new Error("geometry error, GPU Instancing is not supported on this device");r.vertexAttribDivisor(f,c.divisor)}}}}draw(e,n,r,i){const{gl:s}=this,o=this._activeGeometry;if(o.indexBuffer){const a=o.indexBuffer.data.BYTES_PER_ELEMENT,l=2===a?s.UNSIGNED_SHORT:s.UNSIGNED_INT;2===a||4===a&&this.canUseUInt32ElementIndex?o.instanced?s.drawElementsInstanced(e,n||o.indexBuffer.data.length,l,(r||0)*a,i||1):s.drawElements(e,n||o.indexBuffer.data.length,l,(r||0)*a):console.warn("unsupported index buffer type: uint32")}else o.instanced?s.drawArraysInstanced(e,r,n||o.getSize(),i||1):s.drawArrays(e,r,n||o.getSize());return this}unbind(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null}destroy(){this.renderer=null}}wb.extension={type:fe.RendererSystem,name:"geometry"},Te.add(wb);const Eb=new Pt;class hg{constructor(e,n){this._texture=e,this.mapCoord=new Pt,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,this.clampMargin=typeof n>"u"?.5:n,this.isSimple=!1}get texture(){return this._texture}set texture(e){this._texture=e,this._textureID=-1}multiplyUvs(e,n){void 0===n&&(n=e);const r=this.mapCoord;for(let i=0;i<e.length;i+=2){const s=e[i],o=e[i+1];n[i]=s*r.a+o*r.c+r.tx,n[i+1]=s*r.b+o*r.d+r.ty}return n}update(e){const n=this._texture;if(!n||!n.valid||!e&&this._textureID===n._updateID)return!1;this._textureID=n._updateID,this._updateID++;const r=n._uvs;this.mapCoord.set(r.x1-r.x0,r.y1-r.y0,r.x3-r.x0,r.y3-r.y0,r.x0,r.y0);const i=n.orig,s=n.trim;s&&(Eb.set(i.width/s.width,0,0,i.height/s.height,-s.x/s.width,-s.y/s.height),this.mapCoord.append(Eb));const o=n.baseTexture,a=this.uClampFrame,l=this.clampMargin/o.resolution,u=this.clampOffset;return a[0]=(n._frame.x+l+u)/o.width,a[1]=(n._frame.y+l+u)/o.height,a[2]=(n._frame.x+n._frame.width-l+u)/o.width,a[3]=(n._frame.y+n._frame.height-l+u)/o.height,this.uClampOffset[0]=u/o.realWidth,this.uClampOffset[1]=u/o.realHeight,this.isSimple=n._frame.width===o.width&&n._frame.height===o.height&&0===n.rotate,!0}}class Kk extends sn{constructor(e,n,r){let i=null;"string"!=typeof e&&void 0===n&&void 0===r&&(i=e,e=void 0,n=void 0,r=void 0),super(e||"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 otherMatrix;\n\nvarying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n}\n",n||"varying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform sampler2D mask;\nuniform float alpha;\nuniform float npmAlpha;\nuniform vec4 maskClamp;\n\nvoid main(void)\n{\n    float clip = step(3.5,\n        step(maskClamp.x, vMaskCoord.x) +\n        step(maskClamp.y, vMaskCoord.y) +\n        step(vMaskCoord.x, maskClamp.z) +\n        step(vMaskCoord.y, maskClamp.w));\n\n    vec4 original = texture2D(uSampler, vTextureCoord);\n    vec4 masky = texture2D(mask, vMaskCoord);\n    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);\n\n    original *= (alphaMul * masky.r * alpha * clip);\n\n    gl_FragColor = original;\n}\n",r),this.maskSprite=i,this.maskMatrix=new Pt}get maskSprite(){return this._maskSprite}set maskSprite(e){this._maskSprite=e,this._maskSprite&&(this._maskSprite.renderable=!1)}apply(e,n,r,i){const s=this._maskSprite,o=s._texture;o.valid&&(o.uvMatrix||(o.uvMatrix=new hg(o,0)),o.uvMatrix.update(),this.uniforms.npmAlpha=o.baseTexture.alphaMode?0:1,this.uniforms.mask=o,this.uniforms.otherMatrix=e.calculateSpriteMatrix(this.maskMatrix,s).prepend(o.uvMatrix.mapCoord),this.uniforms.alpha=s.worldAlpha,this.uniforms.maskClamp=o.uvMatrix.uClampFrame,e.applyFilter(this,n,r,i))}}class Qk{constructor(e=null){this.type=Kt.NONE,this.autoDetect=!0,this.maskObject=e||null,this.pooled=!1,this.isMaskData=!0,this.resolution=null,this.multisample=sn.defaultMultisample,this.enabled=!0,this.colorMask=15,this._filters=null,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._scissorRectLocal=null,this._colorMask=15,this._target=null}get filter(){return this._filters?this._filters[0]:null}set filter(e){e?this._filters?this._filters[0]=e:this._filters=[e]:this._filters=null}reset(){this.pooled&&(this.maskObject=null,this.type=Kt.NONE,this.autoDetect=!0),this._target=null,this._scissorRectLocal=null}copyCountersOrReset(e){e?(this._stencilCounter=e._stencilCounter,this._scissorCounter=e._scissorCounter,this._scissorRect=e._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)}}class bb{constructor(e){this.renderer=e,this.enableScissor=!0,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],this.alphaMaskIndex=0}setMaskStack(e){this.maskStack=e,this.renderer.scissor.setMaskStack(e),this.renderer.stencil.setMaskStack(e)}push(e,n){let r=n;if(!r.isMaskData){const s=this.maskDataPool.pop()||new Qk;s.pooled=!0,s.maskObject=n,r=s}const i=0!==this.maskStack.length?this.maskStack[this.maskStack.length-1]:null;if(r.copyCountersOrReset(i),r._colorMask=i?i._colorMask:15,r.autoDetect&&this.detect(r),r._target=e,r.type!==Kt.SPRITE&&this.maskStack.push(r),r.enabled)switch(r.type){case Kt.SCISSOR:this.renderer.scissor.push(r);break;case Kt.STENCIL:this.renderer.stencil.push(r);break;case Kt.SPRITE:r.copyCountersOrReset(null),this.pushSpriteMask(r);break;case Kt.COLOR:this.pushColorMask(r)}r.type===Kt.SPRITE&&this.maskStack.push(r)}pop(e){const n=this.maskStack.pop();if(n&&n._target===e){if(n.enabled)switch(n.type){case Kt.SCISSOR:this.renderer.scissor.pop(n);break;case Kt.STENCIL:this.renderer.stencil.pop(n.maskObject);break;case Kt.SPRITE:this.popSpriteMask(n);break;case Kt.COLOR:this.popColorMask(n)}if(n.reset(),n.pooled&&this.maskDataPool.push(n),0!==this.maskStack.length){const r=this.maskStack[this.maskStack.length-1];r.type===Kt.SPRITE&&r._filters&&(r._filters[0].maskSprite=r.maskObject)}}}detect(e){const n=e.maskObject;e.type=n?n.isSprite?Kt.SPRITE:this.enableScissor&&this.renderer.scissor.testScissor(e)?Kt.SCISSOR:Kt.STENCIL:Kt.COLOR}pushSpriteMask(e){const{maskObject:n}=e,r=e._target;let i=e._filters;i||(i=this.alphaMaskPool[this.alphaMaskIndex],i||(i=this.alphaMaskPool[this.alphaMaskIndex]=[new Kk]));const s=this.renderer,o=s.renderTexture;let a,l;if(o.current){const c=o.current;a=e.resolution||c.resolution,l=e.multisample??c.multisample}else a=e.resolution||s.resolution,l=e.multisample??s.multisample;i[0].resolution=a,i[0].multisample=l,i[0].maskSprite=n;const u=r.filterArea;r.filterArea=n.getBounds(!0),s.filter.push(r,i),r.filterArea=u,e._filters||this.alphaMaskIndex++}popSpriteMask(e){this.renderer.filter.pop(),e._filters?e._filters[0].maskSprite=null:(this.alphaMaskIndex--,this.alphaMaskPool[this.alphaMaskIndex][0].maskSprite=null)}pushColorMask(e){const n=e._colorMask,r=e._colorMask=n&e.colorMask;r!==n&&this.renderer.gl.colorMask(0!=(1&r),0!=(2&r),0!=(4&r),0!=(8&r))}popColorMask(e){const r=this.maskStack.length>0?this.maskStack[this.maskStack.length-1]._colorMask:15;r!==e._colorMask&&this.renderer.gl.colorMask(0!=(1&r),0!=(2&r),0!=(4&r),0!=(8&r))}destroy(){this.renderer=null}}bb.extension={type:fe.RendererSystem,name:"mask"},Te.add(bb);class Db{constructor(e){this.renderer=e,this.maskStack=[],this.glConst=0}getStackLength(){return this.maskStack.length}setMaskStack(e){const{gl:n}=this.renderer,r=this.getStackLength();this.maskStack=e;const i=this.getStackLength();i!==r&&(0===i?n.disable(this.glConst):(n.enable(this.glConst),this._useCurrent()))}_useCurrent(){}destroy(){this.renderer=null,this.maskStack=null}}const Sb=new Pt,Tb=[],Tc=class extends Db{constructor(t){super(t),this.glConst=ce.ADAPTER.getWebGLRenderingContext().SCISSOR_TEST}getStackLength(){const t=this.maskStack[this.maskStack.length-1];return t?t._scissorCounter:0}calcScissorRect(t){if(t._scissorRectLocal)return;const e=t._scissorRect,{maskObject:n}=t,{renderer:r}=this,i=r.renderTexture,s=n.getBounds(!0,Tb.pop()??new et);this.roundFrameToPixels(s,i.current?i.current.resolution:r.resolution,i.sourceFrame,i.destinationFrame,r.projection.transform),e&&s.fit(e),t._scissorRectLocal=s}static isMatrixRotated(t){if(!t)return!1;const{a:e,b:n,c:r,d:i}=t;return(Math.abs(n)>1e-4||Math.abs(r)>1e-4)&&(Math.abs(e)>1e-4||Math.abs(i)>1e-4)}testScissor(t){const{maskObject:e}=t;if(!e.isFastRect||!e.isFastRect()||Tc.isMatrixRotated(e.worldTransform)||Tc.isMatrixRotated(this.renderer.projection.transform))return!1;this.calcScissorRect(t);const n=t._scissorRectLocal;return n.width>0&&n.height>0}roundFrameToPixels(t,e,n,r,i){Tc.isMatrixRotated(i)||((i=i?Sb.copyFrom(i):Sb.identity()).translate(-n.x,-n.y).scale(r.width/n.width,r.height/n.height).translate(r.x,r.y),this.renderer.filter.transformAABB(i,t),t.fit(r),t.x=Math.round(t.x*e),t.y=Math.round(t.y*e),t.width=Math.round(t.width*e),t.height=Math.round(t.height*e))}push(t){t._scissorRectLocal||this.calcScissorRect(t);const{gl:e}=this.renderer;t._scissorRect||e.enable(e.SCISSOR_TEST),t._scissorCounter++,t._scissorRect=t._scissorRectLocal,this._useCurrent()}pop(t){const{gl:e}=this.renderer;t&&Tb.push(t._scissorRectLocal),this.getStackLength()>0?this._useCurrent():e.disable(e.SCISSOR_TEST)}_useCurrent(){const t=this.maskStack[this.maskStack.length-1]._scissorRect;let e;e=this.renderer.renderTexture.current?t.y:this.renderer.height-t.height-t.y,this.renderer.gl.scissor(t.x,e,t.width,t.height)}};let Cb=Tc;Cb.extension={type:fe.RendererSystem,name:"scissor"},Te.add(Cb);class Ib extends Db{constructor(e){super(e),this.glConst=ce.ADAPTER.getWebGLRenderingContext().STENCIL_TEST}getStackLength(){const e=this.maskStack[this.maskStack.length-1];return e?e._stencilCounter:0}push(e){const n=e.maskObject,{gl:r}=this.renderer,i=e._stencilCounter;0===i&&(this.renderer.framebuffer.forceStencil(),r.clearStencil(0),r.clear(r.STENCIL_BUFFER_BIT),r.enable(r.STENCIL_TEST)),e._stencilCounter++;const s=e._colorMask;0!==s&&(e._colorMask=0,r.colorMask(!1,!1,!1,!1)),r.stencilFunc(r.EQUAL,i,4294967295),r.stencilOp(r.KEEP,r.KEEP,r.INCR),n.renderable=!0,n.render(this.renderer),this.renderer.batch.flush(),n.renderable=!1,0!==s&&(e._colorMask=s,r.colorMask(0!=(1&s),0!=(2&s),0!=(4&s),0!=(8&s))),this._useCurrent()}pop(e){const n=this.renderer.gl;if(0===this.getStackLength())n.disable(n.STENCIL_TEST);else{const r=0!==this.maskStack.length?this.maskStack[this.maskStack.length-1]:null,i=r?r._colorMask:15;0!==i&&(r._colorMask=0,n.colorMask(!1,!1,!1,!1)),n.stencilOp(n.KEEP,n.KEEP,n.DECR),e.renderable=!0,e.render(this.renderer),this.renderer.batch.flush(),e.renderable=!1,0!==i&&(r._colorMask=i,n.colorMask(0!=(1&i),0!=(2&i),0!=(4&i),0!=(8&i))),this._useCurrent()}}_useCurrent(){const e=this.renderer.gl;e.stencilFunc(e.EQUAL,this.getStackLength(),4294967295),e.stencilOp(e.KEEP,e.KEEP,e.KEEP)}}Ib.extension={type:fe.RendererSystem,name:"stencil"},Te.add(Ib);class Ab{constructor(e){this.renderer=e,this.plugins={},Object.defineProperties(this.plugins,{extract:{enumerable:!1,get:()=>(Ye("7.0.0","renderer.plugins.extract has moved to renderer.extract"),e.extract)},prepare:{enumerable:!1,get:()=>(Ye("7.0.0","renderer.plugins.prepare has moved to renderer.prepare"),e.prepare)},interaction:{enumerable:!1,get:()=>(Ye("7.0.0","renderer.plugins.interaction has been deprecated, use renderer.events"),e.events)}})}init(){const e=this.rendererPlugins;for(const n in e)this.plugins[n]=new e[n](this.renderer)}destroy(){for(const e in this.plugins)this.plugins[e].destroy(),this.plugins[e]=null}}Ab.extension={type:[fe.RendererSystem,fe.CanvasRendererSystem],name:"_plugin"},Te.add(Ab);class Mb{constructor(e){this.renderer=e,this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new Pt,this.transform=null}update(e,n,r,i){this.destinationFrame=e||this.destinationFrame||this.defaultFrame,this.sourceFrame=n||this.sourceFrame||e,this.calculateProjection(this.destinationFrame,this.sourceFrame,r,i),this.transform&&this.projectionMatrix.append(this.transform);const s=this.renderer;s.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,s.globalUniforms.update(),s.shader.shader&&s.shader.syncUniformGroup(s.shader.shader.uniforms.globals)}calculateProjection(e,n,r,i){const s=this.projectionMatrix,o=i?-1:1;s.identity(),s.a=1/n.width*2,s.d=o*(1/n.height*2),s.tx=-1-n.x*s.a,s.ty=-o-n.y*s.d}setTransform(e){}destroy(){this.renderer=null}}Mb.extension={type:fe.RendererSystem,name:"projection"},Te.add(Mb);const Jk=new mc;class Rb{constructor(e){this.renderer=e,this._tempMatrix=new Pt}generateTexture(e,n){const{region:r,...i}=n||{},s=r||e.getLocalBounds(null,!0);0===s.width&&(s.width=1),0===s.height&&(s.height=1);const o=is.create({width:s.width,height:s.height,...i});this._tempMatrix.tx=-s.x,this._tempMatrix.ty=-s.y;const a=e.transform;return e.transform=Jk,this.renderer.render(e,{renderTexture:o,transform:this._tempMatrix,skipUpdateTransform:!!e.parent,blit:!0}),e.transform=a,o}destroy(){}}Rb.extension={type:[fe.RendererSystem,fe.CanvasRendererSystem],name:"textureGenerator"},Te.add(Rb);const ss=new et,za=new et;class Pb{constructor(e){this.renderer=e,this.defaultMaskStack=[],this.current=null,this.sourceFrame=new et,this.destinationFrame=new et,this.viewportFrame=new et}contextChange(){const e=this.renderer?.gl.getContextAttributes();this._rendererPremultipliedAlpha=!!(e&&e.alpha&&e.premultipliedAlpha)}bind(e=null,n,r){const i=this.renderer;let s,o,a;this.current=e,e?(s=e.baseTexture,a=s.resolution,n||(ss.width=e.frame.width,ss.height=e.frame.height,n=ss),r||(za.x=e.frame.x,za.y=e.frame.y,za.width=n.width,za.height=n.height,r=za),o=s.framebuffer):(a=i.resolution,n||(ss.width=i._view.screen.width,ss.height=i._view.screen.height,n=ss),r||((r=ss).width=n.width,r.height=n.height));const l=this.viewportFrame;l.x=r.x*a,l.y=r.y*a,l.width=r.width*a,l.height=r.height*a,e||(l.y=i.view.height-(l.y+l.height)),l.ceil(),this.renderer.framebuffer.bind(o,l),this.renderer.projection.update(r,n,a,!o),this.renderer.mask.setMaskStack(e?s.maskStack:this.defaultMaskStack),this.sourceFrame.copyFrom(n),this.destinationFrame.copyFrom(r)}clear(e,n){const i=ft.shared.setValue(e||(this.current?this.current.baseTexture.clear:this.renderer.background.backgroundColor));(this.current&&this.current.baseTexture.alphaMode>0||!this.current&&this._rendererPremultipliedAlpha)&&i.premultiply(i.alpha);const s=this.destinationFrame,o=this.current?this.current.baseTexture:this.renderer._view.screen,a=s.width!==o.width||s.height!==o.height;if(a){let{x:l,y:u,width:c,height:h}=this.viewportFrame;l=Math.round(l),u=Math.round(u),c=Math.round(c),h=Math.round(h),this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST),this.renderer.gl.scissor(l,u,c,h)}this.renderer.framebuffer.clear(i.red,i.green,i.blue,i.alpha,n),a&&this.renderer.scissor.pop()}resize(){this.bind(null)}reset(){this.bind(null)}destroy(){this.renderer=null}}Pb.extension={type:fe.RendererSystem,name:"renderTexture"},Te.add(Pb);class eB{constructor(e,n){this.program=e,this.uniformData=n,this.uniformGroups={},this.uniformDirtyGroups={},this.uniformBufferBindings={}}destroy(){this.uniformData=null,this.uniformGroups=null,this.uniformDirtyGroups=null,this.uniformBufferBindings=null,this.program=null}}function Nb(t,e,n){const r=t.createShader(e);return t.shaderSource(r,n),t.compileShader(r),r}function dg(t){const e=new Array(t);for(let n=0;n<e.length;n++)e[n]=!1;return e}function Ob(t,e){switch(t){case"float":case"int":case"uint":case"sampler2D":case"sampler2DArray":return 0;case"vec2":return new Float32Array(2*e);case"vec3":return new Float32Array(3*e);case"vec4":return new Float32Array(4*e);case"ivec2":return new Int32Array(2*e);case"ivec3":return new Int32Array(3*e);case"ivec4":return new Int32Array(4*e);case"uvec2":return new Uint32Array(2*e);case"uvec3":return new Uint32Array(3*e);case"uvec4":return new Uint32Array(4*e);case"bool":return!1;case"bvec2":return dg(2*e);case"bvec3":return dg(3*e);case"bvec4":return dg(4*e);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}function Fb(t,e){const n=t.getShaderSource(e).split("\n").map((u,c)=>`${c}: ${u}`),r=t.getShaderInfoLog(e),i=r.split("\n"),s={},o=i.map(u=>parseFloat(u.replace(/^ERROR\: 0\:([\d]+)\:.*$/,"$1"))).filter(u=>!(!u||s[u]||(s[u]=!0,0))),a=[""];o.forEach(u=>{n[u-1]=`%c${n[u-1]}%c`,a.push("background: #FF0000; color:#FFFFFF; font-size: 10px","font-size: 10px")});const l=n.join("\n");a[0]=l,console.error(r),console.groupCollapsed("click to view full shader code"),console.warn(...a),console.groupEnd()}function sB(t,e,n,r,i){n.buffer.update(i)}const oB={float:"\n        data[offset] = v;\n    ",vec2:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n    ",vec3:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n        data[offset+2] = v[2];\n\n    ",vec4:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n        data[offset+2] = v[2];\n        data[offset+3] = v[3];\n    ",mat2:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n\n        data[offset+4] = v[2];\n        data[offset+5] = v[3];\n    ",mat3:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n        data[offset+2] = v[2];\n\n        data[offset + 4] = v[3];\n        data[offset + 5] = v[4];\n        data[offset + 6] = v[5];\n\n        data[offset + 8] = v[6];\n        data[offset + 9] = v[7];\n        data[offset + 10] = v[8];\n    ",mat4:"\n        for(var i = 0; i < 16; i++)\n        {\n            data[offset + i] = v[i];\n        }\n    "},Lb={float:4,vec2:8,vec3:12,vec4:16,int:4,ivec2:8,ivec3:12,ivec4:16,uint:4,uvec2:8,uvec3:12,uvec4:16,bool:4,bvec2:8,bvec3:12,bvec4:16,mat2:32,mat3:48,mat4:64};let Wa,hB=0;const Cc={textureCount:0,uboCount:0};class kb{constructor(e){this.destroyed=!1,this.renderer=e,this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this._uboCache={},this.id=hB++}systemCheck(){if(!function cB(){if("boolean"==typeof Wa)return Wa;try{Wa=!0===new Function("param1","param2","param3","return param1[param2] === param3;")({a:"b"},"a","b")}catch{Wa=!1}return Wa}())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")}contextChange(e){this.gl=e,this.reset()}bind(e,n){e.disposeRunner.add(this),e.uniforms.globals=this.renderer.globalUniforms;const r=e.program,i=r.glPrograms[this.renderer.CONTEXT_UID]||this.generateProgram(e);return this.shader=e,this.program!==r&&(this.program=r,this.gl.useProgram(i.program)),n||(Cc.textureCount=0,Cc.uboCount=0,this.syncUniformGroup(e.uniformGroup,Cc)),i}setUniforms(e){const n=this.shader.program;n.syncUniforms(n.glPrograms[this.renderer.CONTEXT_UID].uniformData,e,this.renderer)}syncUniformGroup(e,n){const r=this.getGlProgram();(!e.static||e.dirtyId!==r.uniformDirtyGroups[e.id])&&(r.uniformDirtyGroups[e.id]=e.dirtyId,this.syncUniforms(e,r,n))}syncUniforms(e,n,r){(e.syncUniforms[this.shader.program.id]||this.createSyncGroups(e))(n.uniformData,e.uniforms,this.renderer,r)}createSyncGroups(e){const n=this.getSignature(e,this.shader.program.uniformData,"u");return this.cache[n]||(this.cache[n]=function Mk(t,e){const n=["\n        var v = null;\n        var cv = null;\n        var cu = null;\n        var t = 0;\n        var gl = renderer.gl;\n    "];for(const r in t.uniforms){const i=e[r];if(!i){t.uniforms[r]?.group&&n.push(t.uniforms[r].ubo?`\n                        renderer.shader.syncUniformBufferGroup(uv.${r}, '${r}');\n                    `:`\n                        renderer.shader.syncUniformGroup(uv.${r}, syncData);\n                    `);continue}const s=t.uniforms[r];let o=!1;for(let a=0;a<_o.length;a++)if(_o[a].test(i,s)){n.push(_o[a].code(r,s)),o=!0;break}if(!o){const l=(1!==i.size||i.isArray?Ak:Ik)[i.type].replace("location",`ud["${r}"].location`);n.push(`\n            cu = ud["${r}"];\n            cv = cu.value;\n            v = uv["${r}"];\n            ${l};`)}}return new Function("ud","uv","renderer","syncData",n.join("\n"))}(e,this.shader.program.uniformData)),e.syncUniforms[this.shader.program.id]=this.cache[n],e.syncUniforms[this.shader.program.id]}syncUniformBufferGroup(e,n){const r=this.getGlProgram();if(!e.static||0!==e.dirtyId||!r.uniformGroups[e.id]){e.dirtyId=0;const i=r.uniformGroups[e.id]||this.createSyncBufferGroup(e,r,n);e.buffer.update(),i(r.uniformData,e.uniforms,this.renderer,Cc,e.buffer)}this.renderer.buffer.bindBufferBase(e.buffer,r.uniformBufferBindings[n])}createSyncBufferGroup(e,n,r){const{gl:i}=this.renderer;this.renderer.buffer.bind(e.buffer);const s=this.gl.getUniformBlockIndex(n.program,r);n.uniformBufferBindings[r]=this.shader.uniformBindCount,i.uniformBlockBinding(n.program,s,this.shader.uniformBindCount),this.shader.uniformBindCount++;const o=this.getSignature(e,this.shader.program.uniformData,"ubo");let a=this._uboCache[o];if(a||(a=this._uboCache[o]=function uB(t,e){if(!t.autoManage)return{size:0,syncFunc:sB};const n=function lB(t,e){const n=[];for(const r in t)e[r]&&n.push(e[r]);return n.sort((r,i)=>r.index-i.index),n}(t.uniforms,e),{uboElements:r,size:i}=function aB(t){const e=t.map(s=>({data:s,offset:0,dataLen:0,dirty:0}));let n=0,r=0,i=0;for(let s=0;s<e.length;s++){const o=e[s];if(n=Lb[o.data.type],o.data.size>1&&(n=Math.max(n,16)*o.data.size),o.dataLen=n,r%n!=0&&r<16){const a=r%n%16;r+=a,i+=a}r+n>16?(i=16*Math.ceil(i/16),o.offset=i,i+=n,r=n):(o.offset=i,r+=n,i+=n)}return i=16*Math.ceil(i/16),{uboElements:e,size:i}}(n),s=["\n    var v = null;\n    var v2 = null;\n    var cv = null;\n    var t = 0;\n    var gl = renderer.gl\n    var index = 0;\n    var data = buffer.data;\n    "];for(let o=0;o<r.length;o++){const a=r[o],l=t.uniforms[a.data.name],u=a.data.name;let c=!1;for(let h=0;h<_o.length;h++){const d=_o[h];if(d.codeUbo&&d.test(a.data,l)){s.push(`offset = ${a.offset/4};`,_o[h].codeUbo(a.data.name,l)),c=!0;break}}if(!c)if(a.data.size>1){const h=lb(a.data.type),d=Math.max(Lb[a.data.type]/16,1),f=h/d;s.push(`\n                cv = ud.${u}.value;\n                v = uv.${u};\n                offset = ${a.offset/4};\n\n                t = 0;\n\n                for(var i=0; i < ${a.data.size*d}; i++)\n                {\n                    for(var j = 0; j < ${f}; j++)\n                    {\n                        data[offset++] = v[t++];\n                    }\n                    offset += ${(4-f%4)%4};\n                }\n\n                `)}else s.push(`\n                cv = ud.${u}.value;\n                v = uv.${u};\n                offset = ${a.offset/4};\n                ${oB[a.data.type]};\n                `)}return s.push("\n       renderer.buffer.update(buffer);\n    "),{size:i,syncFunc:new Function("ud","uv","renderer","syncData","buffer",s.join("\n"))}}(e,this.shader.program.uniformData)),e.autoManage){const l=new Float32Array(a.size/4);e.buffer.update(l)}return n.uniformGroups[e.id]=a.syncFunc,n.uniformGroups[e.id]}getSignature(e,n,r){const i=e.uniforms,s=[`${r}-`];for(const o in i)s.push(o),n[o]&&s.push(n[o].type);return s.join("-")}getGlProgram(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null}generateProgram(e){const r=e.program,i=function iB(t,e){const n=Nb(t,t.VERTEX_SHADER,e.vertexSrc),r=Nb(t,t.FRAGMENT_SHADER,e.fragmentSrc),i=t.createProgram();t.attachShader(i,n),t.attachShader(i,r);const s=e.extra?.transformFeedbackVaryings;if(s&&("function"!=typeof t.transformFeedbackVaryings?console.warn("TransformFeedback is not supported but TransformFeedbackVaryings are given."):t.transformFeedbackVaryings(i,s.names,"separate"===s.bufferMode?t.SEPARATE_ATTRIBS:t.INTERLEAVED_ATTRIBS)),t.linkProgram(i),t.getProgramParameter(i,t.LINK_STATUS)||function rB(t,e,n,r){t.getProgramParameter(e,t.LINK_STATUS)||(t.getShaderParameter(n,t.COMPILE_STATUS)||Fb(t,n),t.getShaderParameter(r,t.COMPILE_STATUS)||Fb(t,r),console.error("PixiJS Error: Could not initialize shader."),""!==t.getProgramInfoLog(e)&&console.warn("PixiJS Warning: gl.getProgramInfoLog()",t.getProgramInfoLog(e)))}(t,i,n,r),e.attributeData=function tB(t,e){const n={},r=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES);for(let i=0;i<r;i++){const s=e.getActiveAttrib(t,i);if(s.name.startsWith("gl_"))continue;const o=cb(e,s.type),a={type:o,name:s.name,size:lb(o),location:e.getAttribLocation(t,s.name)};n[s.name]=a}return n}(i,t),e.uniformData=function nB(t,e){const n={},r=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let i=0;i<r;i++){const s=e.getActiveUniform(t,i),o=s.name.replace(/\[.*?\]$/,""),a=!!s.name.match(/\[.*?\]$/),l=cb(e,s.type);n[o]={name:o,index:i,type:l,size:s.size,isArray:a,value:Ob(l,s.size)}}return n}(i,t),!/^[ \t]*#[ \t]*version[ \t]+300[ \t]+es[ \t]*$/m.test(e.vertexSrc)){const l=Object.keys(e.attributeData);l.sort((u,c)=>u>c?1:-1);for(let u=0;u<l.length;u++)e.attributeData[l[u]].location=u,t.bindAttribLocation(i,u,l[u]);t.linkProgram(i)}t.deleteShader(n),t.deleteShader(r);const o={};for(const l in e.uniformData){const u=e.uniformData[l];o[l]={location:t.getUniformLocation(i,l),value:Ob(u.type,u.size)}}return new eB(i,o)}(this.gl,r);return r.glPrograms[this.renderer.CONTEXT_UID]=i,i}reset(){this.program=null,this.shader=null}disposeShader(e){this.shader===e&&(this.shader=null)}destroy(){this.renderer=null,this.destroyed=!0}}kb.extension={type:fe.RendererSystem,name:"shader"},Te.add(kb);class Ic{constructor(e){this.renderer=e}run(e){const{renderer:n}=this;n.runners.init.emit(n.options),e.hello&&console.log(`PixiJS 7.2.4 - ${n.rendererLogId} - https://pixijs.com`),n.resize(n.screen.width,n.screen.height)}destroy(){}}Ic.defaultOptions={hello:!1},Ic.extension={type:[fe.RendererSystem,fe.CanvasRendererSystem],name:"startup"},Te.add(Ic);const fg=class{constructor(){this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=Oe.NONE,this._blendEq=!1,this.map=[],this.map[0]=this.setBlend,this.map[1]=this.setOffset,this.map[2]=this.setCullFace,this.map[3]=this.setDepthTest,this.map[4]=this.setFrontFace,this.map[5]=this.setDepthMask,this.checks=[],this.defaultState=new li,this.defaultState.blend=!0}contextChange(t){this.gl=t,this.blendModes=function dB(t,e=[]){return e[Oe.NORMAL]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Oe.ADD]=[t.ONE,t.ONE],e[Oe.MULTIPLY]=[t.DST_COLOR,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Oe.SCREEN]=[t.ONE,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Oe.OVERLAY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Oe.DARKEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Oe.LIGHTEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Oe.COLOR_DODGE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Oe.COLOR_BURN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Oe.HARD_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Oe.SOFT_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Oe.DIFFERENCE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Oe.EXCLUSION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Oe.HUE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Oe.SATURATION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Oe.COLOR]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Oe.LUMINOSITY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Oe.NONE]=[0,0],e[Oe.NORMAL_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Oe.ADD_NPM]=[t.SRC_ALPHA,t.ONE,t.ONE,t.ONE],e[Oe.SCREEN_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[Oe.SRC_IN]=[t.DST_ALPHA,t.ZERO],e[Oe.SRC_OUT]=[t.ONE_MINUS_DST_ALPHA,t.ZERO],e[Oe.SRC_ATOP]=[t.DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[Oe.DST_OVER]=[t.ONE_MINUS_DST_ALPHA,t.ONE],e[Oe.DST_IN]=[t.ZERO,t.SRC_ALPHA],e[Oe.DST_OUT]=[t.ZERO,t.ONE_MINUS_SRC_ALPHA],e[Oe.DST_ATOP]=[t.ONE_MINUS_DST_ALPHA,t.SRC_ALPHA],e[Oe.XOR]=[t.ONE_MINUS_DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[Oe.SUBTRACT]=[t.ONE,t.ONE,t.ONE,t.ONE,t.FUNC_REVERSE_SUBTRACT,t.FUNC_ADD],e}(t),this.set(this.defaultState),this.reset()}set(t){if(this.stateId!==(t=t||this.defaultState).data){let e=this.stateId^t.data,n=0;for(;e;)1&e&&this.map[n].call(this,!!(t.data&1<<n)),e>>=1,n++;this.stateId=t.data}for(let e=0;e<this.checks.length;e++)this.checks[e](this,t)}forceState(t){t=t||this.defaultState;for(let e=0;e<this.map.length;e++)this.map[e].call(this,!!(t.data&1<<e));for(let e=0;e<this.checks.length;e++)this.checks[e](this,t);this.stateId=t.data}setBlend(t){this.updateCheck(fg.checkBlendMode,t),this.gl[t?"enable":"disable"](this.gl.BLEND)}setOffset(t){this.updateCheck(fg.checkPolygonOffset,t),this.gl[t?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)}setDepthTest(t){this.gl[t?"enable":"disable"](this.gl.DEPTH_TEST)}setDepthMask(t){this.gl.depthMask(t)}setCullFace(t){this.gl[t?"enable":"disable"](this.gl.CULL_FACE)}setFrontFace(t){this.gl.frontFace(this.gl[t?"CW":"CCW"])}setBlendMode(t){if(t===this.blendMode)return;this.blendMode=t;const e=this.blendModes[t],n=this.gl;2===e.length?n.blendFunc(e[0],e[1]):n.blendFuncSeparate(e[0],e[1],e[2],e[3]),6===e.length?(this._blendEq=!0,n.blendEquationSeparate(e[4],e[5])):this._blendEq&&(this._blendEq=!1,n.blendEquationSeparate(n.FUNC_ADD,n.FUNC_ADD))}setPolygonOffset(t,e){this.gl.polygonOffset(t,e)}reset(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(this.defaultState),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)}updateCheck(t,e){const n=this.checks.indexOf(t);e&&-1===n?this.checks.push(t):!e&&-1!==n&&this.checks.splice(n,1)}static checkBlendMode(t,e){t.setBlendMode(e.blendMode)}static checkPolygonOffset(t,e){t.setPolygonOffset(1,e.polygonOffset)}destroy(){this.gl=null}};let Bb=fg;Bb.extension={type:fe.RendererSystem,name:"state"},Te.add(Bb);class vB extends Ba{constructor(){super(...arguments),this.runners={},this._systemsHash={}}setup(e){this.addRunners(...e.runners);const n=(e.priority??[]).filter(i=>e.systems[i]),r=[...n,...Object.keys(e.systems).filter(i=>!n.includes(i))];for(const i of r)this.addSystem(e.systems[i],i)}addRunners(...e){e.forEach(n=>{this.runners[n]=new ur(n)})}addSystem(e,n){const r=new e(this);if(this[n])throw new Error(`Whoops! The name "${n}" is already in use`);this[n]=r,this._systemsHash[n]=r;for(const i in this.runners)this.runners[i].add(r);return this}emitWithCustomOptions(e,n){const r=Object.keys(this._systemsHash);e.items.forEach(i=>{const s=r.find(o=>this._systemsHash[o]===i);i[e.name](n[s])})}destroy(){Object.values(this.runners).forEach(e=>{e.destroy()}),this._systemsHash={}}}const Ac=class{constructor(t){this.renderer=t,this.count=0,this.checkCount=0,this.maxIdle=Ac.defaultMaxIdle,this.checkCountMax=Ac.defaultCheckCountMax,this.mode=Ac.defaultMode}postrender(){this.renderer.objectRenderer.renderingToScreen&&(this.count++,this.mode!==Lp.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))}run(){const t=this.renderer.texture,e=t.managedTextures;let n=!1;for(let r=0;r<e.length;r++){const i=e[r];!i.framebuffer&&this.count-i.touched>this.maxIdle&&(t.destroyTexture(i,!0),e[r]=null,n=!0)}if(n){let r=0;for(let i=0;i<e.length;i++)null!==e[i]&&(e[r++]=e[i]);e.length=r}}unload(t){const n=t._texture;n&&!n.framebuffer&&this.renderer.texture.destroyTexture(n);for(let r=t.children.length-1;r>=0;r--)this.unload(t.children[r])}destroy(){this.renderer=null}};let pr=Ac;pr.defaultMode=Lp.AUTO,pr.defaultMaxIdle=3600,pr.defaultCheckCountMax=600,pr.extension={type:fe.RendererSystem,name:"textureGC"},Te.add(pr);class pg{constructor(e){this.texture=e,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=Re.UNSIGNED_BYTE,this.internalFormat=K.RGBA,this.samplerType=0}}class Ub{constructor(e){this.renderer=e,this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new $e,this.hasIntegerTextures=!1}contextChange(){const e=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion,this.internalFormats=function xB(t){let e;return e="WebGL2RenderingContext"in globalThis&&t instanceof globalThis.WebGL2RenderingContext?{[Re.UNSIGNED_BYTE]:{[K.RGBA]:t.RGBA8,[K.RGB]:t.RGB8,[K.RG]:t.RG8,[K.RED]:t.R8,[K.RGBA_INTEGER]:t.RGBA8UI,[K.RGB_INTEGER]:t.RGB8UI,[K.RG_INTEGER]:t.RG8UI,[K.RED_INTEGER]:t.R8UI,[K.ALPHA]:t.ALPHA,[K.LUMINANCE]:t.LUMINANCE,[K.LUMINANCE_ALPHA]:t.LUMINANCE_ALPHA},[Re.BYTE]:{[K.RGBA]:t.RGBA8_SNORM,[K.RGB]:t.RGB8_SNORM,[K.RG]:t.RG8_SNORM,[K.RED]:t.R8_SNORM,[K.RGBA_INTEGER]:t.RGBA8I,[K.RGB_INTEGER]:t.RGB8I,[K.RG_INTEGER]:t.RG8I,[K.RED_INTEGER]:t.R8I},[Re.UNSIGNED_SHORT]:{[K.RGBA_INTEGER]:t.RGBA16UI,[K.RGB_INTEGER]:t.RGB16UI,[K.RG_INTEGER]:t.RG16UI,[K.RED_INTEGER]:t.R16UI,[K.DEPTH_COMPONENT]:t.DEPTH_COMPONENT16},[Re.SHORT]:{[K.RGBA_INTEGER]:t.RGBA16I,[K.RGB_INTEGER]:t.RGB16I,[K.RG_INTEGER]:t.RG16I,[K.RED_INTEGER]:t.R16I},[Re.UNSIGNED_INT]:{[K.RGBA_INTEGER]:t.RGBA32UI,[K.RGB_INTEGER]:t.RGB32UI,[K.RG_INTEGER]:t.RG32UI,[K.RED_INTEGER]:t.R32UI,[K.DEPTH_COMPONENT]:t.DEPTH_COMPONENT24},[Re.INT]:{[K.RGBA_INTEGER]:t.RGBA32I,[K.RGB_INTEGER]:t.RGB32I,[K.RG_INTEGER]:t.RG32I,[K.RED_INTEGER]:t.R32I},[Re.FLOAT]:{[K.RGBA]:t.RGBA32F,[K.RGB]:t.RGB32F,[K.RG]:t.RG32F,[K.RED]:t.R32F,[K.DEPTH_COMPONENT]:t.DEPTH_COMPONENT32F},[Re.HALF_FLOAT]:{[K.RGBA]:t.RGBA16F,[K.RGB]:t.RGB16F,[K.RG]:t.RG16F,[K.RED]:t.R16F},[Re.UNSIGNED_SHORT_5_6_5]:{[K.RGB]:t.RGB565},[Re.UNSIGNED_SHORT_4_4_4_4]:{[K.RGBA]:t.RGBA4},[Re.UNSIGNED_SHORT_5_5_5_1]:{[K.RGBA]:t.RGB5_A1},[Re.UNSIGNED_INT_2_10_10_10_REV]:{[K.RGBA]:t.RGB10_A2,[K.RGBA_INTEGER]:t.RGB10_A2UI},[Re.UNSIGNED_INT_10F_11F_11F_REV]:{[K.RGB]:t.R11F_G11F_B10F},[Re.UNSIGNED_INT_5_9_9_9_REV]:{[K.RGB]:t.RGB9_E5},[Re.UNSIGNED_INT_24_8]:{[K.DEPTH_STENCIL]:t.DEPTH24_STENCIL8},[Re.FLOAT_32_UNSIGNED_INT_24_8_REV]:{[K.DEPTH_STENCIL]:t.DEPTH32F_STENCIL8}}:{[Re.UNSIGNED_BYTE]:{[K.RGBA]:t.RGBA,[K.RGB]:t.RGB,[K.ALPHA]:t.ALPHA,[K.LUMINANCE]:t.LUMINANCE,[K.LUMINANCE_ALPHA]:t.LUMINANCE_ALPHA},[Re.UNSIGNED_SHORT_5_6_5]:{[K.RGB]:t.RGB},[Re.UNSIGNED_SHORT_4_4_4_4]:{[K.RGBA]:t.RGBA},[Re.UNSIGNED_SHORT_5_5_5_1]:{[K.RGBA]:t.RGBA}},e}(e);const n=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=n;for(let i=0;i<n;i++)this.boundTextures[i]=null;this.emptyTextures={};const r=new pg(e.createTexture());e.bindTexture(e.TEXTURE_2D,r.texture),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[e.TEXTURE_2D]=r,this.emptyTextures[e.TEXTURE_CUBE_MAP]=new pg(e.createTexture()),e.bindTexture(e.TEXTURE_CUBE_MAP,this.emptyTextures[e.TEXTURE_CUBE_MAP].texture);for(let i=0;i<6;i++)e.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+i,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,null);e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MIN_FILTER,e.LINEAR);for(let i=0;i<this.boundTextures.length;i++)this.bind(null,i)}bind(e,n=0){const{gl:r}=this;if(e=e?.castToBaseTexture(),e?.valid&&!e.parentTextureArray){e.touched=this.renderer.textureGC.count;const i=e._glTextures[this.CONTEXT_UID]||this.initTexture(e);this.boundTextures[n]!==e&&(this.currentLocation!==n&&(this.currentLocation=n,r.activeTexture(r.TEXTURE0+n)),r.bindTexture(e.target,i.texture)),i.dirtyId!==e.dirtyId?(this.currentLocation!==n&&(this.currentLocation=n,r.activeTexture(r.TEXTURE0+n)),this.updateTexture(e)):i.dirtyStyleId!==e.dirtyStyleId&&this.updateTextureStyle(e),this.boundTextures[n]=e}else this.currentLocation!==n&&(this.currentLocation=n,r.activeTexture(r.TEXTURE0+n)),r.bindTexture(r.TEXTURE_2D,this.emptyTextures[r.TEXTURE_2D].texture),this.boundTextures[n]=null}reset(){this._unknownBoundTextures=!0,this.hasIntegerTextures=!1,this.currentLocation=-1;for(let e=0;e<this.boundTextures.length;e++)this.boundTextures[e]=this.unknownTexture}unbind(e){const{gl:n,boundTextures:r}=this;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(let i=0;i<r.length;i++)r[i]===this.unknownTexture&&this.bind(null,i)}for(let i=0;i<r.length;i++)r[i]===e&&(this.currentLocation!==i&&(n.activeTexture(n.TEXTURE0+i),this.currentLocation=i),n.bindTexture(e.target,this.emptyTextures[e.target].texture),r[i]=null)}ensureSamplerType(e){const{boundTextures:n,hasIntegerTextures:r,CONTEXT_UID:i}=this;if(r)for(let s=e-1;s>=0;--s){const o=n[s];o&&o._glTextures[i].samplerType!==Fp.FLOAT&&this.renderer.texture.unbind(o)}}initTexture(e){const n=new pg(this.gl.createTexture());return n.dirtyId=-1,e._glTextures[this.CONTEXT_UID]=n,this.managedTextures.push(e),e.on("dispose",this.destroyTexture,this),n}initTextureType(e,n){n.internalFormat=this.internalFormats[e.type]?.[e.format]??e.format,n.type=2===this.webGLVersion&&e.type===Re.HALF_FLOAT?this.gl.HALF_FLOAT:e.type}updateTexture(e){const n=e._glTextures[this.CONTEXT_UID];if(!n)return;const r=this.renderer;if(this.initTextureType(e,n),e.resource?.upload(r,e,n))n.samplerType!==Fp.FLOAT&&(this.hasIntegerTextures=!0);else{const i=e.realWidth,s=e.realHeight,o=r.gl;(n.width!==i||n.height!==s||n.dirtyId<0)&&(n.width=i,n.height=s,o.texImage2D(e.target,0,n.internalFormat,i,s,0,e.format,n.type,null))}e.dirtyStyleId!==n.dirtyStyleId&&this.updateTextureStyle(e),n.dirtyId=e.dirtyId}destroyTexture(e,n){const{gl:r}=this;if((e=e.castToBaseTexture())._glTextures[this.CONTEXT_UID]&&(this.unbind(e),r.deleteTexture(e._glTextures[this.CONTEXT_UID].texture),e.off("dispose",this.destroyTexture,this),delete e._glTextures[this.CONTEXT_UID],!n)){const i=this.managedTextures.indexOf(e);-1!==i&&mo(this.managedTextures,i,1)}}updateTextureStyle(e){const n=e._glTextures[this.CONTEXT_UID];n&&(n.mipmap=!!(e.mipmap!==Br.POW2&&2===this.webGLVersion||e.isPowerOfTwo)&&e.mipmap>=1,n.wrapMode=2===this.webGLVersion||e.isPowerOfTwo?e.wrapMode:Ei.CLAMP,e.resource?.style(this.renderer,e,n)||this.setStyle(e,n),n.dirtyStyleId=e.dirtyStyleId)}setStyle(e,n){const r=this.gl;if(n.mipmap&&e.mipmap!==Br.ON_MANUAL&&r.generateMipmap(e.target),r.texParameteri(e.target,r.TEXTURE_WRAP_S,n.wrapMode),r.texParameteri(e.target,r.TEXTURE_WRAP_T,n.wrapMode),n.mipmap){r.texParameteri(e.target,r.TEXTURE_MIN_FILTER,e.scaleMode===kr.LINEAR?r.LINEAR_MIPMAP_LINEAR:r.NEAREST_MIPMAP_NEAREST);const i=this.renderer.context.extensions.anisotropicFiltering;if(i&&e.anisotropicLevel>0&&e.scaleMode===kr.LINEAR){const s=Math.min(e.anisotropicLevel,r.getParameter(i.MAX_TEXTURE_MAX_ANISOTROPY_EXT));r.texParameterf(e.target,i.TEXTURE_MAX_ANISOTROPY_EXT,s)}}else r.texParameteri(e.target,r.TEXTURE_MIN_FILTER,e.scaleMode===kr.LINEAR?r.LINEAR:r.NEAREST);r.texParameteri(e.target,r.TEXTURE_MAG_FILTER,e.scaleMode===kr.LINEAR?r.LINEAR:r.NEAREST)}destroy(){this.renderer=null}}Ub.extension={type:fe.RendererSystem,name:"texture"},Te.add(Ub);class Hb{constructor(e){this.renderer=e}contextChange(){this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(e){const{gl:n,CONTEXT_UID:r}=this,i=e._glTransformFeedbacks[r]||this.createGLTransformFeedback(e);n.bindTransformFeedback(n.TRANSFORM_FEEDBACK,i)}unbind(){const{gl:e}=this;e.bindTransformFeedback(e.TRANSFORM_FEEDBACK,null)}beginTransformFeedback(e,n){const{gl:r,renderer:i}=this;n&&i.shader.bind(n),r.beginTransformFeedback(e)}endTransformFeedback(){const{gl:e}=this;e.endTransformFeedback()}createGLTransformFeedback(e){const{gl:n,renderer:r,CONTEXT_UID:i}=this,s=n.createTransformFeedback();e._glTransformFeedbacks[i]=s,n.bindTransformFeedback(n.TRANSFORM_FEEDBACK,s);for(let o=0;o<e.buffers.length;o++){const a=e.buffers[o];a&&(r.buffer.update(a),a._glBuffers[i].refCount++,n.bindBufferBase(n.TRANSFORM_FEEDBACK_BUFFER,o,a._glBuffers[i].buffer||null))}return n.bindTransformFeedback(n.TRANSFORM_FEEDBACK,null),e.disposeRunner.add(this),s}disposeTransformFeedback(e,n){const r=e._glTransformFeedbacks[this.CONTEXT_UID],i=this.gl;e.disposeRunner.remove(this);const s=this.renderer.buffer;if(s)for(let o=0;o<e.buffers.length;o++){const a=e.buffers[o];if(!a)continue;const l=a._glBuffers[this.CONTEXT_UID];l&&(l.refCount--,0===l.refCount&&!n&&s.dispose(a,n))}r&&(n||i.deleteTransformFeedback(r),delete e._glTransformFeedbacks[this.CONTEXT_UID])}destroy(){this.renderer=null}}Hb.extension={type:fe.RendererSystem,name:"transformFeedback"},Te.add(Hb);class Mc{constructor(e){this.renderer=e}init(e){this.screen=new et(0,0,e.width,e.height),this.element=e.view||ce.ADAPTER.createCanvas(),this.resolution=e.resolution||ce.RESOLUTION,this.autoDensity=!!e.autoDensity}resizeView(e,n){this.element.width=Math.round(e*this.resolution),this.element.height=Math.round(n*this.resolution);const r=this.element.width/this.resolution,i=this.element.height/this.resolution;this.screen.width=r,this.screen.height=i,this.autoDensity&&(this.element.style.width=`${r}px`,this.element.style.height=`${i}px`),this.renderer.emit("resize",r,i),this.renderer.runners.resize.emit(this.screen.width,this.screen.height)}destroy(e){e&&this.element.parentNode?.removeChild(this.element),this.renderer=null,this.element=null,this.screen=null}}Mc.defaultOptions={width:800,height:600,resolution:ce.RESOLUTION,autoDensity:!1},Mc.extension={type:[fe.RendererSystem,fe.CanvasRendererSystem],name:"_view"},Te.add(Mc),ce.PREFER_ENV=Ki.WEBGL2,ce.STRICT_TEXTURE_CACHE=!1,ce.RENDER_OPTIONS={...bc.defaultOptions,...Ec.defaultOptions,...Mc.defaultOptions,...Ic.defaultOptions},Object.defineProperties(ce,{WRAP_MODE:{get:()=>$e.defaultOptions.wrapMode,set(t){Ye("7.1.0","settings.WRAP_MODE is deprecated, use BaseTexture.defaultOptions.wrapMode"),$e.defaultOptions.wrapMode=t}},SCALE_MODE:{get:()=>$e.defaultOptions.scaleMode,set(t){Ye("7.1.0","settings.SCALE_MODE is deprecated, use BaseTexture.defaultOptions.scaleMode"),$e.defaultOptions.scaleMode=t}},MIPMAP_TEXTURES:{get:()=>$e.defaultOptions.mipmap,set(t){Ye("7.1.0","settings.MIPMAP_TEXTURES is deprecated, use BaseTexture.defaultOptions.mipmap"),$e.defaultOptions.mipmap=t}},ANISOTROPIC_LEVEL:{get:()=>$e.defaultOptions.anisotropicLevel,set(t){Ye("7.1.0","settings.ANISOTROPIC_LEVEL is deprecated, use BaseTexture.defaultOptions.anisotropicLevel"),$e.defaultOptions.anisotropicLevel=t}},FILTER_RESOLUTION:{get:()=>(Ye("7.1.0","settings.FILTER_RESOLUTION is deprecated, use Filter.defaultResolution"),sn.defaultResolution),set(t){sn.defaultResolution=t}},FILTER_MULTISAMPLE:{get:()=>(Ye("7.1.0","settings.FILTER_MULTISAMPLE is deprecated, use Filter.defaultMultisample"),sn.defaultMultisample),set(t){sn.defaultMultisample=t}},SPRITE_MAX_TEXTURES:{get:()=>fr.defaultMaxTextures,set(t){Ye("7.1.0","settings.SPRITE_MAX_TEXTURES is deprecated, use BatchRenderer.defaultMaxTextures"),fr.defaultMaxTextures=t}},SPRITE_BATCH_SIZE:{get:()=>fr.defaultBatchSize,set(t){Ye("7.1.0","settings.SPRITE_BATCH_SIZE is deprecated, use BatchRenderer.defaultBatchSize"),fr.defaultBatchSize=t}},CAN_UPLOAD_SAME_BUFFER:{get:()=>fr.canUploadSameBuffer,set(t){Ye("7.1.0","settings.CAN_UPLOAD_SAME_BUFFER is deprecated, use BatchRenderer.canUploadSameBuffer"),fr.canUploadSameBuffer=t}},GC_MODE:{get:()=>pr.defaultMode,set(t){Ye("7.1.0","settings.GC_MODE is deprecated, use TextureGCSystem.defaultMode"),pr.defaultMode=t}},GC_MAX_IDLE:{get:()=>pr.defaultMaxIdle,set(t){Ye("7.1.0","settings.GC_MAX_IDLE is deprecated, use TextureGCSystem.defaultMaxIdle"),pr.defaultMaxIdle=t}},GC_MAX_CHECK_COUNT:{get:()=>pr.defaultCheckCountMax,set(t){Ye("7.1.0","settings.GC_MAX_CHECK_COUNT is deprecated, use TextureGCSystem.defaultCheckCountMax"),pr.defaultCheckCountMax=t}},PRECISION_VERTEX:{get:()=>cr.defaultVertexPrecision,set(t){Ye("7.1.0","settings.PRECISION_VERTEX is deprecated, use Program.defaultVertexPrecision"),cr.defaultVertexPrecision=t}},PRECISION_FRAGMENT:{get:()=>cr.defaultFragmentPrecision,set(t){Ye("7.1.0","settings.PRECISION_FRAGMENT is deprecated, use Program.defaultFragmentPrecision"),cr.defaultFragmentPrecision=t}}});var Ii=(t=>(t[t.INTERACTION=50]="INTERACTION",t[t.HIGH=25]="HIGH",t[t.NORMAL=0]="NORMAL",t[t.LOW=-25]="LOW",t[t.UTILITY=-50]="UTILITY",t))(Ii||{});class gg{constructor(e,n=null,r=0,i=!1){this.next=null,this.previous=null,this._destroyed=!1,this.fn=e,this.context=n,this.priority=r,this.once=i}match(e,n=null){return this.fn===e&&this.context===n}emit(e){this.fn&&(this.context?this.fn.call(this.context,e):this.fn(e));const n=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),n}connect(e){this.previous=e,e.next&&(e.next.previous=this),this.next=e.next,e.next=this}destroy(e=!1){this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);const n=this.next;return this.next=e?null:n,this.previous=null,n}}const Hn=class{constructor(){this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new gg(null,null,1/0),this.deltaMS=1/Hn.targetFPMS,this.elapsedMS=1/Hn.targetFPMS,this._tick=t=>{this._requestId=null,this.started&&(this.update(t),this.started&&null===this._requestId&&this._head.next&&(this._requestId=requestAnimationFrame(this._tick)))}}_requestIfNeeded(){null===this._requestId&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))}_cancelIfNeeded(){null!==this._requestId&&(cancelAnimationFrame(this._requestId),this._requestId=null)}_startIfPossible(){this.started?this._requestIfNeeded():this.autoStart&&this.start()}add(t,e,n=Ii.NORMAL){return this._addListener(new gg(t,e,n))}addOnce(t,e,n=Ii.NORMAL){return this._addListener(new gg(t,e,n,!0))}_addListener(t){let e=this._head.next,n=this._head;if(e){for(;e;){if(t.priority>e.priority){t.connect(n);break}n=e,e=e.next}t.previous||t.connect(n)}else t.connect(n);return this._startIfPossible(),this}remove(t,e){let n=this._head.next;for(;n;)n=n.match(t,e)?n.destroy():n.next;return this._head.next||this._cancelIfNeeded(),this}get count(){if(!this._head)return 0;let t=0,e=this._head;for(;e=e.next;)t++;return t}start(){this.started||(this.started=!0,this._requestIfNeeded())}stop(){this.started&&(this.started=!1,this._cancelIfNeeded())}destroy(){if(!this._protected){this.stop();let t=this._head.next;for(;t;)t=t.destroy(!0);this._head.destroy(),this._head=null}}update(t=performance.now()){let e;if(t>this.lastTime){if(e=this.elapsedMS=t-this.lastTime,e>this._maxElapsedMS&&(e=this._maxElapsedMS),e*=this.speed,this._minElapsedMS){const i=t-this._lastFrame|0;if(i<this._minElapsedMS)return;this._lastFrame=t-i%this._minElapsedMS}this.deltaMS=e,this.deltaTime=this.deltaMS*Hn.targetFPMS;const n=this._head;let r=n.next;for(;r;)r=r.emit(this.deltaTime);n.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=t}get FPS(){return 1e3/this.elapsedMS}get minFPS(){return 1e3/this._maxElapsedMS}set minFPS(t){const e=Math.min(this.maxFPS,t),n=Math.min(Math.max(0,e)/1e3,Hn.targetFPMS);this._maxElapsedMS=1/n}get maxFPS(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0}set maxFPS(t){if(0===t)this._minElapsedMS=0;else{const e=Math.max(this.minFPS,t);this._minElapsedMS=1/(e/1e3)}}static get shared(){if(!Hn._shared){const t=Hn._shared=new Hn;t.autoStart=!0,t._protected=!0}return Hn._shared}static get system(){if(!Hn._system){const t=Hn._system=new Hn;t.autoStart=!0,t._protected=!0}return Hn._system}};let Xt=Hn;Xt.targetFPMS=.06,Object.defineProperties(ce,{TARGET_FPMS:{get:()=>Xt.targetFPMS,set(t){Ye("7.1.0","settings.TARGET_FPMS is deprecated, use Ticker.targetFPMS"),Xt.targetFPMS=t}}});class Vb{static init(e){e=Object.assign({autoStart:!0,sharedTicker:!1},e),Object.defineProperty(this,"ticker",{set(n){this._ticker&&this._ticker.remove(this.render,this),this._ticker=n,n&&n.add(this.render,this,Ii.LOW)},get(){return this._ticker}}),this.stop=()=>{this._ticker.stop()},this.start=()=>{this._ticker.start()},this._ticker=null,this.ticker=e.sharedTicker?Xt.shared:new Xt,e.autoStart&&this.start()}static destroy(){if(this._ticker){const e=this._ticker;this.ticker=null,e.destroy()}}}Vb.extension=fe.Application,Te.add(Vb);const Gb=[];Te.handleByList(fe.Renderer,Gb);const jb="attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n";class $b{constructor(e){this.renderer=e}contextChange(e){let n;if(1===this.renderer.context.webGLVersion){const r=e.getParameter(e.FRAMEBUFFER_BINDING);e.bindFramebuffer(e.FRAMEBUFFER,null),n=e.getParameter(e.SAMPLES),e.bindFramebuffer(e.FRAMEBUFFER,r)}else{const r=e.getParameter(e.DRAW_FRAMEBUFFER_BINDING);e.bindFramebuffer(e.DRAW_FRAMEBUFFER,null),n=e.getParameter(e.SAMPLES),e.bindFramebuffer(e.DRAW_FRAMEBUFFER,r)}this.multisample=n>=Wt.HIGH?Wt.HIGH:n>=Wt.MEDIUM?Wt.MEDIUM:n>=Wt.LOW?Wt.LOW:Wt.NONE}destroy(){}}$b.extension={type:fe.RendererSystem,name:"_multisample"},Te.add($b);class SB{constructor(e){this.buffer=e||null,this.updateID=-1,this.byteLength=-1,this.refCount=0}}class zb{constructor(e){this.renderer=e,this.managedBuffers={},this.boundBufferBases={}}destroy(){this.renderer=null}contextChange(){this.disposeAll(!0),this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(e){const{gl:n,CONTEXT_UID:r}=this,i=e._glBuffers[r]||this.createGLBuffer(e);n.bindBuffer(e.type,i.buffer)}unbind(e){const{gl:n}=this;n.bindBuffer(e,null)}bindBufferBase(e,n){const{gl:r,CONTEXT_UID:i}=this;if(this.boundBufferBases[n]!==e){const s=e._glBuffers[i]||this.createGLBuffer(e);this.boundBufferBases[n]=e,r.bindBufferBase(r.UNIFORM_BUFFER,n,s.buffer)}}bindBufferRange(e,n,r){const{gl:i,CONTEXT_UID:s}=this;r=r||0;const o=e._glBuffers[s]||this.createGLBuffer(e);i.bindBufferRange(i.UNIFORM_BUFFER,n||0,o.buffer,256*r,256)}update(e){const{gl:n,CONTEXT_UID:r}=this,i=e._glBuffers[r]||this.createGLBuffer(e);if(e._updateID!==i.updateID)if(i.updateID=e._updateID,n.bindBuffer(e.type,i.buffer),i.byteLength>=e.data.byteLength)n.bufferSubData(e.type,0,e.data);else{const s=e.static?n.STATIC_DRAW:n.DYNAMIC_DRAW;i.byteLength=e.data.byteLength,n.bufferData(e.type,e.data,s)}}dispose(e,n){if(!this.managedBuffers[e.id])return;delete this.managedBuffers[e.id];const r=e._glBuffers[this.CONTEXT_UID],i=this.gl;e.disposeRunner.remove(this),r&&(n||i.deleteBuffer(r.buffer),delete e._glBuffers[this.CONTEXT_UID])}disposeAll(e){const n=Object.keys(this.managedBuffers);for(let r=0;r<n.length;r++)this.dispose(this.managedBuffers[n[r]],e)}createGLBuffer(e){const{CONTEXT_UID:n,gl:r}=this;return e._glBuffers[n]=new SB(r.createBuffer()),this.managedBuffers[e.id]=e,e.disposeRunner.add(this),e._glBuffers[n]}}zb.extension={type:fe.RendererSystem,name:"buffer"},Te.add(zb);class Wb{constructor(e){this.renderer=e}render(e,n){const r=this.renderer;let i,s,o,a;if(n&&(i=n.renderTexture,s=n.clear,o=n.transform,a=n.skipUpdateTransform),this.renderingToScreen=!i,r.runners.prerender.emit(),r.emit("prerender"),r.projection.transform=o,!r.context.isLost){if(i||(this.lastObjectRendered=e),!a){const l=e.enableTempParent();e.updateTransform(),e.disableTempParent(l)}r.renderTexture.bind(i),r.batch.currentRenderer.start(),(s??r.background.clearBeforeRender)&&r.renderTexture.clear(),e.render(r),r.batch.currentRenderer.flush(),i&&(n.blit&&r.framebuffer.blit(),i.baseTexture.update()),r.runners.postrender.emit(),r.projection.transform=null,r.emit("postrender")}}destroy(){this.renderer=null,this.lastObjectRendered=null}}Wb.extension={type:fe.RendererSystem,name:"objectRenderer"},Te.add(Wb);const mg=class extends vB{constructor(t){super(),this.type=EE.WEBGL,t=Object.assign({},ce.RENDER_OPTIONS,t),this.gl=null,this.CONTEXT_UID=0,this.globalUniforms=new hr({projectionMatrix:new Pt},!0),this.setup({runners:["init","destroy","contextChange","resolutionChange","reset","update","postrender","prerender","resize"],systems:mg.__systems,priority:["_view","textureGenerator","background","_plugin","startup","context","state","texture","buffer","geometry","framebuffer","transformFeedback","mask","scissor","stencil","projection","textureGC","filter","renderTexture","batch","objectRenderer","_multisample"]}),"useContextAlpha"in t&&(Ye("7.0.0","options.useContextAlpha is deprecated, use options.premultipliedAlpha and options.backgroundAlpha instead"),t.premultipliedAlpha=t.useContextAlpha&&"notMultiplied"!==t.useContextAlpha,t.backgroundAlpha=!1===t.useContextAlpha?1:t.backgroundAlpha),this._plugin.rendererPlugins=mg.__plugins,this.options=t,this.startup.run(this.options)}static test(t){return!t?.forceCanvas&&function YL(){return typeof Hp>"u"&&(Hp=function(){const e={stencil:!0,failIfMajorPerformanceCaveat:ce.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT};try{if(!ce.ADAPTER.getWebGLRenderingContext())return!1;const n=ce.ADAPTER.createCanvas();let r=n.getContext("webgl",e)||n.getContext("experimental-webgl",e);const i=!!r?.getContextAttributes()?.stencil;if(r){const s=r.getExtension("WEBGL_lose_context");s&&s.loseContext()}return r=null,i}catch{return!1}}()),Hp}()}render(t,e){this.objectRenderer.render(t,e)}resize(t,e){this._view.resizeView(t,e)}reset(){return this.runners.reset.emit(),this}clear(){this.renderTexture.bind(),this.renderTexture.clear()}destroy(t=!1){this.runners.destroy.items.reverse(),this.emitWithCustomOptions(this.runners.destroy,{_view:t}),super.destroy()}get plugins(){return this._plugin.plugins}get multisample(){return this._multisample.multisample}get width(){return this._view.element.width}get height(){return this._view.element.height}get resolution(){return this._view.resolution}set resolution(t){this._view.resolution=t,this.runners.resolutionChange.emit(t)}get autoDensity(){return this._view.autoDensity}get view(){return this._view.element}get screen(){return this._view.screen}get lastObjectRendered(){return this.objectRenderer.lastObjectRendered}get renderingToScreen(){return this.objectRenderer.renderingToScreen}get rendererLogId(){return`WebGL ${this.context.webGLVersion}`}get clearBeforeRender(){return Ye("7.0.0","renderer.clearBeforeRender has been deprecated, please use renderer.background.clearBeforeRender instead."),this.background.clearBeforeRender}get useContextAlpha(){return Ye("7.0.0","renderer.useContextAlpha has been deprecated, please use renderer.context.premultipliedAlpha instead."),this.context.useContextAlpha}get preserveDrawingBuffer(){return Ye("7.0.0","renderer.preserveDrawingBuffer has been deprecated, we cannot truly know this unless pixi created the context"),this.context.preserveDrawingBuffer}get backgroundColor(){return Ye("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color}set backgroundColor(t){Ye("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color=t}get backgroundAlpha(){return Ye("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha}set backgroundAlpha(t){Ye("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha=t}get powerPreference(){return Ye("7.0.0","renderer.powerPreference has been deprecated, we can only know this if pixi creates the context"),this.context.powerPreference}generateTexture(t,e){return this.textureGenerator.generateTexture(t,e)}};let xo=mg;xo.extension={type:fe.Renderer,priority:1},xo.__plugins={},xo.__systems={},Te.handleByMap(fe.RendererPlugin,xo.__plugins),Te.handleByMap(fe.RendererSystem,xo.__systems),Te.add(xo);class Xb extends Va{constructor(e,n){const{width:r,height:i}=n||{};super(r,i),this.items=[],this.itemDirtyIds=[];for(let s=0;s<e;s++){const o=new $e;this.items.push(o),this.itemDirtyIds.push(-2)}this.length=e,this._load=null,this.baseTexture=null}initFromArray(e,n){for(let r=0;r<this.length;r++)e[r]&&(e[r].castToBaseTexture?this.addBaseTextureAt(e[r].castToBaseTexture(),r):this.addResourceAt(e[r]instanceof Va?e[r]:nb(e[r],n),r))}dispose(){for(let e=0,n=this.length;e<n;e++)this.items[e].destroy();this.items=null,this.itemDirtyIds=null,this._load=null}addResourceAt(e,n){if(!this.items[n])throw new Error(`Index ${n} is out of bounds`);return e.valid&&!this.valid&&this.resize(e.width,e.height),this.items[n].setResource(e),this}bind(e){if(null!==this.baseTexture)throw new Error("Only one base texture per TextureArray is allowed");super.bind(e);for(let n=0;n<this.length;n++)this.items[n].parentTextureArray=e,this.items[n].on("update",e.update,e)}unbind(e){super.unbind(e);for(let n=0;n<this.length;n++)this.items[n].parentTextureArray=null,this.items[n].off("update",e.update,e)}load(){if(this._load)return this._load;const n=this.items.map(r=>r.resource).filter(r=>r).map(r=>r.load());return this._load=Promise.all(n).then(()=>{const{realWidth:r,realHeight:i}=this.items[0];return this.resize(r,i),Promise.resolve(this)}),this._load}}const Xa=class extends Xb{constructor(t,e){const{width:n,height:r,autoLoad:i,linkBaseTexture:s}=e||{};if(t&&t.length!==Xa.SIDES)throw new Error(`Invalid length. Got ${t.length}, expected 6`);super(6,{width:n,height:r});for(let o=0;o<Xa.SIDES;o++)this.items[o].target=fo.TEXTURE_CUBE_MAP_POSITIVE_X+o;this.linkBaseTexture=!1!==s,t&&this.initFromArray(t,e),!1!==i&&this.load()}bind(t){super.bind(t),t.target=fo.TEXTURE_CUBE_MAP}addBaseTextureAt(t,e,n){if(void 0===n&&(n=this.linkBaseTexture),!this.items[e])throw new Error(`Index ${e} is out of bounds`);if(!this.linkBaseTexture||t.parentTextureArray||Object.keys(t._glTextures).length>0){if(!t.resource)throw new Error("CubeResource does not support copying of renderTexture.");this.addResourceAt(t.resource,e)}else t.target=fo.TEXTURE_CUBE_MAP_POSITIVE_X+e,t.parentTextureArray=this.baseTexture,this.items[e]=t;return t.valid&&!this.valid&&this.resize(t.realWidth,t.realHeight),this.items[e]=t,this}upload(t,e,n){const r=this.itemDirtyIds;for(let i=0;i<Xa.SIDES;i++){const s=this.items[i];(r[i]<s.dirtyId||n.dirtyId<e.dirtyId)&&(s.valid&&s.resource?(s.resource.upload(t,s,n),r[i]=s.dirtyId):r[i]<-1&&(t.gl.texImage2D(s.target,0,n.internalFormat,e.realWidth,e.realHeight,0,e.format,n.type,null),r[i]=-1))}return!0}static test(t){return Array.isArray(t)&&t.length===Xa.SIDES}};let Yb=Xa;function qb(t,e,n,r,i,s,o){try{var a=t[s](o),l=a.value}catch(u){return void n(u)}a.done?e(l):Promise.resolve(l).then(r,i)}function re(t){return function(){var e=this,n=arguments;return new Promise(function(r,i){var s=t.apply(e,n);function o(l){qb(s,r,i,o,a,"next",l)}function a(l){qb(s,r,i,o,a,"throw",l)}o(void 0)})}}Yb.SIDES=6;class wo extends Ci{constructor(e,n){let r,i;n=n||{},"string"==typeof e?(r=wo.EMPTY,i=e):(r=e,i=null),super(r),this.url=i,this.crossOrigin=n.crossOrigin??!0,this.alphaMode="number"==typeof n.alphaMode?n.alphaMode:null,this._load=null,!1!==n.autoLoad&&this.load()}load(){var e=this;return this._load||(this._load=new Promise(function(){var n=re(function*(r,i){if(null!==e.url)try{const s=yield ce.ADAPTER.fetch(e.url,{mode:e.crossOrigin?"cors":"no-cors"});if(e.destroyed)return;const o=yield s.blob();if(e.destroyed)return;const a=yield createImageBitmap(o,{premultiplyAlpha:null===e.alphaMode||e.alphaMode===ar.UNPACK?"premultiply":"none"});if(e.destroyed)return;e.source=a,e.update(),r(e)}catch(s){if(e.destroyed)return;i(s),e.onError.emit(s)}else r(e)});return function(r,i){return n.apply(this,arguments)}}())),this._load}upload(e,n,r){return this.source instanceof ImageBitmap?("number"==typeof this.alphaMode&&(n.alphaMode=this.alphaMode),super.upload(e,n,r)):(this.load(),!1)}dispose(){this.source instanceof ImageBitmap&&this.source.close(),super.dispose(),this._load=null}static test(e){return!!globalThis.createImageBitmap&&typeof ImageBitmap<"u"&&("string"==typeof e||e instanceof ImageBitmap)}static get EMPTY(){return wo._EMPTY=wo._EMPTY??ce.ADAPTER.createCanvas(0,0),wo._EMPTY}}const Rc=class extends Ci{constructor(t,e){e=e||{},super(ce.ADAPTER.createCanvas()),this._width=0,this._height=0,this.svg=t,this.scale=e.scale||1,this._overrideWidth=e.width,this._overrideHeight=e.height,this._resolve=null,this._crossorigin=e.crossorigin,this._load=null,!1!==e.autoLoad&&this.load()}load(){return this._load||(this._load=new Promise(t=>{if(this._resolve=()=>{this.resize(this.source.width,this.source.height),t(this)},Rc.SVG_XML.test(this.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");this.svg=`data:image/svg+xml;base64,${btoa(unescape(encodeURIComponent(this.svg)))}`}this._loadSvg()})),this._load}_loadSvg(){const t=new Image;Ci.crossOrigin(t,this.svg,this._crossorigin),t.src=this.svg,t.onerror=e=>{this._resolve&&(t.onerror=null,this.onError.emit(e))},t.onload=()=>{if(!this._resolve)return;const e=t.width,n=t.height;if(!e||!n)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");let r=e*this.scale,i=n*this.scale;(this._overrideWidth||this._overrideHeight)&&(r=this._overrideWidth||this._overrideHeight/n*e,i=this._overrideHeight||this._overrideWidth/e*n),r=Math.round(r),i=Math.round(i);const s=this.source;s.width=r,s.height=i,s._pixiId=`canvas_${Qi()}`,s.getContext("2d").drawImage(t,0,0,e,n,0,0,r,i),this._resolve(),this._resolve=null}}static getSize(t){const e=Rc.SVG_SIZE.exec(t),n={};return e&&(n[e[1]]=Math.round(parseFloat(e[3])),n[e[5]]=Math.round(parseFloat(e[7]))),n}dispose(){super.dispose(),this._resolve=null,this._crossorigin=null}static test(t,e){return"svg"===e||"string"==typeof t&&t.startsWith("data:image/svg+xml")||"string"==typeof t&&Rc.SVG_XML.test(t)}};let Ya=Rc;Ya.SVG_XML=/^(<\?xml[^?]+\?>)?\s*(<!--[^(-->)]*-->)?\s*\<svg/m,Ya.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i;const yg=class extends Ci{constructor(t,e){if(e=e||{},!(t instanceof HTMLVideoElement)){const n=document.createElement("video");n.setAttribute("preload","auto"),n.setAttribute("webkit-playsinline",""),n.setAttribute("playsinline",""),"string"==typeof t&&(t=[t]),Ci.crossOrigin(n,t[0].src||t[0],e.crossorigin);for(let i=0;i<t.length;++i){const s=document.createElement("source");let{src:o,mime:a}=t[i];o=o||t[i];const l=o.split("?").shift().toLowerCase(),u=l.slice(l.lastIndexOf(".")+1);a=a||yg.MIME_TYPES[u]||`video/${u}`,s.src=o,s.type=a,n.appendChild(s)}t=n}super(t),this.noSubImage=!0,this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=e.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=!1!==e.autoPlay,this._load=null,this._resolve=null,this._onCanPlay=this._onCanPlay.bind(this),this._onError=this._onError.bind(this),!1!==e.autoLoad&&this.load()}update(t=0){this.destroyed||(this._msToNextUpdate=Math.floor(this._msToNextUpdate-Xt.shared.elapsedMS*this.source.playbackRate),(!this._updateFPS||this._msToNextUpdate<=0)&&(super.update(),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0))}load(){if(this._load)return this._load;const t=this.source;return(t.readyState===t.HAVE_ENOUGH_DATA||t.readyState===t.HAVE_FUTURE_DATA)&&t.width&&t.height&&(t.complete=!0),t.addEventListener("play",this._onPlayStart.bind(this)),t.addEventListener("pause",this._onPlayStop.bind(this)),this._isSourceReady()?this._onCanPlay():(t.addEventListener("canplay",this._onCanPlay),t.addEventListener("canplaythrough",this._onCanPlay),t.addEventListener("error",this._onError,!0)),this._load=new Promise(e=>{this.valid?e(this):(this._resolve=e,t.load())}),this._load}_onError(t){this.source.removeEventListener("error",this._onError,!0),this.onError.emit(t)}_isSourcePlaying(){const t=this.source;return!t.paused&&!t.ended&&this._isSourceReady()}_isSourceReady(){return this.source.readyState>2}_onPlayStart(){this.valid||this._onCanPlay(),this.autoUpdate&&!this._isConnectedToTicker&&(Xt.shared.add(this.update,this),this._isConnectedToTicker=!0)}_onPlayStop(){this._isConnectedToTicker&&(Xt.shared.remove(this.update,this),this._isConnectedToTicker=!1)}_onCanPlay(){const t=this.source;t.removeEventListener("canplay",this._onCanPlay),t.removeEventListener("canplaythrough",this._onCanPlay);const e=this.valid;this.resize(t.videoWidth,t.videoHeight),!e&&this._resolve&&(this._resolve(this),this._resolve=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&t.play()}dispose(){this._isConnectedToTicker&&(Xt.shared.remove(this.update,this),this._isConnectedToTicker=!1);const t=this.source;t&&(t.removeEventListener("error",this._onError,!0),t.pause(),t.src="",t.load()),super.dispose()}get autoUpdate(){return this._autoUpdate}set autoUpdate(t){t!==this._autoUpdate&&(this._autoUpdate=t,!this._autoUpdate&&this._isConnectedToTicker?(Xt.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._isSourcePlaying()&&(Xt.shared.add(this.update,this),this._isConnectedToTicker=!0))}get updateFPS(){return this._updateFPS}set updateFPS(t){t!==this._updateFPS&&(this._updateFPS=t)}static test(t,e){return globalThis.HTMLVideoElement&&t instanceof HTMLVideoElement||yg.TYPES.includes(e)}};let _g=yg;_g.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"],_g.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"},tg.push(wo,gb,class CB extends Ci{constructor(e){super(e)}static test(e){const{OffscreenCanvas:n}=globalThis;return!!(n&&e instanceof n)||globalThis.HTMLCanvasElement&&e instanceof HTMLCanvasElement}},_g,Ya,Ga,Yb,class TB extends Xb{constructor(e,n){const{width:r,height:i}=n||{};let s,o;Array.isArray(e)?(s=e,o=e.length):o=e,super(o,{width:r,height:i}),s&&this.initFromArray(s,n)}addBaseTextureAt(e,n){if(!e.resource)throw new Error("ArrayResource does not support RenderTexture");return this.addResourceAt(e.resource,n),this}bind(e){super.bind(e),e.target=fo.TEXTURE_2D_ARRAY}upload(e,n,r){const{length:i,itemDirtyIds:s,items:o}=this,{gl:a}=e;r.dirtyId<0&&a.texImage3D(a.TEXTURE_2D_ARRAY,0,r.internalFormat,this._width,this._height,i,0,n.format,r.type,null);for(let l=0;l<i;l++){const u=o[l];s[l]<u.dirtyId&&(s[l]=u.dirtyId,u.valid&&a.texSubImage3D(a.TEXTURE_2D_ARRAY,0,0,0,l,u.resource.width,u.resource.height,1,n.format,r.type,u.resource.source))}return!0}});const qa={build(t){const e=t.points;let n,r,i,s,o,a;if(t.type===rn.CIRC){const p=t.shape;n=p.x,r=p.y,o=a=p.radius,i=s=0}else if(t.type===rn.ELIP){const p=t.shape;n=p.x,r=p.y,o=p.width,a=p.height,i=s=0}else{const p=t.shape,g=p.width/2,m=p.height/2;n=p.x+g,r=p.y+m,o=a=Math.max(0,Math.min(p.radius,Math.min(g,m))),i=g-o,s=m-a}if(!(o>=0&&a>=0&&i>=0&&s>=0))return void(e.length=0);const l=Math.ceil(2.3*Math.sqrt(o+a)),u=8*l+(i?4:0)+(s?4:0);if(e.length=u,0===u)return;if(0===l)return e.length=8,e[0]=e[6]=n+i,e[1]=e[3]=r+s,e[2]=e[4]=n-i,void(e[5]=e[7]=r-s);let c=0,h=4*l+(i?2:0)+2,d=h,f=u;{const p=i+o,g=s,m=n+p,_=n-p,v=r+g;if(e[c++]=m,e[c++]=v,e[--h]=v,e[--h]=_,s){const D=r-g;e[d++]=_,e[d++]=D,e[--f]=D,e[--f]=m}}for(let p=1;p<l;p++){const g=Math.PI/2*(p/l),m=i+Math.cos(g)*o,_=s+Math.sin(g)*a,v=n+m,D=n-m,A=r+_,$=r-_;e[c++]=v,e[c++]=A,e[--h]=A,e[--h]=D,e[d++]=D,e[d++]=$,e[--f]=$,e[--f]=v}{const g=s+a,m=n+i,_=n-i,v=r+g,D=r-g;e[c++]=m,e[c++]=v,e[--f]=D,e[--f]=m,i&&(e[c++]=_,e[c++]=v,e[--f]=D,e[--f]=_)}},triangulate(t,e){const n=t.points,r=e.points,i=e.indices;if(0===n.length)return;let s=r.length/2;const o=s;let a,l;if(t.type!==rn.RREC){const c=t.shape;a=c.x,l=c.y}else{const c=t.shape;a=c.x+c.width/2,l=c.y+c.height/2}const u=t.matrix;r.push(t.matrix?u.a*a+u.c*l+u.tx:a,t.matrix?u.b*a+u.d*l+u.ty:l),s++,r.push(n[0],n[1]);for(let c=2;c<n.length;c+=2)r.push(n[c],n[c+1]),i.push(s++,o,s);i.push(o+1,o,s)}};function Zb(t,e=!1){const n=t.length;if(n<6)return;let r=0;for(let i=0,s=t[n-2],o=t[n-1];i<n;i+=2){const a=t[i],l=t[i+1];r+=(a-s)*(l+o),s=a,o=l}if(!e&&r>0||e&&r<=0){const i=n/2;for(let s=i+i%2;s<n;s+=2){const o=n-s-2,a=n-s-1,l=s,u=s+1;[t[o],t[l]]=[t[l],t[o]],[t[a],t[u]]=[t[u],t[a]]}}}const vg={build(t){t.points=t.shape.points.slice()},triangulate(t,e){let n=t.points;const r=t.holes,i=e.points,s=e.indices;if(n.length>=6){Zb(n,!1);const o=[];for(let u=0;u<r.length;u++){const c=r[u];Zb(c.points,!0),o.push(n.length/2),n=n.concat(c.points)}const a=jL(n,o,2);if(!a)return;const l=i.length/2;for(let u=0;u<a.length;u+=3)s.push(a[u]+l),s.push(a[u+1]+l),s.push(a[u+2]+l);for(let u=0;u<n.length;u++)i.push(n[u])}}},Kb={build(t){const e=t.shape,n=e.x,r=e.y,i=e.width,s=e.height,o=t.points;o.length=0,i>=0&&s>=0&&o.push(n,r,n+i,r,n+i,r+s,n,r+s)},triangulate(t,e){const n=t.points,r=e.points;if(0===n.length)return;const i=r.length/2;r.push(n[0],n[1],n[2],n[3],n[6],n[7],n[4],n[5]),e.indices.push(i,i+1,i+2,i+1,i+2,i+3)}},Qb={build(t){qa.build(t)},triangulate(t,e){qa.triangulate(t,e)}};var gr=(t=>(t.MITER="miter",t.BEVEL="bevel",t.ROUND="round",t))(gr||{}),os=(t=>(t.BUTT="butt",t.ROUND="round",t.SQUARE="square",t))(os||{});const Eo={adaptive:!0,maxLength:10,minSegments:8,maxSegments:2048,epsilon:1e-4,_segmentsCount(t,e=20){if(!this.adaptive||!t||isNaN(t))return e;let n=Math.ceil(t/this.maxLength);return n<this.minSegments?n=this.minSegments:n>this.maxSegments&&(n=this.maxSegments),n}};class xg{static curveTo(e,n,r,i,s,o){const u=o[o.length-1]-n,c=o[o.length-2]-e,h=i-n,d=r-e,f=Math.abs(u*d-c*h);if(f<1e-8||0===s)return(o[o.length-2]!==e||o[o.length-1]!==n)&&o.push(e,n),null;const p=u*u+c*c,g=h*h+d*d,m=u*h+c*d,_=s*Math.sqrt(p)/f,v=s*Math.sqrt(g)/f,D=_*m/p,A=v*m/g,$=_*d+v*c,ge=_*h+v*u,Ve=d*(_+A),ee=h*(_+A);return{cx:$+e,cy:ge+n,radius:s,startAngle:Math.atan2(u*(v+D)-ge,c*(v+D)-$),endAngle:Math.atan2(ee-ge,Ve-$),anticlockwise:c*h>d*u}}static arc(e,n,r,i,s,o,a,l,u){const c=a-o,h=Eo._segmentsCount(Math.abs(c)*s,40*Math.ceil(Math.abs(c)/ja)),d=c/(2*h),f=2*d,p=Math.cos(d),g=Math.sin(d),m=h-1,_=m%1/m;for(let v=0;v<=m;++v){const A=d+o+f*(v+_*v),$=Math.cos(A),ge=-Math.sin(A);u.push((p*$+g*ge)*s+r,(p*-ge+g*$)*s+i)}}}class Pc{static curveLength(e,n,r,i,s,o,a,l){let c=0,h=0,d=0,f=0,p=0,g=0,m=0,_=0,v=0,D=0,A=0,$=e,ge=n;for(let Q=1;Q<=10;++Q)h=Q/10,d=h*h,f=d*h,p=1-h,g=p*p,m=g*p,_=m*e+3*g*h*r+3*p*d*s+f*a,v=m*n+3*g*h*i+3*p*d*o+f*l,D=$-_,A=ge-v,$=_,ge=v,c+=Math.sqrt(D*D+A*A);return c}static curveTo(e,n,r,i,s,o,a){const l=a[a.length-2],u=a[a.length-1];a.length-=2;const c=Eo._segmentsCount(Pc.curveLength(l,u,e,n,r,i,s,o));let h=0,d=0,f=0,p=0,g=0;a.push(l,u);for(let m=1,_=0;m<=c;++m)_=m/c,h=1-_,d=h*h,f=d*h,p=_*_,g=p*_,a.push(f*l+3*d*_*e+3*h*p*r+g*s,f*u+3*d*_*n+3*h*p*i+g*o)}}function Jb(t,e,n,r,i,s,o,a){let d,f;return o?(d=r,f=-n):(d=-r,f=n),a.push(t-n*i+d,e-r*i+f,t+n*s+d,e+r*s+f),2}function as(t,e,n,r,i,s,o,a){const l=n-t,u=r-e;let c=Math.atan2(l,u),h=Math.atan2(i-t,s-e);a&&c<h?c+=2*Math.PI:!a&&c>h&&(h+=2*Math.PI);let d=c;const f=h-c,p=Math.abs(f),g=Math.sqrt(l*l+u*u),m=1+(15*p*Math.sqrt(g)/Math.PI>>0),_=f/m;if(d+=_,a){o.push(t,e,n,r);for(let v=1,D=d;v<m;v++,D+=_)o.push(t,e,t+Math.sin(D)*g,e+Math.cos(D)*g);o.push(t,e,i,s)}else{o.push(n,r,t,e);for(let v=1,D=d;v<m;v++,D+=_)o.push(t+Math.sin(D)*g,e+Math.cos(D)*g,t,e);o.push(i,s,t,e)}return 2*m}function wg(t,e){t.lineStyle.native?function AB(t,e){let n=0;const r=t.shape,i=t.points||r.points,s=r.type!==rn.POLY||r.closeStroke;if(0===i.length)return;const o=e.points,a=e.indices,l=i.length/2,u=o.length/2;let c=u;for(o.push(i[0],i[1]),n=1;n<l;n++)o.push(i[2*n],i[2*n+1]),a.push(c,c+1),c++;s&&a.push(c,u)}(t,e):function IB(t,e){const n=t.shape;let r=t.points||n.points.slice();const i=e.closePointEps;if(0===r.length)return;const s=t.lineStyle,o=new ut(r[0],r[1]),a=new ut(r[r.length-2],r[r.length-1]),l=n.type!==rn.POLY||n.closeStroke,u=Math.abs(o.x-a.x)<i&&Math.abs(o.y-a.y)<i;if(l){r=r.slice(),u&&(r.pop(),r.pop(),a.set(r[r.length-2],r[r.length-1]));const qe=.5*(o.x+a.x),Tt=.5*(a.y+o.y);r.unshift(qe,Tt),r.push(qe,Tt)}const c=e.points,h=r.length/2;let d=r.length;const f=c.length/2,p=s.width/2,g=p*p,m=s.miterLimit*s.miterLimit;let _=r[0],v=r[1],D=r[2],A=r[3],$=0,ge=0,Q=-(v-A),J=_-D,Ve=0,ee=0,he=Math.sqrt(Q*Q+J*J);Q/=he,J/=he,Q*=p,J*=p;const st=s.alignment,X=2*(1-st),Y=2*st;l||(s.cap===os.ROUND?d+=as(_-Q*(X-Y)*.5,v-J*(X-Y)*.5,_-Q*X,v-J*X,_+Q*Y,v+J*Y,c,!0)+2:s.cap===os.SQUARE&&(d+=Jb(_,v,Q,J,X,Y,!0,c))),c.push(_-Q*X,v-J*X,_+Q*Y,v+J*Y);for(let qe=1;qe<h-1;++qe){_=r[2*(qe-1)],v=r[2*(qe-1)+1],D=r[2*qe],A=r[2*qe+1],$=r[2*(qe+1)],ge=r[2*(qe+1)+1],Q=-(v-A),J=_-D,he=Math.sqrt(Q*Q+J*J),Q/=he,J/=he,Q*=p,J*=p,Ve=-(A-ge),ee=D-$,he=Math.sqrt(Ve*Ve+ee*ee),Ve/=he,ee/=he,Ve*=p,ee*=p;const Tt=D-_,ct=v-A,ll=D-$,ul=ge-A,HD=Tt*ll+ct*ul,sh=ct*ll-ul*Tt,cl=sh<0;if(Math.abs(sh)<.001*Math.abs(HD)){c.push(D-Q*X,A-J*X,D+Q*Y,A+J*Y),HD>=0&&(d+=s.join===gr.ROUND?as(D,A,D-Q*X,A-J*X,D-Ve*X,A-ee*X,c,!1)+4:2,c.push(D-Ve*Y,A-ee*Y,D+Ve*X,A+ee*X));continue}const VD=(-Q+_)*(-J+A)-(-Q+D)*(-J+v),GD=(-Ve+$)*(-ee+A)-(-Ve+D)*(-ee+ge),oh=(Tt*GD-ll*VD)/sh,ah=(ul*VD-ct*GD)/sh,jD=(oh-D)*(oh-D)+(ah-A)*(ah-A),hs=D+(oh-D)*X,ds=A+(ah-A)*X,fs=D-(oh-D)*Y,ps=A-(ah-A)*Y,RU=Math.min(Tt*Tt+ct*ct,ll*ll+ul*ul),$D=cl?X:Y;let lh=s.join;if(lh===gr.MITER&&jD/g>m&&(lh=gr.BEVEL),jD<=RU+$D*$D*g)switch(lh){case gr.MITER:c.push(hs,ds,fs,ps);break;case gr.BEVEL:cl?c.push(hs,ds,D+Q*Y,A+J*Y,hs,ds,D+Ve*Y,A+ee*Y):c.push(D-Q*X,A-J*X,fs,ps,D-Ve*X,A-ee*X,fs,ps),d+=2;break;case gr.ROUND:cl?(c.push(hs,ds,D+Q*Y,A+J*Y),d+=as(D,A,D+Q*Y,A+J*Y,D+Ve*Y,A+ee*Y,c,!0)+4,c.push(hs,ds,D+Ve*Y,A+ee*Y)):(c.push(D-Q*X,A-J*X,fs,ps),d+=as(D,A,D-Q*X,A-J*X,D-Ve*X,A-ee*X,c,!1)+4,c.push(D-Ve*X,A-ee*X,fs,ps))}else{switch(c.push(D-Q*X,A-J*X,D+Q*Y,A+J*Y),lh){case gr.MITER:cl?c.push(fs,ps,fs,ps):c.push(hs,ds,hs,ds),d+=2;break;case gr.ROUND:d+=cl?as(D,A,D+Q*Y,A+J*Y,D+Ve*Y,A+ee*Y,c,!0)+2:as(D,A,D-Q*X,A-J*X,D-Ve*X,A-ee*X,c,!1)+2}c.push(D-Ve*X,A-ee*X,D+Ve*Y,A+ee*Y),d+=2}}_=r[2*(h-2)],v=r[2*(h-2)+1],D=r[2*(h-1)],A=r[2*(h-1)+1],Q=-(v-A),J=_-D,he=Math.sqrt(Q*Q+J*J),Q/=he,J/=he,Q*=p,J*=p,c.push(D-Q*X,A-J*X,D+Q*Y,A+J*Y),l||(s.cap===os.ROUND?d+=as(D-Q*(X-Y)*.5,A-J*(X-Y)*.5,D-Q*X,A-J*X,D+Q*Y,A+J*Y,c,!1)+2:s.cap===os.SQUARE&&(d+=Jb(D,A,Q,J,X,Y,!1,c)));const St=e.indices,Qe=Eo.epsilon*Eo.epsilon;for(let qe=f;qe<d+f-2;++qe)_=c[2*qe],v=c[2*qe+1],D=c[2*(qe+1)],A=c[2*(qe+1)+1],$=c[2*(qe+2)],ge=c[2*(qe+2)+1],!(Math.abs(_*(A-ge)+D*(ge-v)+$*(v-A))<Qe)&&St.push(qe,qe+1,qe+2)}(t,e)}class Nc{static curveLength(e,n,r,i,s,o){const a=e-2*r+s,l=n-2*i+o,u=2*r-2*e,c=2*i-2*n,h=4*(a*a+l*l),d=4*(a*u+l*c),f=u*u+c*c,p=2*Math.sqrt(h+d+f),g=Math.sqrt(h),m=2*h*g,_=2*Math.sqrt(f),v=d/g;return(m*p+g*d*(p-_)+(4*f*h-d*d)*Math.log((2*g+v+p)/(v+_)))/(4*m)}static curveTo(e,n,r,i,s){const o=s[s.length-2],a=s[s.length-1],l=Eo._segmentsCount(Nc.curveLength(o,a,e,n,r,i));let u=0,c=0;for(let h=1;h<=l;++h){const d=h/l;u=o+(e-o)*d,c=a+(n-a)*d,s.push(u+(e+(r-e)*d-u)*d,c+(n+(i-n)*d-c)*d)}}}const Oc={[rn.POLY]:vg,[rn.CIRC]:qa,[rn.ELIP]:qa,[rn.RECT]:Kb,[rn.RREC]:Qb},Eg=[],Za=[];class Fc{constructor(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null,this.updateID=-1}isEmpty(){return this.minX>this.maxX||this.minY>this.maxY}clear(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0}getRectangle(e){return this.minX>this.maxX||this.minY>this.maxY?et.EMPTY:((e=e||new et(0,0,1,1)).x=this.minX,e.y=this.minY,e.width=this.maxX-this.minX,e.height=this.maxY-this.minY,e)}addPoint(e){this.minX=Math.min(this.minX,e.x),this.maxX=Math.max(this.maxX,e.x),this.minY=Math.min(this.minY,e.y),this.maxY=Math.max(this.maxY,e.y)}addPointMatrix(e,n){const{a:r,b:i,c:s,d:o,tx:a,ty:l}=e,u=r*n.x+s*n.y+a,c=i*n.x+o*n.y+l;this.minX=Math.min(this.minX,u),this.maxX=Math.max(this.maxX,u),this.minY=Math.min(this.minY,c),this.maxY=Math.max(this.maxY,c)}addQuad(e){let n=this.minX,r=this.minY,i=this.maxX,s=this.maxY,o=e[0],a=e[1];n=o<n?o:n,r=a<r?a:r,i=o>i?o:i,s=a>s?a:s,o=e[2],a=e[3],n=o<n?o:n,r=a<r?a:r,i=o>i?o:i,s=a>s?a:s,o=e[4],a=e[5],n=o<n?o:n,r=a<r?a:r,i=o>i?o:i,s=a>s?a:s,o=e[6],a=e[7],n=o<n?o:n,r=a<r?a:r,i=o>i?o:i,s=a>s?a:s,this.minX=n,this.minY=r,this.maxX=i,this.maxY=s}addFrame(e,n,r,i,s){this.addFrameMatrix(e.worldTransform,n,r,i,s)}addFrameMatrix(e,n,r,i,s){const o=e.a,a=e.b,l=e.c,u=e.d,c=e.tx,h=e.ty;let d=this.minX,f=this.minY,p=this.maxX,g=this.maxY,m=o*n+l*r+c,_=a*n+u*r+h;d=m<d?m:d,f=_<f?_:f,p=m>p?m:p,g=_>g?_:g,m=o*i+l*r+c,_=a*i+u*r+h,d=m<d?m:d,f=_<f?_:f,p=m>p?m:p,g=_>g?_:g,m=o*n+l*s+c,_=a*n+u*s+h,d=m<d?m:d,f=_<f?_:f,p=m>p?m:p,g=_>g?_:g,m=o*i+l*s+c,_=a*i+u*s+h,d=m<d?m:d,f=_<f?_:f,p=m>p?m:p,g=_>g?_:g,this.minX=d,this.minY=f,this.maxX=p,this.maxY=g}addVertexData(e,n,r){let i=this.minX,s=this.minY,o=this.maxX,a=this.maxY;for(let l=n;l<r;l+=2){const u=e[l],c=e[l+1];i=u<i?u:i,s=c<s?c:s,o=u>o?u:o,a=c>a?c:a}this.minX=i,this.minY=s,this.maxX=o,this.maxY=a}addVertices(e,n,r,i){this.addVerticesMatrix(e.worldTransform,n,r,i)}addVerticesMatrix(e,n,r,i,s=0,o=s){const a=e.a,l=e.b,u=e.c,c=e.d,h=e.tx,d=e.ty;let f=this.minX,p=this.minY,g=this.maxX,m=this.maxY;for(let _=r;_<i;_+=2){const v=n[_],D=n[_+1],A=a*v+u*D+h,$=c*D+l*v+d;f=Math.min(f,A-s),g=Math.max(g,A+s),p=Math.min(p,$-o),m=Math.max(m,$+o)}this.minX=f,this.minY=p,this.maxX=g,this.maxY=m}addBounds(e){const n=this.minX,r=this.minY,i=this.maxX,s=this.maxY;this.minX=e.minX<n?e.minX:n,this.minY=e.minY<r?e.minY:r,this.maxX=e.maxX>i?e.maxX:i,this.maxY=e.maxY>s?e.maxY:s}addBoundsMask(e,n){const r=e.minX>n.minX?e.minX:n.minX,i=e.minY>n.minY?e.minY:n.minY,s=e.maxX<n.maxX?e.maxX:n.maxX,o=e.maxY<n.maxY?e.maxY:n.maxY;if(r<=s&&i<=o){const a=this.minX,l=this.minY,u=this.maxX,c=this.maxY;this.minX=r<a?r:a,this.minY=i<l?i:l,this.maxX=s>u?s:u,this.maxY=o>c?o:c}}addBoundsMatrix(e,n){this.addFrameMatrix(n,e.minX,e.minY,e.maxX,e.maxY)}addBoundsArea(e,n){const r=e.minX>n.x?e.minX:n.x,i=e.minY>n.y?e.minY:n.y,s=e.maxX<n.x+n.width?e.maxX:n.x+n.width,o=e.maxY<n.y+n.height?e.maxY:n.y+n.height;if(r<=s&&i<=o){const a=this.minX,l=this.minY,u=this.maxX,c=this.maxY;this.minX=r<a?r:a,this.minY=i<l?i:l,this.maxX=s>u?s:u,this.maxY=o>c?o:c}}pad(e=0,n=e){this.isEmpty()||(this.minX-=e,this.maxX+=e,this.minY-=n,this.maxY+=n)}addFramePad(e,n,r,i,s,o){n-=o,r+=s,i+=o,this.minX=this.minX<(e-=s)?this.minX:e,this.maxX=this.maxX>r?this.maxX:r,this.minY=this.minY<n?this.minY:n,this.maxY=this.maxY>i?this.maxY:i}}class kt extends Ba{constructor(){super(),this.tempDisplayObjectParent=null,this.transform=new mc,this.alpha=1,this.visible=!0,this.renderable=!0,this.cullable=!1,this.cullArea=null,this.parent=null,this.worldAlpha=1,this._lastSortedIndex=0,this._zIndex=0,this.filterArea=null,this.filters=null,this._enabledFilters=null,this._bounds=new Fc,this._localBounds=null,this._boundsID=0,this._boundsRect=null,this._localBoundsRect=null,this._mask=null,this._maskRefCount=0,this._destroyed=!1,this.isSprite=!1,this.isMask=!1}static mixin(e){const n=Object.keys(e);for(let r=0;r<n.length;++r){const i=n[r];Object.defineProperty(kt.prototype,i,Object.getOwnPropertyDescriptor(e,i))}}get destroyed(){return this._destroyed}_recursivePostUpdateTransform(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)}updateTransform(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha}getBounds(e,n){return e||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._bounds.updateID!==this._boundsID&&(this.calculateBounds(),this._bounds.updateID=this._boundsID),n||(this._boundsRect||(this._boundsRect=new et),n=this._boundsRect),this._bounds.getRectangle(n)}getLocalBounds(e){e||(this._localBoundsRect||(this._localBoundsRect=new et),e=this._localBoundsRect),this._localBounds||(this._localBounds=new Fc);const n=this.transform,r=this.parent;this.parent=null,this.transform=this._tempDisplayObjectParent.transform;const i=this._bounds,s=this._boundsID;this._bounds=this._localBounds;const o=this.getBounds(!1,e);return this.parent=r,this.transform=n,this._bounds=i,this._bounds.updateID+=this._boundsID-s,o}toGlobal(e,n,r=!1){return r||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(e,n)}toLocal(e,n,r,i){return n&&(e=n.toGlobal(e,r,i)),i||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(e,r)}setParent(e){if(!e||!e.addChild)throw new Error("setParent: Argument must be a Container");return e.addChild(this),e}removeFromParent(){this.parent?.removeChild(this)}setTransform(e=0,n=0,r=1,i=1,s=0,o=0,a=0,l=0,u=0){return this.position.x=e,this.position.y=n,this.scale.x=r||1,this.scale.y=i||1,this.rotation=s,this.skew.x=o,this.skew.y=a,this.pivot.x=l,this.pivot.y=u,this}destroy(e){this.removeFromParent(),this._destroyed=!0,this.transform=null,this.parent=null,this._bounds=null,this.mask=null,this.cullArea=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.eventMode="auto",this.interactiveChildren=!1,this.emit("destroyed"),this.removeAllListeners()}get _tempDisplayObjectParent(){return null===this.tempDisplayObjectParent&&(this.tempDisplayObjectParent=new MB),this.tempDisplayObjectParent}enableTempParent(){const e=this.parent;return this.parent=this._tempDisplayObjectParent,e}disableTempParent(e){this.parent=e}get x(){return this.position.x}set x(e){this.transform.position.x=e}get y(){return this.position.y}set y(e){this.transform.position.y=e}get worldTransform(){return this.transform.worldTransform}get localTransform(){return this.transform.localTransform}get position(){return this.transform.position}set position(e){this.transform.position.copyFrom(e)}get scale(){return this.transform.scale}set scale(e){this.transform.scale.copyFrom(e)}get pivot(){return this.transform.pivot}set pivot(e){this.transform.pivot.copyFrom(e)}get skew(){return this.transform.skew}set skew(e){this.transform.skew.copyFrom(e)}get rotation(){return this.transform.rotation}set rotation(e){this.transform.rotation=e}get angle(){return this.transform.rotation*bk}set angle(e){this.transform.rotation=e*Dk}get zIndex(){return this._zIndex}set zIndex(e){this._zIndex=e,this.parent&&(this.parent.sortDirty=!0)}get worldVisible(){let e=this;do{if(!e.visible)return!1;e=e.parent}while(e);return!0}get mask(){return this._mask}set mask(e){if(this._mask!==e){if(this._mask){const n=this._mask.isMaskData?this._mask.maskObject:this._mask;n&&(n._maskRefCount--,0===n._maskRefCount&&(n.renderable=!0,n.isMask=!1))}if(this._mask=e,this._mask){const n=this._mask.isMaskData?this._mask.maskObject:this._mask;n&&(0===n._maskRefCount&&(n.renderable=!1,n.isMask=!0),n._maskRefCount++)}}}}class MB extends kt{constructor(){super(...arguments),this.sortDirty=null}}kt.prototype.displayObjectUpdateTransform=kt.prototype.updateTransform;const RB=new Pt;function PB(t,e){return t.zIndex===e.zIndex?t._lastSortedIndex-e._lastSortedIndex:t.zIndex-e.zIndex}const bg=class extends kt{constructor(){super(),this.children=[],this.sortableChildren=bg.defaultSortableChildren,this.sortDirty=!1}onChildrenChange(t){}addChild(...t){if(t.length>1)for(let e=0;e<t.length;e++)this.addChild(t[e]);else{const e=t[0];e.parent&&e.parent.removeChild(e),e.parent=this,this.sortDirty=!0,e.transform._parentID=-1,this.children.push(e),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",e,this,this.children.length-1),e.emit("added",this)}return t[0]}addChildAt(t,e){if(e<0||e>this.children.length)throw new Error(`${t}addChildAt: The index ${e} supplied is out of bounds ${this.children.length}`);return t.parent&&t.parent.removeChild(t),t.parent=this,this.sortDirty=!0,t.transform._parentID=-1,this.children.splice(e,0,t),this._boundsID++,this.onChildrenChange(e),t.emit("added",this),this.emit("childAdded",t,this,e),t}swapChildren(t,e){if(t===e)return;const n=this.getChildIndex(t),r=this.getChildIndex(e);this.children[n]=e,this.children[r]=t,this.onChildrenChange(n<r?n:r)}getChildIndex(t){const e=this.children.indexOf(t);if(-1===e)throw new Error("The supplied DisplayObject must be a child of the caller");return e}setChildIndex(t,e){if(e<0||e>=this.children.length)throw new Error(`The index ${e} supplied is out of bounds ${this.children.length}`);const n=this.getChildIndex(t);mo(this.children,n,1),this.children.splice(e,0,t),this.onChildrenChange(e)}getChildAt(t){if(t<0||t>=this.children.length)throw new Error(`getChildAt: Index (${t}) does not exist.`);return this.children[t]}removeChild(...t){if(t.length>1)for(let e=0;e<t.length;e++)this.removeChild(t[e]);else{const e=t[0],n=this.children.indexOf(e);if(-1===n)return null;e.parent=null,e.transform._parentID=-1,mo(this.children,n,1),this._boundsID++,this.onChildrenChange(n),e.emit("removed",this),this.emit("childRemoved",e,this,n)}return t[0]}removeChildAt(t){const e=this.getChildAt(t);return e.parent=null,e.transform._parentID=-1,mo(this.children,t,1),this._boundsID++,this.onChildrenChange(t),e.emit("removed",this),this.emit("childRemoved",e,this,t),e}removeChildren(t=0,e=this.children.length){const i=e-t;let s;if(i>0&&i<=e){s=this.children.splice(t,i);for(let o=0;o<s.length;++o)s[o].parent=null,s[o].transform&&(s[o].transform._parentID=-1);this._boundsID++,this.onChildrenChange(t);for(let o=0;o<s.length;++o)s[o].emit("removed",this),this.emit("childRemoved",s[o],this,o);return s}if(0===i&&0===this.children.length)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")}sortChildren(){let t=!1;for(let e=0,n=this.children.length;e<n;++e){const r=this.children[e];r._lastSortedIndex=e,!t&&0!==r.zIndex&&(t=!0)}t&&this.children.length>1&&this.children.sort(PB),this.sortDirty=!1}updateTransform(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(let t=0,e=this.children.length;t<e;++t){const n=this.children[t];n.visible&&n.updateTransform()}}calculateBounds(){this._bounds.clear(),this._calculateBounds();for(let t=0;t<this.children.length;t++){const e=this.children[t];if(e.visible&&e.renderable)if(e.calculateBounds(),e._mask){const n=e._mask.isMaskData?e._mask.maskObject:e._mask;n?(n.calculateBounds(),this._bounds.addBoundsMask(e._bounds,n._bounds)):this._bounds.addBounds(e._bounds)}else e.filterArea?this._bounds.addBoundsArea(e._bounds,e.filterArea):this._bounds.addBounds(e._bounds)}this._bounds.updateID=this._boundsID}getLocalBounds(t,e=!1){const n=super.getLocalBounds(t);if(!e)for(let r=0,i=this.children.length;r<i;++r){const s=this.children[r];s.visible&&s.updateTransform()}return n}_calculateBounds(){}_renderWithCulling(t){const e=t.renderTexture.sourceFrame;if(!(e.width>0&&e.height>0))return;let n,r;this.cullArea?(n=this.cullArea,r=this.worldTransform):this._render!==bg.prototype._render&&(n=this.getBounds(!0));const i=t.projection.transform;if(i&&(r?(r=RB.copyFrom(r),r.prepend(i)):r=i),n&&e.intersects(n,r))this._render(t);else if(this.cullArea)return;for(let s=0,o=this.children.length;s<o;++s){const a=this.children[s],l=a.cullable;a.cullable=l||!this.cullArea,a.render(t),a.cullable=l}}render(t){if(this.visible&&!(this.worldAlpha<=0)&&this.renderable)if(this._mask||this.filters?.length)this.renderAdvanced(t);else if(this.cullable)this._renderWithCulling(t);else{this._render(t);for(let e=0,n=this.children.length;e<n;++e)this.children[e].render(t)}}renderAdvanced(t){const e=this.filters,n=this._mask;if(e){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(let i=0;i<e.length;i++)e[i].enabled&&this._enabledFilters.push(e[i])}const r=e&&this._enabledFilters?.length||n&&(!n.isMaskData||n.enabled&&(n.autoDetect||n.type!==Kt.NONE));if(r&&t.batch.flush(),e&&this._enabledFilters?.length&&t.filter.push(this,this._enabledFilters),n&&t.mask.push(this,this._mask),this.cullable)this._renderWithCulling(t);else{this._render(t);for(let i=0,s=this.children.length;i<s;++i)this.children[i].render(t)}r&&t.batch.flush(),n&&t.mask.pop(this),e&&this._enabledFilters?.length&&t.filter.pop()}_render(t){}destroy(t){super.destroy(),this.sortDirty=!1;const e="boolean"==typeof t?t:t?.children,n=this.removeChildren(0,this.children.length);if(e)for(let r=0;r<n.length;++r)n[r].destroy(t)}get width(){return this.scale.x*this.getLocalBounds().width}set width(t){const e=this.getLocalBounds().width;this.scale.x=0!==e?t/e:1,this._width=t}get height(){return this.scale.y*this.getLocalBounds().height}set height(t){const e=this.getLocalBounds().height;this.scale.y=0!==e?t/e:1,this._height=t}};let on=bg;on.defaultSortableChildren=!1,on.prototype.containerUpdateTransform=on.prototype.updateTransform,Object.defineProperties(ce,{SORTABLE_CHILDREN:{get:()=>on.defaultSortableChildren,set(t){Ye("7.1.0","settings.SORTABLE_CHILDREN is deprecated, use Container.defaultSortableChildren"),on.defaultSortableChildren=t}}});class Lc{constructor(e,n=null,r=null,i=null){this.points=[],this.holes=[],this.shape=e,this.lineStyle=r,this.fillStyle=n,this.matrix=i,this.type=e.type}clone(){return new Lc(this.shape,this.fillStyle,this.lineStyle,this.matrix)}destroy(){this.shape=null,this.holes.length=0,this.holes=null,this.points.length=0,this.points=null,this.lineStyle=null,this.fillStyle=null}}class eD{constructor(){this.reset()}begin(e,n,r){this.reset(),this.style=e,this.start=n,this.attribStart=r}end(e,n){this.attribSize=n-this.attribStart,this.size=e-this.start}reset(){this.style=null,this.size=0,this.start=0,this.attribStart=0,this.attribSize=0}}const bo=new ut,tD=class extends ib{constructor(){super(),this.closePointEps=1e-4,this.boundsPadding=0,this.uvsFloat32=null,this.indicesUint16=null,this.batchable=!1,this.points=[],this.colors=[],this.uvs=[],this.indices=[],this.textureIds=[],this.graphicsData=[],this.drawCalls=[],this.batchDirty=-1,this.batches=[],this.dirty=0,this.cacheDirty=-1,this.clearDirty=0,this.shapeIndex=0,this._bounds=new Fc,this.boundsDirty=-1}get bounds(){return this.updateBatches(),this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.calculateBounds()),this._bounds}invalidate(){this.boundsDirty=-1,this.dirty++,this.batchDirty++,this.shapeIndex=0,this.points.length=0,this.colors.length=0,this.uvs.length=0,this.indices.length=0,this.textureIds.length=0;for(let t=0;t<this.drawCalls.length;t++)this.drawCalls[t].texArray.clear(),Za.push(this.drawCalls[t]);this.drawCalls.length=0;for(let t=0;t<this.batches.length;t++){const e=this.batches[t];e.reset(),Eg.push(e)}this.batches.length=0}clear(){return this.graphicsData.length>0&&(this.invalidate(),this.clearDirty++,this.graphicsData.length=0),this}drawShape(t,e=null,n=null,r=null){const i=new Lc(t,e,n,r);return this.graphicsData.push(i),this.dirty++,this}drawHole(t,e=null){if(!this.graphicsData.length)return null;const n=new Lc(t,null,null,e),r=this.graphicsData[this.graphicsData.length-1];return n.lineStyle=r.lineStyle,r.holes.push(n),this.dirty++,this}destroy(){super.destroy();for(let t=0;t<this.graphicsData.length;++t)this.graphicsData[t].destroy();this.points.length=0,this.points=null,this.colors.length=0,this.colors=null,this.uvs.length=0,this.uvs=null,this.indices.length=0,this.indices=null,this.indexBuffer.destroy(),this.indexBuffer=null,this.graphicsData.length=0,this.graphicsData=null,this.drawCalls.length=0,this.drawCalls=null,this.batches.length=0,this.batches=null,this._bounds=null}containsPoint(t){const e=this.graphicsData;for(let n=0;n<e.length;++n){const r=e[n];if(r.fillStyle.visible&&r.shape&&(r.matrix?r.matrix.applyInverse(t,bo):bo.copyFrom(t),r.shape.contains(bo.x,bo.y))){let i=!1;if(r.holes)for(let s=0;s<r.holes.length;s++)if(r.holes[s].shape.contains(bo.x,bo.y)){i=!0;break}if(!i)return!0}}return!1}updateBatches(){if(!this.graphicsData.length)return void(this.batchable=!0);if(!this.validateBatching())return;this.cacheDirty=this.dirty;const t=this.uvs,e=this.graphicsData;let n=null,r=null;this.batches.length>0&&(n=this.batches[this.batches.length-1],r=n.style);for(let a=this.shapeIndex;a<e.length;a++){this.shapeIndex++;const l=e[a],u=l.fillStyle,c=l.lineStyle;Oc[l.type].build(l),l.matrix&&this.transformPoints(l.points,l.matrix),(u.visible||c.visible)&&this.processHoles(l.holes);for(let d=0;d<2;d++){const f=0===d?u:c;if(!f.visible)continue;const g=this.indices.length,m=this.points.length/2;f.texture.baseTexture.wrapMode=Ei.REPEAT,0===d?this.processFill(l):this.processLine(l);const _=this.points.length/2-m;0!==_&&(n&&!this._compareStyles(r,f)&&(n.end(g,m),n=null),n||(n=Eg.pop()||new eD,n.begin(f,g,m),this.batches.push(n),r=f),this.addUvs(this.points,t,f.texture,m,_,f.matrix))}}const s=this.points.length/2;if(n&&n.end(this.indices.length,s),0===this.batches.length)return void(this.batchable=!0);const o=s>65535;this.indicesUint16&&this.indices.length===this.indicesUint16.length&&o===this.indicesUint16.BYTES_PER_ELEMENT>2?this.indicesUint16.set(this.indices):this.indicesUint16=o?new Uint32Array(this.indices):new Uint16Array(this.indices),this.batchable=this.isBatchable(),this.batchable?this.packBatches():this.buildDrawCalls()}_compareStyles(t,e){return!(!t||!e||t.texture.baseTexture!==e.texture.baseTexture||t.color+t.alpha!==e.color+e.alpha||!!t.native!=!!e.native)}validateBatching(){if(this.dirty===this.cacheDirty||!this.graphicsData.length)return!1;for(let t=0,e=this.graphicsData.length;t<e;t++){const n=this.graphicsData[t],r=n.fillStyle,i=n.lineStyle;if(r&&!r.texture.baseTexture.valid||i&&!i.texture.baseTexture.valid)return!1}return!0}packBatches(){this.batchDirty++,this.uvsFloat32=new Float32Array(this.uvs);const t=this.batches;for(let e=0,n=t.length;e<n;e++){const r=t[e];for(let i=0;i<r.size;i++){const s=r.start+i;this.indicesUint16[s]=this.indicesUint16[s]-r.attribStart}}}isBatchable(){if(this.points.length>131070)return!1;const t=this.batches;for(let e=0;e<t.length;e++)if(t[e].style.native)return!1;return this.points.length<2*tD.BATCHABLE_SIZE}buildDrawCalls(){let t=++$e._globalBatch;for(let c=0;c<this.drawCalls.length;c++)this.drawCalls[c].texArray.clear(),Za.push(this.drawCalls[c]);this.drawCalls.length=0;const e=this.colors,n=this.textureIds;let r=Za.pop();r||(r=new ng,r.texArray=new ag),r.texArray.count=0,r.start=0,r.size=0,r.type=Lr.TRIANGLES;let i=0,s=null,o=0,a=!1,l=Lr.TRIANGLES,u=0;this.drawCalls.push(r);for(let c=0;c<this.batches.length;c++){const h=this.batches[c],d=8,f=h.style,p=f.texture.baseTexture;a!==!!f.native&&(a=!!f.native,l=a?Lr.LINES:Lr.TRIANGLES,s=null,i=d,t++),s!==p&&(s=p,p._batchEnabled!==t&&(i===d&&(t++,i=0,r.size>0&&(r=Za.pop(),r||(r=new ng,r.texArray=new ag),this.drawCalls.push(r)),r.start=u,r.size=0,r.texArray.count=0,r.type=l),p.touched=1,p._batchEnabled=t,p._batchLocation=i,p.wrapMode=Ei.REPEAT,r.texArray.elements[r.texArray.count++]=p,i++)),r.size+=h.size,u+=h.size,o=p._batchLocation,this.addColors(e,f.color,f.alpha,h.attribSize,h.attribStart),this.addTextureIds(n,o,h.attribSize,h.attribStart)}$e._globalBatch=t,this.packAttributes()}packAttributes(){const t=this.points,e=this.uvs,n=this.colors,r=this.textureIds,i=new ArrayBuffer(3*t.length*4),s=new Float32Array(i),o=new Uint32Array(i);let a=0;for(let l=0;l<t.length/2;l++)s[a++]=t[2*l],s[a++]=t[2*l+1],s[a++]=e[2*l],s[a++]=e[2*l+1],o[a++]=n[l],s[a++]=r[l];this._buffer.update(i),this._indexBuffer.update(this.indicesUint16)}processFill(t){t.holes.length?vg.triangulate(t,this):Oc[t.type].triangulate(t,this)}processLine(t){wg(t,this);for(let e=0;e<t.holes.length;e++)wg(t.holes[e],this)}processHoles(t){for(let e=0;e<t.length;e++){const n=t[e];Oc[n.type].build(n),n.matrix&&this.transformPoints(n.points,n.matrix)}}calculateBounds(){const t=this._bounds;t.clear(),t.addVertexData(this.points,0,this.points.length),t.pad(this.boundsPadding,this.boundsPadding)}transformPoints(t,e){for(let n=0;n<t.length/2;n++){const r=t[2*n],i=t[2*n+1];t[2*n]=e.a*r+e.c*i+e.tx,t[2*n+1]=e.b*r+e.d*i+e.ty}}addColors(t,e,n,r,i=0){const s=ft.shared.setValue(e).toLittleEndianNumber(),o=ft.shared.setValue(s).toPremultiplied(n);t.length=Math.max(t.length,i+r);for(let a=0;a<r;a++)t[i+a]=o}addTextureIds(t,e,n,r=0){t.length=Math.max(t.length,r+n);for(let i=0;i<n;i++)t[r+i]=e}addUvs(t,e,n,r,i,s=null){let o=0;const a=e.length,l=n.frame;for(;o<i;){let c=t[2*(r+o)],h=t[2*(r+o)+1];if(s){const d=s.a*c+s.c*h+s.tx;h=s.b*c+s.d*h+s.ty,c=d}o++,e.push(c/l.width,h/l.height)}const u=n.baseTexture;(l.width<u.width||l.height<u.height)&&this.adjustUvs(e,n,a,i)}adjustUvs(t,e,n,r){const i=e.baseTexture,s=1e-6,o=n+2*r,a=e.frame,l=a.width/i.width,u=a.height/i.height;let c=a.x/a.width,h=a.y/a.height,d=Math.floor(t[n]+s),f=Math.floor(t[n+1]+s);for(let p=n+2;p<o;p+=2)d=Math.min(d,Math.floor(t[p]+s)),f=Math.min(f,Math.floor(t[p+1]+s));c-=d,h-=f;for(let p=n;p<o;p+=2)t[p]=(t[p]+c)*l,t[p+1]=(t[p+1]+h)*u}};let nD=tD;nD.BATCHABLE_SIZE=100;class kc{constructor(){this.color=16777215,this.alpha=1,this.texture=_e.WHITE,this.matrix=null,this.visible=!1,this.reset()}clone(){const e=new kc;return e.color=this.color,e.alpha=this.alpha,e.texture=this.texture,e.matrix=this.matrix,e.visible=this.visible,e}reset(){this.color=16777215,this.alpha=1,this.texture=_e.WHITE,this.matrix=null,this.visible=!1}destroy(){this.texture=null,this.matrix=null}}class Dg extends kc{constructor(){super(...arguments),this.width=0,this.alignment=.5,this.native=!1,this.cap=os.BUTT,this.join=gr.MITER,this.miterLimit=10}clone(){const e=new Dg;return e.color=this.color,e.alpha=this.alpha,e.texture=this.texture,e.matrix=this.matrix,e.visible=this.visible,e.width=this.width,e.alignment=this.alignment,e.native=this.native,e.cap=this.cap,e.join=this.join,e.miterLimit=this.miterLimit,e}reset(){super.reset(),this.color=0,this.alignment=.5,this.width=0,this.native=!1}}const Sg={},Bc=class extends on{constructor(t=null){super(),this.shader=null,this.pluginName="batch",this.currentPath=null,this.batches=[],this.batchTint=-1,this.batchDirty=-1,this.vertexData=null,this._fillStyle=new kc,this._lineStyle=new Dg,this._matrix=null,this._holeMode=!1,this.state=li.for2d(),this._geometry=t||new nD,this._geometry.refCount++,this._transformID=-1,this._tintColor=new ft(16777215),this.blendMode=Oe.NORMAL}get geometry(){return this._geometry}clone(){return this.finishPoly(),new Bc(this._geometry)}set blendMode(t){this.state.blendMode=t}get blendMode(){return this.state.blendMode}get tint(){return this._tintColor.value}set tint(t){this._tintColor.setValue(t)}get fill(){return this._fillStyle}get line(){return this._lineStyle}lineStyle(t=null,e=0,n,r=.5,i=!1){return"number"==typeof t&&(t={width:t,color:e,alpha:n,alignment:r,native:i}),this.lineTextureStyle(t)}lineTextureStyle(t){t=Object.assign({width:0,texture:_e.WHITE,color:t?.texture?16777215:0,matrix:null,alignment:.5,native:!1,cap:os.BUTT,join:gr.MITER,miterLimit:10},t),this.normalizeColor(t),this.currentPath&&this.startPoly();const n=t.width>0&&t.alpha>0;return n?(t.matrix&&(t.matrix=t.matrix.clone(),t.matrix.invert()),Object.assign(this._lineStyle,{visible:n},t)):this._lineStyle.reset(),this}startPoly(){if(this.currentPath){const t=this.currentPath.points,e=this.currentPath.points.length;e>2&&(this.drawShape(this.currentPath),this.currentPath=new Ji,this.currentPath.closeStroke=!1,this.currentPath.points.push(t[e-2],t[e-1]))}else this.currentPath=new Ji,this.currentPath.closeStroke=!1}finishPoly(){this.currentPath&&(this.currentPath.points.length>2?(this.drawShape(this.currentPath),this.currentPath=null):this.currentPath.points.length=0)}moveTo(t,e){return this.startPoly(),this.currentPath.points[0]=t,this.currentPath.points[1]=e,this}lineTo(t,e){this.currentPath||this.moveTo(0,0);const n=this.currentPath.points;return(n[n.length-2]!==t||n[n.length-1]!==e)&&n.push(t,e),this}_initCurve(t=0,e=0){this.currentPath?0===this.currentPath.points.length&&(this.currentPath.points=[t,e]):this.moveTo(t,e)}quadraticCurveTo(t,e,n,r){this._initCurve();const i=this.currentPath.points;return 0===i.length&&this.moveTo(0,0),Nc.curveTo(t,e,n,r,i),this}bezierCurveTo(t,e,n,r,i,s){return this._initCurve(),Pc.curveTo(t,e,n,r,i,s,this.currentPath.points),this}arcTo(t,e,n,r,i){this._initCurve(t,e);const o=xg.curveTo(t,e,n,r,i,this.currentPath.points);if(o){const{cx:a,cy:l,radius:u,startAngle:c,endAngle:h,anticlockwise:d}=o;this.arc(a,l,u,c,h,d)}return this}arc(t,e,n,r,i,s=!1){if(r===i)return this;if(!s&&i<=r?i+=ja:s&&r<=i&&(r+=ja),i-r==0)return this;const a=t+Math.cos(r)*n,l=e+Math.sin(r)*n,u=this._geometry.closePointEps;let c=this.currentPath?this.currentPath.points:null;if(c){const h=Math.abs(c[c.length-2]-a),d=Math.abs(c[c.length-1]-l);h<u&&d<u||c.push(a,l)}else this.moveTo(a,l),c=this.currentPath.points;return xg.arc(a,l,t,e,n,r,i,s,c),this}beginFill(t=0,e){return this.beginTextureFill({texture:_e.WHITE,color:t,alpha:e})}normalizeColor(t){const e=ft.shared.setValue(t.color??0);t.color=e.toNumber(),t.alpha??(t.alpha=e.alpha)}beginTextureFill(t){t=Object.assign({texture:_e.WHITE,color:16777215,matrix:null},t),this.normalizeColor(t),this.currentPath&&this.startPoly();const n=t.alpha>0;return n?(t.matrix&&(t.matrix=t.matrix.clone(),t.matrix.invert()),Object.assign(this._fillStyle,{visible:n},t)):this._fillStyle.reset(),this}endFill(){return this.finishPoly(),this._fillStyle.reset(),this}drawRect(t,e,n,r){return this.drawShape(new et(t,e,n,r))}drawRoundedRect(t,e,n,r,i){return this.drawShape(new sg(t,e,n,r,i))}drawCircle(t,e,n){return this.drawShape(new rg(t,e,n))}drawEllipse(t,e,n,r){return this.drawShape(new ig(t,e,n,r))}drawPolygon(...t){let e,n=!0;const r=t[0];r.points?(n=r.closeStroke,e=r.points):e=Array.isArray(t[0])?t[0]:t;const i=new Ji(e);return i.closeStroke=n,this.drawShape(i),this}drawShape(t){return this._holeMode?this._geometry.drawHole(t,this._matrix):this._geometry.drawShape(t,this._fillStyle.clone(),this._lineStyle.clone(),this._matrix),this}clear(){return this._geometry.clear(),this._lineStyle.reset(),this._fillStyle.reset(),this._boundsID++,this._matrix=null,this._holeMode=!1,this.currentPath=null,this}isFastRect(){const t=this._geometry.graphicsData;return!(1!==t.length||t[0].shape.type!==rn.RECT||t[0].matrix||t[0].holes.length||t[0].lineStyle.visible&&t[0].lineStyle.width)}_render(t){this.finishPoly();const e=this._geometry;e.updateBatches(),e.batchable?(this.batchDirty!==e.batchDirty&&this._populateBatches(),this._renderBatched(t)):(t.batch.flush(),this._renderDirect(t))}_populateBatches(){const t=this._geometry,e=this.blendMode,n=t.batches.length;this.batchTint=-1,this._transformID=-1,this.batchDirty=t.batchDirty,this.batches.length=n,this.vertexData=new Float32Array(t.points);for(let r=0;r<n;r++){const i=t.batches[r],s=i.style.color,o=new Float32Array(this.vertexData.buffer,4*i.attribStart*2,2*i.attribSize),a=new Float32Array(t.uvsFloat32.buffer,4*i.attribStart*2,2*i.attribSize),u={vertexData:o,blendMode:e,indices:new Uint16Array(t.indicesUint16.buffer,2*i.start,i.size),uvs:a,_batchRGB:ft.shared.setValue(s).toRgbArray(),_tintRGB:s,_texture:i.style.texture,alpha:i.style.alpha,worldAlpha:1};this.batches[r]=u}}_renderBatched(t){if(this.batches.length){t.batch.setObjectRenderer(t.plugins[this.pluginName]),this.calculateVertices(),this.calculateTints();for(let e=0,n=this.batches.length;e<n;e++){const r=this.batches[e];r.worldAlpha=this.worldAlpha*r.alpha,t.plugins[this.pluginName].render(r)}}}_renderDirect(t){const e=this._resolveDirectShader(t),n=this._geometry,r=this.worldAlpha,i=e.uniforms,s=n.drawCalls;i.translationMatrix=this.transform.worldTransform,ft.shared.setValue(this._tintColor).premultiply(r).toArray(i.tint),t.shader.bind(e),t.geometry.bind(n,e),t.state.set(this.state);for(let o=0,a=s.length;o<a;o++)this._renderDrawCallDirect(t,n.drawCalls[o])}_renderDrawCallDirect(t,e){const{texArray:n,type:r,size:i,start:s}=e,o=n.count;for(let a=0;a<o;a++)t.texture.bind(n.elements[a],a);t.geometry.draw(r,i,s)}_resolveDirectShader(t){let e=this.shader;const n=this.pluginName;if(!e){if(!Sg[n]){const{maxTextures:r}=t.plugins[n],i=new Int32Array(r);for(let a=0;a<r;a++)i[a]=a;const s={tint:new Float32Array([1,1,1,1]),translationMatrix:new Pt,default:hr.from({uSamplers:i},!0)};Sg[n]=new Gr(t.plugins[n]._shader.program,s)}e=Sg[n]}return e}_calculateBounds(){this.finishPoly();const t=this._geometry;if(!t.graphicsData.length)return;const{minX:e,minY:n,maxX:r,maxY:i}=t.bounds;this._bounds.addFrame(this.transform,e,n,r,i)}containsPoint(t){return this.worldTransform.applyInverse(t,Bc._TEMP_POINT),this._geometry.containsPoint(Bc._TEMP_POINT)}calculateTints(){if(this.batchTint!==this.tint){this.batchTint=this._tintColor.toNumber();for(let t=0;t<this.batches.length;t++){const e=this.batches[t];e._tintRGB=ft.shared.setValue(this._tintColor).multiply(e._batchRGB).toLittleEndianNumber()}}}calculateVertices(){const t=this.transform._worldID;if(this._transformID===t)return;this._transformID=t;const e=this.transform.worldTransform,n=e.a,r=e.b,i=e.c,s=e.d,o=e.tx,a=e.ty,l=this._geometry.points,u=this.vertexData;let c=0;for(let h=0;h<l.length;h+=2){const d=l[h],f=l[h+1];u[c++]=n*d+i*f+o,u[c++]=s*f+r*d+a}}closePath(){const t=this.currentPath;return t&&(t.closeStroke=!0,this.finishPoly()),this}setMatrix(t){return this._matrix=t,this}beginHole(){return this.finishPoly(),this._holeMode=!0,this}endHole(){return this.finishPoly(),this._holeMode=!1,this}destroy(t){this._geometry.refCount--,0===this._geometry.refCount&&this._geometry.dispose(),this._matrix=null,this.currentPath=null,this._lineStyle.destroy(),this._lineStyle=null,this._fillStyle.destroy(),this._fillStyle=null,this._geometry=null,this.shader=null,this.vertexData=null,this.batches.length=0,this.batches=null,super.destroy(t)}};let ui=Bc;ui.curves=Eo,ui._TEMP_POINT=new ut;class kB extends Ji{constructor(e,n,r,i,s,o=0){s=s||i/2;const a=-1*Math.PI/2+o,l=2*r,u=ja/l,c=[];for(let h=0;h<l;h++){const d=h%2?s:i,f=h*u+a;c.push(e+d*Math.cos(f),n+d*Math.sin(f))}super(c)}}Object.defineProperties(ui.prototype,{drawTorus:{value:function UB(t,e,n,r,i=0,s=2*Math.PI){return Math.abs(s-i)>=2*Math.PI?this.drawCircle(t,e,r).beginHole().drawCircle(t,e,n).endHole():(this.finishPoly(),this.arc(t,e,n,s,i,!0).arc(t,e,r,i,s,!1).finishPoly(),this)}},drawChamferRect:{value:function NB(t,e,n,r,i){if(i<=0)return this.drawRect(t,e,n,r);const s=Math.min(i,Math.min(n,r)/2),o=t+n,a=e+r,l=[t+s,e,o-s,e,o,e+s,o,a-s,o-s,a,t+s,a,t,a-s,t,e+s];for(let u=l.length-1;u>=2;u-=2)l[u]===l[u-2]&&l[u-1]===l[u-3]&&l.splice(u-1,2);return this.drawPolygon(l)}},drawFilletRect:{value:function OB(t,e,n,r,i){if(0===i)return this.drawRect(t,e,n,r);const s=Math.min(n,r)/2,o=Math.min(s,Math.max(-s,i)),a=t+n,l=e+r,u=o<0?-o:0,c=Math.abs(o);return this.moveTo(t,e+c).arcTo(t+u,e+u,t+c,e,c).lineTo(a-c,e).arcTo(a-u,e+u,a,e+c,c).lineTo(a,l-c).arcTo(a-u,l-u,t+n-c,l,c).lineTo(t+c,l).arcTo(t+u,l-u,t,l-c,c).closePath()}},drawRegularPolygon:{value:function FB(t,e,n,r,i=0){r=Math.max(0|r,3);const s=-1*Math.PI/2+i,o=2*Math.PI/r,a=[];for(let l=0;l<r;l++){const u=l*o+s;a.push(t+n*Math.cos(u),e+n*Math.sin(u))}return this.drawPolygon(a)}},drawRoundedPolygon:{value:function LB(t,e,n,r,i,s=0){if(r=Math.max(0|r,3),i<=0)return this.drawRegularPolygon(t,e,n,r,s);const o=n*Math.sin(Math.PI/r)-.001;i=Math.min(i,o);const a=-1*Math.PI/2+s,l=2*Math.PI/r,u=(r-2)*Math.PI/r/2;for(let c=0;c<r;c++){const h=c*l+a,d=t+n*Math.cos(h),f=e+n*Math.sin(h),p=h+Math.PI+u,g=h-Math.PI-u,m=d+i*Math.cos(p),_=f+i*Math.sin(p),v=d+i*Math.cos(g),D=f+i*Math.sin(g);0===c?this.moveTo(m,_):this.lineTo(m,_),this.quadraticCurveTo(d,f,v,D)}return this.closePath()}},drawStar:{value:function BB(t,e,n,r,i,s=0){return this.drawPolygon(new kB(t,e,n,r,i,s))}}});const Ka=new ut,HB=new Uint16Array([0,1,2,0,2,3]);class dn extends on{constructor(e){super(),this._anchor=new Ti(this._onAnchorUpdate,this,e?e.defaultAnchor.x:0,e?e.defaultAnchor.y:0),this._texture=null,this._width=0,this._height=0,this._tintColor=new ft(16777215),this._tintRGB=null,this.tint=16777215,this.blendMode=Oe.NORMAL,this._cachedTint=16777215,this.uvs=null,this.texture=e||_e.EMPTY,this.vertexData=new Float32Array(8),this.vertexTrimmedData=null,this._transformID=-1,this._textureID=-1,this._transformTrimmedID=-1,this._textureTrimmedID=-1,this.indices=HB,this.pluginName="batch",this.isSprite=!0,this._roundPixels=ce.ROUND_PIXELS}_onTextureUpdate(){this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this._width&&(this.scale.x=bi(this.scale.x)*this._width/this._texture.orig.width),this._height&&(this.scale.y=bi(this.scale.y)*this._height/this._texture.orig.height)}_onAnchorUpdate(){this._transformID=-1,this._transformTrimmedID=-1}calculateVertices(){const e=this._texture;if(this._transformID===this.transform._worldID&&this._textureID===e._updateID)return;this._textureID!==e._updateID&&(this.uvs=this._texture._uvs.uvsFloat32),this._transformID=this.transform._worldID,this._textureID=e._updateID;const n=this.transform.worldTransform,r=n.a,i=n.b,s=n.c,o=n.d,a=n.tx,l=n.ty,u=this.vertexData,c=e.trim,h=e.orig,d=this._anchor;let f=0,p=0,g=0,m=0;if(c?(p=c.x-d._x*h.width,f=p+c.width,m=c.y-d._y*h.height,g=m+c.height):(p=-d._x*h.width,f=p+h.width,m=-d._y*h.height,g=m+h.height),u[0]=r*p+s*m+a,u[1]=o*m+i*p+l,u[2]=r*f+s*m+a,u[3]=o*m+i*f+l,u[4]=r*f+s*g+a,u[5]=o*g+i*f+l,u[6]=r*p+s*g+a,u[7]=o*g+i*p+l,this._roundPixels){const _=ce.RESOLUTION;for(let v=0;v<u.length;++v)u[v]=Math.round(u[v]*_)/_}}calculateTrimmedVertices(){if(this.vertexTrimmedData){if(this._transformTrimmedID===this.transform._worldID&&this._textureTrimmedID===this._texture._updateID)return}else this.vertexTrimmedData=new Float32Array(8);this._transformTrimmedID=this.transform._worldID,this._textureTrimmedID=this._texture._updateID;const n=this.vertexTrimmedData,r=this._texture.orig,i=this._anchor,s=this.transform.worldTransform,o=s.a,a=s.b,l=s.c,u=s.d,c=s.tx,h=s.ty,d=-i._x*r.width,f=d+r.width,p=-i._y*r.height,g=p+r.height;n[0]=o*d+l*p+c,n[1]=u*p+a*d+h,n[2]=o*f+l*p+c,n[3]=u*p+a*f+h,n[4]=o*f+l*g+c,n[5]=u*g+a*f+h,n[6]=o*d+l*g+c,n[7]=u*g+a*d+h}_render(e){this.calculateVertices(),e.batch.setObjectRenderer(e.plugins[this.pluginName]),e.plugins[this.pluginName].render(this)}_calculateBounds(){const e=this._texture.trim,n=this._texture.orig;!e||e.width===n.width&&e.height===n.height?(this.calculateVertices(),this._bounds.addQuad(this.vertexData)):(this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData))}getLocalBounds(e){return 0===this.children.length?(this._localBounds||(this._localBounds=new Fc),this._localBounds.minX=this._texture.orig.width*-this._anchor._x,this._localBounds.minY=this._texture.orig.height*-this._anchor._y,this._localBounds.maxX=this._texture.orig.width*(1-this._anchor._x),this._localBounds.maxY=this._texture.orig.height*(1-this._anchor._y),e||(this._localBoundsRect||(this._localBoundsRect=new et),e=this._localBoundsRect),this._localBounds.getRectangle(e)):super.getLocalBounds.call(this,e)}containsPoint(e){this.worldTransform.applyInverse(e,Ka);const n=this._texture.orig.width,r=this._texture.orig.height,i=-n*this.anchor.x;let s=0;return Ka.x>=i&&Ka.x<i+n&&(s=-r*this.anchor.y,Ka.y>=s&&Ka.y<s+r)}destroy(e){super.destroy(e),this._texture.off("update",this._onTextureUpdate,this),this._anchor=null,("boolean"==typeof e?e:e?.texture)&&this._texture.destroy(!!("boolean"==typeof e?e:e?.baseTexture)),this._texture=null}static from(e,n){const r=e instanceof _e?e:_e.from(e,n);return new dn(r)}set roundPixels(e){this._roundPixels!==e&&(this._transformID=-1),this._roundPixels=e}get roundPixels(){return this._roundPixels}get width(){return Math.abs(this.scale.x)*this._texture.orig.width}set width(e){const n=bi(this.scale.x)||1;this.scale.x=n*e/this._texture.orig.width,this._width=e}get height(){return Math.abs(this.scale.y)*this._texture.orig.height}set height(e){const n=bi(this.scale.y)||1;this.scale.y=n*e/this._texture.orig.height,this._height=e}get anchor(){return this._anchor}set anchor(e){this._anchor.copyFrom(e)}get tint(){return this._tintColor.value}set tint(e){this._tintColor.setValue(e),this._tintRGB=this._tintColor.toLittleEndianNumber()}get tintValue(){return this._tintColor.toNumber()}get texture(){return this._texture}set texture(e){this._texture!==e&&(this._texture&&this._texture.off("update",this._onTextureUpdate,this),this._texture=e||_e.EMPTY,this._cachedTint=16777215,this._textureID=-1,this._textureTrimmedID=-1,e&&(e.baseTexture.valid?this._onTextureUpdate():e.once("update",this._onTextureUpdate,this)))}}const rD=new Pt;kt.prototype._cacheAsBitmap=!1,kt.prototype._cacheData=null,kt.prototype._cacheAsBitmapResolution=null,kt.prototype._cacheAsBitmapMultisample=null;class VB{constructor(){this.textureCacheId=null,this.originalRender=null,this.originalRenderCanvas=null,this.originalCalculateBounds=null,this.originalGetLocalBounds=null,this.originalUpdateTransform=null,this.originalDestroy=null,this.originalMask=null,this.originalFilterArea=null,this.originalContainsPoint=null,this.sprite=null}}Object.defineProperties(kt.prototype,{cacheAsBitmapResolution:{get(){return this._cacheAsBitmapResolution},set(t){t!==this._cacheAsBitmapResolution&&(this._cacheAsBitmapResolution=t,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmapMultisample:{get(){return this._cacheAsBitmapMultisample},set(t){t!==this._cacheAsBitmapMultisample&&(this._cacheAsBitmapMultisample=t,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmap:{get(){return this._cacheAsBitmap},set(t){if(this._cacheAsBitmap===t)return;let e;this._cacheAsBitmap=t,t?(this._cacheData||(this._cacheData=new VB),e=this._cacheData,e.originalRender=this.render,e.originalRenderCanvas=this.renderCanvas,e.originalUpdateTransform=this.updateTransform,e.originalCalculateBounds=this.calculateBounds,e.originalGetLocalBounds=this.getLocalBounds,e.originalDestroy=this.destroy,e.originalContainsPoint=this.containsPoint,e.originalMask=this._mask,e.originalFilterArea=this.filterArea,this.render=this._renderCached,this.renderCanvas=this._renderCachedCanvas,this.destroy=this._cacheAsBitmapDestroy):(e=this._cacheData,e.sprite&&this._destroyCachedDisplayObject(),this.render=e.originalRender,this.renderCanvas=e.originalRenderCanvas,this.calculateBounds=e.originalCalculateBounds,this.getLocalBounds=e.originalGetLocalBounds,this.destroy=e.originalDestroy,this.updateTransform=e.originalUpdateTransform,this.containsPoint=e.originalContainsPoint,this._mask=e.originalMask,this.filterArea=e.originalFilterArea)}}}),kt.prototype._renderCached=function(e){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObject(e),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._render(e))},kt.prototype._initCachedDisplayObject=function(e){if(this._cacheData?.sprite)return;const n=this.alpha;this.alpha=1,e.batch.flush();const r=this.getLocalBounds(null,!0).clone();this.filters?.length&&r.pad(this.filters[0].padding),r.ceil(ce.RESOLUTION);const i=e.renderTexture.current,s=e.renderTexture.sourceFrame.clone(),o=e.renderTexture.destinationFrame.clone(),a=e.projection.transform,l=is.create({width:r.width,height:r.height,resolution:this.cacheAsBitmapResolution||e.resolution,multisample:this.cacheAsBitmapMultisample??e.multisample}),u=`cacheAsBitmap_${Qi()}`;this._cacheData.textureCacheId=u,$e.addToCache(l.baseTexture,u),_e.addToCache(l,u);const c=this.transform.localTransform.copyTo(rD).invert().translate(-r.x,-r.y);this.render=this._cacheData.originalRender,e.render(this,{renderTexture:l,clear:!0,transform:c,skipUpdateTransform:!1}),e.framebuffer.blit(),e.projection.transform=a,e.renderTexture.bind(i,s,o),this.render=this._renderCached,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=n;const h=new dn(l);h.transform.worldTransform=this.transform.worldTransform,h.anchor.x=-r.x/r.width,h.anchor.y=-r.y/r.height,h.alpha=n,h._bounds=this._bounds,this._cacheData.sprite=h,this.transform._parentID=-1,this.parent?this.updateTransform():(this.enableTempParent(),this.updateTransform(),this.disableTempParent(null)),this.containsPoint=h.containsPoint.bind(h)},kt.prototype._renderCachedCanvas=function(e){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObjectCanvas(e),this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._renderCanvas(e))},kt.prototype._initCachedDisplayObjectCanvas=function(e){if(this._cacheData?.sprite)return;const n=this.getLocalBounds(null,!0),r=this.alpha;this.alpha=1;const i=e.canvasContext.activeContext,s=e._projTransform;n.ceil(ce.RESOLUTION);const o=is.create({width:n.width,height:n.height}),a=`cacheAsBitmap_${Qi()}`;this._cacheData.textureCacheId=a,$e.addToCache(o.baseTexture,a),_e.addToCache(o,a);const l=rD;this.transform.localTransform.copyTo(l),l.invert(),l.tx-=n.x,l.ty-=n.y,this.renderCanvas=this._cacheData.originalRenderCanvas,e.render(this,{renderTexture:o,clear:!0,transform:l,skipUpdateTransform:!1}),e.canvasContext.activeContext=i,e._projTransform=s,this.renderCanvas=this._renderCachedCanvas,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=r;const u=new dn(o);u.transform.worldTransform=this.transform.worldTransform,u.anchor.x=-n.x/n.width,u.anchor.y=-n.y/n.height,u.alpha=r,u._bounds=this._bounds,this._cacheData.sprite=u,this.transform._parentID=-1,this.parent?this.updateTransform():(this.parent=e._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.containsPoint=u.containsPoint.bind(u)},kt.prototype._calculateCachedBounds=function(){this._bounds.clear(),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite._calculateBounds(),this._bounds.updateID=this._boundsID},kt.prototype._getCachedLocalBounds=function(){return this._cacheData.sprite.getLocalBounds(null)},kt.prototype._destroyCachedDisplayObject=function(){this._cacheData.sprite._texture.destroy(!0),this._cacheData.sprite=null,$e.removeFromCache(this._cacheData.textureCacheId),_e.removeFromCache(this._cacheData.textureCacheId),this._cacheData.textureCacheId=null},kt.prototype._cacheAsBitmapDestroy=function(e){this.cacheAsBitmap=!1,this.destroy(e)},kt.prototype.name=null,on.prototype.getChildByName=function(e,n){for(let r=0,i=this.children.length;r<i;r++)if(this.children[r].name===e)return this.children[r];if(n)for(let r=0,i=this.children.length;r<i;r++){const s=this.children[r];if(!s.getChildByName)continue;const o=s.getChildByName(e,!0);if(o)return o}return null},kt.prototype.getGlobalPosition=function(e=new ut,n=!1){return this.parent?this.parent.toGlobal(this.position,e,n):(e.x=this.position.x,e.y=this.position.y),e};const $B={5:[.153388,.221461,.250301],7:[.071303,.131514,.189879,.214607],9:[.028532,.067234,.124009,.179044,.20236],11:[.0093,.028002,.065984,.121703,.175713,.198596],13:[.002406,.009255,.027867,.065666,.121117,.174868,.197641],15:[489e-6,.002403,.009246,.02784,.065602,.120999,.174697,.197448]},zB=["varying vec2 vBlurTexCoords[%size%];","uniform sampler2D uSampler;","void main(void)","{","    gl_FragColor = vec4(0.0);","    %blur%","}"].join("\n");class Tg extends sn{constructor(e,n=8,r=4,i=sn.defaultResolution,s=5){const o=function YB(t,e){const n=Math.ceil(t/2);let s,r="\n    attribute vec2 aVertexPosition;\n\n    uniform mat3 projectionMatrix;\n\n    uniform float strength;\n\n    varying vec2 vBlurTexCoords[%size%];\n\n    uniform vec4 inputSize;\n    uniform vec4 outputFrame;\n\n    vec4 filterVertexPosition( void )\n    {\n        vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n        return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n    }\n\n    vec2 filterTextureCoord( void )\n    {\n        return aVertexPosition * (outputFrame.zw * inputSize.zw);\n    }\n\n    void main(void)\n    {\n        gl_Position = filterVertexPosition();\n\n        vec2 textureCoord = filterTextureCoord();\n        %blur%\n    }",i="";s=e?"vBlurTexCoords[%index%] =  textureCoord + vec2(%sampleIndex% * strength, 0.0);":"vBlurTexCoords[%index%] =  textureCoord + vec2(0.0, %sampleIndex% * strength);";for(let o=0;o<t;o++){let a=s.replace("%index%",o.toString());a=a.replace("%sampleIndex%",o-(n-1)+".0"),i+=a,i+="\n"}return r=r.replace("%blur%",i),r=r.replace("%size%",t.toString()),r}(s,e),a=function WB(t){const e=$B[t],n=e.length;let o,r=zB,i="";for(let a=0;a<t;a++){let l="gl_FragColor += texture2D(uSampler, vBlurTexCoords[%index%]) * %value%;".replace("%index%",a.toString());o=a,a>=n&&(o=t-a-1),l=l.replace("%value%",e[o].toString()),i+=l,i+="\n"}return r=r.replace("%blur%",i),r=r.replace("%size%",t.toString()),r}(s);super(o,a),this.horizontal=e,this.resolution=i,this._quality=0,this.quality=r,this.blur=n}apply(e,n,r,i){if(this.uniforms.strength=r?this.horizontal?1/r.width*(r.width/n.width):1/r.height*(r.height/n.height):this.horizontal?1/e.renderer.width*(e.renderer.width/n.width):1/e.renderer.height*(e.renderer.height/n.height),this.uniforms.strength*=this.strength,this.uniforms.strength/=this.passes,1===this.passes)e.applyFilter(this,n,r,i);else{const s=e.getFilterTexture(),o=e.renderer;let a=n,l=s;this.state.blend=!1,e.applyFilter(this,a,l,Ur.CLEAR);for(let u=1;u<this.passes-1;u++){e.bindAndClear(a,Ur.BLIT),this.uniforms.uSampler=l;const c=l;l=a,a=c,o.shader.bind(this),o.geometry.draw(5)}this.state.blend=!0,e.applyFilter(this,l,r,i),e.returnFilterTexture(s)}}get blur(){return this.strength}set blur(e){this.padding=1+2*Math.abs(e),this.strength=e}get quality(){return this._quality}set quality(e){this._quality=e,this.passes=e}}class Cg extends sn{constructor(){const e={m:new Float32Array([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0]),uAlpha:1};super(jb,"varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform float m[20];\nuniform float uAlpha;\n\nvoid main(void)\n{\n    vec4 c = texture2D(uSampler, vTextureCoord);\n\n    if (uAlpha == 0.0) {\n        gl_FragColor = c;\n        return;\n    }\n\n    // Un-premultiply alpha before applying the color matrix. See issue #3539.\n    if (c.a > 0.0) {\n      c.rgb /= c.a;\n    }\n\n    vec4 result;\n\n    result.r = (m[0] * c.r);\n        result.r += (m[1] * c.g);\n        result.r += (m[2] * c.b);\n        result.r += (m[3] * c.a);\n        result.r += m[4];\n\n    result.g = (m[5] * c.r);\n        result.g += (m[6] * c.g);\n        result.g += (m[7] * c.b);\n        result.g += (m[8] * c.a);\n        result.g += m[9];\n\n    result.b = (m[10] * c.r);\n       result.b += (m[11] * c.g);\n       result.b += (m[12] * c.b);\n       result.b += (m[13] * c.a);\n       result.b += m[14];\n\n    result.a = (m[15] * c.r);\n       result.a += (m[16] * c.g);\n       result.a += (m[17] * c.b);\n       result.a += (m[18] * c.a);\n       result.a += m[19];\n\n    vec3 rgb = mix(c.rgb, result.rgb, uAlpha);\n\n    // Premultiply alpha again.\n    rgb *= result.a;\n\n    gl_FragColor = vec4(rgb, result.a);\n}\n",e),this.alpha=1}_loadMatrix(e,n=!1){let r=e;n&&(this._multiply(r,this.uniforms.m,e),r=this._colorMatrix(r)),this.uniforms.m=r}_multiply(e,n,r){return e[0]=n[0]*r[0]+n[1]*r[5]+n[2]*r[10]+n[3]*r[15],e[1]=n[0]*r[1]+n[1]*r[6]+n[2]*r[11]+n[3]*r[16],e[2]=n[0]*r[2]+n[1]*r[7]+n[2]*r[12]+n[3]*r[17],e[3]=n[0]*r[3]+n[1]*r[8]+n[2]*r[13]+n[3]*r[18],e[4]=n[0]*r[4]+n[1]*r[9]+n[2]*r[14]+n[3]*r[19]+n[4],e[5]=n[5]*r[0]+n[6]*r[5]+n[7]*r[10]+n[8]*r[15],e[6]=n[5]*r[1]+n[6]*r[6]+n[7]*r[11]+n[8]*r[16],e[7]=n[5]*r[2]+n[6]*r[7]+n[7]*r[12]+n[8]*r[17],e[8]=n[5]*r[3]+n[6]*r[8]+n[7]*r[13]+n[8]*r[18],e[9]=n[5]*r[4]+n[6]*r[9]+n[7]*r[14]+n[8]*r[19]+n[9],e[10]=n[10]*r[0]+n[11]*r[5]+n[12]*r[10]+n[13]*r[15],e[11]=n[10]*r[1]+n[11]*r[6]+n[12]*r[11]+n[13]*r[16],e[12]=n[10]*r[2]+n[11]*r[7]+n[12]*r[12]+n[13]*r[17],e[13]=n[10]*r[3]+n[11]*r[8]+n[12]*r[13]+n[13]*r[18],e[14]=n[10]*r[4]+n[11]*r[9]+n[12]*r[14]+n[13]*r[19]+n[14],e[15]=n[15]*r[0]+n[16]*r[5]+n[17]*r[10]+n[18]*r[15],e[16]=n[15]*r[1]+n[16]*r[6]+n[17]*r[11]+n[18]*r[16],e[17]=n[15]*r[2]+n[16]*r[7]+n[17]*r[12]+n[18]*r[17],e[18]=n[15]*r[3]+n[16]*r[8]+n[17]*r[13]+n[18]*r[18],e[19]=n[15]*r[4]+n[16]*r[9]+n[17]*r[14]+n[18]*r[19]+n[19],e}_colorMatrix(e){const n=new Float32Array(e);return n[4]/=255,n[9]/=255,n[14]/=255,n[19]/=255,n}brightness(e,n){this._loadMatrix([e,0,0,0,0,0,e,0,0,0,0,0,e,0,0,0,0,0,1,0],n)}tint(e,n){const[r,i,s]=ft.shared.setValue(e).toArray();this._loadMatrix([r,0,0,0,0,0,i,0,0,0,0,0,s,0,0,0,0,0,1,0],n)}greyscale(e,n){this._loadMatrix([e,e,e,0,0,e,e,e,0,0,e,e,e,0,0,0,0,0,1,0],n)}blackAndWhite(e){this._loadMatrix([.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0],e)}hue(e,n){e=(e||0)/180*Math.PI;const r=Math.cos(e),i=Math.sin(e),o=1/3,a=(0,Math.sqrt)(o);this._loadMatrix([r+(1-r)*o,o*(1-r)-a*i,o*(1-r)+a*i,0,0,o*(1-r)+a*i,r+o*(1-r),o*(1-r)-a*i,0,0,o*(1-r)-a*i,o*(1-r)+a*i,r+o*(1-r),0,0,0,0,0,1,0],n)}contrast(e,n){const r=(e||0)+1,i=-.5*(r-1);this._loadMatrix([r,0,0,0,i,0,r,0,0,i,0,0,r,0,i,0,0,0,1,0],n)}saturate(e=0,n){const r=2*e/3+1,i=-.5*(r-1);this._loadMatrix([r,i,i,0,0,i,r,i,0,0,i,i,r,0,0,0,0,0,1,0],n)}desaturate(){this.saturate(-1)}negative(e){this._loadMatrix([-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,0],e)}sepia(e){this._loadMatrix([.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0],e)}technicolor(e){this._loadMatrix([1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0],e)}polaroid(e){this._loadMatrix([1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0],e)}toBGR(e){this._loadMatrix([0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0],e)}kodachrome(e){this._loadMatrix([1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0],e)}browni(e){this._loadMatrix([.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0],e)}vintage(e){this._loadMatrix([.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0],e)}colorTone(e,n,r,i,s){e=e||.2,n=n||.15,r=r||16770432,i=i||3375104;const o=ft.shared,[a,l,u]=o.setValue(r).toArray(),[c,h,d]=o.setValue(i).toArray();this._loadMatrix([.3,.59,.11,0,0,a,l,u,e,0,c,h,d,n,0,a-c,l-h,u-d,0,0],s)}night(e,n){this._loadMatrix([-2*(e=e||.1),-e,0,0,0,-e,0,e,0,0,0,e,2*e,0,0,0,0,0,1,0],n)}predator(e,n){this._loadMatrix([11.224130630493164*e,-4.794486999511719*e,-2.8746118545532227*e,0*e,.40342438220977783*e,-3.6330697536468506*e,9.193157196044922*e,-2.951810836791992*e,0*e,-1.316135048866272*e,-3.2184197902679443*e,-4.2375030517578125*e,7.476448059082031*e,0*e,.8044459223747253*e,0,0,0,1,0],n)}lsd(e){this._loadMatrix([2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0],e)}reset(){this._loadMatrix([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],!1)}get matrix(){return this.uniforms.m}set matrix(e){this.uniforms.m=e}get alpha(){return this.uniforms.uAlpha}set alpha(e){this.uniforms.uAlpha=e}}Cg.prototype.grayscale=Cg.prototype.greyscale;const iD={AlphaFilter:class jB extends sn{constructor(e=1){super("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform float uAlpha;\n\nvoid main(void)\n{\n   gl_FragColor = texture2D(uSampler, vTextureCoord) * uAlpha;\n}\n",{uAlpha:1}),this.alpha=e}get alpha(){return this.uniforms.uAlpha}set alpha(e){this.uniforms.uAlpha=e}},BlurFilter:class qB extends sn{constructor(e=8,n=4,r=sn.defaultResolution,i=5){super(),this._repeatEdgePixels=!1,this.blurXFilter=new Tg(!0,e,n,r,i),this.blurYFilter=new Tg(!1,e,n,r,i),this.resolution=r,this.quality=n,this.blur=e,this.repeatEdgePixels=!1}apply(e,n,r,i){const s=Math.abs(this.blurXFilter.strength),o=Math.abs(this.blurYFilter.strength);if(s&&o){const a=e.getFilterTexture();this.blurXFilter.apply(e,n,a,Ur.CLEAR),this.blurYFilter.apply(e,a,r,i),e.returnFilterTexture(a)}else o?this.blurYFilter.apply(e,n,r,i):this.blurXFilter.apply(e,n,r,i)}updatePadding(){this.padding=this._repeatEdgePixels?0:2*Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))}get blur(){return this.blurXFilter.blur}set blur(e){this.blurXFilter.blur=this.blurYFilter.blur=e,this.updatePadding()}get quality(){return this.blurXFilter.quality}set quality(e){this.blurXFilter.quality=this.blurYFilter.quality=e}get blurX(){return this.blurXFilter.blur}set blurX(e){this.blurXFilter.blur=e,this.updatePadding()}get blurY(){return this.blurYFilter.blur}set blurY(e){this.blurYFilter.blur=e,this.updatePadding()}get blendMode(){return this.blurYFilter.blendMode}set blendMode(e){this.blurYFilter.blendMode=e}get repeatEdgePixels(){return this._repeatEdgePixels}set repeatEdgePixels(e){this._repeatEdgePixels=e,this.updatePadding()}},BlurFilterPass:Tg,ColorMatrixFilter:Cg,DisplacementFilter:class JB extends sn{constructor(e,n){const r=new Pt;e.renderable=!1,super("attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\nuniform mat3 filterMatrix;\n\nvarying vec2 vTextureCoord;\nvarying vec2 vFilterCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n\tgl_Position = filterVertexPosition();\n\tvTextureCoord = filterTextureCoord();\n\tvFilterCoord = ( filterMatrix * vec3( vTextureCoord, 1.0)  ).xy;\n}\n","varying vec2 vFilterCoord;\nvarying vec2 vTextureCoord;\n\nuniform vec2 scale;\nuniform mat2 rotation;\nuniform sampler2D uSampler;\nuniform sampler2D mapSampler;\n\nuniform highp vec4 inputSize;\nuniform vec4 inputClamp;\n\nvoid main(void)\n{\n  vec4 map =  texture2D(mapSampler, vFilterCoord);\n\n  map -= 0.5;\n  map.xy = scale * inputSize.zw * (rotation * map.xy);\n\n  gl_FragColor = texture2D(uSampler, clamp(vec2(vTextureCoord.x + map.x, vTextureCoord.y + map.y), inputClamp.xy, inputClamp.zw));\n}\n",{mapSampler:e._texture,filterMatrix:r,scale:{x:1,y:1},rotation:new Float32Array([1,0,0,1])}),this.maskSprite=e,this.maskMatrix=r,null==n&&(n=20),this.scale=new ut(n,n)}apply(e,n,r,i){this.uniforms.filterMatrix=e.calculateSpriteMatrix(this.maskMatrix,this.maskSprite),this.uniforms.scale.x=this.scale.x,this.uniforms.scale.y=this.scale.y;const s=this.maskSprite.worldTransform,o=Math.sqrt(s.a*s.a+s.b*s.b),a=Math.sqrt(s.c*s.c+s.d*s.d);0!==o&&0!==a&&(this.uniforms.rotation[0]=s.a/o,this.uniforms.rotation[1]=s.b/o,this.uniforms.rotation[2]=s.c/a,this.uniforms.rotation[3]=s.d/a),e.applyFilter(this,n,r,i)}get map(){return this.uniforms.mapSampler}set map(e){this.uniforms.mapSampler=e}},FXAAFilter:class n2 extends sn{constructor(){super("\nattribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 v_rgbNW;\nvarying vec2 v_rgbNE;\nvarying vec2 v_rgbSW;\nvarying vec2 v_rgbSE;\nvarying vec2 v_rgbM;\n\nvarying vec2 vFragCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvoid texcoords(vec2 fragCoord, vec2 inverseVP,\n               out vec2 v_rgbNW, out vec2 v_rgbNE,\n               out vec2 v_rgbSW, out vec2 v_rgbSE,\n               out vec2 v_rgbM) {\n    v_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;\n    v_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;\n    v_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;\n    v_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;\n    v_rgbM = vec2(fragCoord * inverseVP);\n}\n\nvoid main(void) {\n\n   gl_Position = filterVertexPosition();\n\n   vFragCoord = aVertexPosition * outputFrame.zw;\n\n   texcoords(vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n}\n",'varying vec2 v_rgbNW;\nvarying vec2 v_rgbNE;\nvarying vec2 v_rgbSW;\nvarying vec2 v_rgbSE;\nvarying vec2 v_rgbM;\n\nvarying vec2 vFragCoord;\nuniform sampler2D uSampler;\nuniform highp vec4 inputSize;\n\n\n/**\n Basic FXAA implementation based on the code on geeks3d.com with the\n modification that the texture2DLod stuff was removed since it\'s\n unsupported by WebGL.\n\n --\n\n From:\n https://github.com/mitsuhiko/webgl-meincraft\n\n Copyright (c) 2011 by Armin Ronacher.\n\n Some rights reserved.\n\n Redistribution and use in source and binary forms, with or without\n modification, are permitted provided that the following conditions are\n met:\n\n * Redistributions of source code must retain the above copyright\n notice, this list of conditions and the following disclaimer.\n\n * Redistributions in binary form must reproduce the above\n copyright notice, this list of conditions and the following\n disclaimer in the documentation and/or other materials provided\n with the distribution.\n\n * The names of the contributors may not be used to endorse or\n promote products derived from this software without specific\n prior written permission.\n\n THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\n "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\n LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\n A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\n OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\n THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\n#ifndef FXAA_REDUCE_MIN\n#define FXAA_REDUCE_MIN   (1.0/ 128.0)\n#endif\n#ifndef FXAA_REDUCE_MUL\n#define FXAA_REDUCE_MUL   (1.0 / 8.0)\n#endif\n#ifndef FXAA_SPAN_MAX\n#define FXAA_SPAN_MAX     8.0\n#endif\n\n//optimized version for mobile, where dependent\n//texture reads can be a bottleneck\nvec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 inverseVP,\n          vec2 v_rgbNW, vec2 v_rgbNE,\n          vec2 v_rgbSW, vec2 v_rgbSE,\n          vec2 v_rgbM) {\n    vec4 color;\n    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;\n    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;\n    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;\n    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;\n    vec4 texColor = texture2D(tex, v_rgbM);\n    vec3 rgbM  = texColor.xyz;\n    vec3 luma = vec3(0.299, 0.587, 0.114);\n    float lumaNW = dot(rgbNW, luma);\n    float lumaNE = dot(rgbNE, luma);\n    float lumaSW = dot(rgbSW, luma);\n    float lumaSE = dot(rgbSE, luma);\n    float lumaM  = dot(rgbM,  luma);\n    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));\n    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));\n\n    mediump vec2 dir;\n    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));\n    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));\n\n    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *\n                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);\n\n    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);\n    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),\n              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),\n                  dir * rcpDirMin)) * inverseVP;\n\n    vec3 rgbA = 0.5 * (\n                       texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +\n                       texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);\n    vec3 rgbB = rgbA * 0.5 + 0.25 * (\n                                     texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +\n                                     texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);\n\n    float lumaB = dot(rgbB, luma);\n    if ((lumaB < lumaMin) || (lumaB > lumaMax))\n        color = vec4(rgbA, texColor.a);\n    else\n        color = vec4(rgbB, texColor.a);\n    return color;\n}\n\nvoid main() {\n\n      vec4 color;\n\n      color = fxaa(uSampler, vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n\n      gl_FragColor = color;\n}\n')}},NoiseFilter:class i2 extends sn{constructor(e=.5,n=Math.random()){super(jb,"precision highp float;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform float uNoise;\nuniform float uSeed;\nuniform sampler2D uSampler;\n\nfloat rand(vec2 co)\n{\n    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);\n}\n\nvoid main()\n{\n    vec4 color = texture2D(uSampler, vTextureCoord);\n    float randomValue = rand(gl_FragCoord.xy * uSeed);\n    float diff = (randomValue - 0.5) * uNoise;\n\n    // Un-premultiply alpha before applying the color matrix. See issue #3539.\n    if (color.a > 0.0) {\n        color.rgb /= color.a;\n    }\n\n    color.r += diff;\n    color.g += diff;\n    color.b += diff;\n\n    // Premultiply alpha again.\n    color.rgb *= color.a;\n\n    gl_FragColor = color;\n}\n",{uNoise:0,uSeed:0}),this.noise=e,this.seed=n}get noise(){return this.uniforms.uNoise}set noise(e){this.uniforms.uNoise=e}get seed(){return this.uniforms.uSeed}set seed(e){this.uniforms.uSeed=e}}};Object.entries(iD).forEach(([t,e])=>{Object.defineProperty(iD,t,{get:()=>(Ye("7.1.0",`filters.${t} has moved to ${t}`),e)})});const Ai=new class s2{constructor(){this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this.tickerAdded=!1,this._pauseUpdate=!0}init(e){this.removeTickerListener(),this.events=e,this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this.tickerAdded=!1,this._pauseUpdate=!0}get pauseUpdate(){return this._pauseUpdate}set pauseUpdate(e){this._pauseUpdate=e}addTickerListener(){this.tickerAdded||!this.domElement||(Xt.system.add(this.tickerUpdate,this,Ii.INTERACTION),this.tickerAdded=!0)}removeTickerListener(){this.tickerAdded&&(Xt.system.remove(this.tickerUpdate,this),this.tickerAdded=!1)}pointerMoved(){this._didMove=!0}update(){if(!this.domElement||this._pauseUpdate)return;if(this._didMove)return void(this._didMove=!1);const e=this.events.rootPointerEvent;this.events.supportsTouchEvents&&"touch"===e.pointerType||globalThis.document.dispatchEvent(new PointerEvent("pointermove",{clientX:e.clientX,clientY:e.clientY}))}tickerUpdate(e){this._deltaTime+=e,!(this._deltaTime<this.interactionFrequency)&&(this._deltaTime=0,this.update())}};class Qa{constructor(e){this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.composed=!1,this.defaultPrevented=!1,this.eventPhase=Qa.prototype.NONE,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer=new ut,this.page=new ut,this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.manager=e}get layerX(){return this.layer.x}get layerY(){return this.layer.y}get pageX(){return this.page.x}get pageY(){return this.page.y}get data(){return this}composedPath(){return this.manager&&(!this.path||this.path[this.path.length-1]!==this.target)&&(this.path=this.target?this.manager.propagationPath(this.target):[]),this.path}initEvent(e,n,r){throw new Error("initEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}initUIEvent(e,n,r,i,s){throw new Error("initUIEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}preventDefault(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0}stopImmediatePropagation(){this.propagationImmediatelyStopped=!0}stopPropagation(){this.propagationStopped=!0}}class Uc extends Qa{constructor(){super(...arguments),this.client=new ut,this.movement=new ut,this.offset=new ut,this.global=new ut,this.screen=new ut}get clientX(){return this.client.x}get clientY(){return this.client.y}get x(){return this.clientX}get y(){return this.clientY}get movementX(){return this.movement.x}get movementY(){return this.movement.y}get offsetX(){return this.offset.x}get offsetY(){return this.offset.y}get globalX(){return this.global.x}get globalY(){return this.global.y}get screenX(){return this.screen.x}get screenY(){return this.screen.y}getLocalPosition(e,n,r){return e.worldTransform.applyInverse(r||this.global,n)}getModifierState(e){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(e)}initMouseEvent(e,n,r,i,s,o,a,l,u,c,h,d,f,p,g){throw new Error("Method not implemented.")}}class mr extends Uc{constructor(){super(...arguments),this.width=0,this.height=0,this.isPrimary=!1}getCoalescedEvents(){return"pointermove"===this.type||"mousemove"===this.type||"touchmove"===this.type?[this]:[]}getPredictedEvents(){throw new Error("getPredictedEvents is not supported!")}}let Ig=(()=>{class t extends Uc{constructor(){super(...arguments),this.DOM_DELTA_PIXEL=0,this.DOM_DELTA_LINE=1,this.DOM_DELTA_PAGE=2}}return t.DOM_DELTA_PIXEL=0,t.DOM_DELTA_LINE=1,t.DOM_DELTA_PAGE=2,t})();const a2=new ut,Ag=new ut;class l2{constructor(e){this.dispatch=new Ba,this.moveOnAll=!1,this.enableGlobalMoveEvents=!0,this.mappingState={trackingData:{}},this.eventPool=new Map,this._allInteractiveElements=[],this._hitElements=[],this._isPointerMoveEvent=!1,this.rootTarget=e,this.hitPruneFn=this.hitPruneFn.bind(this),this.hitTestFn=this.hitTestFn.bind(this),this.mapPointerDown=this.mapPointerDown.bind(this),this.mapPointerMove=this.mapPointerMove.bind(this),this.mapPointerOut=this.mapPointerOut.bind(this),this.mapPointerOver=this.mapPointerOver.bind(this),this.mapPointerUp=this.mapPointerUp.bind(this),this.mapPointerUpOutside=this.mapPointerUpOutside.bind(this),this.mapWheel=this.mapWheel.bind(this),this.mappingTable={},this.addEventMapping("pointerdown",this.mapPointerDown),this.addEventMapping("pointermove",this.mapPointerMove),this.addEventMapping("pointerout",this.mapPointerOut),this.addEventMapping("pointerleave",this.mapPointerOut),this.addEventMapping("pointerover",this.mapPointerOver),this.addEventMapping("pointerup",this.mapPointerUp),this.addEventMapping("pointerupoutside",this.mapPointerUpOutside),this.addEventMapping("wheel",this.mapWheel)}addEventMapping(e,n){this.mappingTable[e]||(this.mappingTable[e]=[]),this.mappingTable[e].push({fn:n,priority:0}),this.mappingTable[e].sort((r,i)=>r.priority-i.priority)}dispatchEvent(e,n){e.propagationStopped=!1,e.propagationImmediatelyStopped=!1,this.propagate(e,n),this.dispatch.emit(n||e.type,e)}mapEvent(e){if(!this.rootTarget)return;const n=this.mappingTable[e.type];if(n)for(let r=0,i=n.length;r<i;r++)n[r].fn(e);else console.warn(`[EventBoundary]: Event mapping not defined for ${e.type}`)}hitTest(e,n){Ai.pauseUpdate=!0;const s=this[this._isPointerMoveEvent&&this.enableGlobalMoveEvents?"hitTestMoveRecursive":"hitTestRecursive"](this.rootTarget,this.rootTarget.eventMode,a2.set(e,n),this.hitTestFn,this.hitPruneFn);return s&&s[0]}propagate(e,n){if(!e.target)return;const r=e.composedPath();e.eventPhase=e.CAPTURING_PHASE;for(let i=0,s=r.length-1;i<s;i++)if(e.currentTarget=r[i],this.notifyTarget(e,n),e.propagationStopped||e.propagationImmediatelyStopped)return;if(e.eventPhase=e.AT_TARGET,e.currentTarget=e.target,this.notifyTarget(e,n),!e.propagationStopped&&!e.propagationImmediatelyStopped){e.eventPhase=e.BUBBLING_PHASE;for(let i=r.length-2;i>=0;i--)if(e.currentTarget=r[i],this.notifyTarget(e,n),e.propagationStopped||e.propagationImmediatelyStopped)return}}all(e,n,r=this._allInteractiveElements){if(0===r.length)return;e.eventPhase=e.BUBBLING_PHASE;const i=Array.isArray(n)?n:[n];for(let s=r.length-1;s>=0;s--)i.forEach(o=>{e.currentTarget=r[s],this.notifyTarget(e,o)})}propagationPath(e){const n=[e];for(let r=0;r<2048&&e!==this.rootTarget;r++){if(!e.parent)throw new Error("Cannot find propagation path to disconnected target");n.push(e.parent),e=e.parent}return n.reverse(),n}hitTestMoveRecursive(e,n,r,i,s,o=!1){let a=!1;if(this._interactivePrune(e))return null;if(("dynamic"===e.eventMode||"dynamic"===n)&&(Ai.pauseUpdate=!1),e.interactiveChildren&&e.children){const c=e.children;for(let h=c.length-1;h>=0;h--){const d=c[h],f=this.hitTestMoveRecursive(d,this._isInteractive(n)?n:d.eventMode,r,i,s,o||s(e,r));if(f){if(f.length>0&&!f[f.length-1].parent)continue;const p=e.isInteractive();(f.length>0||p)&&(p&&this._allInteractiveElements.push(e),f.push(e)),0===this._hitElements.length&&(this._hitElements=f),a=!0}}}const l=this._isInteractive(n),u=e.isInteractive();return u&&u&&this._allInteractiveElements.push(e),o||this._hitElements.length>0?null:a?this._hitElements:l&&!s(e,r)&&i(e,r)?u?[e]:[]:null}hitTestRecursive(e,n,r,i,s){if(this._interactivePrune(e)||s(e,r))return null;if(("dynamic"===e.eventMode||"dynamic"===n)&&(Ai.pauseUpdate=!1),e.interactiveChildren&&e.children){const l=e.children;for(let u=l.length-1;u>=0;u--){const c=l[u],h=this.hitTestRecursive(c,this._isInteractive(n)?n:c.eventMode,r,i,s);if(h){if(h.length>0&&!h[h.length-1].parent)continue;const d=e.isInteractive();return(h.length>0||d)&&h.push(e),h}}}const o=this._isInteractive(n),a=e.isInteractive();return o&&i(e,r)?a?[e]:[]:null}_isInteractive(e){return"static"===e||"dynamic"===e}_interactivePrune(e){return!(e&&!e.isMask&&e.visible&&e.renderable&&"none"!==e.eventMode&&("passive"!==e.eventMode||e.interactiveChildren)&&!e.isMask)}hitPruneFn(e,n){if(e.hitArea&&(e.worldTransform.applyInverse(n,Ag),!e.hitArea.contains(Ag.x,Ag.y)))return!0;if(e._mask){const r=e._mask.isMaskData?e._mask.maskObject:e._mask;if(r&&!r.containsPoint?.(n))return!0}return!1}hitTestFn(e,n){return"passive"!==e.eventMode&&(!!e.hitArea||!!e.containsPoint&&e.containsPoint(n))}notifyTarget(e,n){const r=`on${n=n??e.type}`;e.currentTarget[r]?.(e),this.notifyListeners(e,e.eventPhase===e.CAPTURING_PHASE||e.eventPhase===e.AT_TARGET?`${n}capture`:n),e.eventPhase===e.AT_TARGET&&this.notifyListeners(e,n)}mapPointerDown(e){if(!(e instanceof mr))return void console.warn("EventBoundary cannot map a non-pointer event as a pointer event");const n=this.createPointerEvent(e);this.dispatchEvent(n,"pointerdown"),"touch"===n.pointerType?this.dispatchEvent(n,"touchstart"):"mouse"!==n.pointerType&&"pen"!==n.pointerType||this.dispatchEvent(n,2===n.button?"rightdown":"mousedown"),this.trackingData(e.pointerId).pressTargetsByButton[e.button]=n.composedPath(),this.freeEvent(n)}mapPointerMove(e){if(!(e instanceof mr))return void console.warn("EventBoundary cannot map a non-pointer event as a pointer event");this._allInteractiveElements.length=0,this._hitElements.length=0,this._isPointerMoveEvent=!0;const n=this.createPointerEvent(e);this._isPointerMoveEvent=!1;const r="mouse"===n.pointerType||"pen"===n.pointerType,i=this.trackingData(e.pointerId),s=this.findMountedTarget(i.overTargets);if(i.overTargets?.length>0&&s!==n.target){const u=this.createPointerEvent(e,"mousemove"===e.type?"mouseout":"pointerout",s);if(this.dispatchEvent(u,"pointerout"),r&&this.dispatchEvent(u,"mouseout"),!n.composedPath().includes(s)){const c=this.createPointerEvent(e,"pointerleave",s);for(c.eventPhase=c.AT_TARGET;c.target&&!n.composedPath().includes(c.target);)c.currentTarget=c.target,this.notifyTarget(c),r&&this.notifyTarget(c,"mouseleave"),c.target=c.target.parent;this.freeEvent(c)}this.freeEvent(u)}if(s!==n.target){const u=this.clonePointerEvent(n,"mousemove"===e.type?"mouseover":"pointerover");this.dispatchEvent(u,"pointerover"),r&&this.dispatchEvent(u,"mouseover");let c=s?.parent;for(;c&&c!==this.rootTarget.parent&&c!==n.target;)c=c.parent;if(!c||c===this.rootTarget.parent){const d=this.clonePointerEvent(n,"pointerenter");for(d.eventPhase=d.AT_TARGET;d.target&&d.target!==s&&d.target!==this.rootTarget.parent;)d.currentTarget=d.target,this.notifyTarget(d),r&&this.notifyTarget(d,"mouseenter"),d.target=d.target.parent;this.freeEvent(d)}this.freeEvent(u)}const o=[],a=this.enableGlobalMoveEvents??!0;this.moveOnAll?o.push("pointermove"):this.dispatchEvent(n,"pointermove"),a&&o.push("globalpointermove"),"touch"===n.pointerType&&(this.moveOnAll?o.splice(1,0,"touchmove"):this.dispatchEvent(n,"touchmove"),a&&o.push("globaltouchmove")),r&&(this.moveOnAll?o.splice(1,0,"mousemove"):this.dispatchEvent(n,"mousemove"),a&&o.push("globalmousemove"),this.cursor=n.target?.cursor),o.length>0&&this.all(n,o),this._allInteractiveElements.length=0,this._hitElements.length=0,i.overTargets=n.composedPath(),this.freeEvent(n)}mapPointerOver(e){if(!(e instanceof mr))return void console.warn("EventBoundary cannot map a non-pointer event as a pointer event");const n=this.trackingData(e.pointerId),r=this.createPointerEvent(e),i="mouse"===r.pointerType||"pen"===r.pointerType;this.dispatchEvent(r,"pointerover"),i&&this.dispatchEvent(r,"mouseover"),"mouse"===r.pointerType&&(this.cursor=r.target?.cursor);const s=this.clonePointerEvent(r,"pointerenter");for(s.eventPhase=s.AT_TARGET;s.target&&s.target!==this.rootTarget.parent;)s.currentTarget=s.target,this.notifyTarget(s),i&&this.notifyTarget(s,"mouseenter"),s.target=s.target.parent;n.overTargets=r.composedPath(),this.freeEvent(r),this.freeEvent(s)}mapPointerOut(e){if(!(e instanceof mr))return void console.warn("EventBoundary cannot map a non-pointer event as a pointer event");const n=this.trackingData(e.pointerId);if(n.overTargets){const r="mouse"===e.pointerType||"pen"===e.pointerType,i=this.findMountedTarget(n.overTargets),s=this.createPointerEvent(e,"pointerout",i);this.dispatchEvent(s),r&&this.dispatchEvent(s,"mouseout");const o=this.createPointerEvent(e,"pointerleave",i);for(o.eventPhase=o.AT_TARGET;o.target&&o.target!==this.rootTarget.parent;)o.currentTarget=o.target,this.notifyTarget(o),r&&this.notifyTarget(o,"mouseleave"),o.target=o.target.parent;n.overTargets=null,this.freeEvent(s),this.freeEvent(o)}this.cursor=null}mapPointerUp(e){if(!(e instanceof mr))return void console.warn("EventBoundary cannot map a non-pointer event as a pointer event");const n=performance.now(),r=this.createPointerEvent(e);this.dispatchEvent(r,"pointerup"),"touch"===r.pointerType?this.dispatchEvent(r,"touchend"):"mouse"!==r.pointerType&&"pen"!==r.pointerType||this.dispatchEvent(r,2===r.button?"rightup":"mouseup");const i=this.trackingData(e.pointerId),s=this.findMountedTarget(i.pressTargetsByButton[e.button]);let o=s;if(s&&!r.composedPath().includes(s)){let a=s;for(;a&&!r.composedPath().includes(a);)r.currentTarget=a,this.notifyTarget(r,"pointerupoutside"),"touch"===r.pointerType?this.notifyTarget(r,"touchendoutside"):"mouse"!==r.pointerType&&"pen"!==r.pointerType||this.notifyTarget(r,2===r.button?"rightupoutside":"mouseupoutside"),a=a.parent;delete i.pressTargetsByButton[e.button],o=a}if(o){const a=this.clonePointerEvent(r,"click");a.target=o,a.path=null,i.clicksByButton[e.button]||(i.clicksByButton[e.button]={clickCount:0,target:a.target,timeStamp:n});const l=i.clicksByButton[e.button];l.target===a.target&&n-l.timeStamp<200?++l.clickCount:l.clickCount=1,l.target=a.target,l.timeStamp=n,a.detail=l.clickCount,"mouse"===a.pointerType?this.dispatchEvent(a,2===a.button?"rightclick":"click"):"touch"===a.pointerType&&this.dispatchEvent(a,"tap"),this.dispatchEvent(a,"pointertap"),this.freeEvent(a)}this.freeEvent(r)}mapPointerUpOutside(e){if(!(e instanceof mr))return void console.warn("EventBoundary cannot map a non-pointer event as a pointer event");const n=this.trackingData(e.pointerId),r=this.findMountedTarget(n.pressTargetsByButton[e.button]),i=this.createPointerEvent(e);if(r){let s=r;for(;s;)i.currentTarget=s,this.notifyTarget(i,"pointerupoutside"),"touch"===i.pointerType?this.notifyTarget(i,"touchendoutside"):("mouse"===i.pointerType||"pen"===i.pointerType)&&this.notifyTarget(i,2===i.button?"rightupoutside":"mouseupoutside"),s=s.parent;delete n.pressTargetsByButton[e.button]}this.freeEvent(i)}mapWheel(e){if(!(e instanceof Ig))return void console.warn("EventBoundary cannot map a non-wheel event as a wheel event");const n=this.createWheelEvent(e);this.dispatchEvent(n),this.freeEvent(n)}findMountedTarget(e){if(!e)return null;let n=e[0];for(let r=1;r<e.length&&e[r].parent===n;r++)n=e[r];return n}createPointerEvent(e,n,r){const i=this.allocateEvent(mr);return this.copyPointerData(e,i),this.copyMouseData(e,i),this.copyData(e,i),i.nativeEvent=e.nativeEvent,i.originalEvent=e,i.target=r??this.hitTest(i.global.x,i.global.y)??this._hitElements[0],"string"==typeof n&&(i.type=n),i}createWheelEvent(e){const n=this.allocateEvent(Ig);return this.copyWheelData(e,n),this.copyMouseData(e,n),this.copyData(e,n),n.nativeEvent=e.nativeEvent,n.originalEvent=e,n.target=this.hitTest(n.global.x,n.global.y),n}clonePointerEvent(e,n){const r=this.allocateEvent(mr);return r.nativeEvent=e.nativeEvent,r.originalEvent=e.originalEvent,this.copyPointerData(e,r),this.copyMouseData(e,r),this.copyData(e,r),r.target=e.target,r.path=e.composedPath().slice(),r.type=n??r.type,r}copyWheelData(e,n){n.deltaMode=e.deltaMode,n.deltaX=e.deltaX,n.deltaY=e.deltaY,n.deltaZ=e.deltaZ}copyPointerData(e,n){e instanceof mr&&n instanceof mr&&(n.pointerId=e.pointerId,n.width=e.width,n.height=e.height,n.isPrimary=e.isPrimary,n.pointerType=e.pointerType,n.pressure=e.pressure,n.tangentialPressure=e.tangentialPressure,n.tiltX=e.tiltX,n.tiltY=e.tiltY,n.twist=e.twist)}copyMouseData(e,n){e instanceof Uc&&n instanceof Uc&&(n.altKey=e.altKey,n.button=e.button,n.buttons=e.buttons,n.client.copyFrom(e.client),n.ctrlKey=e.ctrlKey,n.metaKey=e.metaKey,n.movement.copyFrom(e.movement),n.screen.copyFrom(e.screen),n.shiftKey=e.shiftKey,n.global.copyFrom(e.global))}copyData(e,n){n.isTrusted=e.isTrusted,n.srcElement=e.srcElement,n.timeStamp=performance.now(),n.type=e.type,n.detail=e.detail,n.view=e.view,n.which=e.which,n.layer.copyFrom(e.layer),n.page.copyFrom(e.page)}trackingData(e){return this.mappingState.trackingData[e]||(this.mappingState.trackingData[e]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[e]}allocateEvent(e){this.eventPool.has(e)||this.eventPool.set(e,[]);const n=this.eventPool.get(e).pop()||new e(this);return n.eventPhase=n.NONE,n.currentTarget=null,n.path=null,n.target=null,n}freeEvent(e){if(e.manager!==this)throw new Error("It is illegal to free an event not managed by this EventBoundary!");const n=e.constructor;this.eventPool.has(n)||this.eventPool.set(n,[]),this.eventPool.get(n).push(e)}notifyListeners(e,n){const r=e.currentTarget._events[n];if(r&&e.currentTarget.isInteractive())if("fn"in r)r.once&&e.currentTarget.removeListener(n,r.fn,void 0,!0),r.fn.call(r.context,e);else for(let i=0,s=r.length;i<s&&!e.propagationImmediatelyStopped;i++)r[i].once&&e.currentTarget.removeListener(n,r[i].fn,void 0,!0),r[i].fn.call(r[i].context,e)}}const c2={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"},Mg=class{constructor(t){this.supportsTouchEvents="ontouchstart"in globalThis,this.supportsPointerEvents=!!globalThis.PointerEvent,this.domElement=null,this.resolution=1,this.renderer=t,this.rootBoundary=new l2(null),Ai.init(this),this.autoPreventDefault=!0,this.eventsAdded=!1,this.rootPointerEvent=new mr(null),this.rootWheelEvent=new Ig(null),this.cursorStyles={default:"inherit",pointer:"pointer"},this.features=new Proxy({...Mg.defaultEventFeatures},{set:(e,n,r)=>("globalMove"===n&&(this.rootBoundary.enableGlobalMoveEvents=r),e[n]=r,!0)}),this.onPointerDown=this.onPointerDown.bind(this),this.onPointerMove=this.onPointerMove.bind(this),this.onPointerUp=this.onPointerUp.bind(this),this.onPointerOverOut=this.onPointerOverOut.bind(this),this.onWheel=this.onWheel.bind(this)}static get defaultEventMode(){return this._defaultEventMode}init(t){const{view:e,resolution:n}=this.renderer;this.setTargetElement(e),this.resolution=n,Mg._defaultEventMode=t.eventMode??"auto",Object.assign(this.features,t.eventFeatures??{}),this.rootBoundary.enableGlobalMoveEvents=this.features.globalMove}resolutionChange(t){this.resolution=t}destroy(){this.setTargetElement(null),this.renderer=null}setCursor(t){t=t||"default";let e=!0;if(globalThis.OffscreenCanvas&&this.domElement instanceof OffscreenCanvas&&(e=!1),this.currentCursor===t)return;this.currentCursor=t;const n=this.cursorStyles[t];if(n)switch(typeof n){case"string":e&&(this.domElement.style.cursor=n);break;case"function":n(t);break;case"object":e&&Object.assign(this.domElement.style,n)}else e&&"string"==typeof t&&!Object.prototype.hasOwnProperty.call(this.cursorStyles,t)&&(this.domElement.style.cursor=t)}get pointer(){return this.rootPointerEvent}onPointerDown(t){if(!this.features.click||(this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.supportsTouchEvents&&"touch"===t.pointerType))return;const e=this.normalizeToPointerData(t);this.autoPreventDefault&&e[0].isNormalized&&(t.cancelable||!("cancelable"in t))&&t.preventDefault();for(let n=0,r=e.length;n<r;n++){const s=this.bootstrapEvent(this.rootPointerEvent,e[n]);this.rootBoundary.mapEvent(s)}this.setCursor(this.rootBoundary.cursor)}onPointerMove(t){if(!this.features.move||(this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.supportsTouchEvents&&"touch"===t.pointerType))return;Ai.pointerMoved();const e=this.normalizeToPointerData(t);for(let n=0,r=e.length;n<r;n++){const i=this.bootstrapEvent(this.rootPointerEvent,e[n]);this.rootBoundary.mapEvent(i)}this.setCursor(this.rootBoundary.cursor)}onPointerUp(t){if(!this.features.click||(this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.supportsTouchEvents&&"touch"===t.pointerType))return;let e=t.target;t.composedPath&&t.composedPath().length>0&&(e=t.composedPath()[0]);const n=e!==this.domElement?"outside":"",r=this.normalizeToPointerData(t);for(let i=0,s=r.length;i<s;i++){const o=this.bootstrapEvent(this.rootPointerEvent,r[i]);o.type+=n,this.rootBoundary.mapEvent(o)}this.setCursor(this.rootBoundary.cursor)}onPointerOverOut(t){if(!this.features.click||(this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.supportsTouchEvents&&"touch"===t.pointerType))return;const e=this.normalizeToPointerData(t);for(let n=0,r=e.length;n<r;n++){const i=this.bootstrapEvent(this.rootPointerEvent,e[n]);this.rootBoundary.mapEvent(i)}this.setCursor(this.rootBoundary.cursor)}onWheel(t){if(!this.features.wheel)return;const e=this.normalizeWheelEvent(t);this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.rootBoundary.mapEvent(e)}setTargetElement(t){this.removeEvents(),this.domElement=t,Ai.domElement=t,this.addEvents()}addEvents(){if(this.eventsAdded||!this.domElement)return;Ai.addTickerListener();const t=this.domElement.style;t&&(globalThis.navigator.msPointerEnabled?(t.msContentZooming="none",t.msTouchAction="none"):this.supportsPointerEvents&&(t.touchAction="none")),this.supportsPointerEvents?(globalThis.document.addEventListener("pointermove",this.onPointerMove,!0),this.domElement.addEventListener("pointerdown",this.onPointerDown,!0),this.domElement.addEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.addEventListener("pointerover",this.onPointerOverOut,!0),globalThis.addEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.addEventListener("mousemove",this.onPointerMove,!0),this.domElement.addEventListener("mousedown",this.onPointerDown,!0),this.domElement.addEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.addEventListener("mouseover",this.onPointerOverOut,!0),globalThis.addEventListener("mouseup",this.onPointerUp,!0)),this.supportsTouchEvents&&(this.domElement.addEventListener("touchstart",this.onPointerDown,!0),this.domElement.addEventListener("touchend",this.onPointerUp,!0),this.domElement.addEventListener("touchmove",this.onPointerMove,!0)),this.domElement.addEventListener("wheel",this.onWheel,{passive:!0,capture:!0}),this.eventsAdded=!0}removeEvents(){if(!this.eventsAdded||!this.domElement)return;Ai.removeTickerListener();const t=this.domElement.style;globalThis.navigator.msPointerEnabled?(t.msContentZooming="",t.msTouchAction=""):this.supportsPointerEvents&&(t.touchAction=""),this.supportsPointerEvents?(globalThis.document.removeEventListener("pointermove",this.onPointerMove,!0),this.domElement.removeEventListener("pointerdown",this.onPointerDown,!0),this.domElement.removeEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.removeEventListener("pointerover",this.onPointerOverOut,!0),globalThis.removeEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.removeEventListener("mousemove",this.onPointerMove,!0),this.domElement.removeEventListener("mousedown",this.onPointerDown,!0),this.domElement.removeEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.removeEventListener("mouseover",this.onPointerOverOut,!0),globalThis.removeEventListener("mouseup",this.onPointerUp,!0)),this.supportsTouchEvents&&(this.domElement.removeEventListener("touchstart",this.onPointerDown,!0),this.domElement.removeEventListener("touchend",this.onPointerUp,!0),this.domElement.removeEventListener("touchmove",this.onPointerMove,!0)),this.domElement.removeEventListener("wheel",this.onWheel,!0),this.domElement=null,this.eventsAdded=!1}mapPositionToPoint(t,e,n){let r;r=this.domElement.parentElement?this.domElement.getBoundingClientRect():{x:0,y:0,width:this.domElement.width,height:this.domElement.height,left:0,top:0};const i=1/this.resolution;t.x=this.domElement.width/r.width*(e-r.left)*i,t.y=this.domElement.height/r.height*(n-r.top)*i}normalizeToPointerData(t){const e=[];if(this.supportsTouchEvents&&t instanceof TouchEvent)for(let n=0,r=t.changedTouches.length;n<r;n++){const i=t.changedTouches[n];typeof i.button>"u"&&(i.button=0),typeof i.buttons>"u"&&(i.buttons=1),typeof i.isPrimary>"u"&&(i.isPrimary=1===t.touches.length&&"touchstart"===t.type),typeof i.width>"u"&&(i.width=i.radiusX||1),typeof i.height>"u"&&(i.height=i.radiusY||1),typeof i.tiltX>"u"&&(i.tiltX=0),typeof i.tiltY>"u"&&(i.tiltY=0),typeof i.pointerType>"u"&&(i.pointerType="touch"),typeof i.pointerId>"u"&&(i.pointerId=i.identifier||0),typeof i.pressure>"u"&&(i.pressure=i.force||.5),typeof i.twist>"u"&&(i.twist=0),typeof i.tangentialPressure>"u"&&(i.tangentialPressure=0),typeof i.layerX>"u"&&(i.layerX=i.offsetX=i.clientX),typeof i.layerY>"u"&&(i.layerY=i.offsetY=i.clientY),i.isNormalized=!0,i.type=t.type,e.push(i)}else if(!globalThis.MouseEvent||t instanceof MouseEvent&&!(this.supportsPointerEvents&&t instanceof globalThis.PointerEvent)){const n=t;typeof n.isPrimary>"u"&&(n.isPrimary=!0),typeof n.width>"u"&&(n.width=1),typeof n.height>"u"&&(n.height=1),typeof n.tiltX>"u"&&(n.tiltX=0),typeof n.tiltY>"u"&&(n.tiltY=0),typeof n.pointerType>"u"&&(n.pointerType="mouse"),typeof n.pointerId>"u"&&(n.pointerId=1),typeof n.pressure>"u"&&(n.pressure=.5),typeof n.twist>"u"&&(n.twist=0),typeof n.tangentialPressure>"u"&&(n.tangentialPressure=0),n.isNormalized=!0,e.push(n)}else e.push(t);return e}normalizeWheelEvent(t){const e=this.rootWheelEvent;return this.transferMouseData(e,t),e.deltaX=t.deltaX,e.deltaY=t.deltaY,e.deltaZ=t.deltaZ,e.deltaMode=t.deltaMode,this.mapPositionToPoint(e.screen,t.clientX,t.clientY),e.global.copyFrom(e.screen),e.offset.copyFrom(e.screen),e.nativeEvent=t,e.type=t.type,e}bootstrapEvent(t,e){return t.originalEvent=null,t.nativeEvent=e,t.pointerId=e.pointerId,t.width=e.width,t.height=e.height,t.isPrimary=e.isPrimary,t.pointerType=e.pointerType,t.pressure=e.pressure,t.tangentialPressure=e.tangentialPressure,t.tiltX=e.tiltX,t.tiltY=e.tiltY,t.twist=e.twist,this.transferMouseData(t,e),this.mapPositionToPoint(t.screen,e.clientX,e.clientY),t.global.copyFrom(t.screen),t.offset.copyFrom(t.screen),t.isTrusted=e.isTrusted,"pointerleave"===t.type&&(t.type="pointerout"),t.type.startsWith("mouse")&&(t.type=t.type.replace("mouse","pointer")),t.type.startsWith("touch")&&(t.type=c2[t.type]||t.type),t}transferMouseData(t,e){t.isTrusted=e.isTrusted,t.srcElement=e.srcElement,t.timeStamp=performance.now(),t.type=e.type,t.altKey=e.altKey,t.button=e.button,t.buttons=e.buttons,t.client.x=e.clientX,t.client.y=e.clientY,t.ctrlKey=e.ctrlKey,t.metaKey=e.metaKey,t.movement.x=e.movementX,t.movement.y=e.movementY,t.page.x=e.pageX,t.page.y=e.pageY,t.relatedTarget=null,t.shiftKey=e.shiftKey}};let Ja=Mg;function sD(t){return"dynamic"===t||"static"===t}Ja.extension={name:"events",type:[fe.RendererSystem,fe.CanvasRendererSystem]},Ja.defaultEventFeatures={move:!0,globalMove:!0,click:!0,wheel:!0},Te.add(Ja);const h2={onclick:null,onmousedown:null,onmouseenter:null,onmouseleave:null,onmousemove:null,onglobalmousemove:null,onmouseout:null,onmouseover:null,onmouseup:null,onmouseupoutside:null,onpointercancel:null,onpointerdown:null,onpointerenter:null,onpointerleave:null,onpointermove:null,onglobalpointermove:null,onpointerout:null,onpointerover:null,onpointertap:null,onpointerup:null,onpointerupoutside:null,onrightclick:null,onrightdown:null,onrightup:null,onrightupoutside:null,ontap:null,ontouchcancel:null,ontouchend:null,ontouchendoutside:null,ontouchmove:null,onglobaltouchmove:null,ontouchstart:null,onwheel:null,_internalInteractive:void 0,get interactive(){return this._internalInteractive??sD(Ja.defaultEventMode)},set interactive(t){Ye("7.2.0","Setting interactive is deprecated, use eventMode = 'none'/'passive'/'auto'/'static'/'dynamic' instead."),this._internalInteractive=t,this.eventMode=t?"static":"auto"},_internalEventMode:void 0,get eventMode(){return this._internalEventMode??Ja.defaultEventMode},set eventMode(t){this._internalInteractive=sD(t),this._internalEventMode=t},isInteractive(){return"static"===this.eventMode||"dynamic"===this.eventMode},interactiveChildren:!0,hitArea:null,addEventListener(t,e,n){const i="function"==typeof e?void 0:e;this.on(t="boolean"==typeof n&&n||"object"==typeof n&&n.capture?`${t}capture`:t,e="function"==typeof e?e:e.handleEvent,i)},removeEventListener(t,e,n){const i="function"==typeof e?void 0:e;this.off(t="boolean"==typeof n&&n||"object"==typeof n&&n.capture?`${t}capture`:t,e="function"==typeof e?e:e.handleEvent,i)},dispatchEvent(t){if(!(t instanceof Qa))throw new Error("DisplayObject cannot propagate events outside of the Federated Events API");return t.defaultPrevented=!1,t.path=null,t.target=this,t.manager.dispatchEvent(t),!t.defaultPrevented}};kt.mixin(h2),kt.mixin({accessible:!1,accessibleTitle:null,accessibleHint:null,tabIndex:0,_accessibleActive:!1,_accessibleDiv:null,accessibleType:"button",accessiblePointerEvents:"auto",accessibleChildren:!0,renderId:-1});class lD{constructor(e){this.debug=!1,this._isActive=!1,this._isMobileAccessibility=!1,this.pool=[],this.renderId=0,this.children=[],this.androidUpdateCount=0,this.androidUpdateFrequency=500,this._hookDiv=null,(oi.tablet||oi.phone)&&this.createTouchHook();const n=document.createElement("div");n.style.width="100px",n.style.height="100px",n.style.position="absolute",n.style.top="0px",n.style.left="0px",n.style.zIndex=2..toString(),this.div=n,this.renderer=e,this._onKeyDown=this._onKeyDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),globalThis.addEventListener("keydown",this._onKeyDown,!1)}get isActive(){return this._isActive}get isMobileAccessibility(){return this._isMobileAccessibility}createTouchHook(){const e=document.createElement("button");e.style.width="1px",e.style.height="1px",e.style.position="absolute",e.style.top="-1000px",e.style.left="-1000px",e.style.zIndex=2..toString(),e.style.backgroundColor="#FF0000",e.title="select to enable accessibility for this content",e.addEventListener("focus",()=>{this._isMobileAccessibility=!0,this.activate(),this.destroyTouchHook()}),document.body.appendChild(e),this._hookDiv=e}destroyTouchHook(){this._hookDiv&&(document.body.removeChild(this._hookDiv),this._hookDiv=null)}activate(){this._isActive||(this._isActive=!0,globalThis.document.addEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown,!1),this.renderer.on("postrender",this.update,this),this.renderer.view.parentNode?.appendChild(this.div))}deactivate(){!this._isActive||this._isMobileAccessibility||(this._isActive=!1,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.addEventListener("keydown",this._onKeyDown,!1),this.renderer.off("postrender",this.update),this.div.parentNode?.removeChild(this.div))}updateAccessibleObjects(e){if(!e.visible||!e.accessibleChildren)return;e.accessible&&e.isInteractive()&&(e._accessibleActive||this.addChild(e),e.renderId=this.renderId);const n=e.children;if(n)for(let r=0;r<n.length;r++)this.updateAccessibleObjects(n[r])}update(){const e=performance.now();if(oi.android.device&&e<this.androidUpdateCount||(this.androidUpdateCount=e+this.androidUpdateFrequency,!this.renderer.renderingToScreen))return;this.renderer.lastObjectRendered&&this.updateAccessibleObjects(this.renderer.lastObjectRendered);const{x:n,y:r,width:i,height:s}=this.renderer.view.getBoundingClientRect(),{width:o,height:a,resolution:l}=this.renderer,u=i/o*l,c=s/a*l;let h=this.div;h.style.left=`${n}px`,h.style.top=`${r}px`,h.style.width=`${o}px`,h.style.height=`${a}px`;for(let d=0;d<this.children.length;d++){const f=this.children[d];if(f.renderId!==this.renderId)f._accessibleActive=!1,mo(this.children,d,1),this.div.removeChild(f._accessibleDiv),this.pool.push(f._accessibleDiv),f._accessibleDiv=null,d--;else{h=f._accessibleDiv;let p=f.hitArea;const g=f.worldTransform;f.hitArea?(h.style.left=(g.tx+p.x*g.a)*u+"px",h.style.top=(g.ty+p.y*g.d)*c+"px",h.style.width=p.width*g.a*u+"px",h.style.height=p.height*g.d*c+"px"):(p=f.getBounds(),this.capHitArea(p),h.style.left=p.x*u+"px",h.style.top=p.y*c+"px",h.style.width=p.width*u+"px",h.style.height=p.height*c+"px",h.title!==f.accessibleTitle&&null!==f.accessibleTitle&&(h.title=f.accessibleTitle),h.getAttribute("aria-label")!==f.accessibleHint&&null!==f.accessibleHint&&h.setAttribute("aria-label",f.accessibleHint)),(f.accessibleTitle!==h.title||f.tabIndex!==h.tabIndex)&&(h.title=f.accessibleTitle,h.tabIndex=f.tabIndex,this.debug&&this.updateDebugHTML(h))}}this.renderId++}updateDebugHTML(e){e.innerHTML=`type: ${e.type}</br> title : ${e.title}</br> tabIndex: ${e.tabIndex}`}capHitArea(e){e.x<0&&(e.width+=e.x,e.x=0),e.y<0&&(e.height+=e.y,e.y=0);const{width:n,height:r}=this.renderer;e.x+e.width>n&&(e.width=n-e.x),e.y+e.height>r&&(e.height=r-e.y)}addChild(e){let n=this.pool.pop();n||(n=document.createElement("button"),n.style.width="100px",n.style.height="100px",n.style.backgroundColor=this.debug?"rgba(255,255,255,0.5)":"transparent",n.style.position="absolute",n.style.zIndex=2..toString(),n.style.borderStyle="none",navigator.userAgent.toLowerCase().includes("chrome")?n.setAttribute("aria-live","off"):n.setAttribute("aria-live","polite"),navigator.userAgent.match(/rv:.*Gecko\//)?n.setAttribute("aria-relevant","additions"):n.setAttribute("aria-relevant","text"),n.addEventListener("click",this._onClick.bind(this)),n.addEventListener("focus",this._onFocus.bind(this)),n.addEventListener("focusout",this._onFocusOut.bind(this))),n.style.pointerEvents=e.accessiblePointerEvents,n.type=e.accessibleType,e.accessibleTitle&&null!==e.accessibleTitle?n.title=e.accessibleTitle:(!e.accessibleHint||null===e.accessibleHint)&&(n.title=`displayObject ${e.tabIndex}`),e.accessibleHint&&null!==e.accessibleHint&&n.setAttribute("aria-label",e.accessibleHint),this.debug&&this.updateDebugHTML(n),e._accessibleActive=!0,e._accessibleDiv=n,n.displayObject=e,this.children.push(e),this.div.appendChild(e._accessibleDiv),e._accessibleDiv.tabIndex=e.tabIndex}_dispatchEvent(e,n){const{displayObject:r}=e.target,i=this.renderer.events.rootBoundary,s=Object.assign(new Qa(i),{target:r});i.rootTarget=this.renderer.lastObjectRendered,n.forEach(o=>i.dispatchEvent(s,o))}_onClick(e){this._dispatchEvent(e,["click","pointertap","tap"])}_onFocus(e){e.target.getAttribute("aria-live")||e.target.setAttribute("aria-live","assertive"),this._dispatchEvent(e,["mouseover"])}_onFocusOut(e){e.target.getAttribute("aria-live")||e.target.setAttribute("aria-live","polite"),this._dispatchEvent(e,["mouseout"])}_onKeyDown(e){9===e.keyCode&&this.activate()}_onMouseMove(e){0===e.movementX&&0===e.movementY||this.deactivate()}destroy(){this.destroyTouchHook(),this.div=null,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown),this.pool=null,this.children=null,this.renderer=null}}lD.extension={name:"accessibility",type:[fe.RendererPlugin,fe.CanvasRendererPlugin]},Te.add(lD);const Rg=class{constructor(t){this.stage=new on,t=Object.assign({forceCanvas:!1},t),this.renderer=function wB(t){for(const e of Gb)if(e.test(t))return new e(t);throw new Error("Unable to auto-detect a suitable renderer.")}(t),Rg._plugins.forEach(e=>{e.init.call(this,t)})}render(){this.renderer.render(this.stage)}get view(){return this.renderer.view}get screen(){return this.renderer.screen}destroy(t,e){const n=Rg._plugins.slice(0);n.reverse(),n.forEach(r=>{r.destroy.call(this)}),this.stage.destroy(e),this.stage=null,this.renderer.destroy(t),this.renderer=null}};let Pg=Rg;Pg._plugins=[],Te.handleByList(fe.Application,Pg._plugins);class uD{static init(e){Object.defineProperty(this,"resizeTo",{set(n){globalThis.removeEventListener("resize",this.queueResize),this._resizeTo=n,n&&(globalThis.addEventListener("resize",this.queueResize),this.resize())},get(){return this._resizeTo}}),this.queueResize=()=>{this._resizeTo&&(this.cancelResize(),this._resizeId=requestAnimationFrame(()=>this.resize()))},this.cancelResize=()=>{this._resizeId&&(cancelAnimationFrame(this._resizeId),this._resizeId=null)},this.resize=()=>{if(!this._resizeTo)return;let n,r;if(this.cancelResize(),this._resizeTo===globalThis.window)n=globalThis.innerWidth,r=globalThis.innerHeight;else{const{clientWidth:i,clientHeight:s}=this._resizeTo;n=i,r=s}this.renderer.resize(n,r),this.render()},this._resizeId=null,this._resizeTo=null,this.resizeTo=e.resizeTo||null}static destroy(){globalThis.removeEventListener("resize",this.queueResize),this.cancelResize(),this.cancelResize=null,this.queueResize=null,this.resizeTo=null,this.resize=null}}uD.extension=fe.Application,Te.add(uD);const cD={loader:fe.LoadParser,resolver:fe.ResolveParser,cache:fe.CacheParser,detection:fe.DetectionParser};Te.handle(fe.Asset,t=>{const e=t.ref;Object.entries(cD).filter(([n])=>!!e[n]).forEach(([n,r])=>Te.add(Object.assign(e[n],{extension:e[n].extension??r})))},t=>{const e=t.ref;Object.keys(cD).filter(n=>!!e[n]).forEach(n=>Te.remove(e[n]))});class v2{constructor(e,n=!1){this._loader=e,this._assetList=[],this._isLoading=!1,this._maxConcurrent=1,this.verbose=n}add(e){e.forEach(n=>{this._assetList.push(n)}),this.verbose&&console.log("[BackgroundLoader] assets: ",this._assetList),this._isActive&&!this._isLoading&&this._next()}_next(){var e=this;return re(function*(){if(e._assetList.length&&e._isActive){e._isLoading=!0;const n=[],r=Math.min(e._assetList.length,e._maxConcurrent);for(let i=0;i<r;i++)n.push(e._assetList.pop());yield e._loader.load(n),e._isLoading=!1,e._next()}})()}get active(){return this._isActive}set active(e){this._isActive!==e&&(this._isActive=e,e&&!this._isLoading&&this._next())}}function ls(t,e){const n=t.split("?")[0],r=hn.extname(n).toLowerCase();return Array.isArray(e)?e.includes(r):r===e}const ci=(t,e)=>(Array.isArray(t)||(t=[t]),e?t.map(n=>"string"==typeof n?e(n):n):t),el=new class x2{constructor(){this._parsers=[],this._cache=new Map,this._cacheMap=new Map}reset(){this._cacheMap.clear(),this._cache.clear()}has(e){return this._cache.has(e)}get(e){const n=this._cache.get(e);return n||console.warn(`[Assets] Asset id ${e} was not found in the Cache`),n}set(e,n){const r=ci(e);let i;for(let a=0;a<this.parsers.length;a++){const l=this.parsers[a];if(l.test(n)){i=l.getCacheableAssets(r,n);break}}i||(i={},r.forEach(a=>{i[a]=n}));const s=Object.keys(i),o={cacheKeys:s,keys:r};if(r.forEach(a=>{this._cacheMap.set(a,o)}),s.forEach(a=>{this._cache.has(a)&&this._cache.get(a)!==n&&console.warn("[Cache] already has key:",a),this._cache.set(a,i[a])}),n instanceof _e){const a=n;r.forEach(l=>{a.baseTexture!==_e.EMPTY.baseTexture&&$e.addToCache(a.baseTexture,l),_e.addToCache(a,l)})}}remove(e){if(this._cacheMap.get(e),!this._cacheMap.has(e))return void console.warn(`[Assets] Asset id ${e} was not found in the Cache`);const n=this._cacheMap.get(e);n.cacheKeys.forEach(i=>{this._cache.delete(i)}),n.keys.forEach(i=>{this._cacheMap.delete(i)})}get parsers(){return this._parsers}},Vc=t=>!Array.isArray(t);class w2{constructor(){this._parsers=[],this._parsersValidated=!1,this.parsers=new Proxy(this._parsers,{set:(e,n,r)=>(this._parsersValidated=!1,e[n]=r,!0)}),this.promiseCache={}}reset(){this._parsersValidated=!1,this.promiseCache={}}_getLoadPromiseAndParser(e,n){var r=this;const i={promise:null,parser:null};return i.promise=re(function*(){let s=null,o=null;if(n.loadParser&&(o=r._parserHash[n.loadParser],o||console.warn(`[Assets] specified load parser "${n.loadParser}" not found while loading ${e}`)),!o){for(let a=0;a<r.parsers.length;a++){const l=r.parsers[a];if(l.load&&l.test?.(e,n,r)){o=l;break}}if(!o)return console.warn(`[Assets] ${e} could not be loaded as we don't know how to parse it, ensure the correct parser has been added`),null}s=yield o.load(e,n,r),i.parser=o;for(let a=0;a<r.parsers.length;a++){const l=r.parsers[a];l.parse&&l.parse&&(yield l.testParse?.(s,n,r))&&(s=(yield l.parse(s,n,r))||s,i.parser=l)}return s})(),i}load(e,n){var r=this;return re(function*(){r._parsersValidated||r._validateParsers();let i=0;const s={},o=Vc(e),a=ci(e,c=>({src:c})),l=a.length,u=a.map(function(){var c=re(function*(h){const d=hn.toAbsolute(h.src);if(!s[h.src])try{r.promiseCache[d]||(r.promiseCache[d]=r._getLoadPromiseAndParser(d,h)),s[h.src]=yield r.promiseCache[d].promise,n&&n(++i/l)}catch(f){throw delete r.promiseCache[d],delete s[h.src],new Error(`[Loader.load] Failed to load ${d}.\n${f}`)}});return function(h){return c.apply(this,arguments)}}());return yield Promise.all(u),o?s[a[0].src]:s})()}unload(e){var n=this;return re(function*(){const i=ci(e,s=>({src:s})).map(function(){var s=re(function*(o){const a=hn.toAbsolute(o.src),l=n.promiseCache[a];if(l){const u=yield l.promise;l.parser?.unload?.(u,o,n),delete n.promiseCache[a]}});return function(o){return s.apply(this,arguments)}}());yield Promise.all(i)})()}_validateParsers(){this._parsersValidated=!0,this._parserHash=this._parsers.filter(e=>e.name).reduce((e,n)=>(e[n.name]&&console.warn(`[Assets] loadParser name conflict "${n.name}"`),{...e,[n.name]:n}),{})}}var jr=(t=>(t[t.Low=0]="Low",t[t.Normal=1]="Normal",t[t.High=2]="High",t))(jr||{});function tl(t,e){if(Array.isArray(e)){for(const n of e)if(t.startsWith(`data:${n}`))return!0;return!1}return t.startsWith(`data:${e}`)}const D2={extension:{type:fe.LoadParser,priority:jr.Low},name:"loadJson",test:t=>tl(t,"application/json")||ls(t,".json"),load:t=>re(function*(){return yield(yield ce.ADAPTER.fetch(t)).json()})()};Te.add(D2);const C2={name:"loadTxt",extension:{type:fe.LoadParser,priority:jr.Low},test:t=>tl(t,"text/plain")||ls(t,".txt"),load:t=>re(function*(){return yield(yield ce.ADAPTER.fetch(t)).text()})()};Te.add(C2);const I2=["normal","bold","100","200","300","400","500","600","700","800","900"],A2=[".ttf",".otf",".woff",".woff2"],M2=["font/ttf","font/otf","font/woff","font/woff2"],R2=/^(--|-?[A-Z_])[0-9A-Z_-]*$/i,N2={extension:{type:fe.LoadParser,priority:jr.Low},name:"loadWebFont",test:t=>tl(t,M2)||ls(t,A2),load:(t,e)=>re(function*(){const n=ce.ADAPTER.getFontFaceSet();if(n){const r=[],i=e.data?.family??function P2(t){const e=hn.extname(t),i=hn.basename(t,e).replace(/(-|_)/g," ").toLowerCase().split(" ").map(a=>a.charAt(0).toUpperCase()+a.slice(1));let s=i.length>0;for(const a of i)if(!a.match(R2)){s=!1;break}let o=i.join(" ");return s||(o=`"${o.replace(/[\\"]/g,"\\$&")}"`),o}(t),s=e.data?.weights?.filter(a=>I2.includes(a))??["normal"],o=e.data??{};for(let a=0;a<s.length;a++){const l=s[a],u=new FontFace(i,`url(${encodeURI(t)})`,{...o,weight:l});yield u.load(),n.add(u),r.push(u)}return 1===r.length?r[0]:r}return console.warn("[loadWebFont] FontFace API is not supported. Skipping loading font"),null})(),unload(t){(Array.isArray(t)?t:[t]).forEach(e=>ce.ADAPTER.getFontFaceSet().delete(e))}};Te.add(N2);let Ng,hD=0;const O2_code="\n    async function checkImageBitmap()\n    {\n        try\n        {\n            if (typeof createImageBitmap !== 'function') return false;\n\n            const response = await fetch('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=');\n            const imageBlob =  await response.blob();\n            const imageBitmap = await createImageBitmap(imageBlob);\n\n            return imageBitmap.width === 1 && imageBitmap.height === 1;\n        }\n        catch (e)\n        {\n            return false;\n        }\n    }\n    checkImageBitmap().then((result) => { self.postMessage(result); });\n    ",F2_code="\n    async function loadImageBitmap(url)\n    {\n        const response = await fetch(url);\n\n        if (!response.ok)\n        {\n            throw new Error(`[WorkerManager.loadImageBitmap] Failed to fetch ${url}: `\n                + `${response.status} ${response.statusText}`);\n        }\n\n        const imageBlob =  await response.blob();\n        const imageBitmap = await createImageBitmap(imageBlob);\n\n        return imageBitmap;\n    }\n    self.onmessage = async (event) =>\n    {\n        try\n        {\n            const imageBitmap = await loadImageBitmap(event.data.data[0]);\n\n            self.postMessage({\n                data: imageBitmap,\n                uuid: event.data.uuid,\n                id: event.data.id,\n            }, [imageBitmap]);\n        }\n        catch(e)\n        {\n            self.postMessage({\n                error: e,\n                uuid: event.data.uuid,\n                id: event.data.id,\n            });\n        }\n    };";let Og;const dD=new class L2{constructor(){this._initialized=!1,this._createdWorkers=0,this.workerPool=[],this.queue=[],this.resolveHash={}}isImageBitmapSupported(){return void 0!==this._isImageBitmapSupported||(this._isImageBitmapSupported=new Promise(e=>{const n=URL.createObjectURL(new Blob([O2_code],{type:"application/javascript"})),r=new Worker(n);r.addEventListener("message",i=>{r.terminate(),URL.revokeObjectURL(n),e(i.data)})})),this._isImageBitmapSupported}loadImageBitmap(e){return this._run("loadImageBitmap",[e])}_initWorkers(){var e=this;return re(function*(){e._initialized||(e._initialized=!0)})()}getWorker(){void 0===Ng&&(Ng=navigator.hardwareConcurrency||4);let e=this.workerPool.pop();return!e&&this._createdWorkers<Ng&&(Og||(Og=URL.createObjectURL(new Blob([F2_code],{type:"application/javascript"}))),this._createdWorkers++,e=new Worker(Og),e.addEventListener("message",n=>{this.complete(n.data),this.returnWorker(n.target),this.next()})),e}returnWorker(e){this.workerPool.push(e)}complete(e){void 0!==e.error?this.resolveHash[e.uuid].reject(e.error):this.resolveHash[e.uuid].resolve(e.data),this.resolveHash[e.uuid]=null}_run(e,n){var r=this;return re(function*(){yield r._initWorkers();const i=new Promise((s,o)=>{r.queue.push({id:e,arguments:n,resolve:s,reject:o})});return r.next(),i})()}next(){if(!this.queue.length)return;const e=this.getWorker();if(!e)return;const n=this.queue.pop(),r=n.id;this.resolveHash[hD]={resolve:n.resolve,reject:n.reject},e.postMessage({data:n.arguments,uuid:hD++,id:r})}};function Gc(t,e,n){const r=new _e(t);return r.baseTexture.on("dispose",()=>{delete e.promiseCache[n]}),r}const k2=[".jpeg",".jpg",".png",".webp",".avif"],B2=["image/jpeg","image/png","image/webp","image/avif"];function Fg(){return(Fg=re(function*(t){const e=yield ce.ADAPTER.fetch(t);if(!e.ok)throw new Error(`[loadImageBitmap] Failed to fetch ${t}: ${e.status} ${e.statusText}`);const n=yield e.blob();return yield createImageBitmap(n)})).apply(this,arguments)}const jc={name:"loadTextures",extension:{type:fe.LoadParser,priority:jr.High},config:{preferWorkers:!0,preferCreateImageBitmap:!0,crossOrigin:"anonymous"},test:t=>tl(t,B2)||ls(t,k2),load(t,e,n){var r=this;return re(function*(){let i=null;i=globalThis.createImageBitmap&&r.config.preferCreateImageBitmap?r.config.preferWorkers&&(yield dD.isImageBitmapSupported())?yield dD.loadImageBitmap(t):yield function U2(t){return Fg.apply(this,arguments)}(t):yield new Promise(o=>{i=new Image,i.crossOrigin=r.config.crossOrigin,i.src=t,i.complete?o(i):i.onload=()=>{o(i)}});const s=new $e(i,{resolution:Di(t),...e.data});return s.resource.src=t,Gc(s,n,t)})()},unload(t){t.destroy(!0)}};Te.add(jc);const G2={extension:{type:fe.LoadParser,priority:jr.High},name:"loadSVG",test:t=>tl(t,"image/svg+xml")||ls(t,".svg"),testParse:t=>re(function*(){return Ya.test(t)})(),parse:(t,e,n)=>re(function*(){const r=new Ya(t,e?.data?.resourceOptions);yield r.load();const i=new $e(r,{resolution:Di(t),...e?.data});return i.resource.src=t,Gc(i,n,t)})(),load:(t,e)=>re(function*(){return(yield ce.ADAPTER.fetch(t)).text()})(),unload:jc.unload};function fD(t,e,n,r,i){const s=e[n];for(let o=0;o<s.length;o++){const a=s[o];n<e.length-1?fD(t.replace(r[n],a),e,n+1,r,i):i.push(t.replace(r[n],a))}}function j2(t){const n=t.match(/\{(.*?)\}/g),r=[];if(n){const i=[];n.forEach(s=>{const o=s.substring(1,s.length-1).split(",");i.push(o)}),fD(t,i,0,n,r)}else r.push(t);return r}Te.add(G2);class $2{constructor(){this._defaultBundleIdentifierOptions={connector:"-",createBundleAssetId:(e,n)=>`${e}${this._bundleIdConnector}${n}`,extractAssetIdFromBundle:(e,n)=>n.replace(`${e}${this._bundleIdConnector}`,"")},this._bundleIdConnector=this._defaultBundleIdentifierOptions.connector,this._createBundleAssetId=this._defaultBundleIdentifierOptions.createBundleAssetId,this._extractAssetIdFromBundle=this._defaultBundleIdentifierOptions.extractAssetIdFromBundle,this._assetMap={},this._preferredOrder=[],this._parsers=[],this._resolverHash={},this._bundles={}}setBundleIdentifier(e){if(this._bundleIdConnector=e.connector??this._bundleIdConnector,this._createBundleAssetId=e.createBundleAssetId??this._createBundleAssetId,this._extractAssetIdFromBundle=e.extractAssetIdFromBundle??this._extractAssetIdFromBundle,"bar"!==this._extractAssetIdFromBundle("foo",this._createBundleAssetId("foo","bar")))throw new Error("[Resolver] GenerateBundleAssetId are not working correctly")}prefer(...e){e.forEach(n=>{this._preferredOrder.push(n),n.priority||(n.priority=Object.keys(n.params))}),this._resolverHash={}}set basePath(e){this._basePath=e}get basePath(){return this._basePath}set rootPath(e){this._rootPath=e}get rootPath(){return this._rootPath}get parsers(){return this._parsers}reset(){this.setBundleIdentifier(this._defaultBundleIdentifierOptions),this._assetMap={},this._preferredOrder=[],this._resolverHash={},this._rootPath=null,this._basePath=null,this._manifest=null,this._bundles={},this._defaultSearchParams=null}setDefaultSearchParams(e){if("string"==typeof e)this._defaultSearchParams=e;else{const n=e;this._defaultSearchParams=Object.keys(n).map(r=>`${encodeURIComponent(r)}=${encodeURIComponent(n[r])}`).join("&")}}addManifest(e){this._manifest&&console.warn("[Resolver] Manifest already exists, this will be overwritten"),this._manifest=e,e.bundles.forEach(n=>{this.addBundle(n.name,n.assets)})}addBundle(e,n){const r=[];Array.isArray(n)?n.forEach(i=>{if("string"==typeof i.name){const s=this._createBundleAssetId(e,i.name);r.push(s),this.add([i.name,s],i.srcs,i.data)}else{const s=i.name.map(o=>this._createBundleAssetId(e,o));s.forEach(o=>{r.push(o)}),this.add([...i.name,...s],i.srcs)}}):Object.keys(n).forEach(i=>{r.push(this._createBundleAssetId(e,i)),this.add([i,this._createBundleAssetId(e,i)],n[i])}),this._bundles[e]=r}add(e,n,r){const i=ci(e);i.forEach(o=>{this.hasKey(o)&&console.warn(`[Resolver] already has key: ${o} overwriting`)}),Array.isArray(n)||(n="string"==typeof n?j2(n):[n]);const s=n.map(o=>{let a=o;if("string"==typeof o){let l=!1;for(let u=0;u<this._parsers.length;u++){const c=this._parsers[u];if(c.test(o)){a=c.parse(o),l=!0;break}}l||(a={src:o})}return a.format||(a.format=a.src.split(".").pop()),a.alias||(a.alias=i),(this._basePath||this._rootPath)&&(a.src=hn.toAbsolute(a.src,this._basePath,this._rootPath)),a.src=this._appendDefaultSearchParams(a.src),a.data=a.data??r,a});i.forEach(o=>{this._assetMap[o]=s})}resolveBundle(e){const n=Vc(e);e=ci(e);const r={};return e.forEach(i=>{const s=this._bundles[i];if(s){const o=this.resolve(s),a={};for(const l in o){const u=o[l];a[this._extractAssetIdFromBundle(i,l)]=u}r[i]=a}}),n?r[e[0]]:r}resolveUrl(e){const n=this.resolve(e);if("string"!=typeof e){const r={};for(const i in n)r[i]=n[i].src;return r}return n.src}resolve(e){const n=Vc(e);e=ci(e);const r={};return e.forEach(i=>{if(!this._resolverHash[i])if(this._assetMap[i]){let s=this._assetMap[i];const o=this._getPreferredOrder(s),a=s[0];o?.priority.forEach(l=>{o.params[l].forEach(u=>{const c=s.filter(h=>!!h[l]&&h[l]===u);c.length&&(s=c)})}),this._resolverHash[i]=s[0]??a}else{let s=i;(this._basePath||this._rootPath)&&(s=hn.toAbsolute(s,this._basePath,this._rootPath)),s=this._appendDefaultSearchParams(s),this._resolverHash[i]={src:s}}r[i]=this._resolverHash[i]}),n?r[e[0]]:r}hasKey(e){return!!this._assetMap[e]}hasBundle(e){return!!this._bundles[e]}_getPreferredOrder(e){for(let n=0;n<e.length;n++){const r=e[0],i=this._preferredOrder.find(s=>s.params.format.includes(r.format));if(i)return i}return this._preferredOrder[0]}_appendDefaultSearchParams(e){return this._defaultSearchParams?`${e}${/\?/.test(e)?"&":"?"}${this._defaultSearchParams}`:e}}const fn=new class z2{constructor(){this._detections=[],this._initialized=!1,this.resolver=new $2,this.loader=new w2,this.cache=el,this._backgroundLoader=new v2(this.loader),this._backgroundLoader.active=!0,this.reset()}init(e={}){var n=this;return re(function*(){if(n._initialized)return void console.warn("[Assets]AssetManager already initialized, did you load before calling this Asset.init()?");if(n._initialized=!0,e.defaultSearchParams&&n.resolver.setDefaultSearchParams(e.defaultSearchParams),e.basePath&&(n.resolver.basePath=e.basePath),e.bundleIdentifier&&n.resolver.setBundleIdentifier(e.bundleIdentifier),e.manifest){let o=e.manifest;"string"==typeof o&&(o=yield n.load(o)),n.resolver.addManifest(o)}const r=e.texturePreference?.resolution??1,i="number"==typeof r?[r]:r;let s=[];if(e.texturePreference?.format){const o=e.texturePreference?.format;s="string"==typeof o?[o]:o;for(const a of n._detections)(yield a.test())||(s=yield a.remove(s))}else for(const o of n._detections)(yield o.test())&&(s=yield o.add(s));n.resolver.prefer({params:{format:s,resolution:i}}),e.preferences&&n.setPreferences(e.preferences)})()}add(e,n,r){this.resolver.add(e,n,r)}load(e,n){var r=this;return re(function*(){r._initialized||(yield r.init());const i=Vc(e),s=ci(e).map(l=>"string"!=typeof l?(r.resolver.add(l.src,l),l.src):(r.resolver.hasKey(l)||r.resolver.add(l,l),l)),o=r.resolver.resolve(s),a=yield r._mapLoadToResolve(o,n);return i?a[s[0]]:a})()}addBundle(e,n){this.resolver.addBundle(e,n)}loadBundle(e,n){var r=this;return re(function*(){r._initialized||(yield r.init());let i=!1;"string"==typeof e&&(i=!0,e=[e]);const s=r.resolver.resolveBundle(e),o={},a=Object.keys(s);let l=0,u=0;const c=()=>{n?.(++l/u)},h=a.map(d=>{const f=s[d];return u+=Object.keys(f).length,r._mapLoadToResolve(f,c).then(p=>{o[d]=p})});return yield Promise.all(h),i?o[e[0]]:o})()}backgroundLoad(e){var n=this;return re(function*(){n._initialized||(yield n.init()),"string"==typeof e&&(e=[e]);const r=n.resolver.resolve(e);n._backgroundLoader.add(Object.values(r))})()}backgroundLoadBundle(e){var n=this;return re(function*(){n._initialized||(yield n.init()),"string"==typeof e&&(e=[e]);const r=n.resolver.resolveBundle(e);Object.values(r).forEach(i=>{n._backgroundLoader.add(Object.values(i))})})()}reset(){this.resolver.reset(),this.loader.reset(),this.cache.reset(),this._initialized=!1}get(e){if("string"==typeof e)return el.get(e);const n={};for(let r=0;r<e.length;r++)n[r]=el.get(e[r]);return n}_mapLoadToResolve(e,n){var r=this;return re(function*(){const i=Object.values(e),s=Object.keys(e);r._backgroundLoader.active=!1;const o=yield r.loader.load(i,n);r._backgroundLoader.active=!0;const a={};return i.forEach((l,u)=>{const c=o[l.src],h=[l.src];l.alias&&h.push(...l.alias),a[s[u]]=c,el.set(h,c)}),a})()}unload(e){var n=this;return re(function*(){n._initialized||(yield n.init());const r=ci(e).map(s=>"string"!=typeof s?s.src:s),i=n.resolver.resolve(r);yield n._unloadFromResolved(i)})()}unloadBundle(e){var n=this;return re(function*(){n._initialized||(yield n.init()),e=ci(e);const r=n.resolver.resolveBundle(e),i=Object.keys(r).map(s=>n._unloadFromResolved(r[s]));yield Promise.all(i)})()}_unloadFromResolved(e){var n=this;return re(function*(){const r=Object.values(e);r.forEach(i=>{el.remove(i.src)}),yield n.loader.unload(r)})()}get detections(){return this._detections}get preferWorkers(){return jc.config.preferWorkers}set preferWorkers(e){Ye("7.2.0","Assets.prefersWorkers is deprecated, use Assets.setPreferences({ preferWorkers: true }) instead."),this.setPreferences({preferWorkers:e})}setPreferences(e){this.loader.parsers.forEach(n=>{n.config&&Object.keys(n.config).filter(r=>r in e).forEach(r=>{n.config[r]=e[r]})})}};Te.handleByList(fe.LoadParser,fn.loader.parsers).handleByList(fe.ResolveParser,fn.resolver.parsers).handleByList(fe.CacheParser,fn.cache.parsers).handleByList(fe.DetectionParser,fn.detections);const W2={extension:fe.CacheParser,test:t=>Array.isArray(t)&&t.every(e=>e instanceof _e),getCacheableAssets:(t,e)=>{const n={};return t.forEach(r=>{e.forEach((i,s)=>{n[r+(0===s?"":s+1)]=i})}),n}};Te.add(W2);const X2={extension:{type:fe.DetectionParser,priority:1},test:(t=re(function*(){if(!globalThis.createImageBitmap)return!1;const n=yield ce.ADAPTER.fetch("data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A=").then(r=>r.blob());return createImageBitmap(n).then(()=>!0,()=>!1)}),function(){return t.apply(this,arguments)}),add:function(){var t=re(function*(e){return[...e,"avif"]});return function(n){return t.apply(this,arguments)}}(),remove:function(){var t=re(function*(e){return e.filter(n=>"avif"!==n)});return function(n){return t.apply(this,arguments)}}()};var t;Te.add(X2);const Y2={extension:{type:fe.DetectionParser,priority:0},test:function(){var t=re(function*(){if(!globalThis.createImageBitmap)return!1;const n=yield ce.ADAPTER.fetch("data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA=").then(r=>r.blob());return createImageBitmap(n).then(()=>!0,()=>!1)});return function(){return t.apply(this,arguments)}}(),add:function(){var t=re(function*(e){return[...e,"webp"]});return function(n){return t.apply(this,arguments)}}(),remove:function(){var t=re(function*(e){return e.filter(n=>"webp"!==n)});return function(n){return t.apply(this,arguments)}}()};Te.add(Y2);const pD=["png","jpg","jpeg"],q2={extension:{type:fe.DetectionParser,priority:-1},test:()=>Promise.resolve(!0),add:function(){var t=re(function*(e){return[...e,...pD]});return function(n){return t.apply(this,arguments)}}(),remove:function(){var t=re(function*(e){return e.filter(n=>!pD.includes(n))});return function(n){return t.apply(this,arguments)}}()};Te.add(q2);const Z2={extension:fe.ResolveParser,test:jc.test,parse:t=>({resolution:parseFloat(ce.RETINA_PREFIX.exec(t)?.[1]??"1"),format:t.split(".").pop(),src:t})};Te.add(Z2);const Lg=(t,e)=>{const n=e.split("?")[1];return n&&(t+=`?${n}`),t};var Vn=(t=>(t[t.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",t[t.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917]="COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT",t[t.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918]="COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT",t[t.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919]="COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT",t[t.COMPRESSED_SRGB_S3TC_DXT1_EXT=35916]="COMPRESSED_SRGB_S3TC_DXT1_EXT",t[t.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",t[t.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",t[t.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",t[t.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",t[t.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",t[t.COMPRESSED_RGBA8_ETC2_EAC=37496]="COMPRESSED_RGBA8_ETC2_EAC",t[t.COMPRESSED_SRGB8_ETC2=37493]="COMPRESSED_SRGB8_ETC2",t[t.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37497]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",t[t.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37494]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",t[t.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37495]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",t[t.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",t[t.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",t[t.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",t[t.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",t[t.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",t[t.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",t[t.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35986]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",t[t.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL",t[t.COMPRESSED_RGBA_ASTC_4x4_KHR=37808]="COMPRESSED_RGBA_ASTC_4x4_KHR",t))(Vn||{});const $c={33776:.5,33777:.5,33778:1,33779:1,35916:.5,35917:.5,35918:1,35919:1,37488:.5,37489:.5,37490:1,37491:1,37492:.5,37496:1,37493:.5,37497:1,37494:.5,37495:.5,35840:.5,35842:.5,35841:.25,35843:.25,36196:.5,35986:.5,35986:1,34798:1,37808:1};let hi,Do;function gD(){Do={s3tc:hi.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:hi.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:hi.getExtension("WEBGL_compressed_texture_etc"),etc1:hi.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:hi.getExtension("WEBGL_compressed_texture_pvrtc")||hi.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:hi.getExtension("WEBGL_compressed_texture_atc"),astc:hi.getExtension("WEBGL_compressed_texture_astc")}}const K2={extension:{type:fe.DetectionParser,priority:2},test:function(){var t=re(function*(){const n=ce.ADAPTER.createCanvas().getContext("webgl");return n?(hi=n,!0):(console.warn("WebGL not available for compressed textures."),!1)});return function(){return t.apply(this,arguments)}}(),add:function(){var t=re(function*(e){Do||gD();const n=[];for(const r in Do)Do[r]&&n.push(r);return[...n,...e]});return function(n){return t.apply(this,arguments)}}(),remove:function(){var t=re(function*(e){return Do||gD(),e.filter(n=>!(n in Do))});return function(n){return t.apply(this,arguments)}}()};Te.add(K2);class Q2 extends Ga{constructor(e,n={width:1,height:1,autoLoad:!0}){let r,i;"string"==typeof e?(r=e,i=new Uint8Array):(r=null,i=e),super(i,n),this.origin=r,this.buffer=i?new Yp(i):null,this._load=null,this.loaded=!1,null!==this.origin&&!1!==n.autoLoad&&this.load(),null===this.origin&&this.buffer&&(this._load=Promise.resolve(this),this.loaded=!0,this.onBlobLoaded(this.buffer.rawBinaryData))}onBlobLoaded(e){}load(){return this._load||(this._load=fetch(this.origin).then(e=>e.blob()).then(e=>e.arrayBuffer()).then(e=>(this.data=new Uint32Array(e),this.buffer=new Yp(e),this.loaded=!0,this.onBlobLoaded(e),this.update(),this))),this._load}}class us extends Q2{constructor(e,n){super(e,n),this.format=n.format,this.levels=n.levels||1,this._width=n.width,this._height=n.height,this._extension=us._formatToExtension(this.format),(n.levelBuffers||this.buffer)&&(this._levelBuffers=n.levelBuffers||us._createLevelBuffers(e instanceof Uint8Array?e:this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height))}upload(e,n,r){const i=e.gl;if(!e.context.extensions[this._extension])throw new Error(`${this._extension} textures are not supported on the current machine`);if(!this._levelBuffers)return!1;for(let o=0,a=this.levels;o<a;o++){const{levelID:l,levelWidth:u,levelHeight:c,levelBuffer:h}=this._levelBuffers[o];i.compressedTexImage2D(i.TEXTURE_2D,l,this.format,u,c,0,h)}return!0}onBlobLoaded(){this._levelBuffers=us._createLevelBuffers(this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height)}static _formatToExtension(e){if(e>=33776&&e<=33779)return"s3tc";if(e>=37488&&e<=37497)return"etc";if(e>=35840&&e<=35843)return"pvrtc";if(e>=36196)return"etc1";if(e>=35986&&e<=34798)return"atc";throw new Error("Invalid (compressed) texture format given!")}static _createLevelBuffers(e,n,r,i,s,o,a){const l=new Array(r);let u=e.byteOffset,c=o,h=a,d=c+i-1&~(i-1),f=h+s-1&~(s-1),p=d*f*$c[n];for(let g=0;g<r;g++)l[g]={levelID:g,levelWidth:r>1?c:d,levelHeight:r>1?h:f,levelBuffer:new Uint8Array(e.buffer,u,p)},u+=p,c=c>>1||1,h=h>>1||1,d=c+i-1&~(i-1),f=h+s-1&~(s-1),p=d*f*$c[n];return l}}const g3={827611204:Vn.COMPRESSED_RGBA_S3TC_DXT1_EXT,861165636:Vn.COMPRESSED_RGBA_S3TC_DXT3_EXT,894720068:Vn.COMPRESSED_RGBA_S3TC_DXT5_EXT},m3={70:Vn.COMPRESSED_RGBA_S3TC_DXT1_EXT,71:Vn.COMPRESSED_RGBA_S3TC_DXT1_EXT,73:Vn.COMPRESSED_RGBA_S3TC_DXT3_EXT,74:Vn.COMPRESSED_RGBA_S3TC_DXT3_EXT,76:Vn.COMPRESSED_RGBA_S3TC_DXT5_EXT,77:Vn.COMPRESSED_RGBA_S3TC_DXT5_EXT,72:Vn.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT,75:Vn.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT,78:Vn.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT},yD=[171,75,84,88,32,49,49,187,13,10,26,10],_D={[Re.UNSIGNED_BYTE]:1,[Re.UNSIGNED_SHORT]:2,[Re.INT]:4,[Re.UNSIGNED_INT]:4,[Re.FLOAT]:4,[Re.HALF_FLOAT]:8},v3={[K.RGBA]:4,[K.RGB]:3,[K.RG]:2,[K.RED]:1,[K.LUMINANCE]:1,[K.LUMINANCE_ALPHA]:2,[K.ALPHA]:1},x3={[Re.UNSIGNED_SHORT_4_4_4_4]:2,[Re.UNSIGNED_SHORT_5_5_5_1]:2,[Re.UNSIGNED_SHORT_5_6_5]:2};function b3(t){switch(t){case K.RGBA:return K.RGBA_INTEGER;case K.RGB:return K.RGB_INTEGER;case K.RG:return K.RG_INTEGER;case K.RED:return K.RED_INTEGER;default:return t}}const S3={extension:{type:fe.LoadParser,priority:jr.High},name:"loadDDS",test:t=>ls(t,".dds"),load:(t,e,n)=>re(function*(){const o=function y3(t){const e=new Uint32Array(t);if(542327876!==e[0])throw new Error("Invalid DDS file magic word");const r=new Uint32Array(t,0,124/Uint32Array.BYTES_PER_ELEMENT),i=r[3],s=r[4],o=r[7],a=new Uint32Array(t,19*Uint32Array.BYTES_PER_ELEMENT,32/Uint32Array.BYTES_PER_ELEMENT),l=a[1];if(4&l){const u=a[2];if(808540228!==u){const D=g3[u],$=new Uint8Array(t,128);return[new us($,{format:D,width:s,height:i,levels:o})]}const h=new Uint32Array(e.buffer,128,20/Uint32Array.BYTES_PER_ELEMENT),d=h[0],f=h[1],p=h[2],g=h[3],m=m3[d];if(void 0===m)throw new Error(`DDSParser cannot parse texture data with DXGI format ${d}`);if(4===p)throw new Error("DDSParser does not support cubemap textures");if(6===f)throw new Error("DDSParser does not supported 3D texture data");const _=new Array,v=148;if(1===g)_.push(new Uint8Array(t,v));else{const D=$c[m];let A=0,$=s,ge=i;for(let J=0;J<o;J++)A+=Math.max(1,$+3&-4)*Math.max(1,ge+3&-4)*D,$>>>=1,ge>>>=1;let Q=v;for(let J=0;J<g;J++)_.push(new Uint8Array(t,Q,A)),Q+=A}return _.map(D=>new us(D,{format:m,width:s,height:i,levels:o}))}throw 64&l?new Error("DDSParser does not support uncompressed texture data."):512&l?new Error("DDSParser does not supported YUV uncompressed texture data."):131072&l?new Error("DDSParser does not support single-channel (lumninance) texture data!"):2&l?new Error("DDSParser does not support single-channel (alpha) texture data!"):new Error("DDSParser failed to load a texture file due to an unknown reason!")}(yield(yield ce.ADAPTER.fetch(t)).arrayBuffer()).map(a=>Gc(new $e(a,{mipmap:Br.OFF,alphaMode:ar.NO_PREMULTIPLIED_ALPHA,resolution:Di(t),...e.data}),n,t));return 1===o.length?o[0]:o})(),unload(t){Array.isArray(t)?t.forEach(e=>e.destroy(!0)):t.destroy(!0)}};Te.add(S3);const T3={extension:{type:fe.LoadParser,priority:jr.High},name:"loadKTX",test:t=>ls(t,".ktx"),load:(t,e,n)=>re(function*(){const i=yield(yield ce.ADAPTER.fetch(t)).arrayBuffer(),{compressed:s,uncompressed:o,kvData:a}=function w3(t,e,n=!1){const r=new DataView(e);if(!function E3(t,e){for(let n=0;n<yD.length;n++)if(e.getUint8(n)!==yD[n])return console.error(`${t} is not a valid *.ktx file!`),!1;return!0}(t,r))return null;const i=67305985===r.getUint32(12,!0),s=r.getUint32(16,i),o=r.getUint32(24,i),a=r.getUint32(28,i),l=r.getUint32(36,i),u=r.getUint32(40,i)||1,c=r.getUint32(44,i)||1,h=r.getUint32(48,i)||1,d=r.getUint32(52,i),f=r.getUint32(56,i),p=r.getUint32(60,i);if(0===u||1!==c)throw new Error("Only 2D textures are supported");if(1!==d)throw new Error("CubeTextures are not supported by KTXLoader yet!");if(1!==h)throw new Error("WebGL does not support array textures");const _=l+3&-4,v=u+3&-4,D=new Array(h);let $,A=l*u;if(0===s&&(A=_*v),$=0!==s?_D[s]?_D[s]*v3[o]:x3[s]:$c[a],void 0===$)throw new Error("Unable to resolve the pixel format stored in the *.ktx file!");const ge=n?function D3(t,e,n){const r=new Map;let i=0;for(;i<e;){const s=t.getUint32(64+i,n),o=64+i+4,a=3-(s+3)%4;if(0===s||s>e-i){console.error("KTXLoader: keyAndValueByteSize out of bounds");break}let l=0;for(;l<s&&0!==t.getUint8(o+l);l++);if(-1===l){console.error("KTXLoader: Failed to find null byte terminating kvData key");break}const u=(new TextDecoder).decode(new Uint8Array(t.buffer,o,l)),c=new DataView(t.buffer,o+l+1,s-l-1);r.set(u,c),i+=4+s+a}return r}(r,p,i):null;let J=A*$,Ve=l,ee=u,he=_,st=v,X=64+p;for(let Y=0;Y<f;Y++){const St=r.getUint32(X,i);let Qe=X+4;for(let qe=0;qe<h;qe++){let Tt=D[qe];Tt||(Tt=D[qe]=new Array(f)),Tt[Y]={levelID:Y,levelWidth:f>1||0!==s?Ve:he,levelHeight:f>1||0!==s?ee:st,levelBuffer:new Uint8Array(e,Qe,J)},Qe+=J}X+=St+4,X=X%4!=0?X+4-X%4:X,Ve=Ve>>1||1,ee=ee>>1||1,he=Ve+4-1&-4,st=ee+4-1&-4,J=he*st*$}return 0!==s?{uncompressed:D.map(Y=>{let St=Y[0].levelBuffer,Qe=!1;return s===Re.FLOAT?St=new Float32Array(Y[0].levelBuffer.buffer,Y[0].levelBuffer.byteOffset,Y[0].levelBuffer.byteLength/4):s===Re.UNSIGNED_INT?(Qe=!0,St=new Uint32Array(Y[0].levelBuffer.buffer,Y[0].levelBuffer.byteOffset,Y[0].levelBuffer.byteLength/4)):s===Re.INT&&(Qe=!0,St=new Int32Array(Y[0].levelBuffer.buffer,Y[0].levelBuffer.byteOffset,Y[0].levelBuffer.byteLength/4)),{resource:new Ga(St,{width:Y[0].levelWidth,height:Y[0].levelHeight}),type:s,format:Qe?b3(o):o}}),kvData:ge}:{compressed:D.map(Y=>new us(null,{format:a,width:l,height:u,levels:f,levelBuffers:Y})),kvData:ge}}(t,i),l=s??o,u={mipmap:Br.OFF,alphaMode:ar.NO_PREMULTIPLIED_ALPHA,resolution:Di(t),...e.data},c=l.map(h=>{l===o&&Object.assign(u,{type:h.type,format:h.format});const d=new $e(h,u);return d.ktxKeyValueData=a,Gc(d,n,t)});return 1===c.length?c[0]:c})(),unload(t){Array.isArray(t)?t.forEach(e=>e.destroy(!0)):t.destroy(!0)}};Te.add(T3);const C3={extension:fe.ResolveParser,test:t=>{const n=t.split("?")[0].split(".").pop();return["basis","ktx","dds"].includes(n)},parse:t=>{if("ktx"===t.split("?")[0].split(".").pop()){const r=[".s3tc.ktx",".s3tc_sRGB.ktx",".etc.ktx",".etc1.ktx",".pvrt.ktx",".atc.ktx",".astc.ktx"];if(r.some(i=>t.endsWith(i)))return{resolution:parseFloat(ce.RETINA_PREFIX.exec(t)?.[1]??"1"),format:r.find(i=>t.endsWith(i)),src:t}}return{resolution:parseFloat(ce.RETINA_PREFIX.exec(t)?.[1]??"1"),format:t.split(".").pop(),src:t}}};Te.add(C3);const I3=new et,nl=class{constructor(t){this.renderer=t}image(t,e,n){var r=this;return re(function*(){const i=new Image;return i.src=yield r.base64(t,e,n),i})()}base64(t,e,n){var r=this;return re(function*(){const i=r.canvas(t);if(void 0!==i.toBlob)return new Promise((s,o)=>{i.toBlob(a=>{if(!a)return void o(new Error("ICanvas.toBlob failed!"));const l=new FileReader;l.onload=()=>s(l.result),l.onerror=o,l.readAsDataURL(a)},e,n)});if(void 0!==i.toDataURL)return i.toDataURL(e,n);if(void 0!==i.convertToBlob){const s=yield i.convertToBlob({type:e,quality:n});return new Promise((o,a)=>{const l=new FileReader;l.onload=()=>o(l.result),l.onerror=a,l.readAsDataURL(s)})}throw new Error("Extract.base64() requires ICanvas.toDataURL, ICanvas.toBlob, or ICanvas.convertToBlob to be implemented")})()}canvas(t,e){const{pixels:n,width:r,height:i,flipY:s}=this._rawPixels(t,e);s&&nl._flipY(n,r,i),nl._unpremultiplyAlpha(n);const o=new ck(r,i,1),a=new ImageData(new Uint8ClampedArray(n.buffer),r,i);return o.context.putImageData(a,0,0),o.canvas}pixels(t,e){const{pixels:n,width:r,height:i,flipY:s}=this._rawPixels(t,e);return s&&nl._flipY(n,r,i),nl._unpremultiplyAlpha(n),n}_rawPixels(t,e){const n=this.renderer;if(!n)throw new Error("The Extract has already been destroyed");let r,s,i=!1,o=!1;if(t&&(t instanceof is?s=t:(s=n.generateTexture(t,{resolution:n.resolution,multisample:n.multisample}),o=!0)),s){if(r=s.baseTexture.resolution,e=e??s.frame,i=!1,!o){n.renderTexture.bind(s);const h=s.framebuffer.glFramebuffers[n.CONTEXT_UID];h.blitFramebuffer&&n.framebuffer.bind(h.blitFramebuffer)}}else r=n.resolution,e||((e=I3).width=n.width/r,e.height=n.height/r),i=!0,n.renderTexture.bind();const a=Math.round(e.width*r),l=Math.round(e.height*r),u=new Uint8Array(4*a*l),c=n.gl;return c.readPixels(Math.round(e.x*r),Math.round(e.y*r),a,l,c.RGBA,c.UNSIGNED_BYTE,u),o&&s?.destroy(!0),{pixels:u,width:a,height:l,flipY:i}}destroy(){this.renderer=null}static _flipY(t,e,n){const r=e<<2,i=n>>1,s=new Uint8Array(r);for(let o=0;o<i;o++){const a=o*r,l=(n-o-1)*r;s.set(t.subarray(a,a+r)),t.copyWithin(a,l,l+r),t.set(s,l)}}static _unpremultiplyAlpha(t){t instanceof Uint8ClampedArray&&(t=new Uint8Array(t.buffer));const e=t.length;for(let n=0;n<e;n+=4){const r=t[n+3];if(0!==r){const i=255.001/r;t[n]=t[n]*i+.5,t[n+1]=t[n+1]*i+.5,t[n+2]=t[n+2]*i+.5}}}};let vD=nl;vD.extension={name:"extract",type:fe.RendererSystem},Te.add(vD);class M3{constructor(e,n){this.uvBuffer=e,this.uvMatrix=n,this.data=null,this._bufferUpdateId=-1,this._textureUpdateId=-1,this._updateID=0}update(e){if(!e&&this._bufferUpdateId===this.uvBuffer._updateID&&this._textureUpdateId===this.uvMatrix._updateID)return;this._bufferUpdateId=this.uvBuffer._updateID,this._textureUpdateId=this.uvMatrix._updateID;const n=this.uvBuffer.data;(!this.data||this.data.length!==n.length)&&(this.data=new Float32Array(n.length)),this.uvMatrix.multiplyUvs(n,this.data),this._updateID++}}const Ug=new ut,xD=new Ji,wD=class extends on{constructor(t,e,n,r=Lr.TRIANGLES){super(),this.geometry=t,this.shader=e,this.state=n||li.for2d(),this.drawMode=r,this.start=0,this.size=0,this.uvs=null,this.indices=null,this.vertexData=new Float32Array(1),this.vertexDirty=-1,this._transformID=-1,this._roundPixels=ce.ROUND_PIXELS,this.batchUvs=null}get geometry(){return this._geometry}set geometry(t){this._geometry!==t&&(this._geometry&&(this._geometry.refCount--,0===this._geometry.refCount&&this._geometry.dispose()),this._geometry=t,this._geometry&&this._geometry.refCount++,this.vertexDirty=-1)}get uvBuffer(){return this.geometry.buffers[1]}get verticesBuffer(){return this.geometry.buffers[0]}set material(t){this.shader=t}get material(){return this.shader}set blendMode(t){this.state.blendMode=t}get blendMode(){return this.state.blendMode}set roundPixels(t){this._roundPixels!==t&&(this._transformID=-1),this._roundPixels=t}get roundPixels(){return this._roundPixels}get tint(){return"tint"in this.shader?this.shader.tint:null}set tint(t){this.shader.tint=t}get tintValue(){return this.shader.tintValue}get texture(){return"texture"in this.shader?this.shader.texture:null}set texture(t){this.shader.texture=t}_render(t){this.shader.batchable&&this.drawMode===Lr.TRIANGLES&&this.geometry.buffers[0].data.length<2*wD.BATCHABLE_SIZE?this._renderToBatch(t):this._renderDefault(t)}_renderDefault(t){const e=this.shader;e.alpha=this.worldAlpha,e.update&&e.update(),t.batch.flush(),e.uniforms.translationMatrix=this.transform.worldTransform.toArray(!0),t.shader.bind(e),t.state.set(this.state),t.geometry.bind(this.geometry,e),t.geometry.draw(this.drawMode,this.size,this.start,this.geometry.instanceCount)}_renderToBatch(t){const e=this.geometry,n=this.shader;n.uvMatrix&&(n.uvMatrix.update(),this.calculateUvs()),this.calculateVertices(),this.indices=e.indexBuffer.data,this._tintRGB=n._tintRGB,this._texture=n.texture;const r=this.material.pluginName;t.batch.setObjectRenderer(t.plugins[r]),t.plugins[r].render(this)}calculateVertices(){const e=this.geometry.buffers[0],n=e.data,r=e._updateID;if(r===this.vertexDirty&&this._transformID===this.transform._worldID)return;this._transformID=this.transform._worldID,this.vertexData.length!==n.length&&(this.vertexData=new Float32Array(n.length));const i=this.transform.worldTransform,s=i.a,o=i.b,a=i.c,l=i.d,u=i.tx,c=i.ty,h=this.vertexData;for(let d=0;d<h.length/2;d++){const f=n[2*d],p=n[2*d+1];h[2*d]=s*f+a*p+u,h[2*d+1]=o*f+l*p+c}if(this._roundPixels){const d=ce.RESOLUTION;for(let f=0;f<h.length;++f)h[f]=Math.round(h[f]*d)/d}this.vertexDirty=r}calculateUvs(){const t=this.geometry.buffers[1],e=this.shader;e.uvMatrix.isSimple?this.uvs=t.data:(this.batchUvs||(this.batchUvs=new M3(t,e.uvMatrix)),this.batchUvs.update(),this.uvs=this.batchUvs.data)}_calculateBounds(){this.calculateVertices(),this._bounds.addVertexData(this.vertexData,0,this.vertexData.length)}containsPoint(t){if(!this.getBounds().contains(t.x,t.y))return!1;this.worldTransform.applyInverse(t,Ug);const e=this.geometry.getBuffer("aVertexPosition").data,n=xD.points,r=this.geometry.getIndex().data,i=r.length,s=4===this.drawMode?3:1;for(let o=0;o+2<i;o+=s){const a=2*r[o],l=2*r[o+1],u=2*r[o+2];if(n[0]=e[a],n[1]=e[a+1],n[2]=e[l],n[3]=e[l+1],n[4]=e[u],n[5]=e[u+1],xD.contains(Ug.x,Ug.y))return!0}return!1}destroy(t){super.destroy(t),this._cachedTexture&&(this._cachedTexture.destroy(),this._cachedTexture=null),this.geometry=null,this.shader=null,this.state=null,this.uvs=null,this.indices=null,this.vertexData=null}};let Hg=wD;Hg.BATCHABLE_SIZE=100;class R3 extends Si{constructor(e,n,r){super();const i=new jt(e),s=new jt(n,!0),o=new jt(r,!0,!0);this.addAttribute("aVertexPosition",i,2,!1,Re.FLOAT).addAttribute("aTextureCoord",s,2,!1,Re.FLOAT).addIndex(o),this._updateId=-1}get vertexDirtyId(){return this.buffers[0]._updateID}}class ED extends Gr{constructor(e,n){const r={uSampler:e,alpha:1,uTextureMatrix:Pt.IDENTITY,uColor:new Float32Array([1,1,1,1])};(n=Object.assign({tint:16777215,alpha:1,pluginName:"batch"},n)).uniforms&&Object.assign(r,n.uniforms),super(n.program||cr.from("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTextureMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;\n}\n","varying vec2 vTextureCoord;\nuniform vec4 uColor;\n\nuniform sampler2D uSampler;\n\nvoid main(void)\n{\n    gl_FragColor = texture2D(uSampler, vTextureCoord) * uColor;\n}\n"),r),this._colorDirty=!1,this.uvMatrix=new hg(e),this.batchable=void 0===n.program,this.pluginName=n.pluginName,this._tintColor=new ft(n.tint),this._tintRGB=this._tintColor.toLittleEndianNumber(),this._colorDirty=!0,this.alpha=n.alpha}get texture(){return this.uniforms.uSampler}set texture(e){this.uniforms.uSampler!==e&&(!this.uniforms.uSampler.baseTexture.alphaMode!=!e.baseTexture.alphaMode&&(this._colorDirty=!0),this.uniforms.uSampler=e,this.uvMatrix.texture=e)}set alpha(e){e!==this._alpha&&(this._alpha=e,this._colorDirty=!0)}get alpha(){return this._alpha}set tint(e){e!==this.tint&&(this._tintColor.setValue(e),this._tintRGB=this._tintColor.toLittleEndianNumber(),this._colorDirty=!0)}get tint(){return this._tintColor.value}get tintValue(){return this._tintColor.toNumber()}update(){if(this._colorDirty){this._colorDirty=!1;const n=this.texture.baseTexture.alphaMode;ft.shared.setValue(this._tintColor).premultiply(this._alpha,n).toArray(this.uniforms.uColor)}this.uvMatrix.update()&&(this.uniforms.uTextureMatrix=this.uvMatrix.mapCoord)}}class bD{constructor(e,n,r){this.geometry=new Si,this.indexBuffer=null,this.size=r,this.dynamicProperties=[],this.staticProperties=[];for(let i=0;i<e.length;++i){let s=e[i];s={attributeName:s.attributeName,size:s.size,uploadFunction:s.uploadFunction,type:s.type||Re.FLOAT,offset:s.offset},n[i]?this.dynamicProperties.push(s):this.staticProperties.push(s)}this.staticStride=0,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.dynamicStride=0,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this._updateID=0,this.initBuffers()}initBuffers(){const e=this.geometry;let n=0;this.indexBuffer=new jt(function ak(t,e=null){const n=6*t;if((e=e||new Uint16Array(n)).length!==n)throw new Error(`Out buffer length is incorrect, got ${e.length} and expected ${n}`);for(let r=0,i=0;r<n;r+=6,i+=4)e[r+0]=i+0,e[r+1]=i+1,e[r+2]=i+2,e[r+3]=i+0,e[r+4]=i+2,e[r+5]=i+3;return e}(this.size),!0,!0),e.addIndex(this.indexBuffer),this.dynamicStride=0;for(let o=0;o<this.dynamicProperties.length;++o){const a=this.dynamicProperties[o];a.offset=n,n+=a.size,this.dynamicStride+=a.size}const r=new ArrayBuffer(this.size*this.dynamicStride*4*4);this.dynamicData=new Float32Array(r),this.dynamicDataUint32=new Uint32Array(r),this.dynamicBuffer=new jt(this.dynamicData,!1,!1);let i=0;this.staticStride=0;for(let o=0;o<this.staticProperties.length;++o){const a=this.staticProperties[o];a.offset=i,i+=a.size,this.staticStride+=a.size}const s=new ArrayBuffer(this.size*this.staticStride*4*4);this.staticData=new Float32Array(s),this.staticDataUint32=new Uint32Array(s),this.staticBuffer=new jt(this.staticData,!0,!1);for(let o=0;o<this.dynamicProperties.length;++o){const a=this.dynamicProperties[o];e.addAttribute(a.attributeName,this.dynamicBuffer,0,a.type===Re.UNSIGNED_BYTE,a.type,4*this.dynamicStride,4*a.offset)}for(let o=0;o<this.staticProperties.length;++o){const a=this.staticProperties[o];e.addAttribute(a.attributeName,this.staticBuffer,0,a.type===Re.UNSIGNED_BYTE,a.type,4*this.staticStride,4*a.offset)}}uploadDynamic(e,n,r){for(let i=0;i<this.dynamicProperties.length;i++){const s=this.dynamicProperties[i];s.uploadFunction(e,n,r,s.type===Re.UNSIGNED_BYTE?this.dynamicDataUint32:this.dynamicData,this.dynamicStride,s.offset)}this.dynamicBuffer._updateID++}uploadStatic(e,n,r){for(let i=0;i<this.staticProperties.length;i++){const s=this.staticProperties[i];s.uploadFunction(e,n,r,s.type===Re.UNSIGNED_BYTE?this.staticDataUint32:this.staticData,this.staticStride,s.offset)}this.staticBuffer._updateID++}destroy(){this.indexBuffer=null,this.dynamicProperties=null,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this.staticProperties=null,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.geometry.destroy()}}class DD extends wc{constructor(e){super(e),this.shader=null,this.properties=null,this.tempMatrix=new Pt,this.properties=[{attributeName:"aVertexPosition",size:2,uploadFunction:this.uploadVertices,offset:0},{attributeName:"aPositionCoord",size:2,uploadFunction:this.uploadPosition,offset:0},{attributeName:"aRotation",size:1,uploadFunction:this.uploadRotation,offset:0},{attributeName:"aTextureCoord",size:2,uploadFunction:this.uploadUvs,offset:0},{attributeName:"aColor",size:1,type:Re.UNSIGNED_BYTE,uploadFunction:this.uploadTint,offset:0}],this.shader=Gr.from("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\n\nattribute vec2 aPositionCoord;\nattribute float aRotation;\n\nuniform mat3 translationMatrix;\nuniform vec4 uColor;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nvoid main(void){\n    float x = (aVertexPosition.x) * cos(aRotation) - (aVertexPosition.y) * sin(aRotation);\n    float y = (aVertexPosition.x) * sin(aRotation) + (aVertexPosition.y) * cos(aRotation);\n\n    vec2 v = vec2(x, y);\n    v = v + aPositionCoord;\n\n    gl_Position = vec4((translationMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vColor = aColor * uColor;\n}\n","varying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n    vec4 color = texture2D(uSampler, vTextureCoord) * vColor;\n    gl_FragColor = color;\n}",{}),this.state=li.for2d()}render(e){const n=e.children,r=e._maxSize,i=e._batchSize,s=this.renderer;let o=n.length;if(0===o)return;o>r&&!e.autoResize&&(o=r);let a=e._buffers;a||(a=e._buffers=this.generateBuffers(e));const l=n[0]._texture.baseTexture,u=l.alphaMode>0;this.state.blendMode=YE(e.blendMode,u),s.state.set(this.state);const c=s.gl,h=e.worldTransform.copyTo(this.tempMatrix);h.prepend(s.globalUniforms.uniforms.projectionMatrix),this.shader.uniforms.translationMatrix=h.toArray(!0),this.shader.uniforms.uColor=ft.shared.setValue(e.tintRgb).premultiply(e.worldAlpha,u).toArray(this.shader.uniforms.uColor),this.shader.uniforms.uSampler=l,this.renderer.shader.bind(this.shader);let d=!1;for(let f=0,p=0;f<o;f+=i,p+=1){let g=o-f;g>i&&(g=i),p>=a.length&&a.push(this._generateOneMoreBuffer(e));const m=a[p];m.uploadDynamic(n,f,g),d=d||m._updateID<(e._bufferUpdateIDs[p]||0),d&&(m._updateID=e._updateID,m.uploadStatic(n,f,g)),s.geometry.bind(m.geometry),c.drawElements(c.TRIANGLES,6*g,c.UNSIGNED_SHORT,0)}}generateBuffers(e){const n=[],r=e._maxSize,i=e._batchSize,s=e._properties;for(let o=0;o<r;o+=i)n.push(new bD(this.properties,s,i));return n}_generateOneMoreBuffer(e){return new bD(this.properties,e._properties,e._batchSize)}uploadVertices(e,n,r,i,s,o){let a=0,l=0,u=0,c=0;for(let h=0;h<r;++h){const d=e[n+h],f=d._texture,p=d.scale.x,g=d.scale.y,m=f.trim,_=f.orig;m?(l=m.x-d.anchor.x*_.width,a=l+m.width,c=m.y-d.anchor.y*_.height,u=c+m.height):(a=_.width*(1-d.anchor.x),l=_.width*-d.anchor.x,u=_.height*(1-d.anchor.y),c=_.height*-d.anchor.y),i[o]=l*p,i[o+1]=c*g,i[o+s]=a*p,i[o+s+1]=c*g,i[o+2*s]=a*p,i[o+2*s+1]=u*g,i[o+3*s]=l*p,i[o+3*s+1]=u*g,o+=4*s}}uploadPosition(e,n,r,i,s,o){for(let a=0;a<r;a++){const l=e[n+a].position;i[o]=l.x,i[o+1]=l.y,i[o+s]=l.x,i[o+s+1]=l.y,i[o+2*s]=l.x,i[o+2*s+1]=l.y,i[o+3*s]=l.x,i[o+3*s+1]=l.y,o+=4*s}}uploadRotation(e,n,r,i,s,o){for(let a=0;a<r;a++){const l=e[n+a].rotation;i[o]=l,i[o+s]=l,i[o+2*s]=l,i[o+3*s]=l,o+=4*s}}uploadUvs(e,n,r,i,s,o){for(let a=0;a<r;++a){const l=e[n+a]._texture._uvs;l?(i[o]=l.x0,i[o+1]=l.y0,i[o+s]=l.x1,i[o+s+1]=l.y1,i[o+2*s]=l.x2,i[o+2*s+1]=l.y2,i[o+3*s]=l.x3,i[o+3*s+1]=l.y3,o+=4*s):(i[o]=0,i[o+1]=0,i[o+s]=0,i[o+s+1]=0,i[o+2*s]=0,i[o+2*s+1]=0,i[o+3*s]=0,i[o+3*s+1]=0,o+=4*s)}}uploadTint(e,n,r,i,s,o){for(let a=0;a<r;++a){const l=e[n+a],u=ft.shared.setValue(l._tintRGB).toPremultiplied(l.alpha,l.texture.baseTexture.alphaMode>0);i[o]=u,i[o+s]=u,i[o+2*s]=u,i[o+3*s]=u,o+=4*s}}destroy(){super.destroy(),this.shader&&(this.shader.destroy(),this.shader=null),this.tempMatrix=null}}DD.extension={name:"particle",type:fe.RendererPlugin},Te.add(DD);var qc=(t=>(t[t.LINEAR_VERTICAL=0]="LINEAR_VERTICAL",t[t.LINEAR_HORIZONTAL=1]="LINEAR_HORIZONTAL",t))(qc||{});const Zc={willReadFrequently:!0},Se=class{static get experimentalLetterSpacingSupported(){let t=Se._experimentalLetterSpacingSupported;if(void 0!==t){const e=ce.ADAPTER.getCanvasRenderingContext2D().prototype;t=Se._experimentalLetterSpacingSupported="letterSpacing"in e||"textLetterSpacing"in e}return t}constructor(t,e,n,r,i,s,o,a,l){this.text=t,this.style=e,this.width=n,this.height=r,this.lines=i,this.lineWidths=s,this.lineHeight=o,this.maxLineWidth=a,this.fontProperties=l}static measureText(t,e,n,r=Se._canvas){n=n??e.wordWrap;const i=e.toFontString(),s=Se.measureFont(i);0===s.fontSize&&(s.fontSize=e.fontSize,s.ascent=e.fontSize);const o=r.getContext("2d",Zc);o.font=i;const l=(n?Se.wordWrap(t,e,r):t).split(/(?:\r\n|\r|\n)/),u=new Array(l.length);let c=0;for(let p=0;p<l.length;p++){const g=Se._measureText(l[p],e.letterSpacing,o);u[p]=g,c=Math.max(c,g)}let h=c+e.strokeThickness;e.dropShadow&&(h+=e.dropShadowDistance);const d=e.lineHeight||s.fontSize+e.strokeThickness;let f=Math.max(d,s.fontSize+2*e.strokeThickness)+(l.length-1)*(d+e.leading);return e.dropShadow&&(f+=e.dropShadowDistance),new Se(t,e,h,f,l,u,d+e.leading,c,s)}static _measureText(t,e,n){let r=!1;Se.experimentalLetterSpacingSupported&&(Se.experimentalLetterSpacing?(n.letterSpacing=`${e}px`,n.textLetterSpacing=`${e}px`,r=!0):(n.letterSpacing="0px",n.textLetterSpacing="0px"));let i=n.measureText(t).width;return i>0&&(r?i-=e:i+=(Se.graphemeSegmenter(t).length-1)*e),i}static wordWrap(t,e,n=Se._canvas){const r=n.getContext("2d",Zc);let i=0,s="",o="";const a=Object.create(null),{letterSpacing:l,whiteSpace:u}=e,c=Se.collapseSpaces(u),h=Se.collapseNewlines(u);let d=!c;const f=e.wordWrapWidth+l,p=Se.tokenize(t);for(let g=0;g<p.length;g++){let m=p[g];if(Se.isNewline(m)){if(!h){o+=Se.addLine(s),d=!c,s="",i=0;continue}m=" "}if(c){const v=Se.isBreakingSpace(m),D=Se.isBreakingSpace(s[s.length-1]);if(v&&D)continue}const _=Se.getFromCache(m,l,a,r);if(_>f)if(""!==s&&(o+=Se.addLine(s),s="",i=0),Se.canBreakWords(m,e.breakWords)){const v=Se.wordWrapSplit(m);for(let D=0;D<v.length;D++){let A=v[D],$=A,ge=1;for(;v[D+ge];){const J=v[D+ge];if(Se.canBreakChars($,J,m,D,e.breakWords))break;A+=J,$=J,ge++}D+=ge-1;const Q=Se.getFromCache(A,l,a,r);Q+i>f&&(o+=Se.addLine(s),d=!1,s="",i=0),s+=A,i+=Q}}else s.length>0&&(o+=Se.addLine(s),s="",i=0),o+=Se.addLine(m,!(g===p.length-1)),d=!1,s="",i=0;else _+i>f&&(d=!1,o+=Se.addLine(s),s="",i=0),(s.length>0||!Se.isBreakingSpace(m)||d)&&(s+=m,i+=_)}return o+=Se.addLine(s,!1),o}static addLine(t,e=!0){return t=Se.trimRight(t),e?`${t}\n`:t}static getFromCache(t,e,n,r){let i=n[t];return"number"!=typeof i&&(i=Se._measureText(t,e,r)+e,n[t]=i),i}static collapseSpaces(t){return"normal"===t||"pre-line"===t}static collapseNewlines(t){return"normal"===t}static trimRight(t){if("string"!=typeof t)return"";for(let e=t.length-1;e>=0&&Se.isBreakingSpace(t[e]);e--)t=t.slice(0,-1);return t}static isNewline(t){return"string"==typeof t&&Se._newlines.includes(t.charCodeAt(0))}static isBreakingSpace(t,e){return"string"==typeof t&&Se._breakingSpaces.includes(t.charCodeAt(0))}static tokenize(t){const e=[];let n="";if("string"!=typeof t)return e;for(let r=0;r<t.length;r++){const i=t[r];Se.isBreakingSpace(i,t[r+1])||Se.isNewline(i)?(""!==n&&(e.push(n),n=""),e.push(i)):n+=i}return""!==n&&e.push(n),e}static canBreakWords(t,e){return e}static canBreakChars(t,e,n,r,i){return!0}static wordWrapSplit(t){return Se.graphemeSegmenter(t)}static measureFont(t){if(Se._fonts[t])return Se._fonts[t];const e={ascent:0,descent:0,fontSize:0},n=Se._canvas,r=Se._context;r.font=t;const i=Se.METRICS_STRING+Se.BASELINE_SYMBOL,s=Math.ceil(r.measureText(i).width);let o=Math.ceil(r.measureText(Se.BASELINE_SYMBOL).width);const a=Math.ceil(Se.HEIGHT_MULTIPLIER*o);if(o=o*Se.BASELINE_MULTIPLIER|0,0===s||0===a)return Se._fonts[t]=e,e;n.width=s,n.height=a,r.fillStyle="#f00",r.fillRect(0,0,s,a),r.font=t,r.textBaseline="alphabetic",r.fillStyle="#000",r.fillText(i,0,o);const l=r.getImageData(0,0,s,a).data,u=l.length,c=4*s;let h=0,d=0,f=!1;for(h=0;h<o;++h){for(let p=0;p<c;p+=4)if(255!==l[d+p]){f=!0;break}if(f)break;d+=c}for(e.ascent=o-h,d=u-c,f=!1,h=a;h>o;--h){for(let p=0;p<c;p+=4)if(255!==l[d+p]){f=!0;break}if(f)break;d-=c}return e.descent=h-o,e.fontSize=e.ascent+e.descent,Se._fonts[t]=e,e}static clearMetrics(t=""){t?delete Se._fonts[t]:Se._fonts={}}static get _canvas(){if(!Se.__canvas){let t;try{const e=new OffscreenCanvas(0,0);if(e.getContext("2d",Zc)?.measureText)return Se.__canvas=e,e;t=ce.ADAPTER.createCanvas()}catch{t=ce.ADAPTER.createCanvas()}t.width=t.height=10,Se.__canvas=t}return Se.__canvas}static get _context(){return Se.__context||(Se.__context=Se._canvas.getContext("2d",Zc)),Se.__context}};let an=Se;an.METRICS_STRING="|\xc9q\xc5",an.BASELINE_SYMBOL="M",an.BASELINE_MULTIPLIER=1.4,an.HEIGHT_MULTIPLIER=2,an.graphemeSegmenter=(()=>{if("function"==typeof Intl?.Segmenter){const t=new Intl.Segmenter;return e=>[...t.segment(e)].map(n=>n.segment)}return t=>[...t]})(),an.experimentalLetterSpacing=!1,an._fonts={},an._newlines=[10,13],an._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];const L3=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],rl=class{constructor(t){this.styleID=0,this.reset(),Gg(this,t,t)}clone(){const t={};return Gg(t,this,rl.defaultStyle),new rl(t)}reset(){Gg(this,rl.defaultStyle,rl.defaultStyle)}get align(){return this._align}set align(t){this._align!==t&&(this._align=t,this.styleID++)}get breakWords(){return this._breakWords}set breakWords(t){this._breakWords!==t&&(this._breakWords=t,this.styleID++)}get dropShadow(){return this._dropShadow}set dropShadow(t){this._dropShadow!==t&&(this._dropShadow=t,this.styleID++)}get dropShadowAlpha(){return this._dropShadowAlpha}set dropShadowAlpha(t){this._dropShadowAlpha!==t&&(this._dropShadowAlpha=t,this.styleID++)}get dropShadowAngle(){return this._dropShadowAngle}set dropShadowAngle(t){this._dropShadowAngle!==t&&(this._dropShadowAngle=t,this.styleID++)}get dropShadowBlur(){return this._dropShadowBlur}set dropShadowBlur(t){this._dropShadowBlur!==t&&(this._dropShadowBlur=t,this.styleID++)}get dropShadowColor(){return this._dropShadowColor}set dropShadowColor(t){const e=Vg(t);this._dropShadowColor!==e&&(this._dropShadowColor=e,this.styleID++)}get dropShadowDistance(){return this._dropShadowDistance}set dropShadowDistance(t){this._dropShadowDistance!==t&&(this._dropShadowDistance=t,this.styleID++)}get fill(){return this._fill}set fill(t){const e=Vg(t);this._fill!==e&&(this._fill=e,this.styleID++)}get fillGradientType(){return this._fillGradientType}set fillGradientType(t){this._fillGradientType!==t&&(this._fillGradientType=t,this.styleID++)}get fillGradientStops(){return this._fillGradientStops}set fillGradientStops(t){(function k3(t,e){if(!Array.isArray(t)||!Array.isArray(e)||t.length!==e.length)return!1;for(let n=0;n<t.length;++n)if(t[n]!==e[n])return!1;return!0})(this._fillGradientStops,t)||(this._fillGradientStops=t,this.styleID++)}get fontFamily(){return this._fontFamily}set fontFamily(t){this.fontFamily!==t&&(this._fontFamily=t,this.styleID++)}get fontSize(){return this._fontSize}set fontSize(t){this._fontSize!==t&&(this._fontSize=t,this.styleID++)}get fontStyle(){return this._fontStyle}set fontStyle(t){this._fontStyle!==t&&(this._fontStyle=t,this.styleID++)}get fontVariant(){return this._fontVariant}set fontVariant(t){this._fontVariant!==t&&(this._fontVariant=t,this.styleID++)}get fontWeight(){return this._fontWeight}set fontWeight(t){this._fontWeight!==t&&(this._fontWeight=t,this.styleID++)}get letterSpacing(){return this._letterSpacing}set letterSpacing(t){this._letterSpacing!==t&&(this._letterSpacing=t,this.styleID++)}get lineHeight(){return this._lineHeight}set lineHeight(t){this._lineHeight!==t&&(this._lineHeight=t,this.styleID++)}get leading(){return this._leading}set leading(t){this._leading!==t&&(this._leading=t,this.styleID++)}get lineJoin(){return this._lineJoin}set lineJoin(t){this._lineJoin!==t&&(this._lineJoin=t,this.styleID++)}get miterLimit(){return this._miterLimit}set miterLimit(t){this._miterLimit!==t&&(this._miterLimit=t,this.styleID++)}get padding(){return this._padding}set padding(t){this._padding!==t&&(this._padding=t,this.styleID++)}get stroke(){return this._stroke}set stroke(t){const e=Vg(t);this._stroke!==e&&(this._stroke=e,this.styleID++)}get strokeThickness(){return this._strokeThickness}set strokeThickness(t){this._strokeThickness!==t&&(this._strokeThickness=t,this.styleID++)}get textBaseline(){return this._textBaseline}set textBaseline(t){this._textBaseline!==t&&(this._textBaseline=t,this.styleID++)}get trim(){return this._trim}set trim(t){this._trim!==t&&(this._trim=t,this.styleID++)}get whiteSpace(){return this._whiteSpace}set whiteSpace(t){this._whiteSpace!==t&&(this._whiteSpace=t,this.styleID++)}get wordWrap(){return this._wordWrap}set wordWrap(t){this._wordWrap!==t&&(this._wordWrap=t,this.styleID++)}get wordWrapWidth(){return this._wordWrapWidth}set wordWrapWidth(t){this._wordWrapWidth!==t&&(this._wordWrapWidth=t,this.styleID++)}toFontString(){const t="number"==typeof this.fontSize?`${this.fontSize}px`:this.fontSize;let e=this.fontFamily;Array.isArray(this.fontFamily)||(e=this.fontFamily.split(","));for(let n=e.length-1;n>=0;n--){let r=e[n].trim();!/([\"\'])[^\'\"]+\1/.test(r)&&!L3.includes(r)&&(r=`"${r}"`),e[n]=r}return`${this.fontStyle} ${this.fontVariant} ${this.fontWeight} ${t} ${e.join(",")}`}};let Kn=rl;function Vg(t){const e=ft.shared;return Array.isArray(t)?t.map(n=>e.setValue(n).toHex()):e.setValue(t).toHex()}function Gg(t,e,n){for(const r in n)t[r]=Array.isArray(e[r])?e[r].slice():e[r]}Kn.defaultStyle={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fillGradientType:qc.LINEAR_VERTICAL,fillGradientStops:[],fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",leading:0,letterSpacing:0,lineHeight:0,lineJoin:"miter",miterLimit:10,padding:0,stroke:"black",strokeThickness:0,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100};const B3={texture:!0,children:!1,baseTexture:!0},jg=class extends dn{constructor(t,e,n){let r=!1;n||(n=ce.ADAPTER.createCanvas(),r=!0),n.width=3,n.height=3;const i=_e.from(n);i.orig=new et,i.trim=new et,super(i),this._ownCanvas=r,this.canvas=n,this.context=n.getContext("2d",{willReadFrequently:!0}),this._resolution=jg.defaultResolution??ce.RESOLUTION,this._autoResolution=jg.defaultAutoResolution,this._text=null,this._style=null,this._styleListener=null,this._font="",this.text=t,this.style=e,this.localStyleID=-1}static get experimentalLetterSpacing(){return an.experimentalLetterSpacing}static set experimentalLetterSpacing(t){Ye("7.1.0","Text.experimentalLetterSpacing is deprecated, use TextMetrics.experimentalLetterSpacing"),an.experimentalLetterSpacing=t}updateText(t){const e=this._style;if(this.localStyleID!==e.styleID&&(this.dirty=!0,this.localStyleID=e.styleID),!this.dirty&&t)return;this._font=this._style.toFontString();const n=this.context,r=an.measureText(this._text||" ",this._style,this._style.wordWrap,this.canvas),s=r.height,o=r.lines,a=r.lineHeight,l=r.lineWidths,u=r.maxLineWidth,c=r.fontProperties;let h,d;this.canvas.width=Math.ceil(Math.ceil(Math.max(1,r.width)+2*e.padding)*this._resolution),this.canvas.height=Math.ceil(Math.ceil(Math.max(1,s)+2*e.padding)*this._resolution),n.scale(this._resolution,this._resolution),n.clearRect(0,0,this.canvas.width,this.canvas.height),n.font=this._font,n.lineWidth=e.strokeThickness,n.textBaseline=e.textBaseline,n.lineJoin=e.lineJoin,n.miterLimit=e.miterLimit;const f=e.dropShadow?2:1;for(let p=0;p<f;++p){const g=e.dropShadow&&0===p,m=g?Math.ceil(Math.max(1,s)+2*e.padding):0,_=m*this._resolution;if(g){n.fillStyle="black",n.strokeStyle="black";const A=e.dropShadowBlur*this._resolution,$=e.dropShadowDistance*this._resolution;n.shadowColor=ft.shared.setValue(e.dropShadowColor).setAlpha(e.dropShadowAlpha).toRgbaString(),n.shadowBlur=A,n.shadowOffsetX=Math.cos(e.dropShadowAngle)*$,n.shadowOffsetY=Math.sin(e.dropShadowAngle)*$+_}else n.fillStyle=this._generateFillStyle(e,o,r),n.strokeStyle=e.stroke,n.shadowColor="black",n.shadowBlur=0,n.shadowOffsetX=0,n.shadowOffsetY=0;let v=(a-c.fontSize)/2;a-c.fontSize<0&&(v=0);for(let D=0;D<o.length;D++)h=e.strokeThickness/2,d=e.strokeThickness/2+D*a+c.ascent+v,"right"===e.align?h+=u-l[D]:"center"===e.align&&(h+=(u-l[D])/2),e.stroke&&e.strokeThickness&&this.drawLetterSpacing(o[D],h+e.padding,d+e.padding-m,!0),e.fill&&this.drawLetterSpacing(o[D],h+e.padding,d+e.padding-m)}this.updateTexture()}drawLetterSpacing(t,e,n,r=!1){const s=this._style.letterSpacing;let o=!1;if(an.experimentalLetterSpacingSupported&&(an.experimentalLetterSpacing?(this.context.letterSpacing=`${s}px`,this.context.textLetterSpacing=`${s}px`,o=!0):(this.context.letterSpacing="0px",this.context.textLetterSpacing="0px")),0===s||o)return void(r?this.context.strokeText(t,e,n):this.context.fillText(t,e,n));let a=e;const l=an.graphemeSegmenter(t);let u=this.context.measureText(t).width,c=0;for(let h=0;h<l.length;++h){const d=l[h];r?this.context.strokeText(d,a,n):this.context.fillText(d,a,n);let f="";for(let p=h+1;p<l.length;++p)f+=l[p];c=this.context.measureText(f).width,a+=u-c+s,u=c}}updateTexture(){const t=this.canvas;if(this._style.trim){const s=function dk(t){const e=function hk(t){const{width:e,height:n}=t,r=t.getContext("2d",{willReadFrequently:!0});if(null===r)throw new TypeError("Failed to get canvas 2D context");const s=r.getImageData(0,0,e,n).data;let o=0,a=0,l=e-1,u=n-1;for(;a<n&&JE(s,e,a);)++a;if(a===n)return Wp.EMPTY;for(;JE(s,e,u);)--u;for(;eb(s,e,o,a,u);)++o;for(;eb(s,e,l,a,u);)--l;return++l,++u,new Wp(o,a,l,u)}(t),{width:n,height:r}=e;let i=null;if(!e.isEmpty()){const s=t.getContext("2d");if(null===s)throw new TypeError("Failed to get canvas 2D context");i=s.getImageData(e.left,e.top,n,r)}return{width:n,height:r,data:i}}(t);s.data&&(t.width=s.width,t.height=s.height,this.context.putImageData(s.data,0,0))}const e=this._texture,n=this._style,r=n.trim?0:n.padding,i=e.baseTexture;e.trim.width=e._frame.width=t.width/this._resolution,e.trim.height=e._frame.height=t.height/this._resolution,e.trim.x=-r,e.trim.y=-r,e.orig.width=e._frame.width-2*r,e.orig.height=e._frame.height-2*r,this._onTextureUpdate(),i.setRealSize(t.width,t.height,this._resolution),e.updateUvs(),this.dirty=!1}_render(t){this._autoResolution&&this._resolution!==t.resolution&&(this._resolution=t.resolution,this.dirty=!0),this.updateText(!0),super._render(t)}updateTransform(){this.updateText(!0),super.updateTransform()}getBounds(t,e){return this.updateText(!0),-1===this._textureID&&(t=!1),super.getBounds(t,e)}getLocalBounds(t){return this.updateText(!0),super.getLocalBounds.call(this,t)}_calculateBounds(){this.calculateVertices(),this._bounds.addQuad(this.vertexData)}_generateFillStyle(t,e,n){const r=t.fill;if(!Array.isArray(r))return r;if(1===r.length)return r[0];let i;const s=t.dropShadow?t.dropShadowDistance:0,o=t.padding||0,a=this.canvas.width/this._resolution-s-2*o,l=this.canvas.height/this._resolution-s-2*o,u=r.slice(),c=t.fillGradientStops.slice();if(!c.length){const h=u.length+1;for(let d=1;d<h;++d)c.push(d/h)}if(u.unshift(r[0]),c.unshift(0),u.push(r[r.length-1]),c.push(1),t.fillGradientType===qc.LINEAR_VERTICAL){i=this.context.createLinearGradient(a/2,o,a/2,l+o);const h=n.fontProperties.fontSize+t.strokeThickness;for(let d=0;d<e.length;d++){const f=n.lineHeight*(d-1)+h,p=n.lineHeight*d;let g=p;d>0&&f>p&&(g=(p+f)/2);const m=p+h,_=n.lineHeight*(d+1);let v=m;d+1<e.length&&_<m&&(v=(m+_)/2);const D=(v-g)/l;for(let A=0;A<u.length;A++){let $=0;$="number"==typeof c[A]?c[A]:A/u.length;let ge=Math.min(1,Math.max(0,g/l+$*D));ge=Number(ge.toFixed(5)),i.addColorStop(ge,u[A])}}}else{i=this.context.createLinearGradient(o,l/2,a+o,l/2);const h=u.length+1;let d=1;for(let f=0;f<u.length;f++){let p;p="number"==typeof c[f]?c[f]:d/h,i.addColorStop(p,u[f]),d++}}return i}destroy(t){"boolean"==typeof t&&(t={children:t}),t=Object.assign({},B3,t),super.destroy(t),this._ownCanvas&&(this.canvas.height=this.canvas.width=0),this.context=null,this.canvas=null,this._style=null}get width(){return this.updateText(!0),Math.abs(this.scale.x)*this._texture.orig.width}set width(t){this.updateText(!0);const e=bi(this.scale.x)||1;this.scale.x=e*t/this._texture.orig.width,this._width=t}get height(){return this.updateText(!0),Math.abs(this.scale.y)*this._texture.orig.height}set height(t){this.updateText(!0);const e=bi(this.scale.y)||1;this.scale.y=e*t/this._texture.orig.height,this._height=t}get style(){return this._style}set style(t){this._style=(t=t||{})instanceof Kn?t:new Kn(t),this.localStyleID=-1,this.dirty=!0}get text(){return this._text}set text(t){t=String(t??""),this._text!==t&&(this._text=t,this.dirty=!0)}get resolution(){return this._resolution}set resolution(t){this._autoResolution=!1,this._resolution!==t&&(this._resolution=t,this.dirty=!0)}};let So=jg;So.defaultAutoResolution=!0;class U3{constructor(e){this.maxItemsPerFrame=e,this.itemsLeft=0}beginFrame(){this.itemsLeft=this.maxItemsPerFrame}allowedToUpload(){return this.itemsLeft-- >0}}function H3(t,e){let n=!1;if(t?._textures?.length)for(let r=0;r<t._textures.length;r++)if(t._textures[r]instanceof _e){const i=t._textures[r].baseTexture;e.includes(i)||(e.push(i),n=!0)}return n}function V3(t,e){if(t.baseTexture instanceof $e){const n=t.baseTexture;return e.includes(n)||e.push(n),!0}return!1}function G3(t,e){if(t._texture&&t._texture instanceof _e){const n=t._texture.baseTexture;return e.includes(n)||e.push(n),!0}return!1}function j3(t,e){return e instanceof So&&(e.updateText(!0),!0)}function $3(t,e){if(e instanceof Kn){const n=e.toFontString();return an.measureFont(n),!0}return!1}function z3(t,e){if(t instanceof So){e.includes(t.style)||e.push(t.style),e.includes(t)||e.push(t);const n=t._texture.baseTexture;return e.includes(n)||e.push(n),!0}return!1}function W3(t,e){return t instanceof Kn&&(e.includes(t)||e.push(t),!0)}const SD=class{constructor(t){this.limiter=new U3(SD.uploadsPerFrame),this.renderer=t,this.uploadHookHelper=null,this.queue=[],this.addHooks=[],this.uploadHooks=[],this.completes=[],this.ticking=!1,this.delayedTick=()=>{this.queue&&this.prepareItems()},this.registerFindHook(z3),this.registerFindHook(W3),this.registerFindHook(H3),this.registerFindHook(V3),this.registerFindHook(G3),this.registerUploadHook(j3),this.registerUploadHook($3)}upload(t){return new Promise(e=>{t&&this.add(t),this.queue.length?(this.completes.push(e),this.ticking||(this.ticking=!0,Xt.system.addOnce(this.tick,this,Ii.UTILITY))):e()})}tick(){setTimeout(this.delayedTick,0)}prepareItems(){for(this.limiter.beginFrame();this.queue.length&&this.limiter.allowedToUpload();){const t=this.queue[0];let e=!1;if(t&&!t._destroyed)for(let n=0,r=this.uploadHooks.length;n<r;n++)if(this.uploadHooks[n](this.uploadHookHelper,t)){this.queue.shift(),e=!0;break}e||this.queue.shift()}if(this.queue.length)Xt.system.addOnce(this.tick,this,Ii.UTILITY);else{this.ticking=!1;const t=this.completes.slice(0);this.completes.length=0;for(let e=0,n=t.length;e<n;e++)t[e]()}}registerFindHook(t){return t&&this.addHooks.push(t),this}registerUploadHook(t){return t&&this.uploadHooks.push(t),this}add(t){for(let e=0,n=this.addHooks.length;e<n&&!this.addHooks[e](t,this.queue);e++);if(t instanceof on)for(let e=t.children.length-1;e>=0;e--)this.add(t.children[e]);return this}destroy(){this.ticking&&Xt.system.remove(this.tick,this),this.ticking=!1,this.addHooks=null,this.uploadHooks=null,this.renderer=null,this.completes=null,this.queue=null,this.limiter=null,this.uploadHookHelper=null}};let Kc=SD;function TD(t,e){return e instanceof $e&&(e._glTextures[t.CONTEXT_UID]||t.texture.bind(e),!0)}function X3(t,e){if(!(e instanceof ui))return!1;const{geometry:n}=e;e.finishPoly(),n.updateBatches();const{batches:r}=n;for(let i=0;i<r.length;i++){const{texture:s}=r[i].style;s&&TD(t,s.baseTexture)}return n.batchable||t.geometry.bind(n,e._resolveDirectShader(t)),!0}function Y3(t,e){return t instanceof ui&&(e.push(t),!0)}Kc.uploadsPerFrame=4,Object.defineProperties(ce,{UPLOADS_PER_FRAME:{get:()=>Kc.uploadsPerFrame,set(t){Ye("7.1.0","settings.UPLOADS_PER_FRAME is deprecated, use prepare.BasePrepare.uploadsPerFrame"),Kc.uploadsPerFrame=t}}});class CD extends Kc{constructor(e){super(e),this.uploadHookHelper=this.renderer,this.registerFindHook(Y3),this.registerUploadHook(TD),this.registerUploadHook(X3)}}CD.extension={name:"prepare",type:fe.RendererSystem},Te.add(CD);class Qc extends dn{constructor(e,n=!0){super(e[0]instanceof _e?e[0]:e[0].texture),this._textures=null,this._durations=null,this._autoUpdate=n,this._isConnectedToTicker=!1,this.animationSpeed=1,this.loop=!0,this.updateAnchor=!1,this.onComplete=null,this.onFrameChange=null,this.onLoop=null,this._currentTime=0,this._playing=!1,this._previousFrame=null,this.textures=e}stop(){this._playing&&(this._playing=!1,this._autoUpdate&&this._isConnectedToTicker&&(Xt.shared.remove(this.update,this),this._isConnectedToTicker=!1))}play(){this._playing||(this._playing=!0,this._autoUpdate&&!this._isConnectedToTicker&&(Xt.shared.add(this.update,this,Ii.HIGH),this._isConnectedToTicker=!0))}gotoAndStop(e){this.stop(),this.currentFrame=e}gotoAndPlay(e){this.currentFrame=e,this.play()}update(e){if(!this._playing)return;const n=this.animationSpeed*e,r=this.currentFrame;if(null!==this._durations){let i=this._currentTime%1*this._durations[this.currentFrame];for(i+=n/60*1e3;i<0;)this._currentTime--,i+=this._durations[this.currentFrame];const s=Math.sign(this.animationSpeed*e);for(this._currentTime=Math.floor(this._currentTime);i>=this._durations[this.currentFrame];)i-=this._durations[this.currentFrame]*s,this._currentTime+=s;this._currentTime+=i/this._durations[this.currentFrame]}else this._currentTime+=n;this._currentTime<0&&!this.loop?(this.gotoAndStop(0),this.onComplete&&this.onComplete()):this._currentTime>=this._textures.length&&!this.loop?(this.gotoAndStop(this._textures.length-1),this.onComplete&&this.onComplete()):r!==this.currentFrame&&(this.loop&&this.onLoop&&(this.animationSpeed>0&&this.currentFrame<r||this.animationSpeed<0&&this.currentFrame>r)&&this.onLoop(),this.updateTexture())}updateTexture(){const e=this.currentFrame;this._previousFrame!==e&&(this._previousFrame=e,this._texture=this._textures[e],this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this.uvs=this._texture._uvs.uvsFloat32,this.updateAnchor&&this._anchor.copyFrom(this._texture.defaultAnchor),this.onFrameChange&&this.onFrameChange(this.currentFrame))}destroy(e){this.stop(),super.destroy(e),this.onComplete=null,this.onFrameChange=null,this.onLoop=null}static fromFrames(e){const n=[];for(let r=0;r<e.length;++r)n.push(_e.from(e[r]));return new Qc(n)}static fromImages(e){const n=[];for(let r=0;r<e.length;++r)n.push(_e.from(e[r]));return new Qc(n)}get totalFrames(){return this._textures.length}get textures(){return this._textures}set textures(e){if(e[0]instanceof _e)this._textures=e,this._durations=null;else{this._textures=[],this._durations=[];for(let n=0;n<e.length;n++)this._textures.push(e[n].texture),this._durations.push(e[n].time)}this._previousFrame=null,this.gotoAndStop(0),this.updateTexture()}get currentFrame(){let e=Math.floor(this._currentTime)%this._textures.length;return e<0&&(e+=this._textures.length),e}set currentFrame(e){if(e<0||e>this.totalFrames-1)throw new Error(`[AnimatedSprite]: Invalid frame index value ${e}, expected to be between 0 and totalFrames ${this.totalFrames}.`);const n=this.currentFrame;this._currentTime=e,n!==this.currentFrame&&this.updateTexture()}get playing(){return this._playing}get autoUpdate(){return this._autoUpdate}set autoUpdate(e){e!==this._autoUpdate&&(this._autoUpdate=e,!this._autoUpdate&&this._isConnectedToTicker?(Xt.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._playing&&(Xt.shared.add(this.update,this),this._isConnectedToTicker=!0))}}const il=new ut;class sl extends dn{constructor(e,n=100,r=100){super(e),this.tileTransform=new mc,this._width=n,this._height=r,this.uvMatrix=this.texture.uvMatrix||new hg(e),this.pluginName="tilingSprite",this.uvRespectAnchor=!1}get clampMargin(){return this.uvMatrix.clampMargin}set clampMargin(e){this.uvMatrix.clampMargin=e,this.uvMatrix.update(!0)}get tileScale(){return this.tileTransform.scale}set tileScale(e){this.tileTransform.scale.copyFrom(e)}get tilePosition(){return this.tileTransform.position}set tilePosition(e){this.tileTransform.position.copyFrom(e)}_onTextureUpdate(){this.uvMatrix&&(this.uvMatrix.texture=this._texture),this._cachedTint=16777215}_render(e){const n=this._texture;!n||!n.valid||(this.tileTransform.updateLocalTransform(),this.uvMatrix.update(),e.batch.setObjectRenderer(e.plugins[this.pluginName]),e.plugins[this.pluginName].render(this))}_calculateBounds(){this._bounds.addFrame(this.transform,this._width*-this._anchor._x,this._height*-this._anchor._y,this._width*(1-this._anchor._x),this._height*(1-this._anchor._y))}getLocalBounds(e){return 0===this.children.length?(this._bounds.minX=this._width*-this._anchor._x,this._bounds.minY=this._height*-this._anchor._y,this._bounds.maxX=this._width*(1-this._anchor._x),this._bounds.maxY=this._height*(1-this._anchor._y),e||(this._localBoundsRect||(this._localBoundsRect=new et),e=this._localBoundsRect),this._bounds.getRectangle(e)):super.getLocalBounds.call(this,e)}containsPoint(e){this.worldTransform.applyInverse(e,il);const n=this._width,r=this._height,i=-n*this.anchor._x;if(il.x>=i&&il.x<i+n){const s=-r*this.anchor._y;if(il.y>=s&&il.y<s+r)return!0}return!1}destroy(e){super.destroy(e),this.tileTransform=null,this.uvMatrix=null}static from(e,n){const r=e instanceof _e?e:_e.from(e,n);return new sl(r,n.width,n.height)}get width(){return this._width}set width(e){this._width=e}get height(){return this._height}set height(e){this._height=e}}var ID="#version 100\n#define SHADER_NAME Tiling-Sprite-100\n\nprecision lowp float;\n\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTransform;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;\n}\n";const Jc=new Pt;class AD extends wc{constructor(e){super(e),e.runners.contextChange.add(this),this.quad=new _b,this.state=li.for2d()}contextChange(){const e=this.renderer,n={globals:e.globalUniforms};this.simpleShader=Gr.from(ID,"#version 100\n#define SHADER_NAME Tiling-Sprite-Simple-100\n\nprecision lowp float;\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\n\nvoid main(void)\n{\n    vec4 texSample = texture2D(uSampler, vTextureCoord);\n    gl_FragColor = texSample * uColor;\n}\n",n),this.shader=e.context.webGLVersion>1?Gr.from("#version 300 es\n#define SHADER_NAME Tiling-Sprite-300\n\nprecision lowp float;\n\nin vec2 aVertexPosition;\nin vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTransform;\n\nout vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;\n}\n","#version 300 es\n#define SHADER_NAME Tiling-Sprite-100\n\nprecision lowp float;\n\nin vec2 vTextureCoord;\n\nout vec4 fragmentColor;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\nuniform mat3 uMapCoord;\nuniform vec4 uClampFrame;\nuniform vec2 uClampOffset;\n\nvoid main(void)\n{\n    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);\n    coord = (uMapCoord * vec3(coord, 1.0)).xy;\n    vec2 unclamped = coord;\n    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);\n\n    vec4 texSample = texture(uSampler, coord, unclamped == coord ? 0.0f : -32.0f);// lod-bias very negative to force lod 0\n\n    fragmentColor = texSample * uColor;\n}\n",n):Gr.from(ID,"#version 100\n#ifdef GL_EXT_shader_texture_lod\n    #extension GL_EXT_shader_texture_lod : enable\n#endif\n#define SHADER_NAME Tiling-Sprite-100\n\nprecision lowp float;\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\nuniform mat3 uMapCoord;\nuniform vec4 uClampFrame;\nuniform vec2 uClampOffset;\n\nvoid main(void)\n{\n    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);\n    coord = (uMapCoord * vec3(coord, 1.0)).xy;\n    vec2 unclamped = coord;\n    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);\n\n    #ifdef GL_EXT_shader_texture_lod\n        vec4 texSample = unclamped == coord\n            ? texture2D(uSampler, coord) \n            : texture2DLodEXT(uSampler, coord, 0);\n    #else\n        vec4 texSample = texture2D(uSampler, coord);\n    #endif\n\n    gl_FragColor = texSample * uColor;\n}\n",n)}render(e){const n=this.renderer,r=this.quad;let i=r.vertices;i[0]=i[6]=e._width*-e.anchor.x,i[1]=i[3]=e._height*-e.anchor.y,i[2]=i[4]=e._width*(1-e.anchor.x),i[5]=i[7]=e._height*(1-e.anchor.y);const s=e.uvRespectAnchor?e.anchor.x:0,o=e.uvRespectAnchor?e.anchor.y:0;i=r.uvs,i[0]=i[6]=-s,i[1]=i[3]=-o,i[2]=i[4]=1-s,i[5]=i[7]=1-o,r.invalidate();const a=e._texture,l=a.baseTexture,u=l.alphaMode>0,c=e.tileTransform.localTransform,h=e.uvMatrix;let d=l.isPowerOfTwo&&a.frame.width===l.width&&a.frame.height===l.height;d&&(l._glTextures[n.CONTEXT_UID]?d=l.wrapMode!==Ei.CLAMP:l.wrapMode===Ei.CLAMP&&(l.wrapMode=Ei.REPEAT));const f=d?this.simpleShader:this.shader,p=a.width,g=a.height,m=e._width,_=e._height;Jc.set(c.a*p/m,c.b*p/_,c.c*g/m,c.d*g/_,c.tx/m,c.ty/_),Jc.invert(),d?Jc.prepend(h.mapCoord):(f.uniforms.uMapCoord=h.mapCoord.toArray(!0),f.uniforms.uClampFrame=h.uClampFrame,f.uniforms.uClampOffset=h.uClampOffset),f.uniforms.uTransform=Jc.toArray(!0),f.uniforms.uColor=ft.shared.setValue(e.tint).premultiply(e.worldAlpha,u).toArray(f.uniforms.uColor),f.uniforms.translationMatrix=e.transform.worldTransform.toArray(!0),f.uniforms.uSampler=a,n.shader.bind(f),n.geometry.bind(r),this.state.blendMode=YE(e.blendMode,u),n.state.set(this.state),n.geometry.draw(this.renderer.gl.TRIANGLES,6,0)}}AD.extension={name:"tilingSprite",type:fe.RendererPlugin},Te.add(AD);const ol=class{constructor(t,e,n=null){this.linkedSheets=[],this._texture=t instanceof _e?t:null,this.baseTexture=t instanceof $e?t:this._texture.baseTexture,this.textures={},this.animations={},this.data=e;const r=this.baseTexture.resource;this.resolution=this._updateResolution(n||(r?r.url:null)),this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}_updateResolution(t=null){const{scale:e}=this.data.meta;let n=Di(t,null);return null===n&&(n=parseFloat(e??"1")),1!==n&&this.baseTexture.setResolution(n),n}parse(){return new Promise(t=>{this._callback=t,this._batchIndex=0,this._frameKeys.length<=ol.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()})}_processFrames(t){let e=t;const n=ol.BATCH_SIZE;for(;e-t<n&&e<this._frameKeys.length;){const r=this._frameKeys[e],i=this._frames[r],s=i.frame;if(s){let o=null,a=null;const l=!1!==i.trimmed&&i.sourceSize?i.sourceSize:i.frame,u=new et(0,0,Math.floor(l.w)/this.resolution,Math.floor(l.h)/this.resolution);o=i.rotated?new et(Math.floor(s.x)/this.resolution,Math.floor(s.y)/this.resolution,Math.floor(s.h)/this.resolution,Math.floor(s.w)/this.resolution):new et(Math.floor(s.x)/this.resolution,Math.floor(s.y)/this.resolution,Math.floor(s.w)/this.resolution,Math.floor(s.h)/this.resolution),!1!==i.trimmed&&i.spriteSourceSize&&(a=new et(Math.floor(i.spriteSourceSize.x)/this.resolution,Math.floor(i.spriteSourceSize.y)/this.resolution,Math.floor(s.w)/this.resolution,Math.floor(s.h)/this.resolution)),this.textures[r]=new _e(this.baseTexture,o,u,a,i.rotated?2:0,i.anchor,i.borders),_e.addToCache(this.textures[r],r)}e++}}_processAnimations(){const t=this.data.animations||{};for(const e in t){this.animations[e]=[];for(let n=0;n<t[e].length;n++)this.animations[e].push(this.textures[t[e][n]])}}_parseComplete(){const t=this._callback;this._callback=null,this._batchIndex=0,t.call(this,this.textures)}_nextBatch(){this._processFrames(this._batchIndex*ol.BATCH_SIZE),this._batchIndex++,setTimeout(()=>{this._batchIndex*ol.BATCH_SIZE<this._frameKeys.length?this._nextBatch():(this._processAnimations(),this._parseComplete())},0)}destroy(t=!1){for(const e in this.textures)this.textures[e].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,t&&(this._texture?.destroy(),this.baseTexture.destroy()),this._texture=null,this.baseTexture=null,this.linkedSheets=[]}};let $g=ol;$g.BATCH_SIZE=1e3;const J3=["jpg","png","jpeg","avif","webp"];function MD(t,e,n){const r={};if(t.forEach(i=>{r[i]=e}),Object.keys(e.textures).forEach(i=>{r[i]=e.textures[i]}),!n){const i=hn.dirname(t[0]);e.linkedSheets.forEach((s,o)=>{const a=MD([`${i}/${e.data.meta.related_multi_packs[o]}`],s,!0);Object.assign(r,a)})}return r}const eU={extension:fe.Asset,cache:{test:t=>t instanceof $g,getCacheableAssets:(t,e)=>MD(t,e,!1)},resolver:{test:t=>{const n=t.split("?")[0].split("."),r=n.pop(),i=n.pop();return"json"===r&&J3.includes(i)},parse:t=>{const e=t.split(".");return{resolution:parseFloat(ce.RETINA_PREFIX.exec(t)?.[1]??"1"),format:e[e.length-2],src:t}}},loader:{name:"spritesheetLoader",extension:{type:fe.LoadParser,priority:jr.Normal},testParse:(t,e)=>re(function*(){return".json"===hn.extname(e.src).toLowerCase()&&!!t.frames})(),parse:(t,e,n)=>re(function*(){let r=hn.dirname(e.src);r&&r.lastIndexOf("/")!==r.length-1&&(r+="/");let i=r+t.meta.image;i=Lg(i,e.src);const o=(yield n.load([i]))[i],a=new $g(o.baseTexture,t,e.src);yield a.parse();const l=t?.meta?.related_multi_packs;if(Array.isArray(l)){const u=[];for(const h of l){if("string"!=typeof h)continue;let d=r+h;e.data?.ignoreMultiPack||(d=Lg(d,e.src),u.push(n.load({src:d,data:{ignoreMultiPack:!0}})))}const c=yield Promise.all(u);a.linkedSheets=c,c.forEach(h=>{h.linkedSheets=[a].concat(a.linkedSheets.filter(d=>d!==h))})}return a})(),unload(t){t.destroy(!0)}}};Te.add(eU);class eh{constructor(){this.info=[],this.common=[],this.page=[],this.char=[],this.kerning=[],this.distanceField=[]}}class th{static test(e){return"string"==typeof e&&e.startsWith("info face=")}static parse(e){const n=e.match(/^[a-z]+\s+.+$/gm),r={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[],distanceField:[]};for(const s in n){const o=n[s].match(/^[a-z]+/gm)[0],a=n[s].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),l={};for(const u in a){const c=a[u].split("="),h=c[0],d=c[1].replace(/"/gm,""),f=parseFloat(d),p=isNaN(f)?d:f;l[h]=p}r[o].push(l)}const i=new eh;return r.info.forEach(s=>i.info.push({face:s.face,size:parseInt(s.size,10)})),r.common.forEach(s=>i.common.push({lineHeight:parseInt(s.lineHeight,10)})),r.page.forEach(s=>i.page.push({id:parseInt(s.id,10),file:s.file})),r.char.forEach(s=>i.char.push({id:parseInt(s.id,10),page:parseInt(s.page,10),x:parseInt(s.x,10),y:parseInt(s.y,10),width:parseInt(s.width,10),height:parseInt(s.height,10),xoffset:parseInt(s.xoffset,10),yoffset:parseInt(s.yoffset,10),xadvance:parseInt(s.xadvance,10)})),r.kerning.forEach(s=>i.kerning.push({first:parseInt(s.first,10),second:parseInt(s.second,10),amount:parseInt(s.amount,10)})),r.distanceField.forEach(s=>i.distanceField.push({distanceRange:parseInt(s.distanceRange,10),fieldType:s.fieldType})),i}}class zg{static test(e){const n=e;return"getElementsByTagName"in n&&n.getElementsByTagName("page").length&&null!==n.getElementsByTagName("info")[0].getAttribute("face")}static parse(e){const n=new eh,r=e.getElementsByTagName("info"),i=e.getElementsByTagName("common"),s=e.getElementsByTagName("page"),o=e.getElementsByTagName("char"),a=e.getElementsByTagName("kerning"),l=e.getElementsByTagName("distanceField");for(let u=0;u<r.length;u++)n.info.push({face:r[u].getAttribute("face"),size:parseInt(r[u].getAttribute("size"),10)});for(let u=0;u<i.length;u++)n.common.push({lineHeight:parseInt(i[u].getAttribute("lineHeight"),10)});for(let u=0;u<s.length;u++)n.page.push({id:parseInt(s[u].getAttribute("id"),10)||0,file:s[u].getAttribute("file")});for(let u=0;u<o.length;u++){const c=o[u];n.char.push({id:parseInt(c.getAttribute("id"),10),page:parseInt(c.getAttribute("page"),10)||0,x:parseInt(c.getAttribute("x"),10),y:parseInt(c.getAttribute("y"),10),width:parseInt(c.getAttribute("width"),10),height:parseInt(c.getAttribute("height"),10),xoffset:parseInt(c.getAttribute("xoffset"),10),yoffset:parseInt(c.getAttribute("yoffset"),10),xadvance:parseInt(c.getAttribute("xadvance"),10)})}for(let u=0;u<a.length;u++)n.kerning.push({first:parseInt(a[u].getAttribute("first"),10),second:parseInt(a[u].getAttribute("second"),10),amount:parseInt(a[u].getAttribute("amount"),10)});for(let u=0;u<l.length;u++)n.distanceField.push({fieldType:l[u].getAttribute("fieldType"),distanceRange:parseInt(l[u].getAttribute("distanceRange"),10)});return n}}class Wg{static test(e){return!("string"!=typeof e||!e.includes("<font>"))&&zg.test(ce.ADAPTER.parseXML(e))}static parse(e){return zg.parse(ce.ADAPTER.parseXML(e))}}const Xg=[th,zg,Wg];function rU(t,e,n,r,i,s,o){const a=n.text,l=n.fontProperties;e.translate(r,i),e.scale(s,s);const u=o.strokeThickness/2,c=-o.strokeThickness/2;if(e.font=o.toFontString(),e.lineWidth=o.strokeThickness,e.textBaseline=o.textBaseline,e.lineJoin=o.lineJoin,e.miterLimit=o.miterLimit,e.fillStyle=function nU(t,e,n,r,i,s){const o=n.fill;if(!Array.isArray(o))return o;if(1===o.length)return o[0];let a;const l=n.dropShadow?n.dropShadowDistance:0,u=n.padding||0,c=t.width/r-l-2*u,h=t.height/r-l-2*u,d=o.slice(),f=n.fillGradientStops.slice();if(!f.length){const p=d.length+1;for(let g=1;g<p;++g)f.push(g/p)}if(d.unshift(o[0]),f.unshift(0),d.push(o[o.length-1]),f.push(1),n.fillGradientType===qc.LINEAR_VERTICAL){a=e.createLinearGradient(c/2,u,c/2,h+u);let p=0;const m=(s.fontProperties.fontSize+n.strokeThickness)/h;for(let _=0;_<i.length;_++){const v=s.lineHeight*_;for(let D=0;D<d.length;D++){let A=0;A="number"==typeof f[D]?f[D]:D/d.length;let ge=Math.max(p,v/h+A*m);ge=Math.min(ge,1),a.addColorStop(ge,d[D]),p=ge}}}else{a=e.createLinearGradient(u,h/2,c+u,h/2);const p=d.length+1;let g=1;for(let m=0;m<d.length;m++){let _;_="number"==typeof f[m]?f[m]:g/p,a.addColorStop(_,d[m]),g++}}return a}(t,e,o,s,[a],n),e.strokeStyle=o.stroke,o.dropShadow){const d=o.dropShadowBlur*s,f=o.dropShadowDistance*s;e.shadowColor=ft.shared.setValue(o.dropShadowColor).setAlpha(o.dropShadowAlpha).toRgbaString(),e.shadowBlur=d,e.shadowOffsetX=Math.cos(o.dropShadowAngle)*f,e.shadowOffsetY=Math.sin(o.dropShadowAngle)*f}else e.shadowColor="black",e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0;o.stroke&&o.strokeThickness&&e.strokeText(a,u,c+n.lineHeight-l.descent),o.fill&&e.fillText(a,u,c+n.lineHeight-l.descent),e.setTransform(1,0,0,1,0,0),e.fillStyle="rgba(0, 0, 0, 0)"}function RD(t){return Array.from?Array.from(t):t.split("")}function nh(t){return t.codePointAt?t.codePointAt(0):t.charCodeAt(0)}const _r=class{constructor(t,e,n){const[r]=t.info,[i]=t.common,[s]=t.page,[o]=t.distanceField,a=Di(s.file),l={};this._ownsTextures=n,this.font=r.face,this.size=r.size,this.lineHeight=i.lineHeight/a,this.chars={},this.pageTextures=l;for(let u=0;u<t.page.length;u++){const{id:c,file:h}=t.page[u];l[c]=e instanceof Array?e[u]:e[h],o?.fieldType&&"none"!==o.fieldType&&(l[c].baseTexture.alphaMode=ar.NO_PREMULTIPLIED_ALPHA,l[c].baseTexture.mipmap=Br.OFF)}for(let u=0;u<t.char.length;u++){const{id:c,page:h}=t.char[u];let{x:d,y:f,width:p,height:g,xoffset:m,yoffset:_,xadvance:v}=t.char[u];d/=a,f/=a,p/=a,g/=a,m/=a,_/=a,v/=a;const D=new et(d+l[h].frame.x/a,f+l[h].frame.y/a,p,g);this.chars[c]={xOffset:m,yOffset:_,xAdvance:v,kerning:{},texture:new _e(l[h].baseTexture,D),page:h}}for(let u=0;u<t.kerning.length;u++){let{first:c,second:h,amount:d}=t.kerning[u];c/=a,h/=a,d/=a,this.chars[h]&&(this.chars[h].kerning[c]=d)}this.distanceFieldRange=o?.distanceRange,this.distanceFieldType=o?.fieldType?.toLowerCase()??"none"}destroy(){for(const t in this.chars)this.chars[t].texture.destroy(),this.chars[t].texture=null;for(const t in this.pageTextures)this._ownsTextures&&this.pageTextures[t].destroy(!0),this.pageTextures[t]=null;this.chars=null,this.pageTextures=null}static install(t,e,n){let r;if(t instanceof eh)r=t;else{const s=function tU(t){for(let e=0;e<Xg.length;e++)if(Xg[e].test(t))return Xg[e];return null}(t);if(!s)throw new Error("Unrecognized data format for font.");r=s.parse(t)}e instanceof _e&&(e=[e]);const i=new _r(r,e,n);return _r.available[i.font]=i,i}static uninstall(t){const e=_r.available[t];if(!e)throw new Error(`No font found named '${t}'`);e.destroy(),delete _r.available[t]}static from(t,e,n){if(!t)throw new Error("[BitmapFont] Property `name` is required.");const{chars:r,padding:i,resolution:s,textureWidth:o,textureHeight:a,...l}=Object.assign({},_r.defaultOptions,n),u=function iU(t){"string"==typeof t&&(t=[t]);const e=[];for(let n=0,r=t.length;n<r;n++){const i=t[n];if(Array.isArray(i)){if(2!==i.length)throw new Error(`[BitmapFont]: Invalid character range length, expecting 2 got ${i.length}.`);const s=i[0].charCodeAt(0),o=i[1].charCodeAt(0);if(o<s)throw new Error("[BitmapFont]: Invalid character range.");for(let a=s,l=o;a<=l;a++)e.push(String.fromCharCode(a))}else e.push(...RD(i))}if(0===e.length)throw new Error("[BitmapFont]: Empty set when resolving characters.");return e}(r),c=e instanceof Kn?e:new Kn(e),h=o,d=new eh;d.info[0]={face:c.fontFamily,size:c.fontSize},d.common[0]={lineHeight:c.fontSize};let g,m,_,f=0,p=0,v=0;const D=[],A=[];for(let ge=0;ge<u.length;ge++){g||(g=ce.ADAPTER.createCanvas(),g.width=o,g.height=a,m=g.getContext("2d"),_=new $e(g,{resolution:s,...l}),D.push(_),A.push(new _e(_)),d.page.push({id:A.length-1,file:""}));const Q=u[ge],J=an.measureText(Q,c,!1,g),Ve=J.width,ee=Math.ceil(J.height),he=Math.ceil(("italic"===c.fontStyle?2:1)*Ve);if(p>=a-ee*s){if(0===p)throw new Error(`[BitmapFont] textureHeight ${a}px is too small (fontFamily: '${c.fontFamily}', fontSize: ${c.fontSize}px, char: '${Q}')`);--ge,g=null,m=null,_=null,p=0,f=0,v=0;continue}if(v=Math.max(ee+J.fontProperties.descent,v),he*s+f>=h){if(0===f)throw new Error(`[BitmapFont] textureWidth ${o}px is too small (fontFamily: '${c.fontFamily}', fontSize: ${c.fontSize}px, char: '${Q}')`);--ge,p+=v*s,p=Math.ceil(p),f=0,v=0;continue}rU(g,m,J,f,p,s,c);const st=nh(J.text);d.char.push({id:st,page:A.length-1,x:f/s,y:p/s,width:he,height:ee,xoffset:0,yoffset:0,xadvance:Ve-(c.dropShadow?c.dropShadowDistance:0)-(c.stroke?c.strokeThickness:0)}),f+=(he+2*i)*s,f=Math.ceil(f)}for(let ge=0,Q=u.length;ge<Q;ge++){const J=u[ge];for(let Ve=0;Ve<Q;Ve++){const ee=u[Ve],he=m.measureText(J).width,st=m.measureText(ee).width,Y=m.measureText(J+ee).width-(he+st);Y&&d.kerning.push({first:nh(J),second:nh(ee),amount:Y})}}const $=new _r(d,A,!0);return void 0!==_r.available[t]&&_r.uninstall(t),_r.available[t]=$,$}};let Nn=_r;Nn.ALPHA=[["a","z"],["A","Z"]," "],Nn.NUMERIC=[["0","9"]],Nn.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "],Nn.ASCII=[[" ","~"]],Nn.defaultOptions={resolution:1,textureWidth:512,textureHeight:512,padding:4,chars:_r.ALPHANUMERIC},Nn.available={};const PD=[],ND=[],OD=[],FD=class extends on{constructor(t,e={}){super();const{align:n,tint:r,maxWidth:i,letterSpacing:s,fontName:o,fontSize:a}=Object.assign({},FD.styleDefaults,e);if(!Nn.available[o])throw new Error(`Missing BitmapFont "${o}"`);this._activePagesMeshData=[],this._textWidth=0,this._textHeight=0,this._align=n,this._tintColor=new ft(r),this._font=void 0,this._fontName=o,this._fontSize=a,this.text=t,this._maxWidth=i,this._maxLineHeight=0,this._letterSpacing=s,this._anchor=new Ti(()=>{this.dirty=!0},this,0,0),this._roundPixels=ce.ROUND_PIXELS,this.dirty=!0,this._resolution=ce.RESOLUTION,this._autoResolution=!0,this._textureCache={}}updateText(){const t=Nn.available[this._fontName],e=this.fontSize,n=e/t.size,r=new ut,i=[],s=[],o=[],l=RD(this._text.replace(/(?:\r\n|\r)/g,"\n")||" "),u=this._maxWidth*t.size/e,c="none"===t.distanceFieldType?PD:ND;let h=null,d=0,f=0,p=0,g=-1,m=0,_=0,v=0,D=0;for(let ee=0;ee<l.length;ee++){const he=l[ee],st=nh(he);if(/(?:\s)/.test(he)&&(g=ee,m=d,D++),"\r"===he||"\n"===he){s.push(d),o.push(-1),f=Math.max(f,d),++p,++_,r.x=0,r.y+=t.lineHeight,h=null,D=0;continue}const X=t.chars[st];if(!X)continue;h&&X.kerning[h]&&(r.x+=X.kerning[h]);const Y=OD.pop()||{texture:_e.EMPTY,line:0,charCode:0,prevSpaces:0,position:new ut};Y.texture=X.texture,Y.line=p,Y.charCode=st,Y.position.x=Math.round(r.x+X.xOffset+this._letterSpacing/2),Y.position.y=Math.round(r.y+X.yOffset),Y.prevSpaces=D,i.push(Y),d=Y.position.x+Math.max(X.xAdvance-X.xOffset,X.texture.orig.width),r.x+=X.xAdvance+this._letterSpacing,v=Math.max(v,X.yOffset+X.texture.height),h=st,-1!==g&&u>0&&r.x>u&&(++_,mo(i,1+g-_,1+ee-g),ee=g,g=-1,s.push(m),o.push(i.length>0?i[i.length-1].prevSpaces:0),f=Math.max(f,m),p++,r.x=0,r.y+=t.lineHeight,h=null,D=0)}const A=l[l.length-1];"\r"!==A&&"\n"!==A&&(/(?:\s)/.test(A)&&(d=m),s.push(d),f=Math.max(f,d),o.push(-1));const $=[];for(let ee=0;ee<=p;ee++){let he=0;"right"===this._align?he=f-s[ee]:"center"===this._align?he=(f-s[ee])/2:"justify"===this._align&&(he=o[ee]<0?0:(f-s[ee])/o[ee]),$.push(he)}const ge=i.length,Q={},J=[],Ve=this._activePagesMeshData;c.push(...Ve);for(let ee=0;ee<ge;ee++){const he=i[ee].texture,st=he.baseTexture.uid;if(!Q[st]){let X=c.pop();if(!X){const St=new R3;let Qe,qe;"none"===t.distanceFieldType?(Qe=new ED(_e.EMPTY),qe=Oe.NORMAL):(Qe=new ED(_e.EMPTY,{program:cr.from("// Mesh material default fragment\r\nattribute vec2 aVertexPosition;\r\nattribute vec2 aTextureCoord;\r\n\r\nuniform mat3 projectionMatrix;\r\nuniform mat3 translationMatrix;\r\nuniform mat3 uTextureMatrix;\r\n\r\nvarying vec2 vTextureCoord;\r\n\r\nvoid main(void)\r\n{\r\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\r\n\r\n    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;\r\n}\r\n","// Pixi texture info\r\nvarying vec2 vTextureCoord;\r\nuniform sampler2D uSampler;\r\n\r\n// Tint\r\nuniform vec4 uColor;\r\n\r\n// on 2D applications fwidth is screenScale / glyphAtlasScale * distanceFieldRange\r\nuniform float uFWidth;\r\n\r\nvoid main(void) {\r\n\r\n  // To stack MSDF and SDF we need a non-pre-multiplied-alpha texture.\r\n  vec4 texColor = texture2D(uSampler, vTextureCoord);\r\n\r\n  // MSDF\r\n  float median = texColor.r + texColor.g + texColor.b -\r\n                  min(texColor.r, min(texColor.g, texColor.b)) -\r\n                  max(texColor.r, max(texColor.g, texColor.b));\r\n  // SDF\r\n  median = min(median, texColor.a);\r\n\r\n  float screenPxDistance = uFWidth * (median - 0.5);\r\n  float alpha = clamp(screenPxDistance + 0.5, 0.0, 1.0);\r\n  if (median < 0.01) {\r\n    alpha = 0.0;\r\n  } else if (median > 0.99) {\r\n    alpha = 1.0;\r\n  }\r\n\r\n  // Gamma correction for coverage-like alpha\r\n  float luma = dot(uColor.rgb, vec3(0.299, 0.587, 0.114));\r\n  float gamma = mix(1.0, 1.0 / 2.2, luma);\r\n  float coverage = pow(uColor.a * alpha, gamma);  \r\n\r\n  // NPM Textures, NPM outputs\r\n  gl_FragColor = vec4(uColor.rgb, coverage);\r\n}\r\n"),uniforms:{uFWidth:0}}),qe=Oe.NORMAL_NPM);const Tt=new Hg(St,Qe);Tt.blendMode=qe,X={index:0,indexCount:0,vertexCount:0,uvsCount:0,total:0,mesh:Tt,vertices:null,uvs:null,indices:null}}X.index=0,X.indexCount=0,X.vertexCount=0,X.uvsCount=0,X.total=0;const{_textureCache:Y}=this;Y[st]=Y[st]||new _e(he.baseTexture),X.mesh.texture=Y[st],X.mesh.tint=this._tintColor.value,J.push(X),Q[st]=X}Q[st].total++}for(let ee=0;ee<Ve.length;ee++)J.includes(Ve[ee])||this.removeChild(Ve[ee].mesh);for(let ee=0;ee<J.length;ee++)J[ee].mesh.parent!==this&&this.addChild(J[ee].mesh);this._activePagesMeshData=J;for(const ee in Q){const he=Q[ee],st=he.total;if(!(he.indices?.length>6*st)||he.vertices.length<2*Hg.BATCHABLE_SIZE)he.vertices=new Float32Array(8*st),he.uvs=new Float32Array(8*st),he.indices=new Uint16Array(6*st);else{const Y=he.vertices;for(let St=4*he.total*2;St<Y.length;St++)Y[St]=0}he.mesh.size=6*st}for(let ee=0;ee<ge;ee++){const he=i[ee];let st=he.position.x+$[he.line]*("justify"===this._align?he.prevSpaces:1);this._roundPixels&&(st=Math.round(st));const X=st*n,Y=he.position.y*n,St=he.texture,Qe=Q[St.baseTexture.uid],qe=St.frame,Tt=St._uvs,ct=Qe.index++;Qe.indices[6*ct+0]=0+4*ct,Qe.indices[6*ct+1]=1+4*ct,Qe.indices[6*ct+2]=2+4*ct,Qe.indices[6*ct+3]=0+4*ct,Qe.indices[6*ct+4]=2+4*ct,Qe.indices[6*ct+5]=3+4*ct,Qe.vertices[8*ct+0]=X,Qe.vertices[8*ct+1]=Y,Qe.vertices[8*ct+2]=X+qe.width*n,Qe.vertices[8*ct+3]=Y,Qe.vertices[8*ct+4]=X+qe.width*n,Qe.vertices[8*ct+5]=Y+qe.height*n,Qe.vertices[8*ct+6]=X,Qe.vertices[8*ct+7]=Y+qe.height*n,Qe.uvs[8*ct+0]=Tt.x0,Qe.uvs[8*ct+1]=Tt.y0,Qe.uvs[8*ct+2]=Tt.x1,Qe.uvs[8*ct+3]=Tt.y1,Qe.uvs[8*ct+4]=Tt.x2,Qe.uvs[8*ct+5]=Tt.y2,Qe.uvs[8*ct+6]=Tt.x3,Qe.uvs[8*ct+7]=Tt.y3}this._textWidth=f*n,this._textHeight=(r.y+t.lineHeight)*n;for(const ee in Q){const he=Q[ee];if(0!==this.anchor.x||0!==this.anchor.y){let St=0;const Qe=this._textWidth*this.anchor.x,qe=this._textHeight*this.anchor.y;for(let Tt=0;Tt<he.total;Tt++)he.vertices[St++]-=Qe,he.vertices[St++]-=qe,he.vertices[St++]-=Qe,he.vertices[St++]-=qe,he.vertices[St++]-=Qe,he.vertices[St++]-=qe,he.vertices[St++]-=Qe,he.vertices[St++]-=qe}this._maxLineHeight=v*n;const st=he.mesh.geometry.getBuffer("aVertexPosition"),X=he.mesh.geometry.getBuffer("aTextureCoord"),Y=he.mesh.geometry.getIndex();st.data=he.vertices,X.data=he.uvs,Y.data=he.indices,st.update(),X.update(),Y.update()}for(let ee=0;ee<i.length;ee++)OD.push(i[ee]);this._font=t,this.dirty=!1}updateTransform(){this.validate(),this.containerUpdateTransform()}_render(t){this._autoResolution&&this._resolution!==t.resolution&&(this._resolution=t.resolution,this.dirty=!0);const{distanceFieldRange:e,distanceFieldType:n,size:r}=Nn.available[this._fontName];if("none"!==n){const{a:i,b:s,c:o,d:a}=this.worldTransform,l=Math.sqrt(i*i+s*s),u=Math.sqrt(o*o+a*a),c=(Math.abs(l)+Math.abs(u))/2,h=this.fontSize/r,d=t._view.resolution;for(const f of this._activePagesMeshData)f.mesh.shader.uniforms.uFWidth=c*e*h*d}super._render(t)}getLocalBounds(){return this.validate(),super.getLocalBounds()}validate(){const t=Nn.available[this._fontName];if(!t)throw new Error(`Missing BitmapFont "${this._fontName}"`);this._font!==t&&(this.dirty=!0),this.dirty&&this.updateText()}get tint(){return this._tintColor.value}set tint(t){if(this.tint!==t){this._tintColor.setValue(t);for(let e=0;e<this._activePagesMeshData.length;e++)this._activePagesMeshData[e].mesh.tint=t}}get align(){return this._align}set align(t){this._align!==t&&(this._align=t,this.dirty=!0)}get fontName(){return this._fontName}set fontName(t){if(!Nn.available[t])throw new Error(`Missing BitmapFont "${t}"`);this._fontName!==t&&(this._fontName=t,this.dirty=!0)}get fontSize(){return this._fontSize??Nn.available[this._fontName].size}set fontSize(t){this._fontSize!==t&&(this._fontSize=t,this.dirty=!0)}get anchor(){return this._anchor}set anchor(t){"number"==typeof t?this._anchor.set(t):this._anchor.copyFrom(t)}get text(){return this._text}set text(t){t=String(t??""),this._text!==t&&(this._text=t,this.dirty=!0)}get maxWidth(){return this._maxWidth}set maxWidth(t){this._maxWidth!==t&&(this._maxWidth=t,this.dirty=!0)}get maxLineHeight(){return this.validate(),this._maxLineHeight}get textWidth(){return this.validate(),this._textWidth}get letterSpacing(){return this._letterSpacing}set letterSpacing(t){this._letterSpacing!==t&&(this._letterSpacing=t,this.dirty=!0)}get roundPixels(){return this._roundPixels}set roundPixels(t){t!==this._roundPixels&&(this._roundPixels=t,this.dirty=!0)}get textHeight(){return this.validate(),this._textHeight}get resolution(){return this._resolution}set resolution(t){this._autoResolution=!1,this._resolution!==t&&(this._resolution=t,this.dirty=!0)}destroy(t){const{_textureCache:e}=this,r="none"===Nn.available[this._fontName].distanceFieldType?PD:ND;r.push(...this._activePagesMeshData);for(const i of this._activePagesMeshData)this.removeChild(i.mesh);this._activePagesMeshData=[],r.filter(i=>e[i.mesh.texture.baseTexture.uid]).forEach(i=>{i.mesh.texture=_e.EMPTY});for(const i in e)e[i].destroy(),delete e[i];this._font=null,this._tintColor=null,this._textureCache=null,super.destroy(t)}};FD.styleDefaults={align:"left",tint:16777215,maxWidth:0,letterSpacing:0};const lU=[".xml",".fnt"],uU={extension:{type:fe.LoadParser,priority:jr.Normal},name:"loadBitmapFont",test:t=>lU.includes(hn.extname(t).toLowerCase()),testParse:t=>re(function*(){return th.test(t)||Wg.test(t)})(),parse:(t,e,n)=>re(function*(){const r=th.test(t)?th.parse(t):Wg.parse(t),{src:i}=e,{page:s}=r,o=[];for(let u=0;u<s.length;++u){const c=s[u].file;let h=hn.join(hn.dirname(i),c);h=Lg(h,i),o.push(h)}const a=yield n.load(o),l=o.map(u=>a[u]);return Nn.install(r,l,!0)})(),load:(t,e)=>re(function*(){return(yield ce.ADAPTER.fetch(t)).text()})(),unload(t){t.destroy()}};Te.add(uU);const To=class extends Kn{constructor(){super(...arguments),this._fonts=[],this._overrides=[],this._stylesheet="",this.fontsDirty=!1}static from(t){return new To(Object.keys(To.defaultOptions).reduce((e,n)=>({...e,[n]:t[n]}),{}))}cleanFonts(){this._fonts.length>0&&(this._fonts.forEach(t=>{URL.revokeObjectURL(t.src),t.refs--,0===t.refs&&(t.fontFace&&document.fonts.delete(t.fontFace),delete To.availableFonts[t.originalUrl])}),this.fontFamily="Arial",this._fonts.length=0,this.styleID++,this.fontsDirty=!0)}loadFont(t,e={}){var n=this;const{availableFonts:r}=To;if(r[t]){const i=r[t];return this._fonts.push(i),i.refs++,this.styleID++,this.fontsDirty=!0,Promise.resolve()}return ce.ADAPTER.fetch(t).then(i=>i.blob()).then(function(){var i=re(function*(s){return new Promise((o,a)=>{const l=URL.createObjectURL(s),u=new FileReader;u.onload=()=>o([l,u.result]),u.onerror=a,u.readAsDataURL(s)})});return function(s){return i.apply(this,arguments)}}()).then(function(){var i=re(function*([s,o]){const a=Object.assign({family:hn.basename(t,hn.extname(t)),weight:"normal",style:"normal",src:s,dataSrc:o,refs:1,originalUrl:t,fontFace:null},e);r[t]=a,n._fonts.push(a),n.styleID++;const l=new FontFace(a.family,`url(${a.src})`,{weight:a.weight,style:a.style});a.fontFace=l,yield l.load(),document.fonts.add(l),yield document.fonts.ready,n.styleID++,n.fontsDirty=!0});return function(s){return i.apply(this,arguments)}}())}addOverride(...t){const e=t.filter(n=>!this._overrides.includes(n));e.length>0&&(this._overrides.push(...e),this.styleID++)}removeOverride(...t){const e=t.filter(n=>this._overrides.includes(n));e.length>0&&(this._overrides=this._overrides.filter(n=>!e.includes(n)),this.styleID++)}toCSS(t){return[`transform: scale(${t})`,"transform-origin: top left","display: inline-block",`color: ${this.normalizeColor(this.fill)}`,`font-size: ${this.fontSize}px`,`font-family: ${this.fontFamily}`,`font-weight: ${this.fontWeight}`,`font-style: ${this.fontStyle}`,`font-variant: ${this.fontVariant}`,`letter-spacing: ${this.letterSpacing}px`,`text-align: ${this.align}`,`padding: ${this.padding}px`,`white-space: ${this.whiteSpace}`,...this.lineHeight?[`line-height: ${this.lineHeight}px`]:[],...this.wordWrap?["word-wrap: "+(this.breakWords?"break-all":"break-word"),`max-width: ${this.wordWrapWidth}px`]:[],...this.strokeThickness?[`-webkit-text-stroke-width: ${this.strokeThickness}px`,`-webkit-text-stroke-color: ${this.normalizeColor(this.stroke)}`,`text-stroke-width: ${this.strokeThickness}px`,`text-stroke-color: ${this.normalizeColor(this.stroke)}`,"paint-order: stroke"]:[],...this.dropShadow?[this.dropShadowToCSS()]:[],...this._overrides].join(";")}toGlobalCSS(){return this._fonts.reduce((t,e)=>`${t}\n            @font-face {\n                font-family: "${e.family}";\n                src: url('${e.dataSrc}');\n                font-weight: ${e.weight};\n                font-style: ${e.style}; \n            }`,this._stylesheet)}get stylesheet(){return this._stylesheet}set stylesheet(t){this._stylesheet!==t&&(this._stylesheet=t,this.styleID++)}normalizeColor(t){return Array.isArray(t)&&(t=function ik(t){return Ye("7.2.0","utils.rgb2hex is deprecated, use Color#toNumber instead"),ft.shared.setValue(t).toNumber()}(t)),"number"==typeof t?function rk(t){return Ye("7.2.0","utils.hex2string is deprecated, use Color#toHex instead"),ft.shared.setValue(t).toHex()}(t):t}dropShadowToCSS(){let t=this.normalizeColor(this.dropShadowColor);const e=this.dropShadowAlpha,n=Math.round(Math.cos(this.dropShadowAngle)*this.dropShadowDistance),r=Math.round(Math.sin(this.dropShadowAngle)*this.dropShadowDistance);t.startsWith("#")&&e<1&&(t+=(255*e|0).toString(16).padStart(2,"0"));const i=`${n}px ${r}px`;return this.dropShadowBlur>0?`text-shadow: ${i} ${this.dropShadowBlur}px ${t}`:`text-shadow: ${i} ${t}`}reset(){Object.assign(this,To.defaultOptions)}onBeforeDraw(){const{fontsDirty:t}=this;return this.fontsDirty=!1,this.isSafari&&this._fonts.length>0&&t?new Promise(e=>setTimeout(e,100)):Promise.resolve()}get isSafari(){const{userAgent:t}=ce.ADAPTER.getNavigator();return/^((?!chrome|android).)*safari/i.test(t)}set fillGradientStops(t){console.warn("[HTMLTextStyle] fillGradientStops is not supported by HTMLText")}get fillGradientStops(){return super.fillGradientStops}set fillGradientType(t){console.warn("[HTMLTextStyle] fillGradientType is not supported by HTMLText")}get fillGradientType(){return super.fillGradientType}set miterLimit(t){console.warn("[HTMLTextStyle] miterLimit is not supported by HTMLText")}get miterLimit(){return super.miterLimit}set trim(t){console.warn("[HTMLTextStyle] trim is not supported by HTMLText")}get trim(){return super.trim}set textBaseline(t){console.warn("[HTMLTextStyle] textBaseline is not supported by HTMLText")}get textBaseline(){return super.textBaseline}set leading(t){console.warn("[HTMLTextStyle] leading is not supported by HTMLText")}get leading(){return super.leading}set lineJoin(t){console.warn("[HTMLTextStyle] lineJoin is not supported by HTMLText")}get lineJoin(){return super.lineJoin}};let al=To;al.availableFonts={},al.defaultOptions={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",letterSpacing:0,lineHeight:0,padding:0,stroke:"black",strokeThickness:0,whiteSpace:"normal",wordWrap:!1,wordWrapWidth:100};const Co=class extends dn{constructor(t="",e={}){super(_e.EMPTY),this._text=null,this._style=null,this._autoResolution=!0,this._loading=!1,this.localStyleID=-1,this.dirty=!1,this.ownsStyle=!1;const n=new Image,r=_e.from(n,{scaleMode:ce.SCALE_MODE,resourceOptions:{autoLoad:!1}});r.orig=new et,r.trim=new et,this.texture=r;const i="http://www.w3.org/2000/svg",s="http://www.w3.org/1999/xhtml",o=document.createElementNS(i,"svg"),a=document.createElementNS(i,"foreignObject"),l=document.createElementNS(s,"div"),u=document.createElementNS(s,"style");a.setAttribute("width","10000"),a.setAttribute("height","10000"),a.style.overflow="hidden",o.appendChild(a),this.maxWidth=Co.defaultMaxWidth,this.maxHeight=Co.defaultMaxHeight,this._domElement=l,this._styleElement=u,this._svgRoot=o,this._foreignObject=a,this._foreignObject.appendChild(u),this._foreignObject.appendChild(l),this._image=n,this._loadImage=new Image,this._autoResolution=Co.defaultAutoResolution,this._resolution=Co.defaultResolution??ce.RESOLUTION,this.text=t,this.style=e}measureText(t){const{text:e,style:n,resolution:r}=Object.assign({text:this._text,style:this._style,resolution:this._resolution},t);Object.assign(this._domElement,{innerHTML:e,style:n.toCSS(r)}),this._styleElement.textContent=n.toGlobalCSS(),document.body.appendChild(this._svgRoot);const i=this._domElement.getBoundingClientRect();this._svgRoot.remove();const s=Math.min(this.maxWidth,Math.ceil(i.width)),o=Math.min(this.maxHeight,Math.ceil(i.height));return this._svgRoot.setAttribute("width",s.toString()),this._svgRoot.setAttribute("height",o.toString()),e!==this._text&&(this._domElement.innerHTML=this._text),n!==this._style&&(Object.assign(this._domElement,{style:this._style?.toCSS(r)}),this._styleElement.textContent=this._style?.toGlobalCSS()),{width:s+2*n.padding,height:o+2*n.padding}}updateText(t=!0){var e=this;return re(function*(){const{style:n,_image:r,_loadImage:i}=e;if(e.localStyleID!==n.styleID&&(e.dirty=!0,e.localStyleID=n.styleID),!e.dirty&&t)return;const{width:s,height:o}=e.measureText();r.width=i.width=Math.ceil(Math.max(1,s)),r.height=i.height=Math.ceil(Math.max(1,o)),e._loading||(e._loading=!0,yield new Promise(a=>{i.onload=re(function*(){yield n.onBeforeDraw(),e._loading=!1,r.src=i.src,i.onload=null,i.src="",e.updateTexture(),a()});const l=(new XMLSerializer).serializeToString(e._svgRoot);i.src=`data:image/svg+xml;charset=utf8,${encodeURIComponent(l)}`}))})()}get source(){return this._image}updateTexture(){const{style:t,texture:e,_image:n,resolution:r}=this,{padding:i}=t,{baseTexture:s}=e;e.trim.width=e._frame.width=n.width/r,e.trim.height=e._frame.height=n.height/r,e.trim.x=-i,e.trim.y=-i,e.orig.width=e._frame.width-2*i,e.orig.height=e._frame.height-2*i,this._onTextureUpdate(),s.setRealSize(n.width,n.height,r),this.dirty=!1}_render(t){this._autoResolution&&this._resolution!==t.resolution&&(this._resolution=t.resolution,this.dirty=!0),this.updateText(!0),super._render(t)}_renderCanvas(t){this._autoResolution&&this._resolution!==t.resolution&&(this._resolution=t.resolution,this.dirty=!0),this.updateText(!0),super._renderCanvas(t)}getLocalBounds(t){return this.updateText(!0),super.getLocalBounds(t)}_calculateBounds(){this.updateText(!0),this.calculateVertices(),this._bounds.addQuad(this.vertexData)}_onStyleChange(){this.dirty=!0}destroy(t){"boolean"==typeof t&&(t={children:t}),t=Object.assign({},Co.defaultDestroyOptions,t),super.destroy(t);const e=null;this.ownsStyle&&this._style?.cleanFonts(),this._style=e,this._svgRoot?.remove(),this._svgRoot=e,this._domElement?.remove(),this._domElement=e,this._foreignObject?.remove(),this._foreignObject=e,this._styleElement?.remove(),this._styleElement=e,this._loadImage.src="",this._loadImage.onload=null,this._loadImage=e,this._image.src="",this._image=e}get width(){return this.updateText(!0),Math.abs(this.scale.x)*this._image.width/this.resolution}set width(t){this.updateText(!0);const e=bi(this.scale.x)||1;this.scale.x=e*t/this._image.width/this.resolution,this._width=t}get height(){return this.updateText(!0),Math.abs(this.scale.y)*this._image.height/this.resolution}set height(t){this.updateText(!0);const e=bi(this.scale.y)||1;this.scale.y=e*t/this._image.height/this.resolution,this._height=t}get style(){return this._style}set style(t){this._style!==t&&((t=t||{})instanceof al?(this.ownsStyle=!1,this._style=t):t instanceof Kn?(console.warn("[HTMLText] Cloning TextStyle, if this is not what you want, use HTMLTextStyle"),this.ownsStyle=!0,this._style=al.from(t)):(this.ownsStyle=!0,this._style=new al(t)),this.localStyleID=-1,this.dirty=!0)}get text(){return this._text}set text(t){t=String(""===t||null==t?" ":t),t=this.sanitiseText(t),this._text!==t&&(this._text=t,this.dirty=!0)}get resolution(){return this._resolution}set resolution(t){this._autoResolution=!1,this._resolution!==t&&(this._resolution=t,this.dirty=!0)}sanitiseText(t){return t.replace(/<br>/gi,"<br/>").replace(/<hr>/gi,"<hr/>").replace(/&nbsp;/gi,"&#160;")}};let rh=Co;rh.defaultDestroyOptions={texture:!0,children:!1,baseTexture:!0},rh.defaultMaxWidth=2024,rh.defaultMaxHeight=2024,rh.defaultAutoResolution=!0;class cU extends on{constructor(e){super(),this.spriteInfo=e,this.stopSpriteEvent=new Or}gotoToFrame(e){this.layerSprite&&(e<0?e=this.layerSprite.totalFrames-1:e>=this.layerSprite.totalFrames&&(e=0),this.layerSprite.gotoAndStop(e))}blink(){this.layerSprite.tint=16711680,setTimeout(()=>{this.layerSprite.tint=16777215,setTimeout(()=>{this.layerSprite.tint=16711680,setTimeout(()=>{this.layerSprite.tint=16777215,setTimeout(()=>{this.layerSprite.tint=16711680,setTimeout(()=>{this.layerSprite.tint=16777215},500)},500)},500)},500)},500)}playOnce(){return this.layerSprite.stop(),new Promise(e=>{this.layerSprite.currentFrame=0,this.layerSprite.onComplete=()=>e(),this.layerSprite.gotoAndPlay(0)})}play(){this.layerSprite.currentFrame=0,this.layerSprite.play()}playSubst(){return new x(e=>{this.layerSprite.currentFrame=0,this.layerSprite.play(),this.stopSpriteEvent.subscribe(()=>{e.next(),e.complete()})})}stop(){this.layerSprite.stop(),this.layerSprite.currentFrame=0,this.stopSpriteEvent.emit()}setAnimation(e,n){this.layerSprite.animationSpeed=n,this.layerSprite.loop=e}initialize(e){var n=this;return re(function*(){n.addChild((new ui).beginFill(16777215,.001).drawRect(0,0,n.spriteInfo.width,n.spriteInfo.height).endFill()),e.textures&&(n.layerSprite=new Qc(e.textures),n.addChild(n.layerSprite),n.zIndex=e.zIndex)})()}}class LD extends on{constructor(){super(...arguments),this.velocityVector={x:0,y:0},this.gravity=.2,this.layers=new Map,this.animations=[],this.groundPoint=null,this.currentAnimationId=null,this.playing=!1,this.isBusyValue=!1}get isBusy(){return this.isBusyValue}setX(e){const n=this.getGroundPoint()??{x:0,y:0};this.x=e-n.x}setY(e){const n=this.getGroundPoint()??{x:0,y:0};this.y=e-n.y}isY(e){return e-(this.getGroundPoint()??{x:0,y:0}).y}getGroundPoint(){return this.groundPoint?{...this.groundPoint}:null}get centerPoint(){return this.groundPoint?{x:this.x+this.groundPoint.x,y:this.y+this.groundPoint.y}:{x:this.x+this.width/2,y:this.y+this.height/2}}playOnce(){var e=this;return re(function*(){return e.isBusyValue=!0,new Promise(n=>{const r=[];e.layers.forEach(i=>{i.visible&&r.push(i.playOnce())}),Promise.all(r).then(()=>{e.isBusyValue=!1,n()})})})()}play(){this.playing=!0,this.layers.forEach(e=>{e.visible&&e.play()})}stop(){this.playing=!1,this.layers.forEach(e=>{e.stop()})}setDefAnimation(){const e=this.animations.find(n=>n.default);e&&this.setAnimation(e.id)}getDynamicCollisionFrame(e){const n=this.getAnimation(e);return n?.collisionFrame?{x:this.x+n.collisionFrame.x,y:this.y+n.collisionFrame.y,width:n.collisionFrame.width,height:n.collisionFrame.height}:{x:this.x,y:this.y,width:this.width,height:this.height}}isAnimation(e){return!!this.currentAnimationId&&(Array.isArray(e)?e.includes(this.currentAnimationId):this.currentAnimationId===e)}getAnimation(e){return this.animations.find(r=>r.id===e)??null}setAnimation(e,n=!1,r,i){if(!e)return this.layers.forEach(o=>o.visible=!0),this.currentAnimationId=null,void this.stop();const s=this.animations.find(o=>o.id===e);this.currentAnimationId!==e&&(this.stop(),this.currentAnimationId=e,s&&this.layers.forEach((o,a)=>{const l=s.layers.find(u=>u.layerId===a);l?(o.setAnimation(l.loop,r??l.speed),o.visible=!0):o.visible=!1})),s&&void 0!==i&&s.layers.forEach(o=>{this.layers.has(Number(o.layerId))&&this.layers.get(Number(o.layerId)).gotoToFrame(i)}),n&&!this.playing?this.play():!n&&this.playing&&this.stop()}initialize(e){var n=this;return re(function*(){n.addChild((new ui).beginFill(0,.001).drawRect(0,0,e.width,e.height).endFill()),n.animations=e.animations,n.groundPoint=e.groundPoint;for(const r of e.layers){const i=new cU(e);yield i.initialize(r),n.addChild(i),n.layers.set(r.id,i)}})()}}class dU{constructor(e){this.app=e,this.frames=new Map}has(e){return this.frames.has(e)}get(e){return this.frames.has(e)?this.frames.get(e):null}getAsCanvas(e){var n=this;return re(function*(){return n.frames.has(e)?n.textureToCanvas(n.frames.get(e)):null})()}add(e,n){if(Array.isArray(e))for(const r of e)for(const i of r.frames)this.frames.has(i.frameId)||this.frames.set(i.frameId,new _e(n[r.textureName],this.rectToRectangle(i.rect)))}textureToCanvas(e){var n=this;return re(function*(){const r=n.app.renderer.generateTexture(dn.from(e)),i=yield n.app.renderer.extract.canvas(r);if(!i)return console.error("textureToCanvas: empty iCanvas"),null;const s=i.toDataURL?.();if(!s)return console.error("textureToCanvas: empty iCanvas to dataUrl"),null;const o=document.createElement("canvas"),a=o.getContext("2d");return a?new Promise(l=>{const u=new Image;u.src=s,u.onload=()=>{o.width=u.width,o.height=u.height,a.drawImage(u,0,0),URL.revokeObjectURL(u.src),l(o)}}):(console.error("textureToCanvas: empty ctx"),null)})()}rectToRectangle(e){return new et(e.x,e.y,e.width,e.height)}}class cs{static lineIntersect(e,n){const r=e.p1.x,i=e.p1.y,s=e.p2.x,o=e.p2.y,a=n.p1.x,l=n.p1.y,u=n.p2.x,c=n.p2.y;if(r===s&&i===o||a===u&&l===c)return null;const h=(c-l)*(s-r)-(u-a)*(o-i);if(0===h)return null;const d=((u-a)*(i-l)-(c-l)*(r-a))/h,f=((s-r)*(i-l)-(o-i)*(r-a))/h;return d<0||d>1||f<0||f>1?null:{x:r+d*(s-r),y:i+d*(o-i)}}static angleOfVector(e){let n=Math.acos(e.x);return e.y<0&&(n=Math.PI+Math.PI-n),cs.rad2grad(n)}static angleToVector(e){const n=cs.grad2rad(e);return{x:Math.cos(n),y:Math.sin(n)}}static isRectangleCollision(e,n){return!(n.x>e.x+e.width||n.x+n.width<e.x||n.y>e.y+e.height||n.y+n.height<e.y)}static pointInRect(e,n){return e.x>=n.x&&e.x<=n.x+n.width&&e.y>=n.y&&e.y<=n.y+n.height}static grad2rad(e){return e*Math.PI/180}static rad2grad(e){return 180/Math.PI*e}static distance(e,n){return Math.sqrt((n.x-e.x)*(n.x-e.x)+(n.y-e.y)*(n.y-e.y))}static getBezierCurve(e,n){const r={x:0,y:0};for(let i=0;i<e.length;i++){const s=cs.getBezierBasis(i,e.length-1,n);r.x+=e[i].x*s,r.y+=e[i].y*s}return r}static getBezierCurves(e,n=.01){const r=[];for(let i=0;i<1+n;i+=n)i>1&&(i=1),r[r.length]=cs.getBezierCurve(e,i);return r}static getBezierBasis(e,n,r){const i=s=>s<=1?1:s*i(s-1);return i(n)/(i(e)*i(n-e))*Math.pow(r,e)*Math.pow(1-r,n-e)}}class fU extends on{constructor(e,n,r,i,s){super(),this.cellX=e,this.cellY=n,this.cellWidth=r,this.cellHeight=i,this.properties=s,this.cellKey=`${this.cellX}x${this.cellY}`}addItem(e,n){var r=this;return re(function*(){r.sprite=new dn(n),r.sprite.width=r.cellWidth,r.sprite.height=r.cellHeight,r.sprite.zIndex=e.zIndex,r.addChild(r.sprite)})()}}class pU{constructor(e){this.info=e}get holdTexture(){return this.info?.holdTexture??null}get mapInfo(){return this.info?.mapInfo??null}get tileInfo(){return this.info?.tileInfo??null}find(e){return(this.info?.cells||[]).find(n=>e(n))??null}filter(e){return(this.info?.cells||[]).filter(n=>e(n))}[Symbol.iterator](){let e=-1;const n=this.info.cells;return{next:()=>({value:n[++e],done:!(e in n)})}}}class gU{constructor(e){this.framesResources=e,this.grids=new Map}get(e){return this.grids.has(e)?this.grids.get(e):null}add(e,n){var r=this;return re(function*(){fn.addBundle(e,{frames:`${n}/frames-def.json`,grid:`${n}/grid-def.json`});const i=yield fn.loadBundle(e);yield r.initFrames(i.frames,n),yield r.addGrid(i.grid)})()}addGrid(e){var n=this;return re(function*(){if(n.grids.has(e.id))return;const r={holdTexture:null,mapInfo:e.mapInfo,tileInfo:e.tileInfo,cells:[]},i=e.items.filter(o=>!o.properties?.canAction);if(i.length>0){const o=yield n.createHoldTexture(i,e.mapInfo,e.tileInfo);o&&(r.holdTexture=o)}const s=e.items.filter(o=>o.properties?.canAction);for(const o of s){const a=n.framesResources.get(o.referenceId);if(!a){console.error("no texture",o.referenceId);continue}const l=new fU(o.x,o.y,e.tileInfo.width,e.tileInfo.height,o.properties);yield l.addItem(o,a),r.cells.push(l)}n.grids.set(e.id,new pU(r))})()}createHoldTexture(e,n,r){var i=this;return re(function*(){const s=document.createElement("canvas"),o=s.getContext("2d");if(!o)return console.error("createHoldTexture: empty ctx"),null;s.width=n.width*r.width,s.height=n.height*r.height;for(const a of e){const l=i.framesResources.get(a.referenceId);if(!l)continue;const u=yield i.framesResources.textureToCanvas(l);u&&o.drawImage(u,a.x*r.width,a.y*r.height)}return _e.from(s)})()}initFrames(e,n){var r=this;return re(function*(){if(!Array.isArray(e))return;const i={};e.forEach(o=>{i[o.textureName]=`${n}/${o.textureName}`}),fn.addBundle("frames",i);const s=yield fn.loadBundle("frames");r.framesResources.add(e,s)})()}}class mU{constructor(e){this.framesResources=e,this.sprites=new Map}showFlash(e,n){var r=this;return re(function*(){const i=yield r.generateById(e.spriteId);if(i){const s=i.centerPoint;i.x=e.showCoords.x-s.x,i.y=e.showCoords.y-s.y,i.setDefAnimation(),n.addChild(i),yield i.playOnce(),i.destroy()}})()}get(e){return this.sprites.has(e)?this.sprites.get(e):null}generateById(e){var n=this;return re(function*(){const r=n.get(e);if(!r)return null;const i=new LD;return yield i.initialize(r),i})()}add(e,n){var r=this;return re(function*(){fn.addBundle(e,{frames:`${n}/frames-def.json`,texture:`${n}/texture.png`,sprite:`${n}/sprite-def.json`});const i=yield fn.loadBundle(e);r.framesResources.add(i.frames,{"texture.png":i.texture}),yield r.addSprite(i.sprite)})()}addSprite(e){var n=this;return re(function*(){if(!n.sprites.has(e.id)){for(const r of e.layers)r.textures=yield n.generateTexturesByFrames(r.frames,e.width,e.height,n.framesResources);n.sprites.set(e.id,e)}})()}generateTexturesByFrames(e,n,r,i){return re(function*(){const s=[];for(const o of e){const a=i.get(o);a&&s.push(a.clone())}return s})()}}class kD extends on{constructor(e){super(),this.app=e,this.framesResources=new dU(this.app),this.gridResources=new gU(this.framesResources),this.spriteResources=new mU(this.framesResources)}}class yU{constructor(e){this.app=e,this.scenes=new Map}add(e,n){return this.scenes.has(e)?(console.error("\u0414\u0443\u0431\u043b\u0438\u043a\u0430\u0442 \u0441\u0446\u0435\u043d\u044b"),this.scenes.get(e)):(this.scenes.set(e,n),n.name=e,n.visible=!1,n.scenesManager=this,this.app.stage.addChild(n),n)}show(e){if(this.scenes.has(e)){this.scenes.forEach((r,i)=>{i!==e&&(r.visible=!1)});const n=this.scenes.get(e);if(n)return n.visible=!0,n}throw new Error("\u0421\u0446\u0435\u043d\u0430 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u0430")}}class _U extends kD{initialize(){var e=this;return re(function*(){e.addChild((new ui).beginFill(0,1).drawRect(0,0,e.app.screen.width,e.app.screen.height).endFill());const n=yield fn.load("logo.png");e.sprite=new dn(n),e.sprite.x=(e.app.screen.width-e.sprite.width)/2,e.sprite.y=(e.app.screen.height-e.sprite.height)/2-10,e.addChild(e.sprite),e.title=new So("",new Kn({fontFamily:"Batman Forever Alternate Cyr",fontSize:22,fill:"#ffffff"})),e.addChild(e.title);const r=new So("\u0423\u0434\u0430\u0440 - \u043f\u0440\u043e\u0431\u0435\u043b",new Kn({fontFamily:"Batman Forever Alternate Cyr",fontSize:16,fill:"#ffffff"}));r.x=e.app.screen.width-r.width-20,r.y=e.app.screen.height-r.height-50,e.addChild(r);const i=new So("\u0423\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435 WASD \u0438\u043b\u0438 \u0441\u0442\u0440\u0435\u043b\u043e\u0447\u043a\u0438",new Kn({fontFamily:"Batman Forever Alternate Cyr",fontSize:16,fill:"#ffffff"}));i.x=e.app.screen.width-i.width-20,i.y=r.y-i.height-10,e.addChild(i)})()}run(e){var n=this;return re(function*(){n.setTitle(e.title)})()}setTitle(e){this.title.text=e,this.title.x=(this.app.screen.width-this.title.width)/2,this.title.y=this.sprite.y+this.sprite.height}}var de=function(t){return t[t.onStayRight=62]="onStayRight",t[t.onWaitRight=63]="onWaitRight",t[t.toRunRight=64]="toRunRight",t[t.runRight=65]="runRight",t[t.toStopRight=66]="toStopRight",t[t.toSeatRight=74]="toSeatRight",t[t.seatRight=76]="seatRight",t[t.fromSeatRight=75]="fromSeatRight",t[t.hitRight=72]="hitRight",t[t.hitSeatRight=80]="hitSeatRight",t[t.hitJumpRight=88]="hitJumpRight",t[t.toJumpRight=83]="toJumpRight",t[t.jumpRight=82]="jumpRight",t[t.jumpRunningRight=90]="jumpRunningRight",t[t.fromJumpRight=84]="fromJumpRight",t[t.onStayLeft=67]="onStayLeft",t[t.onWaitLeft=68]="onWaitLeft",t[t.toRunLeft=69]="toRunLeft",t[t.runLeft=70]="runLeft",t[t.toStopLeft=71]="toStopLeft",t[t.toSeatLeft=77]="toSeatLeft",t[t.seatLeft=78]="seatLeft",t[t.fromSeatLeft=79]="fromSeatLeft",t[t.hitLeft=73]="hitLeft",t[t.hitSeatLeft=81]="hitSeatLeft",t[t.hitJumpLeft=89]="hitJumpLeft",t[t.toJumpLeft=85]="toJumpLeft",t[t.jumpLeft=86]="jumpLeft",t[t.jumpRunningLeft=91]="jumpRunningLeft",t[t.fromJumpLeft=87]="fromJumpLeft",t}(de||{});class xU extends LD{constructor(e){var n;super(),n=this,this.spriteResources=e,this.directionValue="right",this.moveStateValue="none",this.beforeJumpState="none",this.beforeHitState="none",this.keyHitPressed=!1,this.jumpSpeed=2.5,this.keyDown=function(){var r=re(function*(i){if("seat"!==n.moveStateValue)if(["jump","jump-running-right","jump-running-left"].includes(n.moveStateValue))"Space"===i.code&&(n.beforeHitState="none",n.keyHitPressed||(n.keyHitPressed=!0,"right"===n.directionValue?n.isAnimation([de.hitJumpRight])||(n.setAnimation(de.hitJumpRight),yield n.playOnce(),n.setAnimation(de.jumpRight,!1,void 0,2)):n.isAnimation([de.hitJumpLeft])||(n.setAnimation(de.hitJumpLeft),yield n.playOnce(),n.setAnimation(de.jumpLeft,!1,void 0,2))));else switch(i.code){case"Space":n.keyHitPressed||(n.keyHitPressed=!0,n.beforeHitState=n.moveStateValue,n.moveStateValue="none","right"===n.directionValue?n.isAnimation([de.hitRight])||(n.setAnimation(de.hitRight),n.playOnce().then(()=>{["left","right"].includes(n.beforeHitState)?"right"===n.beforeHitState&&n.keyPressedIsMoveRight():"none"===n.moveStateValue&&n.setAnimation(de.onStayRight),n.beforeHitState="none"})):n.isAnimation([de.hitLeft])||(n.setAnimation(de.hitLeft),n.playOnce().then(()=>{["left","right"].includes(n.beforeHitState)?"left"===n.beforeHitState&&n.keyPressedIsMoveLeft():"none"===n.moveStateValue&&n.setAnimation(de.onStayLeft),n.beforeHitState="none"})));break;case"KeyA":case"ArrowLeft":n.keyPressedIsMoveLeft();break;case"KeyD":case"ArrowRight":n.keyPressedIsMoveRight();break;case"KeyS":case"ArrowDown":n.moveStateValue="seat","right"===n.directionValue?(n.setAnimation(de.toSeatRight),yield n.playOnce(),n.setAnimation(de.seatRight)):(n.setAnimation(de.toSeatLeft),yield n.playOnce(),n.setAnimation(de.seatLeft));break;case"KeyW":case"ArrowUp":["left","right"].includes(n.moveStateValue)?(n.beforeJumpState=n.moveStateValue,n.velocityVector.y=2*-n.jumpSpeed,"right"===n.directionValue?(n.moveStateValue="jump-running-right",n.isAnimation(de.jumpRunningRight)||(n.setAnimation(de.jumpRunningRight),n.playOnce().then(re(function*(){n.setAnimation(de.fromJumpRight),yield n.playOnce(),n.moveStateValue="none"})))):"left"===n.directionValue&&(n.moveStateValue="jump-running-left",n.isAnimation(de.jumpRunningLeft)||(n.setAnimation(de.jumpRunningLeft),n.playOnce().then(re(function*(){n.setAnimation(de.fromJumpLeft),yield n.playOnce(),n.moveStateValue="none"}))))):(n.moveStateValue="jump",n.velocityVector.y=2*-n.jumpSpeed,"right"===n.directionValue?n.isAnimation([de.toJumpRight,de.jumpRight])||(n.setAnimation(de.toJumpRight),yield n.playOnce(),n.setAnimation(de.jumpRight),n.playOnce().then(re(function*(){n.setAnimation(de.fromJumpRight),n.setAnimation(de.onStayRight),yield n.playOnce(),n.moveStateValue="none"}))):n.isAnimation([de.toJumpLeft,de.jumpLeft])||(n.setAnimation(de.toJumpLeft),yield n.playOnce(),n.setAnimation(de.jumpLeft),n.playOnce().then(re(function*(){n.setAnimation(de.fromJumpLeft),yield n.playOnce(),n.setAnimation(de.onStayLeft),yield n.playOnce(),n.moveStateValue="none"}))))}else switch(i.code){case"KeyA":case"ArrowLeft":n.directionValue="left",n.isAnimation(de.seatLeft)||n.setAnimation(de.seatLeft);break;case"KeyD":case"ArrowRight":n.directionValue="right",n.isAnimation([de.seatRight])||n.setAnimation(de.seatRight);break;case"Space":n.beforeHitState="none",n.keyHitPressed||(n.keyHitPressed=!0,"right"===n.directionValue?n.isAnimation([de.hitSeatRight])||(n.setAnimation(de.hitSeatRight),yield n.playOnce(),n.setAnimation(de.seatRight)):n.isAnimation([de.hitSeatLeft])||(n.setAnimation(de.hitSeatLeft),yield n.playOnce(),n.setAnimation(de.seatLeft)))}});return function(i){return r.apply(this,arguments)}}(),this.keyUp=function(){var r=re(function*(i){if("Space"===i.code&&(n.keyHitPressed=!1),"seat"!==n.moveStateValue)switch(i.code){case"KeyA":case"ArrowLeft":"left"===n.beforeJumpState&&(n.beforeJumpState="none"),n.isAnimation([de.toRunLeft,de.runLeft])&&(n.setAnimation(de.toStopLeft),n.moveStateValue="none",n.playOnce().then(()=>{"none"===n.moveStateValue&&n.setAnimation(de.onStayLeft,!0)}));break;case"KeyD":case"ArrowRight":"right"===n.beforeJumpState&&(n.beforeJumpState="none"),n.isAnimation([de.toRunRight,de.runRight])&&(n.setAnimation(de.toStopRight),n.moveStateValue="none",n.playOnce().then(()=>{"none"===n.moveStateValue&&n.setAnimation(de.onStayRight,!0)}))}else switch(i.code){case"KeyS":case"ArrowDown":"right"===n.directionValue?(n.setAnimation(de.fromSeatRight),yield n.playOnce(),n.setAnimation(de.onStayRight,!0)):(n.setAnimation(de.fromSeatLeft),yield n.playOnce(),n.setAnimation(de.onStayLeft,!0)),n.moveStateValue="none"}});return function(i){return r.apply(this,arguments)}}()}get direction(){return this.directionValue}get moveState(){return this.moveStateValue}onLanding(){["jump-running-right","jump-running-left"].includes(this.moveStateValue)?("right"===this.beforeJumpState?(this.setAnimation(de.runRight,!0),this.moveStateValue="right"):"left"===this.beforeJumpState?(this.setAnimation(de.runLeft,!0),this.moveStateValue="left"):(this.moveStateValue="none",this.setAnimation("right"===this.directionValue?de.fromJumpRight:de.fromJumpLeft,!0)),this.beforeJumpState="none"):"jump"===this.moveStateValue&&(this.moveStateValue="none",this.setAnimation("right"===this.directionValue?de.fromJumpRight:de.fromJumpLeft,!0)),this.velocityVector.y=0}run(){var e=this;return re(function*(){window.addEventListener("keydown",e.keyDown),window.addEventListener("keyup",e.keyUp),yield e.playOnce()})()}stopRun(){window.removeEventListener("keydown",this.keyDown),window.removeEventListener("keyup",this.keyUp)}initialize(){var e=()=>super.initialize,n=this;return re(function*(){yield n.spriteResources.add("batman","actors/hero");const r=n.spriteResources.get(39);if(!r)throw new Error("BatmanActor.initialize: \u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a...");yield e().call(n,r),n.setAnimation(de.onStayRight)})()}keyPressedIsMoveLeft(){this.directionValue="left","left"!==this.moveStateValue&&(this.isAnimation([de.toRunLeft,de.runLeft])||(this.setAnimation(de.toRunLeft),this.moveStateValue="left",this.playOnce().then(()=>this.setAnimation(de.runLeft,!0))))}keyPressedIsMoveRight(){this.directionValue="right","right"!==this.moveStateValue&&(this.isAnimation([de.toRunRight,de.runRight])||(this.setAnimation(de.toRunRight),this.moveStateValue="right",this.playOnce().then(()=>this.setAnimation(de.runRight,!0))))}}const ih=[[{x:0,y:205},{x:1350,y:205},{x:1450,y:160},{x:1580,y:160},{x:1580,y:205},{x:2670,y:205}],[{x:1660,y:120},{x:1800,y:120}],[{x:1870,y:80},{x:1915,y:80}],[{x:1935,y:80},{x:1980,y:80}],[{x:2005,y:65},{x:2080,y:65}],[{x:2110,y:80},{x:2155,y:80}],[{x:2175,y:80},{x:2215,y:80}]];class AU extends kD{constructor(){var e;super(...arguments),e=this,this.assetsPath="scenes/level-1",this.batmanActor=new xU(this.spriteResources),this.cafeContainer=new on,this.defCafeOffsetX=0,this.offsetGlobalX=0,this.offsetGroundX=0,this.halfScreenWidth=this.app.screen.width/2,this.gDebug=new ui,this.tickerUpdate=function(){var n=re(function*(r){console.log(e.batmanActor.direction,e.batmanActor.moveState),e.updateGraviti(r),e.updateMove(r)});return function(r){return n.apply(this,arguments)}}()}initialize(){var e=this;return re(function*(){fn.addBundle("bg",{bgSky:`${e.assetsPath}/bg-sky.png`,bgCity:`${e.assetsPath}/bg-city.png`,bgCorner:`${e.assetsPath}/bg-corner.png`,bgCafe:`${e.assetsPath}/bg-cafe.png`,bgGates:`${e.assetsPath}/gates.png`,bgGatesFront:`${e.assetsPath}/gates-front.png`,flashlight:`${e.assetsPath}/flashlight.png`,trashcan:`${e.assetsPath}/trashcan.png`}),e.sortableChildren=!0,e.gDebug.zIndex=100;const n=yield fn.loadBundle("bg");yield e.spriteResources.add("batman","actors/hero"),e.bgSky=new sl(n.bgSky,e.app.screen.width,244),e.bgCity=new sl(n.bgCity,e.app.screen.width,256),e.bgCity.y=10,e.bgCorner=new sl(n.bgCorner,e.app.screen.width,200),e.bgCorner.y=25,e.defCafeOffsetX=n.bgCorner.width,e.cafeContainer.x=e.defCafeOffsetX;const r=new dn(n.bgCafe);e.cafeContainer.addChild(r);const i=new dn(n.bgGates);i.x=r.x+r.width+150,e.cafeContainer.addChild(i);const s=new dn(n.flashlight);s.x=0,s.y=10,e.cafeContainer.addChild(s);const o=new dn(n.trashcan);o.x=r.x+r.width-30,o.y=e.cafeContainer.height-o.height-20,e.cafeContainer.addChild(o),e.addChild(e.bgSky),e.addChild(e.bgCity),e.addChild(e.bgCorner),e.addChild(e.cafeContainer),e.bgGatesFront=new dn(n.bgGatesFront),e.bgGatesFront.x=e.cafeContainer.x+e.cafeContainer.width-e.bgGatesFront.width,e.bgGatesFront.y=e.cafeContainer.height-e.bgGatesFront.height,e.bgGatesFront.zIndex=2,e.addChild(e.bgGatesFront),yield e.batmanActor.initialize(),e.batmanActor.zIndex=1,e.addChild(e.batmanActor),e.batmanActor.setY(210),e.debugGround(),e.scale.set(e.app.screen.height/235),e.halfScreenWidth=e.app.screen.width/e.scale.x/2})()}run(){var e=this;return re(function*(){yield e.batmanActor.run(),e.app.ticker.add(e.tickerUpdate)})()}updateMove(e){let n=0;switch(this.batmanActor.moveState){case"left":case"jump-running-left":n=1;break;case"jump-running-right":case"right":n=-1}this.offsetGlobalX-=n*e,this.offsetGlobalX<0&&(this.offsetGlobalX=0);const r=this.cafeContainer.width+this.cafeContainer.x<=this.app.screen.width/this.scale.x;let i=r;if(i||(i=this.offsetGlobalX+36<this.halfScreenWidth),i){let s=this.batmanActor.centerPoint.x-n*e;"right"===this.batmanActor.direction?s>=this.halfScreenWidth&&!r&&(s=this.halfScreenWidth):"left"===this.batmanActor.direction&&s<36&&(s=36),s>=this.app.screen.width/this.scale.x-this.batmanActor.width/2&&this.levelWin(),this.batmanActor.setX(s)}else this.offsetGroundX-=n*e,this.bgCity.tilePosition.x+=.1*n*e,this.bgCorner.tilePosition.x+=.8*n*e,this.cafeContainer.x+=1*n*e,this.bgGatesFront.x=this.cafeContainer.x+this.cafeContainer.width-this.bgGatesFront.width,this.gDebug.x+=1*n*e}updateGraviti(e){this.batmanActor.velocityVector.y+=this.batmanActor.gravity;const n=this.offsetGroundX+this.batmanActor.centerPoint.x,r=this.batmanActor.centerPoint.y+this.batmanActor.velocityVector.y*e,i={p1:{x:n,y:0},p2:{x:n,y:this.height}},s={x:n,y:r},o=[];for(let l=0;l<ih.length;l++){const u=ih[l];for(let c=1;c<u.length;c++){const d=cs.lineIntersect(i,{p1:{x:u[c-1].x,y:u[c-1].y},p2:{x:u[c].x,y:u[c].y}});if(d){const f=cs.distance(s,d);if(f>=0){o.push({d:f,y:d.y,down:r<d.y});break}}}}let a=null;if(o.length>0){const l={d:1/0,y:0},u={d:1/0,y:0};let c=!1;for(const h of o)h.down?l.d>h.d&&(l.d=h.d,l.y=h.y,c=!0):u.d>h.d&&(u.d=h.d,u.y=h.y);a=c?l.y:u.y}null!==a&&r>=a?(this.batmanActor.setY(a),this.batmanActor.onLanding()):this.batmanActor.setY(r)}levelWin(){this.stop(),this.scenesManager.show("loading").run({title:"\u041f\u043e\u0437\u0434\u0440\u0430\u0432\u043b\u044f\u0435\u043c!!! \u0412\u044b \u043f\u0440\u043e\u0448\u043b\u0438 \u0443\u0440\u043e\u0432\u0435\u043d\u044c!!!"})}stop(){this.batmanActor.stopRun(),this.batmanActor.visible=!1,this.app.ticker.remove(this.tickerUpdate)}debugGround(e=!1){if(e){this.gDebug.clear(),this.gDebug.lineStyle(1,16777215);for(let n=0;n<ih.length;n++){const r=ih[n];this.gDebug.moveTo(r[0].x,r[0].y);for(let i=1;i<r.length;i++)this.gDebug.lineTo(r[i].x,r[i].y)}this.addChild(this.gDebug)}}}class MU{constructor(e){this.app=e,this.scenesManager=new yU(this.app)}initializaion(){var e=this;return re(function*(){fn.init({basePath:"assets"}),fn.addBundle("fonts",{BatmanForever:"fonts/batmanforeveralternatecyr.ttf"}),yield fn.loadBundle("fonts"),yield e.scenesManager.add("loading",new _U(e.app)).initialize(),e.scenesManager.show("loading").run({title:"\u0418\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044f..."}),yield e.scenesManager.add("level-1",new AU(e.app)).initialize(),e.scenesManager.show("level-1").run()})()}}!function IL(t,e){jN({rootComponent:t,..._E(e)})}((()=>{var t;class e{constructor(r,i){this.elementRef=r,i.detach(),$e.defaultOptions.scaleMode=kr.NEAREST;const s=new Pg({antialias:!1,resolution:1,backgroundColor:0,autoDensity:!0});this.elementRef.nativeElement.appendChild(s.view),s.resizeTo=this.elementRef.nativeElement,new MU(s).initializaion()}}return(t=e).\u0275fac=function(r){return new(r||t)(Ke(ji),Ke(Cw))},t.\u0275cmp=xm({type:t,selectors:[["app-root"]],standalone:!0,features:[mx],decls:0,vars:0,template:function(r,i){},styles:["[_nghost-%COMP%]{flex:auto}"],changeDetection:0}),e})())},98:(Pe,tt,ne)=>{"use strict";var O=ne(491),ve=ne(436),Ee=ve(O("String.prototype.indexOf"));Pe.exports=function(ie,se){var te=O(ie,!!se);return"function"==typeof te&&Ee(ie,".prototype.")>-1?ve(te):te}},436:(Pe,tt,ne)=>{"use strict";var O=ne(333),ve=ne(491),Ee=ve("%Function.prototype.apply%"),xe=ve("%Function.prototype.call%"),ie=ve("%Reflect.apply%",!0)||O.call(xe,Ee),se=ve("%Object.getOwnPropertyDescriptor%",!0),te=ve("%Object.defineProperty%",!0),me=ve("%Math.max%");if(te)try{te({},"a",{value:1})}catch{te=null}Pe.exports=function(we){var oe=ie(O,xe,arguments);return se&&te&&se(oe,"length").configurable&&te(oe,"length",{value:1+me(0,we.length-(arguments.length-1))}),oe};var le=function(){return ie(O,Ee,arguments)};te?te(Pe.exports,"apply",{value:le}):Pe.exports.apply=le},145:Pe=>{"use strict";function tt(y,w,x){x=x||2;var F,V,W,H,q,ae,Ie,C=w&&w.length,P=C?w[0]*x:y.length,b=ne(y,0,P,x,!0),I=[];if(!b||b.next===b.prev)return I;if(C&&(b=function te(y,w,x,C){var b,I,W,P=[];for(b=0,I=w.length;b<I;b++)(W=ne(y,w[b]*C,b<I-1?w[b+1]*C:y.length,C,!1))===W.next&&(W.steiner=!0),P.push(De(W));for(P.sort(me),b=0;b<P.length;b++)x=le(P[b],x);return x}(y,w,b,x)),y.length>80*x){F=W=y[0],V=H=y[1];for(var Ce=x;Ce<P;Ce+=x)(q=y[Ce])<F&&(F=q),(ae=y[Ce+1])<V&&(V=ae),q>W&&(W=q),ae>H&&(H=ae);Ie=0!==(Ie=Math.max(W-F,H-V))?32767/Ie:0}return ve(b,I,x,F,V,Ie,0),I}function ne(y,w,x,C,P){var b,I;if(P===j(y,w,x,C)>0)for(b=w;b<x;b+=C)I=Le(b,y[b],y[b+1],I);else for(b=x-C;b>=w;b-=C)I=Le(b,y[b],y[b+1],I);return I&&k(I,I.next)&&(rt(I),I=I.next),I}function O(y,w){if(!y)return y;w||(w=y);var C,x=y;do{if(C=!1,x.steiner||!k(x,x.next)&&0!==S(x.prev,x,x.next))x=x.next;else{if(rt(x),(x=w=x.prev)===x.next)break;C=!0}}while(C||x!==w);return w}function ve(y,w,x,C,P,b,I){if(y){!I&&b&&function oe(y,w,x,C){var P=y;do{0===P.z&&(P.z=L(P.x,P.y,w,x,C)),P.prevZ=P.prev,P.nextZ=P.next,P=P.next}while(P!==y);P.prevZ.nextZ=null,P.prevZ=null,function be(y){var w,x,C,P,b,I,F,V,W=1;do{for(x=y,y=null,b=null,I=0;x;){for(I++,C=x,F=0,w=0;w<W&&(F++,C=C.nextZ);w++);for(V=W;F>0||V>0&&C;)0!==F&&(0===V||!C||x.z<=C.z)?(P=x,x=x.nextZ,F--):(P=C,C=C.nextZ,V--),b?b.nextZ=P:y=P,P.prevZ=b,b=P;x=C}b.nextZ=null,W*=2}while(I>1)}(P)}(y,C,P,b);for(var V,W,F=y;y.prev!==y.next;)if(V=y.prev,W=y.next,b?xe(y,C,P,b):Ee(y))w.push(V.i/x|0),w.push(y.i/x|0),w.push(W.i/x|0),rt(y),y=W.next,F=W.next;else if((y=W)===F){I?1===I?ve(y=ie(O(y),w,x),w,x,C,P,b,2):2===I&&se(y,w,x,C,P,b):ve(O(y),w,x,C,P,b,1);break}}}function Ee(y){var w=y.prev,x=y,C=y.next;if(S(w,x,C)>=0)return!1;for(var P=w.x,b=x.x,I=C.x,F=w.y,V=x.y,W=C.y,H=P<b?P<I?P:I:b<I?b:I,q=F<V?F<W?F:W:V<W?V:W,ae=P>b?P>I?P:I:b>I?b:I,Ie=F>V?F>W?F:W:V>W?V:W,Ce=C.next;Ce!==w;){if(Ce.x>=H&&Ce.x<=ae&&Ce.y>=q&&Ce.y<=Ie&&pe(P,F,b,V,I,W,Ce.x,Ce.y)&&S(Ce.prev,Ce,Ce.next)>=0)return!1;Ce=Ce.next}return!0}function xe(y,w,x,C){var P=y.prev,b=y,I=y.next;if(S(P,b,I)>=0)return!1;for(var F=P.x,V=b.x,W=I.x,H=P.y,q=b.y,ae=I.y,Ie=F<V?F<W?F:W:V<W?V:W,Ce=H<q?H<ae?H:ae:q<ae?q:ae,_t=F>V?F>W?F:W:V>W?V:W,nt=H>q?H>ae?H:ae:q>ae?q:ae,Ze=L(Ie,Ce,w,x,C),wt=L(_t,nt,w,x,C),Fe=y.prevZ,Ae=y.nextZ;Fe&&Fe.z>=Ze&&Ae&&Ae.z<=wt;){if(Fe.x>=Ie&&Fe.x<=_t&&Fe.y>=Ce&&Fe.y<=nt&&Fe!==P&&Fe!==I&&pe(F,H,V,q,W,ae,Fe.x,Fe.y)&&S(Fe.prev,Fe,Fe.next)>=0||(Fe=Fe.prevZ,Ae.x>=Ie&&Ae.x<=_t&&Ae.y>=Ce&&Ae.y<=nt&&Ae!==P&&Ae!==I&&pe(F,H,V,q,W,ae,Ae.x,Ae.y)&&S(Ae.prev,Ae,Ae.next)>=0))return!1;Ae=Ae.nextZ}for(;Fe&&Fe.z>=Ze;){if(Fe.x>=Ie&&Fe.x<=_t&&Fe.y>=Ce&&Fe.y<=nt&&Fe!==P&&Fe!==I&&pe(F,H,V,q,W,ae,Fe.x,Fe.y)&&S(Fe.prev,Fe,Fe.next)>=0)return!1;Fe=Fe.prevZ}for(;Ae&&Ae.z<=wt;){if(Ae.x>=Ie&&Ae.x<=_t&&Ae.y>=Ce&&Ae.y<=nt&&Ae!==P&&Ae!==I&&pe(F,H,V,q,W,ae,Ae.x,Ae.y)&&S(Ae.prev,Ae,Ae.next)>=0)return!1;Ae=Ae.nextZ}return!0}function ie(y,w,x){var C=y;do{var P=C.prev,b=C.next.next;!k(P,b)&&B(P,C,C.next,b)&&Z(P,b)&&Z(b,P)&&(w.push(P.i/x|0),w.push(C.i/x|0),w.push(b.i/x|0),rt(C),rt(C.next),C=y=b),C=C.next}while(C!==y);return O(C)}function se(y,w,x,C,P,b){var I=y;do{for(var F=I.next.next;F!==I.prev;){if(I.i!==F.i&&R(I,F)){var V=He(I,F);return I=O(I,I.next),V=O(V,V.next),ve(I,w,x,C,P,b,0),void ve(V,w,x,C,P,b,0)}F=F.next}I=I.next}while(I!==y)}function me(y,w){return y.x-w.x}function le(y,w){var x=function Me(y,w){var I,x=w,C=y.x,P=y.y,b=-1/0;do{if(P<=x.y&&P>=x.next.y&&x.next.y!==x.y){var F=x.x+(P-x.y)*(x.next.x-x.x)/(x.next.y-x.y);if(F<=C&&F>b&&(b=F,I=x.x<x.next.x?x:x.next,F===C))return I}x=x.next}while(x!==w);if(!I)return null;var ae,V=I,W=I.x,H=I.y,q=1/0;x=I;do{C>=x.x&&x.x>=W&&C!==x.x&&pe(P<H?C:b,P,W,H,P<H?b:C,P,x.x,x.y)&&(ae=Math.abs(P-x.y)/(C-x.x),Z(x,y)&&(ae<q||ae===q&&(x.x>I.x||x.x===I.x&&we(I,x)))&&(I=x,q=ae)),x=x.next}while(x!==V);return I}(y,w);if(!x)return w;var C=He(x,y);return O(C,C.next),O(x,x.next)}function we(y,w){return S(y.prev,y,w.prev)<0&&S(w.next,y,y.next)<0}function L(y,w,x,C,P){return(y=1431655765&((y=858993459&((y=252645135&((y=16711935&((y=(y-x)*P|0)|y<<8))|y<<4))|y<<2))|y<<1))|(w=1431655765&((w=858993459&((w=252645135&((w=16711935&((w=(w-C)*P|0)|w<<8))|w<<4))|w<<2))|w<<1))<<1}function De(y){var w=y,x=y;do{(w.x<x.x||w.x===x.x&&w.y<x.y)&&(x=w),w=w.next}while(w!==y);return x}function pe(y,w,x,C,P,b,I,F){return(P-I)*(w-F)>=(y-I)*(b-F)&&(y-I)*(C-F)>=(x-I)*(w-F)&&(x-I)*(b-F)>=(P-I)*(C-F)}function R(y,w){return y.next.i!==w.i&&y.prev.i!==w.i&&!function T(y,w){var x=y;do{if(x.i!==y.i&&x.next.i!==y.i&&x.i!==w.i&&x.next.i!==w.i&&B(x,x.next,y,w))return!0;x=x.next}while(x!==y);return!1}(y,w)&&(Z(y,w)&&Z(w,y)&&function E(y,w){var x=y,C=!1,P=(y.x+w.x)/2,b=(y.y+w.y)/2;do{x.y>b!=x.next.y>b&&x.next.y!==x.y&&P<(x.next.x-x.x)*(b-x.y)/(x.next.y-x.y)+x.x&&(C=!C),x=x.next}while(x!==y);return C}(y,w)&&(S(y.prev,y,w.prev)||S(y,w.prev,w))||k(y,w)&&S(y.prev,y,y.next)>0&&S(w.prev,w,w.next)>0)}function S(y,w,x){return(w.y-y.y)*(x.x-w.x)-(w.x-y.x)*(x.y-w.y)}function k(y,w){return y.x===w.x&&y.y===w.y}function B(y,w,x,C){var P=G(S(y,w,x)),b=G(S(y,w,C)),I=G(S(x,C,y)),F=G(S(x,C,w));return!!(P!==b&&I!==F||0===P&&z(y,x,w)||0===b&&z(y,C,w)||0===I&&z(x,y,C)||0===F&&z(x,w,C))}function z(y,w,x){return w.x<=Math.max(y.x,x.x)&&w.x>=Math.min(y.x,x.x)&&w.y<=Math.max(y.y,x.y)&&w.y>=Math.min(y.y,x.y)}function G(y){return y>0?1:y<0?-1:0}function Z(y,w){return S(y.prev,y,y.next)<0?S(y,w,y.next)>=0&&S(y,y.prev,w)>=0:S(y,w,y.prev)<0||S(y,y.next,w)<0}function He(y,w){var x=new Ne(y.i,y.x,y.y),C=new Ne(w.i,w.x,w.y),P=y.next,b=w.prev;return y.next=w,w.prev=y,x.next=P,P.prev=x,C.next=x,x.prev=C,b.next=C,C.prev=b,C}function Le(y,w,x,C){var P=new Ne(y,w,x);return C?(P.next=C.next,P.prev=C,C.next.prev=P,C.next=P):(P.prev=P,P.next=P),P}function rt(y){y.next.prev=y.prev,y.prev.next=y.next,y.prevZ&&(y.prevZ.nextZ=y.nextZ),y.nextZ&&(y.nextZ.prevZ=y.prevZ)}function Ne(y,w,x){this.i=y,this.x=w,this.y=x,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function j(y,w,x,C){for(var P=0,b=w,I=x-C;b<x;b+=C)P+=(y[I]-y[b])*(y[b+1]+y[I+1]),I=b;return P}Pe.exports=tt,Pe.exports.default=tt,tt.deviation=function(y,w,x,C){var P=w&&w.length,I=Math.abs(j(y,0,P?w[0]*x:y.length,x));if(P)for(var F=0,V=w.length;F<V;F++)I-=Math.abs(j(y,w[F]*x,F<V-1?w[F+1]*x:y.length,x));var q=0;for(F=0;F<C.length;F+=3){var ae=C[F]*x,Ie=C[F+1]*x,Ce=C[F+2]*x;q+=Math.abs((y[ae]-y[Ce])*(y[Ie+1]-y[ae+1])-(y[ae]-y[Ie])*(y[Ce+1]-y[ae+1]))}return 0===I&&0===q?0:Math.abs((q-I)/I)},tt.flatten=function(y){for(var w=y[0][0].length,x={vertices:[],holes:[],dimensions:w},C=0,P=0;P<y.length;P++){for(var b=0;b<y[P].length;b++)for(var I=0;I<w;I++)x.vertices.push(y[P][b][I]);P>0&&x.holes.push(C+=y[P-1].length)}return x}},472:Pe=>{"use strict";var tt=Object.prototype.hasOwnProperty,ne="~";function O(){}function ve(se,te,me){this.fn=se,this.context=te,this.once=me||!1}function Ee(se,te,me,le,Me){if("function"!=typeof me)throw new TypeError("The listener must be a function");var we=new ve(me,le||se,Me),oe=ne?ne+te:te;return se._events[oe]?se._events[oe].fn?se._events[oe]=[se._events[oe],we]:se._events[oe].push(we):(se._events[oe]=we,se._eventsCount++),se}function xe(se,te){0==--se._eventsCount?se._events=new O:delete se._events[te]}function ie(){this._events=new O,this._eventsCount=0}Object.create&&(O.prototype=Object.create(null),(new O).__proto__||(ne=!1)),ie.prototype.eventNames=function(){var me,le,te=[];if(0===this._eventsCount)return te;for(le in me=this._events)tt.call(me,le)&&te.push(ne?le.slice(1):le);return Object.getOwnPropertySymbols?te.concat(Object.getOwnPropertySymbols(me)):te},ie.prototype.listeners=function(te){var le=this._events[ne?ne+te:te];if(!le)return[];if(le.fn)return[le.fn];for(var Me=0,we=le.length,oe=new Array(we);Me<we;Me++)oe[Me]=le[Me].fn;return oe},ie.prototype.listenerCount=function(te){var le=this._events[ne?ne+te:te];return le?le.fn?1:le.length:0},ie.prototype.emit=function(te,me,le,Me,we,oe){var be=ne?ne+te:te;if(!this._events[be])return!1;var pe,R,L=this._events[be],De=arguments.length;if(L.fn){switch(L.once&&this.removeListener(te,L.fn,void 0,!0),De){case 1:return L.fn.call(L.context),!0;case 2:return L.fn.call(L.context,me),!0;case 3:return L.fn.call(L.context,me,le),!0;case 4:return L.fn.call(L.context,me,le,Me),!0;case 5:return L.fn.call(L.context,me,le,Me,we),!0;case 6:return L.fn.call(L.context,me,le,Me,we,oe),!0}for(R=1,pe=new Array(De-1);R<De;R++)pe[R-1]=arguments[R];L.fn.apply(L.context,pe)}else{var k,S=L.length;for(R=0;R<S;R++)switch(L[R].once&&this.removeListener(te,L[R].fn,void 0,!0),De){case 1:L[R].fn.call(L[R].context);break;case 2:L[R].fn.call(L[R].context,me);break;case 3:L[R].fn.call(L[R].context,me,le);break;case 4:L[R].fn.call(L[R].context,me,le,Me);break;default:if(!pe)for(k=1,pe=new Array(De-1);k<De;k++)pe[k-1]=arguments[k];L[R].fn.apply(L[R].context,pe)}}return!0},ie.prototype.on=function(te,me,le){return Ee(this,te,me,le,!1)},ie.prototype.once=function(te,me,le){return Ee(this,te,me,le,!0)},ie.prototype.removeListener=function(te,me,le,Me){var we=ne?ne+te:te;if(!this._events[we])return this;if(!me)return xe(this,we),this;var oe=this._events[we];if(oe.fn)oe.fn===me&&(!Me||oe.once)&&(!le||oe.context===le)&&xe(this,we);else{for(var be=0,L=[],De=oe.length;be<De;be++)(oe[be].fn!==me||Me&&!oe[be].once||le&&oe[be].context!==le)&&L.push(oe[be]);L.length?this._events[we]=1===L.length?L[0]:L:xe(this,we)}return this},ie.prototype.removeAllListeners=function(te){var me;return te?this._events[me=ne?ne+te:te]&&xe(this,me):(this._events=new O,this._eventsCount=0),this},ie.prototype.off=ie.prototype.removeListener,ie.prototype.addListener=ie.prototype.on,ie.prefixed=ne,ie.EventEmitter=ie,Pe.exports=ie},238:Pe=>{"use strict";var ne=Array.prototype.slice,O=Object.prototype.toString;Pe.exports=function(xe){var ie=this;if("function"!=typeof ie||"[object Function]"!==O.call(ie))throw new TypeError("Function.prototype.bind called on incompatible "+ie);for(var te,se=ne.call(arguments,1),le=Math.max(0,ie.length-se.length),Me=[],we=0;we<le;we++)Me.push("$"+we);if(te=Function("binder","return function ("+Me.join(",")+"){ return binder.apply(this,arguments); }")(function(){if(this instanceof te){var be=ie.apply(this,se.concat(ne.call(arguments)));return Object(be)===be?be:this}return ie.apply(xe,se.concat(ne.call(arguments)))}),ie.prototype){var oe=function(){};oe.prototype=ie.prototype,te.prototype=new oe,oe.prototype=null}return te}},333:(Pe,tt,ne)=>{"use strict";var O=ne(238);Pe.exports=Function.prototype.bind||O},491:(Pe,tt,ne)=>{"use strict";var O,ve=SyntaxError,Ee=Function,xe=TypeError,ie=function(Ne){try{return Ee('"use strict"; return ('+Ne+").constructor;")()}catch{}},se=Object.getOwnPropertyDescriptor;if(se)try{se({},"")}catch{se=null}var te=function(){throw new xe},me=se?function(){try{return te}catch{try{return se(arguments,"callee").get}catch{return te}}}():te,le=ne(152)(),Me=ne(28)(),we=Object.getPrototypeOf||(Me?function(Ne){return Ne.__proto__}:null),oe={},be=typeof Uint8Array>"u"||!we?O:we(Uint8Array),L={"%AggregateError%":typeof AggregateError>"u"?O:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?O:ArrayBuffer,"%ArrayIteratorPrototype%":le&&we?we([][Symbol.iterator]()):O,"%AsyncFromSyncIteratorPrototype%":O,"%AsyncFunction%":oe,"%AsyncGenerator%":oe,"%AsyncGeneratorFunction%":oe,"%AsyncIteratorPrototype%":oe,"%Atomics%":typeof Atomics>"u"?O:Atomics,"%BigInt%":typeof BigInt>"u"?O:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?O:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?O:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?O:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":typeof Float32Array>"u"?O:Float32Array,"%Float64Array%":typeof Float64Array>"u"?O:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?O:FinalizationRegistry,"%Function%":Ee,"%GeneratorFunction%":oe,"%Int8Array%":typeof Int8Array>"u"?O:Int8Array,"%Int16Array%":typeof Int16Array>"u"?O:Int16Array,"%Int32Array%":typeof Int32Array>"u"?O:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":le&&we?we(we([][Symbol.iterator]())):O,"%JSON%":"object"==typeof JSON?JSON:O,"%Map%":typeof Map>"u"?O:Map,"%MapIteratorPrototype%":typeof Map>"u"||!le||!we?O:we((new Map)[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?O:Promise,"%Proxy%":typeof Proxy>"u"?O:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":typeof Reflect>"u"?O:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?O:Set,"%SetIteratorPrototype%":typeof Set>"u"||!le||!we?O:we((new Set)[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?O:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":le&&we?we(""[Symbol.iterator]()):O,"%Symbol%":le?Symbol:O,"%SyntaxError%":ve,"%ThrowTypeError%":me,"%TypedArray%":be,"%TypeError%":xe,"%Uint8Array%":typeof Uint8Array>"u"?O:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?O:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?O:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?O:Uint32Array,"%URIError%":URIError,"%WeakMap%":typeof WeakMap>"u"?O:WeakMap,"%WeakRef%":typeof WeakRef>"u"?O:WeakRef,"%WeakSet%":typeof WeakSet>"u"?O:WeakSet};if(we)try{null.error}catch(Ne){var De=we(we(Ne));L["%Error.prototype%"]=De}var pe=function Ne(j){var y;if("%AsyncFunction%"===j)y=ie("async function () {}");else if("%GeneratorFunction%"===j)y=ie("function* () {}");else if("%AsyncGeneratorFunction%"===j)y=ie("async function* () {}");else if("%AsyncGenerator%"===j){var w=Ne("%AsyncGeneratorFunction%");w&&(y=w.prototype)}else if("%AsyncIteratorPrototype%"===j){var x=Ne("%AsyncGenerator%");x&&we&&(y=we(x.prototype))}return L[j]=y,y},R={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},S=ne(333),k=ne(533),B=S.call(Function.call,Array.prototype.concat),z=S.call(Function.apply,Array.prototype.splice),G=S.call(Function.call,String.prototype.replace),T=S.call(Function.call,String.prototype.slice),Z=S.call(Function.call,RegExp.prototype.exec),E=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,He=/\\(\\)?/g,rt=function(j,y){var x,w=j;if(k(R,w)&&(w="%"+(x=R[w])[0]+"%"),k(L,w)){var C=L[w];if(C===oe&&(C=pe(w)),typeof C>"u"&&!y)throw new xe("intrinsic "+j+" exists, but is not available. Please file an issue!");return{alias:x,name:w,value:C}}throw new ve("intrinsic "+j+" does not exist!")};Pe.exports=function(j,y){if("string"!=typeof j||0===j.length)throw new xe("intrinsic name must be a non-empty string");if(arguments.length>1&&"boolean"!=typeof y)throw new xe('"allowMissing" argument must be a boolean');if(null===Z(/^%?[^%]*%?$/,j))throw new ve("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var w=function(j){var y=T(j,0,1),w=T(j,-1);if("%"===y&&"%"!==w)throw new ve("invalid intrinsic syntax, expected closing `%`");if("%"===w&&"%"!==y)throw new ve("invalid intrinsic syntax, expected opening `%`");var x=[];return G(j,E,function(C,P,b,I){x[x.length]=b?G(I,He,"$1"):P||C}),x}(j),x=w.length>0?w[0]:"",C=rt("%"+x+"%",y),P=C.name,b=C.value,I=!1,F=C.alias;F&&(x=F[0],z(w,B([0,1],F)));for(var V=1,W=!0;V<w.length;V+=1){var H=w[V],q=T(H,0,1),ae=T(H,-1);if(('"'===q||"'"===q||"`"===q||'"'===ae||"'"===ae||"`"===ae)&&q!==ae)throw new ve("property names with quotes must have matching quotes");if(("constructor"===H||!W)&&(I=!0),k(L,P="%"+(x+="."+H)+"%"))b=L[P];else if(null!=b){if(!(H in b)){if(!y)throw new xe("base intrinsic for "+j+" exists, but the property is not available.");return}if(se&&V+1>=w.length){var Ie=se(b,H);b=(W=!!Ie)&&"get"in Ie&&!("originalValue"in Ie.get)?Ie.get:b[H]}else W=k(b,H),b=b[H];W&&!I&&(L[P]=b)}}return b}},28:Pe=>{"use strict";var tt={foo:{}},ne=Object;Pe.exports=function(){return{__proto__:tt}.foo===tt.foo&&!({__proto__:null}instanceof ne)}},152:(Pe,tt,ne)=>{"use strict";var O=typeof Symbol<"u"&&Symbol,ve=ne(441);Pe.exports=function(){return"function"==typeof O&&"function"==typeof Symbol&&"symbol"==typeof O("foo")&&"symbol"==typeof Symbol("bar")&&ve()}},441:Pe=>{"use strict";Pe.exports=function(){if("function"!=typeof Symbol||"function"!=typeof Object.getOwnPropertySymbols)return!1;if("symbol"==typeof Symbol.iterator)return!0;var ne={},O=Symbol("test"),ve=Object(O);if("string"==typeof O||"[object Symbol]"!==Object.prototype.toString.call(O)||"[object Symbol]"!==Object.prototype.toString.call(ve))return!1;for(O in ne[O]=42,ne)return!1;if("function"==typeof Object.keys&&0!==Object.keys(ne).length||"function"==typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(ne).length)return!1;var xe=Object.getOwnPropertySymbols(ne);if(1!==xe.length||xe[0]!==O||!Object.prototype.propertyIsEnumerable.call(ne,O))return!1;if("function"==typeof Object.getOwnPropertyDescriptor){var ie=Object.getOwnPropertyDescriptor(ne,O);if(42!==ie.value||!0!==ie.enumerable)return!1}return!0}},533:(Pe,tt,ne)=>{"use strict";var O=ne(333);Pe.exports=O.call(Function.call,Object.prototype.hasOwnProperty)},826:(Pe,tt,ne)=>{var O="function"==typeof Map&&Map.prototype,ve=Object.getOwnPropertyDescriptor&&O?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,Ee=O&&ve&&"function"==typeof ve.get?ve.get:null,xe=O&&Map.prototype.forEach,ie="function"==typeof Set&&Set.prototype,se=Object.getOwnPropertyDescriptor&&ie?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,te=ie&&se&&"function"==typeof se.get?se.get:null,me=ie&&Set.prototype.forEach,Me="function"==typeof WeakMap&&WeakMap.prototype?WeakMap.prototype.has:null,oe="function"==typeof WeakSet&&WeakSet.prototype?WeakSet.prototype.has:null,L="function"==typeof WeakRef&&WeakRef.prototype?WeakRef.prototype.deref:null,De=Boolean.prototype.valueOf,pe=Object.prototype.toString,R=Function.prototype.toString,S=String.prototype.match,k=String.prototype.slice,B=String.prototype.replace,z=String.prototype.toUpperCase,G=String.prototype.toLowerCase,T=RegExp.prototype.test,Z=Array.prototype.concat,E=Array.prototype.join,He=Array.prototype.slice,Le=Math.floor,rt="function"==typeof BigInt?BigInt.prototype.valueOf:null,Ne=Object.getOwnPropertySymbols,j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?Symbol.prototype.toString:null,y="function"==typeof Symbol&&"object"==typeof Symbol.iterator,w="function"==typeof Symbol&&Symbol.toStringTag&&(Symbol,1)?Symbol.toStringTag:null,x=Object.prototype.propertyIsEnumerable,C=("function"==typeof Reflect?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(M){return M.__proto__}:null);function P(M,N){if(M===1/0||M===-1/0||M!=M||M&&M>-1e3&&M<1e3||T.call(/e/,N))return N;var ht=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if("number"==typeof M){var vt=M<0?-Le(-M):Le(M);if(vt!==M){var Ot=String(vt),Je=k.call(N,Ot.length+1);return B.call(Ot,ht,"$&_")+"."+B.call(B.call(Je,/([0-9]{3})/g,"$&_"),/_$/,"")}}return B.call(N,ht,"$&_")}var b=ne(654),I=b.custom,F=Ze(I)?I:null;function V(M,N,ht){var vt="double"===(ht.quoteStyle||N)?'"':"'";return vt+M+vt}function W(M){return B.call(String(M),/"/g,"&quot;")}function H(M){return!("[object Array]"!==Nt(M)||w&&"object"==typeof M&&w in M)}function ae(M){return!("[object RegExp]"!==Nt(M)||w&&"object"==typeof M&&w in M)}function Ze(M){if(y)return M&&"object"==typeof M&&M instanceof Symbol;if("symbol"==typeof M)return!0;if(!M||"object"!=typeof M||!j)return!1;try{return j.call(M),!0}catch{}return!1}Pe.exports=function M(N,ht,vt,Ot){var Je=ht||{};if(Ae(Je,"quoteStyle")&&"single"!==Je.quoteStyle&&"double"!==Je.quoteStyle)throw new TypeError('option "quoteStyle" must be "single" or "double"');if(Ae(Je,"maxStringLength")&&("number"==typeof Je.maxStringLength?Je.maxStringLength<0&&Je.maxStringLength!==1/0:null!==Je.maxStringLength))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var xr=!Ae(Je,"customInspect")||Je.customInspect;if("boolean"!=typeof xr&&"symbol"!==xr)throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(Ae(Je,"indent")&&null!==Je.indent&&"\t"!==Je.indent&&!(parseInt(Je.indent,10)===Je.indent&&Je.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(Ae(Je,"numericSeparator")&&"boolean"!=typeof Je.numericSeparator)throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var $r=Je.numericSeparator;if(typeof N>"u")return"undefined";if(null===N)return"null";if("boolean"==typeof N)return N?"true":"false";if("string"==typeof N)return ms(N,Je);if("number"==typeof N){if(0===N)return 1/0/N>0?"0":"-0";var pn=String(N);return $r?P(N,pn):pn}if("bigint"==typeof N){var wr=String(N)+"n";return $r?P(N,wr):wr}var gl=typeof Je.depth>"u"?5:Je.depth;if(typeof vt>"u"&&(vt=0),vt>=gl&&gl>0&&"object"==typeof N)return H(N)?"[Array]":"[Object]";var zr=function pl(M,N){var ht;if("\t"===M.indent)ht="\t";else{if(!("number"==typeof M.indent&&M.indent>0))return null;ht=E.call(Array(M.indent+1)," ")}return{base:ht,prev:E.call(Array(N+1),ht)}}(Je,vt);if(typeof Ot>"u")Ot=[];else if(Mi(Ot,N)>=0)return"[Circular]";function bn(gn,xs,_l){if(xs&&(Ot=He.call(Ot)).push(xs),_l){var vl={depth:Je.depth};return Ae(Je,"quoteStyle")&&(vl.quoteStyle=Je.quoteStyle),M(gn,vl,vt+1,Ot)}return M(gn,Je,vt+1,Ot)}if("function"==typeof N&&!ae(N)){var Po=function gs(M){if(M.name)return M.name;var N=S.call(R.call(M),/^function\s*([\w$]+)/);return N?N[1]:null}(N),No=Ni(N,bn);return"[Function"+(Po?": "+Po:" (anonymous)")+"]"+(No.length>0?" { "+E.call(No,", ")+" }":"")}if(Ze(N)){var Oo=y?B.call(String(N),/^(Symbol\(.*\))_[^)]*$/,"$1"):j.call(N);return"object"!=typeof N||y?Oo:Pi(Oo)}if(function ch(M){return!(!M||"object"!=typeof M)&&(typeof HTMLElement<"u"&&M instanceof HTMLElement||"string"==typeof M.nodeName&&"function"==typeof M.getAttribute)}(N)){for(var Oi="<"+G.call(String(N.nodeName)),ys=N.attributes||[],Fi=0;Fi<ys.length;Fi++)Oi+=" "+ys[Fi].name+"="+V(W(ys[Fi].value),"double",Je);return Oi+=">",N.childNodes&&N.childNodes.length&&(Oi+="..."),Oi+"</"+G.call(String(N.nodeName))+">"}if(H(N)){if(0===N.length)return"[]";var _s=Ni(N,bn);return zr&&!function vr(M){for(var N=0;N<M.length;N++)if(Mi(M[N],"\n")>=0)return!1;return!0}(_s)?"["+Ro(_s,zr)+"]":"[ "+E.call(_s,", ")+" ]"}if(function Ie(M){return!("[object Error]"!==Nt(M)||w&&"object"==typeof M&&w in M)}(N)){var vs=Ni(N,bn);return"cause"in Error.prototype||!("cause"in N)||x.call(N,"cause")?0===vs.length?"["+String(N)+"]":"{ ["+String(N)+"] "+E.call(vs,", ")+" }":"{ ["+String(N)+"] "+E.call(Z.call("[cause]: "+bn(N.cause),vs),", ")+" }"}if("object"==typeof N&&xr){if(F&&"function"==typeof N[F]&&b)return b(N,{depth:gl-vt});if("symbol"!==xr&&"function"==typeof N.inspect)return N.inspect()}if(function Ri(M){if(!Ee||!M||"object"!=typeof M)return!1;try{Ee.call(M);try{te.call(M)}catch{return!0}return M instanceof Map}catch{}return!1}(N)){var Qn=[];return xe&&xe.call(N,function(gn,xs){Qn.push(bn(xs,N,!0)+" => "+bn(gn,N))}),fl("Map",Ee.call(N),Qn,zr)}if(function uh(M){if(!te||!M||"object"!=typeof M)return!1;try{te.call(M);try{Ee.call(M)}catch{return!0}return M instanceof Set}catch{}return!1}(N)){var ml=[];return me&&me.call(N,function(gn){ml.push(bn(gn,N))}),fl("Set",te.call(N),ml,zr)}if(function Io(M){if(!Me||!M||"object"!=typeof M)return!1;try{Me.call(M,Me);try{oe.call(M,oe)}catch{return!0}return M instanceof WeakMap}catch{}return!1}(N))return Mo("WeakMap");if(function Ao(M){if(!oe||!M||"object"!=typeof M)return!1;try{oe.call(M,oe);try{Me.call(M,Me)}catch{return!0}return M instanceof WeakSet}catch{}return!1}(N))return Mo("WeakSet");if(function hl(M){if(!L||!M||"object"!=typeof M)return!1;try{return L.call(M),!0}catch{}return!1}(N))return Mo("WeakRef");if(function _t(M){return!("[object Number]"!==Nt(M)||w&&"object"==typeof M&&w in M)}(N))return Pi(bn(Number(N)));if(function wt(M){if(!M||"object"!=typeof M||!rt)return!1;try{return rt.call(M),!0}catch{}return!1}(N))return Pi(bn(rt.call(N)));if(function nt(M){return!("[object Boolean]"!==Nt(M)||w&&"object"==typeof M&&w in M)}(N))return Pi(De.call(N));if(function Ce(M){return!("[object String]"!==Nt(M)||w&&"object"==typeof M&&w in M)}(N))return Pi(bn(String(N)));if(!function q(M){return!("[object Date]"!==Nt(M)||w&&"object"==typeof M&&w in M)}(N)&&!ae(N)){var Fo=Ni(N,bn),yl=C?C(N)===Object.prototype:N instanceof Object||N.constructor===Object,Lo=N instanceof Object?"":"null prototype",ko=!yl&&w&&Object(N)===N&&w in N?k.call(Nt(N),8,-1):Lo?"Object":"",Bo=(yl||"function"!=typeof N.constructor?"":N.constructor.name?N.constructor.name+" ":"")+(ko||Lo?"["+E.call(Z.call([],ko||[],Lo||[]),": ")+"] ":"");return 0===Fo.length?Bo+"{}":zr?Bo+"{"+Ro(Fo,zr)+"}":Bo+"{ "+E.call(Fo,", ")+" }"}return String(N)};var Fe=Object.prototype.hasOwnProperty||function(M){return M in this};function Ae(M,N){return Fe.call(M,N)}function Nt(M){return pe.call(M)}function Mi(M,N){if(M.indexOf)return M.indexOf(N);for(var ht=0,vt=M.length;ht<vt;ht++)if(M[ht]===N)return ht;return-1}function ms(M,N){if(M.length>N.maxStringLength){var ht=M.length-N.maxStringLength,vt="... "+ht+" more character"+(ht>1?"s":"");return ms(k.call(M,0,N.maxStringLength),N)+vt}return V(B.call(B.call(M,/(['\\])/g,"\\$1"),/[\x00-\x1f]/g,dl),"single",N)}function dl(M){var N=M.charCodeAt(0),ht={8:"b",9:"t",10:"n",12:"f",13:"r"}[N];return ht?"\\"+ht:"\\x"+(N<16?"0":"")+z.call(N.toString(16))}function Pi(M){return"Object("+M+")"}function Mo(M){return M+" { ? }"}function fl(M,N,ht,vt){return M+" ("+N+") {"+(vt?Ro(ht,vt):E.call(ht,", "))+"}"}function Ro(M,N){if(0===M.length)return"";var ht="\n"+N.prev+N.base;return ht+E.call(M,","+ht)+"\n"+N.prev}function Ni(M,N){var ht=H(M),vt=[];if(ht){vt.length=M.length;for(var Ot=0;Ot<M.length;Ot++)vt[Ot]=Ae(M,Ot)?N(M[Ot],M):""}var xr,Je="function"==typeof Ne?Ne(M):[];if(y){xr={};for(var $r=0;$r<Je.length;$r++)xr["$"+Je[$r]]=Je[$r]}for(var pn in M)Ae(M,pn)&&(ht&&String(Number(pn))===pn&&pn<M.length||y&&xr["$"+pn]instanceof Symbol||(T.call(/[^\w$]/,pn)?vt.push(N(pn,M)+": "+N(M[pn],M)):vt.push(pn+": "+N(M[pn],M))));if("function"==typeof Ne)for(var wr=0;wr<Je.length;wr++)x.call(M,Je[wr])&&vt.push("["+N(Je[wr])+"]: "+N(M[Je[wr]],M));return vt}},439:Pe=>{"use strict";var tt=String.prototype.replace,ne=/%20/g;Pe.exports={default:"RFC3986",formatters:{RFC1738:function(ve){return tt.call(ve,ne,"+")},RFC3986:function(ve){return String(ve)}},RFC1738:"RFC1738",RFC3986:"RFC3986"}},956:(Pe,tt,ne)=>{"use strict";var O=ne(562),ve=ne(625),Ee=ne(439);Pe.exports={formats:Ee,parse:ve,stringify:O}},625:(Pe,tt,ne)=>{"use strict";var O=ne(978),ve=Object.prototype.hasOwnProperty,Ee=Array.isArray,xe={allowDots:!1,allowPrototypes:!1,allowSparse:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decoder:O.decode,delimiter:"&",depth:5,ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictNullHandling:!1},se=function(be,L){return be&&"string"==typeof be&&L.comma&&be.indexOf(",")>-1?be.split(","):be},we=function(L,De,pe,R){if(L){var S=pe.allowDots?L.replace(/\.([^.[]+)/g,"[$1]"):L,B=/(\[[^[\]]*])/g,z=pe.depth>0&&/(\[[^[\]]*])/.exec(S),G=z?S.slice(0,z.index):S,T=[];if(G){if(!pe.plainObjects&&ve.call(Object.prototype,G)&&!pe.allowPrototypes)return;T.push(G)}for(var Z=0;pe.depth>0&&null!==(z=B.exec(S))&&Z<pe.depth;){if(Z+=1,!pe.plainObjects&&ve.call(Object.prototype,z[1].slice(1,-1))&&!pe.allowPrototypes)return;T.push(z[1])}return z&&T.push("["+S.slice(z.index)+"]"),function(be,L,De,pe){for(var R=pe?L:se(L,De),S=be.length-1;S>=0;--S){var k,B=be[S];if("[]"===B&&De.parseArrays)k=[].concat(R);else{k=De.plainObjects?Object.create(null):{};var z="["===B.charAt(0)&&"]"===B.charAt(B.length-1)?B.slice(1,-1):B,G=parseInt(z,10);De.parseArrays||""!==z?!isNaN(G)&&B!==z&&String(G)===z&&G>=0&&De.parseArrays&&G<=De.arrayLimit?(k=[])[G]=R:"__proto__"!==z&&(k[z]=R):k={0:R}}R=k}return R}(T,De,pe,R)}};Pe.exports=function(be,L){var De=function(L){if(!L)return xe;if(null!=L.decoder&&"function"!=typeof L.decoder)throw new TypeError("Decoder has to be a function.");if(typeof L.charset<"u"&&"utf-8"!==L.charset&&"iso-8859-1"!==L.charset)throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");return{allowDots:typeof L.allowDots>"u"?xe.allowDots:!!L.allowDots,allowPrototypes:"boolean"==typeof L.allowPrototypes?L.allowPrototypes:xe.allowPrototypes,allowSparse:"boolean"==typeof L.allowSparse?L.allowSparse:xe.allowSparse,arrayLimit:"number"==typeof L.arrayLimit?L.arrayLimit:xe.arrayLimit,charset:typeof L.charset>"u"?xe.charset:L.charset,charsetSentinel:"boolean"==typeof L.charsetSentinel?L.charsetSentinel:xe.charsetSentinel,comma:"boolean"==typeof L.comma?L.comma:xe.comma,decoder:"function"==typeof L.decoder?L.decoder:xe.decoder,delimiter:"string"==typeof L.delimiter||O.isRegExp(L.delimiter)?L.delimiter:xe.delimiter,depth:"number"==typeof L.depth||!1===L.depth?+L.depth:xe.depth,ignoreQueryPrefix:!0===L.ignoreQueryPrefix,interpretNumericEntities:"boolean"==typeof L.interpretNumericEntities?L.interpretNumericEntities:xe.interpretNumericEntities,parameterLimit:"number"==typeof L.parameterLimit?L.parameterLimit:xe.parameterLimit,parseArrays:!1!==L.parseArrays,plainObjects:"boolean"==typeof L.plainObjects?L.plainObjects:xe.plainObjects,strictNullHandling:"boolean"==typeof L.strictNullHandling?L.strictNullHandling:xe.strictNullHandling}}(L);if(""===be||null===be||typeof be>"u")return De.plainObjects?Object.create(null):{};for(var pe="string"==typeof be?function(L,De){var z,pe={},k=(De.ignoreQueryPrefix?L.replace(/^\?/,""):L).split(De.delimiter,De.parameterLimit===1/0?void 0:De.parameterLimit),B=-1,G=De.charset;if(De.charsetSentinel)for(z=0;z<k.length;++z)0===k[z].indexOf("utf8=")&&("utf8=%E2%9C%93"===k[z]?G="utf-8":"utf8=%26%2310003%3B"===k[z]&&(G="iso-8859-1"),B=z,z=k.length);for(z=0;z<k.length;++z)if(z!==B){var He,Le,T=k[z],Z=T.indexOf("]="),E=-1===Z?T.indexOf("="):Z+1;-1===E?(He=De.decoder(T,xe.decoder,G,"key"),Le=De.strictNullHandling?null:""):(He=De.decoder(T.slice(0,E),xe.decoder,G,"key"),Le=O.maybeMap(se(T.slice(E+1),De),function(rt){return De.decoder(rt,xe.decoder,G,"value")})),Le&&De.interpretNumericEntities&&"iso-8859-1"===G&&(Le=Le.replace(/&#(\d+);/g,function(L,De){return String.fromCharCode(parseInt(De,10))})),T.indexOf("[]=")>-1&&(Le=Ee(Le)?[Le]:Le),pe[He]=ve.call(pe,He)?O.combine(pe[He],Le):Le}return pe}(be,De):be,R=De.plainObjects?Object.create(null):{},S=Object.keys(pe),k=0;k<S.length;++k){var B=S[k],z=we(B,pe[B],De,"string"==typeof be);R=O.merge(R,z,De)}return!0===De.allowSparse?R:O.compact(R)}},562:(Pe,tt,ne)=>{"use strict";var O=ne(379),ve=ne(978),Ee=ne(439),xe=Object.prototype.hasOwnProperty,ie={brackets:function(S){return S+"[]"},comma:"comma",indices:function(S,k){return S+"["+k+"]"},repeat:function(S){return S}},se=Array.isArray,te=String.prototype.split,me=Array.prototype.push,le=function(R,S){me.apply(R,se(S)?S:[S])},Me=Date.prototype.toISOString,we=Ee.default,oe={addQueryPrefix:!1,allowDots:!1,charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encoder:ve.encode,encodeValuesOnly:!1,format:we,formatter:Ee.formatters[we],indices:!1,serializeDate:function(S){return Me.call(S)},skipNulls:!1,strictNullHandling:!1},L={},De=function R(S,k,B,z,G,T,Z,E,He,Le,rt,Ne,j,y,w,x){for(var C=S,P=x,b=0,I=!1;void 0!==(P=P.get(L))&&!I;){var F=P.get(S);if(b+=1,typeof F<"u"){if(F===b)throw new RangeError("Cyclic object value");I=!0}typeof P.get(L)>"u"&&(b=0)}if("function"==typeof E?C=E(k,C):C instanceof Date?C=rt(C):"comma"===B&&se(C)&&(C=ve.maybeMap(C,function(Nt){return Nt instanceof Date?rt(Nt):Nt})),null===C){if(G)return Z&&!y?Z(k,oe.encoder,w,"key",Ne):k;C=""}if(function(S){return"string"==typeof S||"number"==typeof S||"boolean"==typeof S||"symbol"==typeof S||"bigint"==typeof S}(C)||ve.isBuffer(C)){if(Z){var V=y?k:Z(k,oe.encoder,w,"key",Ne);if("comma"===B&&y){for(var W=te.call(String(C),","),H="",q=0;q<W.length;++q)H+=(0===q?"":",")+j(Z(W[q],oe.encoder,w,"value",Ne));return[j(V)+(z&&se(C)&&1===W.length?"[]":"")+"="+H]}return[j(V)+"="+j(Z(C,oe.encoder,w,"value",Ne))]}return[j(k)+"="+j(String(C))]}var Ie,ae=[];if(typeof C>"u")return ae;if("comma"===B&&se(C))Ie=[{value:C.length>0?C.join(",")||null:void 0}];else if(se(E))Ie=E;else{var Ce=Object.keys(C);Ie=He?Ce.sort(He):Ce}for(var _t=z&&se(C)&&1===C.length?k+"[]":k,nt=0;nt<Ie.length;++nt){var Ze=Ie[nt],wt="object"==typeof Ze&&typeof Ze.value<"u"?Ze.value:C[Ze];if(!T||null!==wt){var Fe=se(C)?"function"==typeof B?B(_t,Ze):_t:_t+(Le?"."+Ze:"["+Ze+"]");x.set(S,b);var Ae=O();Ae.set(L,x),le(ae,R(wt,Fe,B,z,G,T,Z,E,He,Le,rt,Ne,j,y,w,Ae))}}return ae};Pe.exports=function(R,S){var z,k=R,B=function(S){if(!S)return oe;if(null!==S.encoder&&typeof S.encoder<"u"&&"function"!=typeof S.encoder)throw new TypeError("Encoder has to be a function.");var k=S.charset||oe.charset;if(typeof S.charset<"u"&&"utf-8"!==S.charset&&"iso-8859-1"!==S.charset)throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var B=Ee.default;if(typeof S.format<"u"){if(!xe.call(Ee.formatters,S.format))throw new TypeError("Unknown format option provided.");B=S.format}var z=Ee.formatters[B],G=oe.filter;return("function"==typeof S.filter||se(S.filter))&&(G=S.filter),{addQueryPrefix:"boolean"==typeof S.addQueryPrefix?S.addQueryPrefix:oe.addQueryPrefix,allowDots:typeof S.allowDots>"u"?oe.allowDots:!!S.allowDots,charset:k,charsetSentinel:"boolean"==typeof S.charsetSentinel?S.charsetSentinel:oe.charsetSentinel,delimiter:typeof S.delimiter>"u"?oe.delimiter:S.delimiter,encode:"boolean"==typeof S.encode?S.encode:oe.encode,encoder:"function"==typeof S.encoder?S.encoder:oe.encoder,encodeValuesOnly:"boolean"==typeof S.encodeValuesOnly?S.encodeValuesOnly:oe.encodeValuesOnly,filter:G,format:B,formatter:z,serializeDate:"function"==typeof S.serializeDate?S.serializeDate:oe.serializeDate,skipNulls:"boolean"==typeof S.skipNulls?S.skipNulls:oe.skipNulls,sort:"function"==typeof S.sort?S.sort:null,strictNullHandling:"boolean"==typeof S.strictNullHandling?S.strictNullHandling:oe.strictNullHandling}}(S);"function"==typeof B.filter?k=(0,B.filter)("",k):se(B.filter)&&(z=B.filter);var T=[];if("object"!=typeof k||null===k)return"";var E=ie[S&&S.arrayFormat in ie?S.arrayFormat:S&&"indices"in S?S.indices?"indices":"repeat":"indices"];if(S&&"commaRoundTrip"in S&&"boolean"!=typeof S.commaRoundTrip)throw new TypeError("`commaRoundTrip` must be a boolean, or absent");var He="comma"===E&&S&&S.commaRoundTrip;z||(z=Object.keys(k)),B.sort&&z.sort(B.sort);for(var Le=O(),rt=0;rt<z.length;++rt){var Ne=z[rt];B.skipNulls&&null===k[Ne]||le(T,De(k[Ne],Ne,E,He,B.strictNullHandling,B.skipNulls,B.encode?B.encoder:null,B.filter,B.sort,B.allowDots,B.serializeDate,B.format,B.formatter,B.encodeValuesOnly,B.charset,Le))}var j=T.join(B.delimiter),y=!0===B.addQueryPrefix?"?":"";return B.charsetSentinel&&(y+="iso-8859-1"===B.charset?"utf8=%26%2310003%3B&":"utf8=%E2%9C%93&"),j.length>0?y+j:""}},978:(Pe,tt,ne)=>{"use strict";var O=ne(439),ve=Object.prototype.hasOwnProperty,Ee=Array.isArray,xe=function(){for(var pe=[],R=0;R<256;++R)pe.push("%"+((R<16?"0":"")+R.toString(16)).toUpperCase());return pe}(),se=function(R,S){for(var k=S&&S.plainObjects?Object.create(null):{},B=0;B<R.length;++B)typeof R[B]<"u"&&(k[B]=R[B]);return k};Pe.exports={arrayToObject:se,assign:function(R,S){return Object.keys(S).reduce(function(k,B){return k[B]=S[B],k},R)},combine:function(R,S){return[].concat(R,S)},compact:function(R){for(var S=[{obj:{o:R},prop:"o"}],k=[],B=0;B<S.length;++B)for(var z=S[B],G=z.obj[z.prop],T=Object.keys(G),Z=0;Z<T.length;++Z){var E=T[Z],He=G[E];"object"==typeof He&&null!==He&&-1===k.indexOf(He)&&(S.push({obj:G,prop:E}),k.push(He))}return function(R){for(;R.length>1;){var S=R.pop(),k=S.obj[S.prop];if(Ee(k)){for(var B=[],z=0;z<k.length;++z)typeof k[z]<"u"&&B.push(k[z]);S.obj[S.prop]=B}}}(S),R},decode:function(pe,R,S){var k=pe.replace(/\+/g," ");if("iso-8859-1"===S)return k.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(k)}catch{return k}},encode:function(R,S,k,B,z){if(0===R.length)return R;var G=R;if("symbol"==typeof R?G=Symbol.prototype.toString.call(R):"string"!=typeof R&&(G=String(R)),"iso-8859-1"===k)return escape(G).replace(/%u[0-9a-f]{4}/gi,function(He){return"%26%23"+parseInt(He.slice(2),16)+"%3B"});for(var T="",Z=0;Z<G.length;++Z){var E=G.charCodeAt(Z);45===E||46===E||95===E||126===E||E>=48&&E<=57||E>=65&&E<=90||E>=97&&E<=122||z===O.RFC1738&&(40===E||41===E)?T+=G.charAt(Z):E<128?T+=xe[E]:E<2048?T+=xe[192|E>>6]+xe[128|63&E]:E<55296||E>=57344?T+=xe[224|E>>12]+xe[128|E>>6&63]+xe[128|63&E]:(E=65536+((1023&E)<<10|1023&G.charCodeAt(Z+=1)),T+=xe[240|E>>18]+xe[128|E>>12&63]+xe[128|E>>6&63]+xe[128|63&E])}return T},isBuffer:function(R){return!(!R||"object"!=typeof R||!(R.constructor&&R.constructor.isBuffer&&R.constructor.isBuffer(R)))},isRegExp:function(R){return"[object RegExp]"===Object.prototype.toString.call(R)},maybeMap:function(R,S){if(Ee(R)){for(var k=[],B=0;B<R.length;B+=1)k.push(S(R[B]));return k}return S(R)},merge:function pe(R,S,k){if(!S)return R;if("object"!=typeof S){if(Ee(R))R.push(S);else{if(!R||"object"!=typeof R)return[R,S];(k&&(k.plainObjects||k.allowPrototypes)||!ve.call(Object.prototype,S))&&(R[S]=!0)}return R}if(!R||"object"!=typeof R)return[R].concat(S);var B=R;return Ee(R)&&!Ee(S)&&(B=se(R,k)),Ee(R)&&Ee(S)?(S.forEach(function(z,G){if(ve.call(R,G)){var T=R[G];T&&"object"==typeof T&&z&&"object"==typeof z?R[G]=pe(T,z,k):R.push(z)}else R[G]=z}),R):Object.keys(S).reduce(function(z,G){var T=S[G];return z[G]=ve.call(z,G)?pe(z[G],T,k):T,z},B)}}},379:(Pe,tt,ne)=>{"use strict";var O=ne(491),ve=ne(98),Ee=ne(826),xe=O("%TypeError%"),ie=O("%WeakMap%",!0),se=O("%Map%",!0),te=ve("WeakMap.prototype.get",!0),me=ve("WeakMap.prototype.set",!0),le=ve("WeakMap.prototype.has",!0),Me=ve("Map.prototype.get",!0),we=ve("Map.prototype.set",!0),oe=ve("Map.prototype.has",!0),be=function(R,S){for(var B,k=R;null!==(B=k.next);k=B)if(B.key===S)return k.next=B.next,B.next=R.next,R.next=B,B};Pe.exports=function(){var S,k,B,z={assert:function(G){if(!z.has(G))throw new xe("Side channel does not contain "+Ee(G))},get:function(G){if(ie&&G&&("object"==typeof G||"function"==typeof G)){if(S)return te(S,G)}else if(se){if(k)return Me(k,G)}else if(B)return function(R,S){var k=be(R,S);return k&&k.value}(B,G)},has:function(G){if(ie&&G&&("object"==typeof G||"function"==typeof G)){if(S)return le(S,G)}else if(se){if(k)return oe(k,G)}else if(B)return function(R,S){return!!be(R,S)}(B,G);return!1},set:function(G,T){ie&&G&&("object"==typeof G||"function"==typeof G)?(S||(S=new ie),me(S,G,T)):se?(k||(k=new se),we(k,G,T)):(B||(B={key:{},next:null}),function(R,S,k){var B=be(R,S);B?B.value=k:R.next={key:S,next:R.next,value:k}}(B,G,T))}};return z}},630:function(Pe,tt,ne){var O;Pe=ne.nmd(Pe),function(ve){"object"==typeof global&&global;var se,te=2147483647,me=36,Me=26,we=38,oe=700,pe=/^xn--/,R=/[^\x20-\x7E]/,S=/[\x2E\u3002\uFF0E\uFF61]/g,k={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},B=me-1,z=Math.floor,G=String.fromCharCode;function Z(b){throw new RangeError(k[b])}function E(b,I){for(var F=b.length,V=[];F--;)V[F]=I(b[F]);return V}function He(b,I){var F=b.split("@"),V="";return F.length>1&&(V=F[0]+"@",b=F[1]),V+E((b=b.replace(S,".")).split("."),I).join(".")}function Le(b){for(var W,H,I=[],F=0,V=b.length;F<V;)(W=b.charCodeAt(F++))>=55296&&W<=56319&&F<V?56320==(64512&(H=b.charCodeAt(F++)))?I.push(((1023&W)<<10)+(1023&H)+65536):(I.push(W),F--):I.push(W);return I}function rt(b){return E(b,function(I){var F="";return I>65535&&(F+=G((I-=65536)>>>10&1023|55296),I=56320|1023&I),F+G(I)}).join("")}function Ne(b){return b-48<10?b-22:b-65<26?b-65:b-97<26?b-97:me}function j(b,I){return b+22+75*(b<26)-((0!=I)<<5)}function y(b,I,F){var V=0;for(b=F?z(b/oe):b>>1,b+=z(b/I);b>B*Me>>1;V+=me)b=z(b/B);return z(V+(B+1)*b/(b+we))}function w(b){var V,ae,Ie,Ce,_t,nt,Ze,wt,Fe,Ae,I=[],F=b.length,W=0,H=128,q=72;for((ae=b.lastIndexOf("-"))<0&&(ae=0),Ie=0;Ie<ae;++Ie)b.charCodeAt(Ie)>=128&&Z("not-basic"),I.push(b.charCodeAt(Ie));for(Ce=ae>0?ae+1:0;Ce<F;){for(_t=W,nt=1,Ze=me;Ce>=F&&Z("invalid-input"),((wt=Ne(b.charCodeAt(Ce++)))>=me||wt>z((te-W)/nt))&&Z("overflow"),W+=wt*nt,!(wt<(Fe=Ze<=q?1:Ze>=q+Me?Me:Ze-q));Ze+=me)nt>z(te/(Ae=me-Fe))&&Z("overflow"),nt*=Ae;q=y(W-_t,V=I.length+1,0==_t),z(W/V)>te-H&&Z("overflow"),H+=z(W/V),W%=V,I.splice(W++,0,H)}return rt(I)}function x(b){var I,F,V,W,H,q,ae,Ie,Ce,_t,nt,wt,Fe,Ae,Nt,Ze=[];for(wt=(b=Le(b)).length,I=128,F=0,H=72,q=0;q<wt;++q)(nt=b[q])<128&&Ze.push(G(nt));for(V=W=Ze.length,W&&Ze.push("-");V<wt;){for(ae=te,q=0;q<wt;++q)(nt=b[q])>=I&&nt<ae&&(ae=nt);for(ae-I>z((te-F)/(Fe=V+1))&&Z("overflow"),F+=(ae-I)*Fe,I=ae,q=0;q<wt;++q)if((nt=b[q])<I&&++F>te&&Z("overflow"),nt==I){for(Ie=F,Ce=me;!(Ie<(_t=Ce<=H?1:Ce>=H+Me?Me:Ce-H));Ce+=me)Ze.push(G(j(_t+(Nt=Ie-_t)%(Ae=me-_t),0))),Ie=z(Nt/Ae);Ze.push(G(j(Ie,0))),H=y(F,Fe,V==W),F=0,++V}++F,++I}return Ze.join("")}se={version:"1.4.1",ucs2:{decode:Le,encode:rt},decode:w,encode:x,toASCII:function P(b){return He(b,function(I){return R.test(I)?"xn--"+x(I):I})},toUnicode:function C(b){return He(b,function(I){return pe.test(I)?w(I.slice(4).toLowerCase()):I})}},void 0!==(O=function(){return se}.call(tt,ne,tt,Pe))&&(Pe.exports=O)}()},445:(Pe,tt,ne)=>{"use strict";var ve=ne(630);function Ee(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var xe=/^([a-z0-9.+-]+:)/i,ie=/:[0-9]*$/,se=/^(\/\/?(?!\/)[^?\s]*)(\?[^\s]*)?$/,me=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),le=["'"].concat(me),Me=["%","/","?",";","#"].concat(le),we=["/","?","#"],be=/^[+a-z0-9A-Z_-]{0,63}$/,L=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,De={javascript:!0,"javascript:":!0},pe={javascript:!0,"javascript:":!0},R={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},S=ne(956);function k(T,Z,E){if(T&&"object"==typeof T&&T instanceof Ee)return T;var He=new Ee;return He.parse(T,Z,E),He}Ee.prototype.parse=function(T,Z,E){if("string"!=typeof T)throw new TypeError("Parameter 'url' must be a string, not "+typeof T);var He=T.indexOf("?"),Le=-1!==He&&He<T.indexOf("#")?"?":"#",rt=T.split(Le);rt[0]=rt[0].replace(/\\/g,"/");var j=T=rt.join(Le);if(j=j.trim(),!E&&1===T.split("#").length){var y=se.exec(j);if(y)return this.path=j,this.href=j,this.pathname=y[1],y[2]?(this.search=y[2],this.query=Z?S.parse(this.search.substr(1)):this.search.substr(1)):Z&&(this.search="",this.query={}),this}var w=xe.exec(j);if(w){var x=(w=w[0]).toLowerCase();this.protocol=x,j=j.substr(w.length)}if(E||w||j.match(/^\/\/[^@/]+@[^@/]+/)){var C="//"===j.substr(0,2);C&&(!w||!pe[w])&&(j=j.substr(2),this.slashes=!0)}if(!pe[w]&&(C||w&&!R[w])){for(var P=-1,b=0;b<we.length;b++)-1!==(I=j.indexOf(we[b]))&&(-1===P||I<P)&&(P=I);var F,V;for(-1!==(V=-1===P?j.lastIndexOf("@"):j.lastIndexOf("@",P))&&(F=j.slice(0,V),j=j.slice(V+1),this.auth=decodeURIComponent(F)),P=-1,b=0;b<Me.length;b++){var I;-1!==(I=j.indexOf(Me[b]))&&(-1===P||I<P)&&(P=I)}-1===P&&(P=j.length),this.host=j.slice(0,P),j=j.slice(P),this.parseHost(),this.hostname=this.hostname||"";var W="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!W)for(var H=this.hostname.split(/\./),q=(b=0,H.length);b<q;b++){var ae=H[b];if(ae&&!ae.match(be)){for(var Ie="",Ce=0,_t=ae.length;Ce<_t;Ce++)ae.charCodeAt(Ce)>127?Ie+="x":Ie+=ae[Ce];if(!Ie.match(be)){var nt=H.slice(0,b),Ze=H.slice(b+1),wt=ae.match(L);wt&&(nt.push(wt[1]),Ze.unshift(wt[2])),Ze.length&&(j="/"+Ze.join(".")+j),this.hostname=nt.join(".");break}}}this.hostname=this.hostname.length>255?"":this.hostname.toLowerCase(),W||(this.hostname=ve.toASCII(this.hostname)),this.host=(this.hostname||"")+(this.port?":"+this.port:""),this.href+=this.host,W&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==j[0]&&(j="/"+j))}if(!De[x])for(b=0,q=le.length;b<q;b++){var Nt=le[b];if(-1!==j.indexOf(Nt)){var gs=encodeURIComponent(Nt);gs===Nt&&(gs=escape(Nt)),j=j.split(Nt).join(gs)}}var Mi=j.indexOf("#");-1!==Mi&&(this.hash=j.substr(Mi),j=j.slice(0,Mi));var Ri=j.indexOf("?");return-1!==Ri?(this.search=j.substr(Ri),this.query=j.substr(Ri+1),Z&&(this.query=S.parse(this.query)),j=j.slice(0,Ri)):Z&&(this.search="",this.query={}),j&&(this.pathname=j),R[x]&&this.hostname&&!this.pathname&&(this.pathname="/"),(this.pathname||this.search)&&(this.path=(this.pathname||"")+(this.search||"")),this.href=this.format(),this},Ee.prototype.format=function(){var T=this.auth||"";T&&(T=(T=encodeURIComponent(T)).replace(/%3A/i,":"),T+="@");var Z=this.protocol||"",E=this.pathname||"",He=this.hash||"",Le=!1,rt="";this.host?Le=T+this.host:this.hostname&&(Le=T+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(Le+=":"+this.port)),this.query&&"object"==typeof this.query&&Object.keys(this.query).length&&(rt=S.stringify(this.query));var Ne=this.search||rt&&"?"+rt||"";return Z&&":"!==Z.substr(-1)&&(Z+=":"),this.slashes||(!Z||R[Z])&&!1!==Le?(Le="//"+(Le||""),E&&"/"!==E.charAt(0)&&(E="/"+E)):Le||(Le=""),He&&"#"!==He.charAt(0)&&(He="#"+He),Ne&&"?"!==Ne.charAt(0)&&(Ne="?"+Ne),Z+Le+(E=E.replace(/[?#]/g,function(j){return encodeURIComponent(j)}))+(Ne=Ne.replace("#","%23"))+He},Ee.prototype.resolve=function(T){return this.resolveObject(k(T,!1,!0)).format()},Ee.prototype.resolveObject=function(T){if("string"==typeof T){var Z=new Ee;Z.parse(T,!1,!0),T=Z}for(var E=new Ee,He=Object.keys(this),Le=0;Le<He.length;Le++){var rt=He[Le];E[rt]=this[rt]}if(E.hash=T.hash,""===T.href)return E.href=E.format(),E;if(T.slashes&&!T.protocol){for(var Ne=Object.keys(T),j=0;j<Ne.length;j++){var y=Ne[j];"protocol"!==y&&(E[y]=T[y])}return R[E.protocol]&&E.hostname&&!E.pathname&&(E.pathname="/",E.path=E.pathname),E.href=E.format(),E}if(T.protocol&&T.protocol!==E.protocol){if(!R[T.protocol]){for(var w=Object.keys(T),x=0;x<w.length;x++){var C=w[x];E[C]=T[C]}return E.href=E.format(),E}if(E.protocol=T.protocol,T.host||pe[T.protocol])E.pathname=T.pathname;else{for(var q=(T.pathname||"").split("/");q.length&&!(T.host=q.shift()););T.host||(T.host=""),T.hostname||(T.hostname=""),""!==q[0]&&q.unshift(""),q.length<2&&q.unshift(""),E.pathname=q.join("/")}return E.search=T.search,E.query=T.query,E.host=T.host||"",E.auth=T.auth,E.hostname=T.hostname||T.host,E.port=T.port,(E.pathname||E.search)&&(E.path=(E.pathname||"")+(E.search||"")),E.slashes=E.slashes||T.slashes,E.href=E.format(),E}var I=E.pathname&&"/"===E.pathname.charAt(0),F=T.host||T.pathname&&"/"===T.pathname.charAt(0),V=F||I||E.host&&T.pathname,W=V,H=E.pathname&&E.pathname.split("/")||[],ae=(q=T.pathname&&T.pathname.split("/")||[],E.protocol&&!R[E.protocol]);if(ae&&(E.hostname="",E.port=null,E.host&&(""===H[0]?H[0]=E.host:H.unshift(E.host)),E.host="",T.protocol&&(T.hostname=null,T.port=null,T.host&&(""===q[0]?q[0]=T.host:q.unshift(T.host)),T.host=null),V=V&&(""===q[0]||""===H[0])),F)E.host=T.host||""===T.host?T.host:E.host,E.hostname=T.hostname||""===T.hostname?T.hostname:E.hostname,E.search=T.search,E.query=T.query,H=q;else if(q.length)H||(H=[]),H.pop(),H=H.concat(q),E.search=T.search,E.query=T.query;else if(null!=T.search)return ae&&(E.host=H.shift(),E.hostname=E.host,(Ie=!!(E.host&&E.host.indexOf("@")>0)&&E.host.split("@"))&&(E.auth=Ie.shift(),E.hostname=Ie.shift(),E.host=E.hostname)),E.search=T.search,E.query=T.query,(null!==E.pathname||null!==E.search)&&(E.path=(E.pathname?E.pathname:"")+(E.search?E.search:"")),E.href=E.format(),E;if(!H.length)return E.pathname=null,E.path=E.search?"/"+E.search:null,E.href=E.format(),E;for(var Ce=H.slice(-1)[0],_t=(E.host||T.host||H.length>1)&&("."===Ce||".."===Ce)||""===Ce,nt=0,Ze=H.length;Ze>=0;Ze--)"."===(Ce=H[Ze])?H.splice(Ze,1):".."===Ce?(H.splice(Ze,1),nt++):nt&&(H.splice(Ze,1),nt--);if(!V&&!W)for(;nt--;nt)H.unshift("..");V&&""!==H[0]&&(!H[0]||"/"!==H[0].charAt(0))&&H.unshift(""),_t&&"/"!==H.join("/").substr(-1)&&H.push("");var Ie,wt=""===H[0]||H[0]&&"/"===H[0].charAt(0);return ae&&(E.hostname=wt?"":H.length?H.shift():"",E.host=E.hostname,(Ie=!!(E.host&&E.host.indexOf("@")>0)&&E.host.split("@"))&&(E.auth=Ie.shift(),E.hostname=Ie.shift(),E.host=E.hostname)),(V=V||E.host&&H.length)&&!wt&&H.unshift(""),H.length>0?E.pathname=H.join("/"):(E.pathname=null,E.path=null),(null!==E.pathname||null!==E.search)&&(E.path=(E.pathname?E.pathname:"")+(E.search?E.search:"")),E.auth=T.auth||E.auth,E.slashes=E.slashes||T.slashes,E.href=E.format(),E},Ee.prototype.parseHost=function(){var T=this.host,Z=ie.exec(T);Z&&(":"!==(Z=Z[0])&&(this.port=Z.substr(1)),T=T.substr(0,T.length-Z.length)),T&&(this.hostname=T)},tt.Qc=k,tt.DB=function z(T,Z){return k(T,!1,!0).resolve(Z)},tt.WU=function B(T){return"string"==typeof T&&(T=k(T)),T instanceof Ee?T.format():Ee.prototype.format.call(T)}},654:()=>{}},Pe=>{Pe(Pe.s=847)}]);